import{s as Mt,a as pt,e as It,c as mt,i as G,d as R,D as yt,E as yn,o as Di,r as Q,u as _t,f as ft,g as ut,h as at,v as Wt,F as Un,p as mi,x as Zt,y as $t,z as te,A as ee,j as J,G as of,H as es,I as lf,J as Fi,K as Y,L as _e,M as Ae,N as Hr,O as W,P as Ii,B as kt,C as hi,Q as We,R as cf,S as je,T as hf,U as fi,V as ff,W as Jn,X as uf,k as xn,Y as zn,l as At,m as Tt,n as Xe,Z as Ic,_ as Oe,$ as df,a0 as gf}from"../chunks/scheduler.wWm9UBBK.js";import{S as Nt,i as Lt,a as O,g as ae,t as B,c as oe,b as tt,d as et,m as it,e as nt,f as is,h as Io}from"../chunks/index.EhDeyRwD.js";import{t as pf,F as ao,g as Kt,a as ns,b as wt,W as mf,T as _f,e as ke,B as rs,V as H,c as Ri,P as oo,L as me,d as re,S as vf,M as Me,f as Te,h as yf,D as lo,i as Go,R as Gc,j as Gi,k as bf,l as wf,n as Bc,C as Uc,z as st,p as Sf,s as Vc,q as zc,r as Hc,v as Wc,w as jc,x as Cf,y as Af,A as Tf,E as Pf,G as kf,H as xf,I as Ef}from"../chunks/modalStore.WnkRK3wx.js";import{w as bn}from"../chunks/index.hgPQWPJq.js";import{b as Mf}from"../chunks/paths.iUnq6Ind.js";function Ff(r){const t=r-1;return t*t*t+1}function Rf(r){return--r*r*r*r*r+1}function Bo(r,{delay:t=0,duration:e=400,easing:i=Ff,axis:n="y"}={}){const s=getComputedStyle(r),a=+s.opacity,l=n==="y"?"height":"width",o=parseFloat(s[l]),c=n==="y"?["top","bottom"]:["left","right"],h=c.map(_=>`${_[0].toUpperCase()}${_.slice(1)}`),f=parseFloat(s[`padding${h[0]}`]),g=parseFloat(s[`padding${h[1]}`]),d=parseFloat(s[`margin${h[0]}`]),p=parseFloat(s[`margin${h[1]}`]),v=parseFloat(s[`border${h[0]}Width`]),b=parseFloat(s[`border${h[1]}Width`]);return{delay:t,duration:e,easing:i,css:_=>`overflow: hidden;opacity: ${Math.min(_*20,1)*a};${l}: ${_*o}px;padding-${c[0]}: ${_*f}px;padding-${c[1]}: ${_*g}px;margin-${c[0]}: ${_*d}px;margin-${c[1]}: ${_*p}px;border-${c[0]}-width: ${_*v}px;border-${c[1]}-width: ${_*b}px;`}}const dn=Math.min,Ei=Math.max,Wr=Math.round,or=Math.floor,ui=r=>({x:r,y:r}),Nf={left:"right",right:"left",bottom:"top",top:"bottom"},Lf={start:"end",end:"start"};function Ga(r,t,e){return Ei(r,dn(t,e))}function Qn(r,t){return typeof r=="function"?r(t):r}function Ni(r){return r.split("-")[0]}function Zn(r){return r.split("-")[1]}function Xc(r){return r==="x"?"y":"x"}function co(r){return r==="y"?"height":"width"}function ss(r){return["top","bottom"].includes(Ni(r))?"y":"x"}function ho(r){return Xc(ss(r))}function Of(r,t,e){e===void 0&&(e=!1);const i=Zn(r),n=ho(r),s=co(n);let a=n==="x"?i===(e?"end":"start")?"right":"left":i==="start"?"bottom":"top";return t.reference[s]>t.floating[s]&&(a=jr(a)),[a,jr(a)]}function Df(r){const t=jr(r);return[Ba(r),t,Ba(t)]}function Ba(r){return r.replace(/start|end/g,t=>Lf[t])}function If(r,t,e){const i=["left","right"],n=["right","left"],s=["top","bottom"],a=["bottom","top"];switch(r){case"top":case"bottom":return e?t?n:i:t?i:n;case"left":case"right":return t?s:a;default:return[]}}function Gf(r,t,e,i){const n=Zn(r);let s=If(Ni(r),e==="start",i);return n&&(s=s.map(a=>a+"-"+n),t&&(s=s.concat(s.map(Ba)))),s}function jr(r){return r.replace(/left|right|bottom|top/g,t=>Nf[t])}function Bf(r){return{top:0,right:0,bottom:0,left:0,...r}}function Yc(r){return typeof r!="number"?Bf(r):{top:r,right:r,bottom:r,left:r}}function Xr(r){return{...r,top:r.y,left:r.x,right:r.x+r.width,bottom:r.y+r.height}}function Uo(r,t,e){let{reference:i,floating:n}=r;const s=ss(t),a=ho(t),l=co(a),o=Ni(t),c=s==="y",h=i.x+i.width/2-n.width/2,f=i.y+i.height/2-n.height/2,g=i[l]/2-n[l]/2;let d;switch(o){case"top":d={x:h,y:i.y-n.height};break;case"bottom":d={x:h,y:i.y+i.height};break;case"right":d={x:i.x+i.width,y:f};break;case"left":d={x:i.x-n.width,y:f};break;default:d={x:i.x,y:i.y}}switch(Zn(t)){case"start":d[a]-=g*(e&&c?-1:1);break;case"end":d[a]+=g*(e&&c?-1:1);break}return d}const Uf=async(r,t,e)=>{const{placement:i="bottom",strategy:n="absolute",middleware:s=[],platform:a}=e,l=s.filter(Boolean),o=await(a.isRTL==null?void 0:a.isRTL(t));let c=await a.getElementRects({reference:r,floating:t,strategy:n}),{x:h,y:f}=Uo(c,i,o),g=i,d={},p=0;for(let v=0;v<l.length;v++){const{name:b,fn:_}=l[v],{x:w,y:u,data:m,reset:y}=await _({x:h,y:f,initialPlacement:i,placement:g,strategy:n,middlewareData:d,rects:c,platform:a,elements:{reference:r,floating:t}});if(h=w??h,f=u??f,d={...d,[b]:{...d[b],...m}},y&&p<=50){p++,typeof y=="object"&&(y.placement&&(g=y.placement),y.rects&&(c=y.rects===!0?await a.getElementRects({reference:r,floating:t,strategy:n}):y.rects),{x:h,y:f}=Uo(c,g,o)),v=-1;continue}}return{x:h,y:f,placement:g,strategy:n,middlewareData:d}};async function Kc(r,t){var e;t===void 0&&(t={});const{x:i,y:n,platform:s,rects:a,elements:l,strategy:o}=r,{boundary:c="clippingAncestors",rootBoundary:h="viewport",elementContext:f="floating",altBoundary:g=!1,padding:d=0}=Qn(t,r),p=Yc(d),b=l[g?f==="floating"?"reference":"floating":f],_=Xr(await s.getClippingRect({element:(e=await(s.isElement==null?void 0:s.isElement(b)))==null||e?b:b.contextElement||await(s.getDocumentElement==null?void 0:s.getDocumentElement(l.floating)),boundary:c,rootBoundary:h,strategy:o})),w=f==="floating"?{...a.floating,x:i,y:n}:a.reference,u=await(s.getOffsetParent==null?void 0:s.getOffsetParent(l.floating)),m=await(s.isElement==null?void 0:s.isElement(u))?await(s.getScale==null?void 0:s.getScale(u))||{x:1,y:1}:{x:1,y:1},y=Xr(s.convertOffsetParentRelativeRectToViewportRelativeRect?await s.convertOffsetParentRelativeRectToViewportRelativeRect({rect:w,offsetParent:u,strategy:o}):w);return{top:(_.top-y.top+p.top)/m.y,bottom:(y.bottom-_.bottom+p.bottom)/m.y,left:(_.left-y.left+p.left)/m.x,right:(y.right-_.right+p.right)/m.x}}const Vf=r=>({name:"arrow",options:r,async fn(t){const{x:e,y:i,placement:n,rects:s,platform:a,elements:l,middlewareData:o}=t,{element:c,padding:h=0}=Qn(r,t)||{};if(c==null)return{};const f=Yc(h),g={x:e,y:i},d=ho(n),p=co(d),v=await a.getDimensions(c),b=d==="y",_=b?"top":"left",w=b?"bottom":"right",u=b?"clientHeight":"clientWidth",m=s.reference[p]+s.reference[d]-g[d]-s.floating[p],y=g[d]-s.reference[d],S=await(a.getOffsetParent==null?void 0:a.getOffsetParent(c));let T=S?S[u]:0;(!T||!await(a.isElement==null?void 0:a.isElement(S)))&&(T=l.floating[u]||s.floating[p]);const C=m/2-y/2,A=T/2-v[p]/2-1,P=dn(f[_],A),k=dn(f[w],A),E=P,M=T-v[p]-k,F=T/2-v[p]/2+C,N=Ga(E,F,M),D=!o.arrow&&Zn(n)!=null&&F!=N&&s.reference[p]/2-(F<E?P:k)-v[p]/2<0,V=D?F<E?F-E:F-M:0;return{[d]:g[d]+V,data:{[d]:N,centerOffset:F-N-V,...D&&{alignmentOffset:V}},reset:D}}}),zf=function(r){return r===void 0&&(r={}),{name:"flip",options:r,async fn(t){var e,i;const{placement:n,middlewareData:s,rects:a,initialPlacement:l,platform:o,elements:c}=t,{mainAxis:h=!0,crossAxis:f=!0,fallbackPlacements:g,fallbackStrategy:d="bestFit",fallbackAxisSideDirection:p="none",flipAlignment:v=!0,...b}=Qn(r,t);if((e=s.arrow)!=null&&e.alignmentOffset)return{};const _=Ni(n),w=Ni(l)===l,u=await(o.isRTL==null?void 0:o.isRTL(c.floating)),m=g||(w||!v?[jr(l)]:Df(l));!g&&p!=="none"&&m.push(...Gf(l,v,p,u));const y=[l,...m],S=await Kc(t,b),T=[];let C=((i=s.flip)==null?void 0:i.overflows)||[];if(h&&T.push(S[_]),f){const E=Of(n,a,u);T.push(S[E[0]],S[E[1]])}if(C=[...C,{placement:n,overflows:T}],!T.every(E=>E<=0)){var A,P;const E=(((A=s.flip)==null?void 0:A.index)||0)+1,M=y[E];if(M)return{data:{index:E,overflows:C},reset:{placement:M}};let F=(P=C.filter(N=>N.overflows[0]<=0).sort((N,D)=>N.overflows[1]-D.overflows[1])[0])==null?void 0:P.placement;if(!F)switch(d){case"bestFit":{var k;const N=(k=C.map(D=>[D.placement,D.overflows.filter(V=>V>0).reduce((V,Z)=>V+Z,0)]).sort((D,V)=>D[1]-V[1])[0])==null?void 0:k[0];N&&(F=N);break}case"initialPlacement":F=l;break}if(n!==F)return{reset:{placement:F}}}return{}}}};async function Hf(r,t){const{placement:e,platform:i,elements:n}=r,s=await(i.isRTL==null?void 0:i.isRTL(n.floating)),a=Ni(e),l=Zn(e),o=ss(e)==="y",c=["left","top"].includes(a)?-1:1,h=s&&o?-1:1,f=Qn(t,r);let{mainAxis:g,crossAxis:d,alignmentAxis:p}=typeof f=="number"?{mainAxis:f,crossAxis:0,alignmentAxis:null}:{mainAxis:0,crossAxis:0,alignmentAxis:null,...f};return l&&typeof p=="number"&&(d=l==="end"?p*-1:p),o?{x:d*h,y:g*c}:{x:g*c,y:d*h}}const Wf=function(r){return r===void 0&&(r=0),{name:"offset",options:r,async fn(t){var e,i;const{x:n,y:s,placement:a,middlewareData:l}=t,o=await Hf(t,r);return a===((e=l.offset)==null?void 0:e.placement)&&(i=l.arrow)!=null&&i.alignmentOffset?{}:{x:n+o.x,y:s+o.y,data:{...o,placement:a}}}}},jf=function(r){return r===void 0&&(r={}),{name:"shift",options:r,async fn(t){const{x:e,y:i,placement:n}=t,{mainAxis:s=!0,crossAxis:a=!1,limiter:l={fn:b=>{let{x:_,y:w}=b;return{x:_,y:w}}},...o}=Qn(r,t),c={x:e,y:i},h=await Kc(t,o),f=ss(Ni(n)),g=Xc(f);let d=c[g],p=c[f];if(s){const b=g==="y"?"top":"left",_=g==="y"?"bottom":"right",w=d+h[b],u=d-h[_];d=Ga(w,d,u)}if(a){const b=f==="y"?"top":"left",_=f==="y"?"bottom":"right",w=p+h[b],u=p-h[_];p=Ga(w,p,u)}const v=l.fn({...t,[g]:d,[f]:p});return{...v,data:{x:v.x-e,y:v.y-i}}}}};function di(r){return qc(r)?(r.nodeName||"").toLowerCase():"#document"}function le(r){var t;return(r==null||(t=r.ownerDocument)==null?void 0:t.defaultView)||window}function Je(r){var t;return(t=(qc(r)?r.ownerDocument:r.document)||window.document)==null?void 0:t.documentElement}function qc(r){return r instanceof Node||r instanceof le(r).Node}function Ye(r){return r instanceof Element||r instanceof le(r).Element}function Fe(r){return r instanceof HTMLElement||r instanceof le(r).HTMLElement}function Vo(r){return typeof ShadowRoot>"u"?!1:r instanceof ShadowRoot||r instanceof le(r).ShadowRoot}function $n(r){const{overflow:t,overflowX:e,overflowY:i,display:n}=ve(r);return/auto|scroll|overlay|hidden|clip/.test(t+i+e)&&!["inline","contents"].includes(n)}function Xf(r){return["table","td","th"].includes(di(r))}function fo(r){const t=uo(),e=ve(r);return e.transform!=="none"||e.perspective!=="none"||(e.containerType?e.containerType!=="normal":!1)||!t&&(e.backdropFilter?e.backdropFilter!=="none":!1)||!t&&(e.filter?e.filter!=="none":!1)||["transform","perspective","filter"].some(i=>(e.willChange||"").includes(i))||["paint","layout","strict","content"].some(i=>(e.contain||"").includes(i))}function Yf(r){let t=gn(r);for(;Fe(t)&&!as(t);){if(fo(t))return t;t=gn(t)}return null}function uo(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function as(r){return["html","body","#document"].includes(di(r))}function ve(r){return le(r).getComputedStyle(r)}function os(r){return Ye(r)?{scrollLeft:r.scrollLeft,scrollTop:r.scrollTop}:{scrollLeft:r.pageXOffset,scrollTop:r.pageYOffset}}function gn(r){if(di(r)==="html")return r;const t=r.assignedSlot||r.parentNode||Vo(r)&&r.host||Je(r);return Vo(t)?t.host:t}function Jc(r){const t=gn(r);return as(t)?r.ownerDocument?r.ownerDocument.body:r.body:Fe(t)&&$n(t)?t:Jc(t)}function jn(r,t,e){var i;t===void 0&&(t=[]),e===void 0&&(e=!0);const n=Jc(r),s=n===((i=r.ownerDocument)==null?void 0:i.body),a=le(n);return s?t.concat(a,a.visualViewport||[],$n(n)?n:[],a.frameElement&&e?jn(a.frameElement):[]):t.concat(n,jn(n,[],e))}function Qc(r){const t=ve(r);let e=parseFloat(t.width)||0,i=parseFloat(t.height)||0;const n=Fe(r),s=n?r.offsetWidth:e,a=n?r.offsetHeight:i,l=Wr(e)!==s||Wr(i)!==a;return l&&(e=s,i=a),{width:e,height:i,$:l}}function go(r){return Ye(r)?r:r.contextElement}function un(r){const t=go(r);if(!Fe(t))return ui(1);const e=t.getBoundingClientRect(),{width:i,height:n,$:s}=Qc(t);let a=(s?Wr(e.width):e.width)/i,l=(s?Wr(e.height):e.height)/n;return(!a||!Number.isFinite(a))&&(a=1),(!l||!Number.isFinite(l))&&(l=1),{x:a,y:l}}const Kf=ui(0);function Zc(r){const t=le(r);return!uo()||!t.visualViewport?Kf:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function qf(r,t,e){return t===void 0&&(t=!1),!e||t&&e!==le(r)?!1:t}function Li(r,t,e,i){t===void 0&&(t=!1),e===void 0&&(e=!1);const n=r.getBoundingClientRect(),s=go(r);let a=ui(1);t&&(i?Ye(i)&&(a=un(i)):a=un(r));const l=qf(s,e,i)?Zc(s):ui(0);let o=(n.left+l.x)/a.x,c=(n.top+l.y)/a.y,h=n.width/a.x,f=n.height/a.y;if(s){const g=le(s),d=i&&Ye(i)?le(i):i;let p=g.frameElement;for(;p&&i&&d!==g;){const v=un(p),b=p.getBoundingClientRect(),_=ve(p),w=b.left+(p.clientLeft+parseFloat(_.paddingLeft))*v.x,u=b.top+(p.clientTop+parseFloat(_.paddingTop))*v.y;o*=v.x,c*=v.y,h*=v.x,f*=v.y,o+=w,c+=u,p=le(p).frameElement}}return Xr({width:h,height:f,x:o,y:c})}function Jf(r){let{rect:t,offsetParent:e,strategy:i}=r;const n=Fe(e),s=Je(e);if(e===s)return t;let a={scrollLeft:0,scrollTop:0},l=ui(1);const o=ui(0);if((n||!n&&i!=="fixed")&&((di(e)!=="body"||$n(s))&&(a=os(e)),Fe(e))){const c=Li(e);l=un(e),o.x=c.x+e.clientLeft,o.y=c.y+e.clientTop}return{width:t.width*l.x,height:t.height*l.y,x:t.x*l.x-a.scrollLeft*l.x+o.x,y:t.y*l.y-a.scrollTop*l.y+o.y}}function Qf(r){return Array.from(r.getClientRects())}function $c(r){return Li(Je(r)).left+os(r).scrollLeft}function Zf(r){const t=Je(r),e=os(r),i=r.ownerDocument.body,n=Ei(t.scrollWidth,t.clientWidth,i.scrollWidth,i.clientWidth),s=Ei(t.scrollHeight,t.clientHeight,i.scrollHeight,i.clientHeight);let a=-e.scrollLeft+$c(r);const l=-e.scrollTop;return ve(i).direction==="rtl"&&(a+=Ei(t.clientWidth,i.clientWidth)-n),{width:n,height:s,x:a,y:l}}function $f(r,t){const e=le(r),i=Je(r),n=e.visualViewport;let s=i.clientWidth,a=i.clientHeight,l=0,o=0;if(n){s=n.width,a=n.height;const c=uo();(!c||c&&t==="fixed")&&(l=n.offsetLeft,o=n.offsetTop)}return{width:s,height:a,x:l,y:o}}function tu(r,t){const e=Li(r,!0,t==="fixed"),i=e.top+r.clientTop,n=e.left+r.clientLeft,s=Fe(r)?un(r):ui(1),a=r.clientWidth*s.x,l=r.clientHeight*s.y,o=n*s.x,c=i*s.y;return{width:a,height:l,x:o,y:c}}function zo(r,t,e){let i;if(t==="viewport")i=$f(r,e);else if(t==="document")i=Zf(Je(r));else if(Ye(t))i=tu(t,e);else{const n=Zc(r);i={...t,x:t.x-n.x,y:t.y-n.y}}return Xr(i)}function th(r,t){const e=gn(r);return e===t||!Ye(e)||as(e)?!1:ve(e).position==="fixed"||th(e,t)}function eu(r,t){const e=t.get(r);if(e)return e;let i=jn(r,[],!1).filter(l=>Ye(l)&&di(l)!=="body"),n=null;const s=ve(r).position==="fixed";let a=s?gn(r):r;for(;Ye(a)&&!as(a);){const l=ve(a),o=fo(a);!o&&l.position==="fixed"&&(n=null),(s?!o&&!n:!o&&l.position==="static"&&!!n&&["absolute","fixed"].includes(n.position)||$n(a)&&!o&&th(r,a))?i=i.filter(h=>h!==a):n=l,a=gn(a)}return t.set(r,i),i}function iu(r){let{element:t,boundary:e,rootBoundary:i,strategy:n}=r;const a=[...e==="clippingAncestors"?eu(t,this._c):[].concat(e),i],l=a[0],o=a.reduce((c,h)=>{const f=zo(t,h,n);return c.top=Ei(f.top,c.top),c.right=dn(f.right,c.right),c.bottom=dn(f.bottom,c.bottom),c.left=Ei(f.left,c.left),c},zo(t,l,n));return{width:o.right-o.left,height:o.bottom-o.top,x:o.left,y:o.top}}function nu(r){return Qc(r)}function ru(r,t,e){const i=Fe(t),n=Je(t),s=e==="fixed",a=Li(r,!0,s,t);let l={scrollLeft:0,scrollTop:0};const o=ui(0);if(i||!i&&!s)if((di(t)!=="body"||$n(n))&&(l=os(t)),i){const c=Li(t,!0,s,t);o.x=c.x+t.clientLeft,o.y=c.y+t.clientTop}else n&&(o.x=$c(n));return{x:a.left+l.scrollLeft-o.x,y:a.top+l.scrollTop-o.y,width:a.width,height:a.height}}function Ho(r,t){return!Fe(r)||ve(r).position==="fixed"?null:t?t(r):r.offsetParent}function eh(r,t){const e=le(r);if(!Fe(r))return e;let i=Ho(r,t);for(;i&&Xf(i)&&ve(i).position==="static";)i=Ho(i,t);return i&&(di(i)==="html"||di(i)==="body"&&ve(i).position==="static"&&!fo(i))?e:i||Yf(r)||e}const su=async function(r){let{reference:t,floating:e,strategy:i}=r;const n=this.getOffsetParent||eh,s=this.getDimensions;return{reference:ru(t,await n(e),i),floating:{x:0,y:0,...await s(e)}}};function au(r){return ve(r).direction==="rtl"}const ou={convertOffsetParentRelativeRectToViewportRelativeRect:Jf,getDocumentElement:Je,getClippingRect:iu,getOffsetParent:eh,getElementRects:su,getClientRects:Qf,getDimensions:nu,getScale:un,isElement:Ye,isRTL:au};function lu(r,t){let e=null,i;const n=Je(r);function s(){clearTimeout(i),e&&e.disconnect(),e=null}function a(l,o){l===void 0&&(l=!1),o===void 0&&(o=1),s();const{left:c,top:h,width:f,height:g}=r.getBoundingClientRect();if(l||t(),!f||!g)return;const d=or(h),p=or(n.clientWidth-(c+f)),v=or(n.clientHeight-(h+g)),b=or(c),w={rootMargin:-d+"px "+-p+"px "+-v+"px "+-b+"px",threshold:Ei(0,dn(1,o))||1};let u=!0;function m(y){const S=y[0].intersectionRatio;if(S!==o){if(!u)return a();S?a(!1,S):i=setTimeout(()=>{a(!1,1e-7)},100)}u=!1}try{e=new IntersectionObserver(m,{...w,root:n.ownerDocument})}catch{e=new IntersectionObserver(m,w)}e.observe(r)}return a(!0),s}function Wo(r,t,e,i){i===void 0&&(i={});const{ancestorScroll:n=!0,ancestorResize:s=!0,elementResize:a=typeof ResizeObserver=="function",layoutShift:l=typeof IntersectionObserver=="function",animationFrame:o=!1}=i,c=go(r),h=n||s?[...c?jn(c):[],...jn(t)]:[];h.forEach(_=>{n&&_.addEventListener("scroll",e,{passive:!0}),s&&_.addEventListener("resize",e)});const f=c&&l?lu(c,e):null;let g=-1,d=null;a&&(d=new ResizeObserver(_=>{let[w]=_;w&&w.target===c&&d&&(d.unobserve(t),cancelAnimationFrame(g),g=requestAnimationFrame(()=>{d&&d.observe(t)})),e()}),c&&!o&&d.observe(c),d.observe(t));let p,v=o?Li(r):null;o&&b();function b(){const _=Li(r);v&&(_.x!==v.x||_.y!==v.y||_.width!==v.width||_.height!==v.height)&&e(),v=_,p=requestAnimationFrame(b)}return e(),()=>{h.forEach(_=>{n&&_.removeEventListener("scroll",e),s&&_.removeEventListener("resize",e)}),f&&f(),d&&d.disconnect(),d=null,o&&cancelAnimationFrame(p)}}const cu=(r,t,e)=>{const i=new Map,n={platform:ou,...e},s={...n.platform,_c:i};return Uf(r,t,{...n,platform:s})};function jo(r){let t;return{c(){t=ft("div")},l(e){t=ut(e,"DIV",{}),at(t).forEach(R)},m(e,i){G(e,t,i),r[23](t)},p:Wt,d(e){e&&R(t),r[23](null)}}}function Xo(r){let t,e;const i=[{use:r[9]},{options:r[3]},{role:"tooltip"},{tabindex:r[1]?-1:void 0},r[11]];let n={$$slots:{default:[hu]},$$scope:{ctx:r}};for(let s=0;s<i.length;s+=1)n=Q(n,i[s]);return t=new ao({props:n}),t.$on("focusin",function(){Un(ii(r[1],r[7]))&&ii(r[1],r[7]).apply(this,arguments)}),t.$on("focusout",function(){Un(ii(r[1],r[8]))&&ii(r[1],r[8]).apply(this,arguments)}),t.$on("mouseenter",function(){Un(ii(r[1]&&!r[4],r[7]))&&ii(r[1]&&!r[4],r[7]).apply(this,arguments)}),t.$on("mouseleave",function(){Un(ii(r[1]&&!r[4],r[8]))&&ii(r[1]&&!r[4],r[8]).apply(this,arguments)}),{c(){tt(t.$$.fragment)},l(s){et(t.$$.fragment,s)},m(s,a){it(t,s,a),e=!0},p(s,a){r=s;const l=a[0]&2570?Kt(i,[a[0]&512&&{use:r[9]},a[0]&8&&{options:r[3]},i[2],a[0]&2&&{tabindex:r[1]?-1:void 0},a[0]&2048&&ns(r[11])]):{};a[0]&16777284&&(l.$$scope={dirty:a,ctx:r}),t.$set(l)},i(s){e||(O(t.$$.fragment,s),e=!0)},o(s){B(t.$$.fragment,s),e=!1},d(s){nt(t,s)}}}function Yo(r){let t,e,i;return{c(){t=ft("div"),this.h()},l(n){t=ut(n,"DIV",{class:!0}),at(t).forEach(R),this.h()},h(){J(t,"class",r[6])},m(n,s){G(n,t,s),e||(i=of(r[10].call(null,t)),e=!0)},p(n,s){s[0]&64&&J(t,"class",n[6])},d(n){n&&R(t),e=!1,i()}}}function hu(r){let t,e,i;const n=r[22].default,s=Zt(n,r,r[24],null);let a=r[2]&&Yo(r);return{c(){s&&s.c(),t=pt(),a&&a.c(),e=It()},l(l){s&&s.l(l),t=mt(l),a&&a.l(l),e=It()},m(l,o){s&&s.m(l,o),G(l,t,o),a&&a.m(l,o),G(l,e,o),i=!0},p(l,o){s&&s.p&&(!i||o[0]&16777216)&&$t(s,n,l,l[24],i?ee(n,l[24],o,null):te(l[24]),null),l[2]?a?a.p(l,o):(a=Yo(l),a.c(),a.m(e.parentNode,e)):a&&(a.d(1),a=null)},i(l){i||(O(s,l),i=!0)},o(l){B(s,l),i=!1},d(l){l&&(R(t),R(e)),s&&s.d(l),a&&a.d(l)}}}function fu(r){let t,e,i,n=!r[3]&&jo(r),s=r[0]&&r[3]&&Xo(r);return{c(){n&&n.c(),t=pt(),s&&s.c(),e=It()},l(a){n&&n.l(a),t=mt(a),s&&s.l(a),e=It()},m(a,l){n&&n.m(a,l),G(a,t,l),s&&s.m(a,l),G(a,e,l),i=!0},p(a,l){a[3]?n&&(n.d(1),n=null):n?n.p(a,l):(n=jo(a),n.c(),n.m(t.parentNode,t)),a[0]&&a[3]?s?(s.p(a,l),l[0]&9&&O(s,1)):(s=Xo(a),s.c(),O(s,1),s.m(e.parentNode,e)):s&&(ae(),B(s,1,1,()=>{s=null}),oe())},i(a){i||(O(s),i=!0)},o(a){B(s),i=!1},d(a){a&&(R(t),R(e)),n&&n.d(a),s&&s.d(a)}}}function ii(r,t){return r?t:()=>{}}function uu(r,t,e){let i;const n=["activeContent","arrow","offset","placement","trigger","triggeredBy","reference","strategy","open","yOnly","middlewares"];let s=yt(t,n),{$$slots:a={},$$scope:l}=t,{activeContent:o=!1}=t,{arrow:c=!0}=t,{offset:h=8}=t,{placement:f="top"}=t,{trigger:g="hover"}=t,{triggeredBy:d=void 0}=t,{reference:p=void 0}=t,{strategy:v="absolute"}=t,{open:b=!1}=t,{yOnly:_=!1}=t,{middlewares:w=[zf(),jf()]}=t;const u=yn();let m,y,S,T,C,A=[],P=!1;const k=()=>(P=!0,setTimeout(()=>P=!1,250)),E=U=>{y===void 0&&console.error("trigger undefined"),!p&&A.includes(U.target)&&y!==U.target&&(e(3,y=U.target),k()),m&&U.type==="focusin"&&!b&&k(),e(0,b=m&&U.type==="click"&&!P?!b:!0)},M=U=>U.matches(":hover"),F=U=>U.contains(document.activeElement),N=U=>U!=null?`${U}px`:"",D=U=>{o?setTimeout(()=>{const I=[y,S,...A].filter(Boolean);U.type==="mouseleave"&&I.some(M)||U.type==="focusout"&&I.some(F)||e(0,b=!1)},100):e(0,b=!1)};let V;const Z={left:"right",right:"left",bottom:"top",top:"bottom"};function lt(){cu(y,S,{placement:f,strategy:v,middleware:i}).then(({x:U,y:I,middlewareData:j,placement:x,strategy:L})=>{S.style.position=L,S.style.left=_?"0":N(U),S.style.top=N(I),j.arrow&&T instanceof HTMLDivElement&&(e(20,T.style.left=N(j.arrow.x),T),e(20,T.style.top=N(j.arrow.y),T),e(21,V=Z[x.split("-")[0]]),e(20,T.style[V]=N(-T.offsetWidth/2-(t.border?1:0)),T))})}function K(U,I){S=U;let j=Wo(I,S,lt);return{update(x){j(),j=Wo(x,S,lt)},destroy(){j()}}}Di(()=>{const U=[["focusin",E,!0],["focusout",D,!0],["click",E,m],["mouseenter",E,!m],["mouseleave",D,!m]];return d?A=[...document.querySelectorAll(d)]:A=C.previousElementSibling?[C.previousElementSibling]:[],A.length||console.error("No triggers found."),A.forEach(I=>{I.tabIndex<0&&(I.tabIndex=0);for(const[j,x,L]of U)L&&I.addEventListener(j,x)}),p?(e(3,y=document.querySelector(p)??document.body),y===document.body?console.error(`Popup reference not found: '${p}'`):(y.addEventListener("focusout",D),m||y.addEventListener("mouseleave",D))):e(3,y=A[0]),()=>{A.forEach(I=>{if(I)for(const[j,x]of U)I.removeEventListener(j,x)}),y&&(y.removeEventListener("focusout",D),y.removeEventListener("mouseleave",D))}});let q;function gt(U){return e(20,T=U),{destroy(){e(20,T=null)}}}function St(U){mi[U?"unshift":"push"](()=>{C=U,e(5,C)})}return r.$$set=U=>{e(36,t=Q(Q({},t),_t(U))),e(11,s=yt(t,n)),"activeContent"in U&&e(1,o=U.activeContent),"arrow"in U&&e(2,c=U.arrow),"offset"in U&&e(12,h=U.offset),"placement"in U&&e(13,f=U.placement),"trigger"in U&&e(14,g=U.trigger),"triggeredBy"in U&&e(15,d=U.triggeredBy),"reference"in U&&e(16,p=U.reference),"strategy"in U&&e(17,v=U.strategy),"open"in U&&e(0,b=U.open),"yOnly"in U&&e(18,_=U.yOnly),"middlewares"in U&&e(19,w=U.middlewares),"$$scope"in U&&e(24,l=U.$$scope)},r.$$.update=()=>{r.$$.dirty[0]&16384&&e(4,m=g==="click"),r.$$.dirty[0]&1&&u("show",b),r.$$.dirty[0]&8200&&f&&(e(3,y),e(13,f)),r.$$.dirty[0]&1576960&&(i=[...w,Wf(+h),T&&Vf({element:T,padding:10})]),e(6,q=pf("absolute pointer-events-none block w-[10px] h-[10px] rotate-45 bg-inherit border-inherit",t.border&&V==="bottom"&&"border-b border-e",t.border&&V==="top"&&"border-t border-s ",t.border&&V==="right"&&"border-t border-e ",t.border&&V==="left"&&"border-b border-s "))},t=_t(t),[b,o,c,y,m,C,q,E,D,K,gt,s,h,f,g,d,p,v,_,w,T,V,a,St,l]}class du extends Nt{constructor(t){super(),Lt(this,t,uu,fu,Mt,{activeContent:1,arrow:2,offset:12,placement:13,trigger:14,triggeredBy:15,reference:16,strategy:17,open:0,yOnly:18,middlewares:19},null,[-1,-1])}}const gu=r=>({}),Ko=r=>({}),pu=r=>({}),qo=r=>({});function Jo(r){let t,e;const i=r[12].header,n=Zt(i,r,r[15],qo);return{c(){t=ft("div"),n&&n.c(),this.h()},l(s){t=ut(s,"DIV",{class:!0});var a=at(t);n&&n.l(a),a.forEach(R),this.h()},h(){J(t,"class",r[2])},m(s,a){G(s,t,a),n&&n.m(t,null),e=!0},p(s,a){n&&n.p&&(!e||a&32768)&&$t(n,i,s,s[15],e?ee(i,s[15],a,pu):te(s[15]),qo)},i(s){e||(O(n,s),e=!0)},o(s){B(n,s),e=!1},d(s){s&&R(t),n&&n.d(s)}}}function Qo(r){let t,e;const i=r[12].footer,n=Zt(i,r,r[15],Ko);return{c(){t=ft("div"),n&&n.c(),this.h()},l(s){t=ut(s,"DIV",{class:!0});var a=at(t);n&&n.l(a),a.forEach(R),this.h()},h(){J(t,"class",r[4])},m(s,a){G(s,t,a),n&&n.m(t,null),e=!0},p(s,a){n&&n.p&&(!e||a&32768)&&$t(n,i,s,s[15],e?ee(i,s[15],a,gu):te(s[15]),Ko)},i(s){e||(O(n,s),e=!0)},o(s){B(n,s),e=!1},d(s){s&&R(t),n&&n.d(s)}}}function mu(r){let t,e,i,n,s,a=r[6].header&&Jo(r);const l=r[12].default,o=Zt(l,r,r[15],null);let c=r[6].footer&&Qo(r);return{c(){a&&a.c(),t=pt(),e=ft("ul"),o&&o.c(),i=pt(),c&&c.c(),n=It(),this.h()},l(h){a&&a.l(h),t=mt(h),e=ut(h,"UL",{class:!0});var f=at(e);o&&o.l(f),f.forEach(R),i=mt(h),c&&c.l(h),n=It(),this.h()},h(){J(e,"class",r[3])},m(h,f){a&&a.m(h,f),G(h,t,f),G(h,e,f),o&&o.m(e,null),G(h,i,f),c&&c.m(h,f),G(h,n,f),s=!0},p(h,f){h[6].header?a?(a.p(h,f),f&64&&O(a,1)):(a=Jo(h),a.c(),O(a,1),a.m(t.parentNode,t)):a&&(ae(),B(a,1,1,()=>{a=null}),oe()),o&&o.p&&(!s||f&32768)&&$t(o,l,h,h[15],s?ee(l,h[15],f,null):te(h[15]),null),h[6].footer?c?(c.p(h,f),f&64&&O(c,1)):(c=Qo(h),c.c(),O(c,1),c.m(n.parentNode,n)):c&&(ae(),B(c,1,1,()=>{c=null}),oe())},i(h){s||(O(a),O(o,h),O(c),s=!0)},o(h){B(a),B(o,h),B(c),s=!1},d(h){h&&(R(t),R(e),R(i),R(n)),a&&a.d(h),o&&o.d(h),c&&c.d(h)}}}function _u(r){let t,e,i;const n=[{activeContent:!0},r[5],{class:r[1]}];function s(l){r[13](l)}let a={$$slots:{default:[mu]},$$scope:{ctx:r}};for(let l=0;l<n.length;l+=1)a=Q(a,n[l]);return r[0]!==void 0&&(a.open=r[0]),t=new du({props:a}),mi.push(()=>is(t,"open",s)),t.$on("show",r[14]),{c(){tt(t.$$.fragment)},l(l){et(t.$$.fragment,l)},m(l,o){it(t,l,o),i=!0},p(l,[o]){const c=o&34?Kt(n,[n[0],o&32&&ns(l[5]),o&2&&{class:l[1]}]):{};o&32832&&(c.$$scope={dirty:o,ctx:l}),!e&&o&1&&(e=!0,c.open=l[0],es(()=>e=!1)),t.$set(c)},i(l){i||(O(t.$$.fragment,l),i=!0)},o(l){B(t.$$.fragment,l),i=!1},d(l){nt(t,l)}}}function vu(r,t,e){const i=["activeUrl","open","containerClass","headerClass","footerClass","activeClass"];let n=yt(t,i),{$$slots:s={},$$scope:a}=t;const l=lf(s),o=bn("");let{activeUrl:c=""}=t,{open:h=!1}=t,{containerClass:f="divide-y z-50"}=t,{headerClass:g="py-1 overflow-hidden rounded-t-lg"}=t,{footerClass:d="py-1 overflow-hidden rounded-b-lg"}=t,{activeClass:p="text-primary-700 dark:text-primary-700 hover:text-primary-900 dark:hover:text-primary-900"}=t,v=wt(p,t.classActive);Fi("DropdownType",{activeClass:v}),Fi("activeUrl",o);let b=wt(f,t.classContainer),_=wt(g,t.classHeader),w=wt("py-1",t.class),u=wt(d,t.classFooter);function m(S){h=S,e(0,h)}function y(S){Y.call(this,r,S)}return r.$$set=S=>{e(18,t=Q(Q({},t),_t(S))),e(5,n=yt(t,i)),"activeUrl"in S&&e(7,c=S.activeUrl),"open"in S&&e(0,h=S.open),"containerClass"in S&&e(8,f=S.containerClass),"headerClass"in S&&e(9,g=S.headerClass),"footerClass"in S&&e(10,d=S.footerClass),"activeClass"in S&&e(11,p=S.activeClass),"$$scope"in S&&e(15,a=S.$$scope)},r.$$.update=()=>{r.$$.dirty&128&&o.set(c),e(5,n.arrow=n.arrow??!1,n),e(5,n.trigger=n.trigger??"click",n),e(5,n.placement=n.placement??"bottom",n),e(5,n.color=n.color??"dropdown",n),e(5,n.shadow=n.shadow??!0,n),e(5,n.rounded=n.rounded??!0,n)},t=_t(t),[h,b,_,w,u,n,l,c,f,g,d,p,s,m,y,a]}class Ua extends Nt{constructor(t){super(),Lt(this,t,vu,_u,Mt,{activeUrl:7,open:0,containerClass:8,headerClass:9,footerClass:10,activeClass:11})}}function yu(r){let t,e,i=[r[1],{class:e=wt(r[0],r[2].class)}],n={};for(let s=0;s<i.length;s+=1)n=Q(n,i[s]);return{c(){t=ft("div"),this.h()},l(s){t=ut(s,"DIV",{class:!0}),at(t).forEach(R),this.h()},h(){_e(t,n)},m(s,a){G(s,t,a)},p(s,[a]){_e(t,n=Kt(i,[a&2&&s[1],a&5&&e!==(e=wt(s[0],s[2].class))&&{class:e}]))},i:Wt,o:Wt,d(s){s&&R(t)}}}function bu(r,t,e){const i=["divClass"];let n=yt(t,i),{divClass:s="my-1 h-px bg-gray-100 dark:bg-gray-600"}=t;return r.$$set=a=>{e(2,t=Q(Q({},t),_t(a))),e(1,n=yt(t,i)),"divClass"in a&&e(0,s=a.divClass)},t=_t(t),[s,n,t]}class ih extends Nt{constructor(t){super(),Lt(this,t,bu,yu,Mt,{divClass:0})}}function na(r){let t,e,i,n,s,a;const l=r[9].default,o=Zt(l,r,r[18],null);let c=[{href:r[0]},{type:e=r[0]?void 0:"button"},{role:i=r[0]?"link":"button"},r[4],{class:r[2]}],h={};for(let f=0;f<c.length;f+=1)h=Q(h,c[f]);return{c(){t=ft(r[0]?"a":"button"),o&&o.c(),this.h()},l(f){t=ut(f,((r[0]?"a":"button")||"null").toUpperCase(),{href:!0,type:!0,role:!0,class:!0});var g=at(t);o&&o.l(g),g.forEach(R),this.h()},h(){Hr(r[0]?"a":"button")(t,h)},m(f,g){G(f,t,g),o&&o.m(t,null),n=!0,s||(a=[W(t,"click",r[10]),W(t,"change",r[11]),W(t,"keydown",r[12]),W(t,"keyup",r[13]),W(t,"focus",r[14]),W(t,"blur",r[15]),W(t,"mouseenter",r[16]),W(t,"mouseleave",r[17])],s=!0)},p(f,g){o&&o.p&&(!n||g&262144)&&$t(o,l,f,f[18],n?ee(l,f[18],g,null):te(f[18]),null),Hr(f[0]?"a":"button")(t,h=Kt(c,[(!n||g&1)&&{href:f[0]},(!n||g&1&&e!==(e=f[0]?void 0:"button"))&&{type:e},(!n||g&1&&i!==(i=f[0]?"link":"button"))&&{role:i},g&16&&f[4],(!n||g&4)&&{class:f[2]}]))},i(f){n||(O(o,f),n=!0)},o(f){B(o,f),n=!1},d(f){f&&R(t),o&&o.d(f),s=!1,Ii(a)}}}function wu(r){let t=r[0]?"a":"button",e,i,n=(r[0]?"a":"button")&&na(r);return{c(){n&&n.c(),e=It()},l(s){n&&n.l(s),e=It()},m(s,a){n&&n.m(s,a),G(s,e,a),i=!0},p(s,a){s[0],t?Mt(t,s[0]?"a":"button")?(n.d(1),n=na(s),t=s[0]?"a":"button",n.c(),n.m(e.parentNode,e)):n.p(s,a):(n=na(s),t=s[0]?"a":"button",n.c(),n.m(e.parentNode,e))},i(s){i||(O(n,s),i=!0)},o(s){B(n,s),i=!1},d(s){s&&R(e),n&&n.d(s)}}}function Su(r){let t,e;return t=new mf({props:{tag:"li",show:r[1],use:r[3],$$slots:{default:[wu]},$$scope:{ctx:r}}}),{c(){tt(t.$$.fragment)},l(i){et(t.$$.fragment,i)},m(i,n){it(t,i,n),e=!0},p(i,[n]){const s={};n&2&&(s.show=i[1]),n&262165&&(s.$$scope={dirty:n,ctx:i}),t.$set(s)},i(i){e||(O(t.$$.fragment,i),e=!0)},o(i){B(t.$$.fragment,i),e=!1},d(i){nt(t,i)}}}function Cu(r,t,e){let i,n;const s=["defaultClass","href","activeClass"];let a=yt(t,s),{$$slots:l={},$$scope:o}=t,{defaultClass:c="font-medium py-2 px-4 text-sm hover:bg-gray-100 dark:hover:bg-gray-600"}=t,{href:h=void 0}=t,{activeClass:f=void 0}=t;const g=Ae("DropdownType")??{},d=Ae("activeUrl");let p="";d.subscribe(A=>{e(7,p=A)});let v=!0;function b(A){e(1,v=A.parentElement?.tagName==="UL")}function _(A){Y.call(this,r,A)}function w(A){Y.call(this,r,A)}function u(A){Y.call(this,r,A)}function m(A){Y.call(this,r,A)}function y(A){Y.call(this,r,A)}function S(A){Y.call(this,r,A)}function T(A){Y.call(this,r,A)}function C(A){Y.call(this,r,A)}return r.$$set=A=>{e(21,t=Q(Q({},t),_t(A))),e(4,a=yt(t,s)),"defaultClass"in A&&e(5,c=A.defaultClass),"href"in A&&e(0,h=A.href),"activeClass"in A&&e(6,f=A.activeClass),"$$scope"in A&&e(18,o=A.$$scope)},r.$$.update=()=>{r.$$.dirty&129&&e(8,i=p?h===p:!1),e(2,n=wt(c,h?"block":"w-full text-left",i&&(f??g.activeClass),t.class))},t=_t(t),[h,v,n,b,a,c,f,p,i,l,_,w,u,m,y,S,T,C,o]}class ze extends Nt{constructor(t){super(),Lt(this,t,Cu,Su,Mt,{defaultClass:5,href:0,activeClass:6})}}function Au(r){let t,e,i,n,s,a,l,o;const c=r[8].default,h=Zt(c,r,r[7],null);let f=[r[6],{type:"file"},{class:"hidden"}],g={};for(let d=0;d<f.length;d+=1)g=Q(g,f[d]);return{c(){t=ft("button"),e=ft("label"),h&&h.c(),i=pt(),n=ft("input"),this.h()},l(d){t=ut(d,"BUTTON",{class:!0,type:!0});var p=at(t);e=ut(p,"LABEL",{class:!0,tabindex:!0});var v=at(e);h&&h.l(v),i=mt(v),n=ut(v,"INPUT",{type:!0,class:!0}),v.forEach(R),p.forEach(R),this.h()},h(){_e(n,g),J(e,"class","flex flex-col items-center"),J(e,"tabindex","0"),J(t,"class",s=wt(r[2],r[5].class)),J(t,"type","button")},m(d,p){G(d,t,p),kt(t,e),h&&h.m(e,null),kt(e,i),kt(e,n),n.autofocus&&n.focus(),r[21](n),a=!0,l||(o=[W(n,"change",r[20]),W(n,"change",r[18]),W(n,"click",r[19]),W(t,"keydown",r[4]),W(t,"focus",r[9]),W(t,"blur",r[10]),W(t,"mouseenter",r[11]),W(t,"mouseleave",r[12]),W(t,"mouseover",r[13]),W(t,"dragenter",r[14]),W(t,"dragleave",r[15]),W(t,"dragover",r[16]),W(t,"drop",r[17])],l=!0)},p(d,[p]){h&&h.p&&(!a||p&128)&&$t(h,c,d,d[7],a?ee(c,d[7],p,null):te(d[7]),null),_e(n,g=Kt(f,[p&64&&d[6],{type:"file"},{class:"hidden"}])),(!a||p&36&&s!==(s=wt(d[2],d[5].class)))&&J(t,"class",s)},i(d){a||(O(h,d),a=!0)},o(d){B(h,d),a=!1},d(d){d&&R(t),h&&h.d(d),r[21](null),l=!1,Ii(o)}}}function Tu(r,t,e){const i=["value","files","defaultClass"];let n=yt(t,i),{$$slots:s={},$$scope:a}=t,{value:l=""}=t,{files:o=void 0}=t,{defaultClass:c="flex flex-col justify-center items-center w-full h-64 bg-gray-50 rounded-lg border-2 border-gray-300 border-dashed cursor-pointer dark:hover:bg-bray-800 dark:bg-gray-700 hover:bg-gray-100 dark:border-gray-600 dark:hover:border-gray-500 dark:hover:bg-gray-600"}=t,h;function f(A){[" ","Enter"].includes(A.key)&&(A.preventDefault(),h.click())}function g(A){Y.call(this,r,A)}function d(A){Y.call(this,r,A)}function p(A){Y.call(this,r,A)}function v(A){Y.call(this,r,A)}function b(A){Y.call(this,r,A)}function _(A){Y.call(this,r,A)}function w(A){Y.call(this,r,A)}function u(A){Y.call(this,r,A)}function m(A){Y.call(this,r,A)}function y(A){Y.call(this,r,A)}function S(A){Y.call(this,r,A)}function T(){l=this.value,o=this.files,e(0,l),e(1,o)}function C(A){mi[A?"unshift":"push"](()=>{h=A,e(3,h)})}return r.$$set=A=>{e(5,t=Q(Q({},t),_t(A))),e(6,n=yt(t,i)),"value"in A&&e(0,l=A.value),"files"in A&&e(1,o=A.files),"defaultClass"in A&&e(2,c=A.defaultClass),"$$scope"in A&&e(7,a=A.$$scope)},t=_t(t),[l,o,c,h,f,t,n,a,s,g,d,p,v,b,_,w,u,m,y,S,T,C]}class Pu extends Nt{constructor(t){super(),Lt(this,t,Tu,Au,Mt,{value:0,files:1,defaultClass:2})}}function ku(r){let t,e,i;const n=r[3].default,s=Zt(n,r,r[2],null);return{c(){t=ft("div"),s&&s.c(),this.h()},l(a){t=ut(a,"DIV",{class:!0});var l=at(t);s&&s.l(l),l.forEach(R),this.h()},h(){J(t,"class",e=wt("mx-auto flex flex-wrap justify-between items-center ",r[0]?"w-full":"container",r[1].class))},m(a,l){G(a,t,l),s&&s.m(t,null),i=!0},p(a,[l]){s&&s.p&&(!i||l&4)&&$t(s,n,a,a[2],i?ee(n,a[2],l,null):te(a[2]),null),(!i||l&3&&e!==(e=wt("mx-auto flex flex-wrap justify-between items-center ",a[0]?"w-full":"container",a[1].class)))&&J(t,"class",e)},i(a){i||(O(s,a),i=!0)},o(a){B(s,a),i=!1},d(a){a&&R(t),s&&s.d(a)}}}function xu(r,t,e){let{$$slots:i={},$$scope:n}=t,{fluid:s=!1}=t;return r.$$set=a=>{e(1,t=Q(Q({},t),_t(a))),"fluid"in a&&e(0,s=a.fluid),"$$scope"in a&&e(2,n=a.$$scope)},t=_t(t),[s,t,n,i]}class nh extends Nt{constructor(t){super(),Lt(this,t,xu,ku,Mt,{fluid:0})}}const Eu=r=>({hidden:r&2}),Zo=r=>({hidden:r[1],toggle:r[3],NavContainer:nh});function Mu(r){let t;const e=r[6].default,i=Zt(e,r,r[7],Zo);return{c(){i&&i.c()},l(n){i&&i.l(n)},m(n,s){i&&i.m(n,s),t=!0},p(n,s){i&&i.p&&(!t||s&130)&&$t(i,e,n,n[7],t?ee(e,n[7],s,Eu):te(n[7]),Zo)},i(n){t||(O(i,n),t=!0)},o(n){B(i,n),t=!1},d(n){i&&i.d(n)}}}function Fu(r){let t,e;return t=new nh({props:{fluid:r[0],$$slots:{default:[Mu]},$$scope:{ctx:r}}}),{c(){tt(t.$$.fragment)},l(i){et(t.$$.fragment,i)},m(i,n){it(t,i,n),e=!0},p(i,n){const s={};n&1&&(s.fluid=i[0]),n&130&&(s.$$scope={dirty:n,ctx:i}),t.$set(s)},i(i){e||(O(t.$$.fragment,i),e=!0)},o(i){B(t.$$.fragment,i),e=!1},d(i){nt(t,i)}}}function Ru(r){let t,e;const i=[{tag:"nav"},r[4],{class:wt("px-2 sm:px-4 py-2.5 w-full",r[5].class)}];let n={$$slots:{default:[Fu]},$$scope:{ctx:r}};for(let s=0;s<i.length;s+=1)n=Q(n,i[s]);return t=new ao({props:n}),{c(){tt(t.$$.fragment)},l(s){et(t.$$.fragment,s)},m(s,a){it(t,s,a),e=!0},p(s,[a]){const l=a&48?Kt(i,[i[0],a&16&&ns(s[4]),a&32&&{class:wt("px-2 sm:px-4 py-2.5 w-full",s[5].class)}]):{};a&131&&(l.$$scope={dirty:a,ctx:s}),t.$set(l)},i(s){e||(O(t.$$.fragment,s),e=!0)},o(s){B(t.$$.fragment,s),e=!1},d(s){nt(t,s)}}}function Nu(r,t,e){const i=["fluid"];let n=yt(t,i),s,{$$slots:a={},$$scope:l}=t,{fluid:o=!1}=t,c=bn(!0);hi(r,c,f=>e(1,s=f)),Fi("navHidden",c);let h=()=>c.update(f=>!f);return r.$$set=f=>{e(5,t=Q(Q({},t),_t(f))),e(4,n=yt(t,i)),"fluid"in f&&e(0,o=f.fluid),"$$scope"in f&&e(7,l=f.$$scope)},r.$$.update=()=>{e(4,n.color=n.color??"navbar",n)},t=_t(t),[o,s,c,h,n,t,a,l]}class Lu extends Nt{constructor(t){super(),Lt(this,t,Nu,Ru,Mt,{fluid:0})}}function Ou(r){let t,e,i;const n=r[4].default,s=Zt(n,r,r[3],null);let a=[{href:r[0]},r[1],{class:e=wt("flex items-center",r[2].class)}],l={};for(let o=0;o<a.length;o+=1)l=Q(l,a[o]);return{c(){t=ft("a"),s&&s.c(),this.h()},l(o){t=ut(o,"A",{href:!0,class:!0});var c=at(t);s&&s.l(c),c.forEach(R),this.h()},h(){_e(t,l)},m(o,c){G(o,t,c),s&&s.m(t,null),i=!0},p(o,[c]){s&&s.p&&(!i||c&8)&&$t(s,n,o,o[3],i?ee(n,o[3],c,null):te(o[3]),null),_e(t,l=Kt(a,[(!i||c&1)&&{href:o[0]},c&2&&o[1],(!i||c&4&&e!==(e=wt("flex items-center",o[2].class)))&&{class:e}]))},i(o){i||(O(s,o),i=!0)},o(o){B(s,o),i=!1},d(o){o&&R(t),s&&s.d(o)}}}function Du(r,t,e){const i=["href"];let n=yt(t,i),{$$slots:s={},$$scope:a}=t,{href:l=""}=t;return r.$$set=o=>{e(2,t=Q(Q({},t),_t(o))),e(1,n=yt(t,i)),"href"in o&&e(0,l=o.href),"$$scope"in o&&e(3,a=o.$$scope)},t=_t(t),[l,n,t,a,s]}class Iu extends Nt{constructor(t){super(),Lt(this,t,Du,Ou,Mt,{href:0})}}function Gu(r){let t,e,i,n,s,a=[{xmlns:"http://www.w3.org/2000/svg"},{role:"button"},{tabindex:"0"},{width:r[0]},{height:r[0]},{class:i=r[4].class},r[5],{"aria-label":r[1]},{fill:"none"},{viewBox:r[2]},{"stroke-width":"2"}],l={};for(let o=0;o<a.length;o+=1)l=Q(l,a[o]);return{c(){t=We("svg"),e=new cf(!0),this.h()},l(o){t=je(o,"svg",{xmlns:!0,role:!0,tabindex:!0,width:!0,height:!0,class:!0,"aria-label":!0,fill:!0,viewBox:!0,"stroke-width":!0});var c=at(t);e=hf(c,!0),c.forEach(R),this.h()},h(){e.a=null,fi(t,l)},m(o,c){G(o,t,c),e.m(r[3],t),n||(s=W(t,"click",r[8]),n=!0)},p(o,[c]){c&8&&e.p(o[3]),fi(t,l=Kt(a,[{xmlns:"http://www.w3.org/2000/svg"},{role:"button"},{tabindex:"0"},c&1&&{width:o[0]},c&1&&{height:o[0]},c&16&&i!==(i=o[4].class)&&{class:i},c&32&&o[5],c&2&&{"aria-label":o[1]},{fill:"none"},c&4&&{viewBox:o[2]},{"stroke-width":"2"}]))},i:Wt,o:Wt,d(o){o&&R(t),n=!1,s()}}}function Bu(r,t,e){const i=["size","color","variation","ariaLabel"];let n=yt(t,i),{size:s="24"}=t,{color:a="currentColor"}=t,{variation:l="outline"}=t,{ariaLabel:o="bars 3"}=t,c,h,f=`<path stroke="${a}" stroke-linecap="round" stroke-linejoin="round" d="M4 6h16M4 12h16M4 18h16"></path> `,g=`<path fill="${a}" clip-rule="evenodd" fill-rule="evenodd" d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z"></path> `;function d(p){Y.call(this,r,p)}return r.$$set=p=>{e(4,t=Q(Q({},t),_t(p))),e(5,n=yt(t,i)),"size"in p&&e(0,s=p.size),"color"in p&&e(6,a=p.color),"variation"in p&&e(7,l=p.variation),"ariaLabel"in p&&e(1,o=p.ariaLabel)},r.$$.update=()=>{if(r.$$.dirty&128)switch(l){case"outline":e(3,h=f),e(2,c="0 0 24 24");break;case"solid":e(3,h=g),e(2,c="0 0 24 24");break;default:e(3,h=f),e(2,c="0 0 24 24")}},t=_t(t),[s,o,c,h,t,n,a,l,d]}class Uu extends Nt{constructor(t){super(),Lt(this,t,Bu,Gu,Mt,{size:0,color:6,variation:7,ariaLabel:1})}}function Vu(r){let t,e;return t=new Uu({props:{class:wt(r[0],r[4].classMenu)}}),{c(){tt(t.$$.fragment)},l(i){et(t.$$.fragment,i)},m(i,n){it(t,i,n),e=!0},p(i,n){const s={};n&17&&(s.class=wt(i[0],i[4].classMenu)),t.$set(s)},i(i){e||(O(t.$$.fragment,i),e=!0)},o(i){B(t.$$.fragment,i),e=!1},d(i){nt(t,i)}}}function zu(r){let t,e;const i=[{name:"Open main menu"},r[3],{class:wt($o,r[4].class)}];let n={$$slots:{default:[Vu]},$$scope:{ctx:r}};for(let s=0;s<i.length;s+=1)n=Q(n,i[s]);return t=new _f({props:n}),t.$on("click",function(){Un(r[1]||r[2])&&(r[1]||r[2]).apply(this,arguments)}),{c(){tt(t.$$.fragment)},l(s){et(t.$$.fragment,s)},m(s,a){it(t,s,a),e=!0},p(s,[a]){r=s;const l=a&24?Kt(i,[i[0],a&8&&ns(r[3]),a&16&&{class:wt($o,r[4].class)}]):{};a&81&&(l.$$scope={dirty:a,ctx:r}),t.$set(l)},i(s){e||(O(t.$$.fragment,s),e=!0)},o(s){B(t.$$.fragment,s),e=!1},d(s){nt(t,s)}}}let $o="ms-3 md:hidden";function Hu(r,t,e){const i=["menuClass","onClick"];let n=yt(t,i),{menuClass:s="h-6 w-6 shrink-0"}=t,{onClick:a=void 0}=t,l=Ae("navHidden")??bn(!0);const o=c=>l.update(h=>!h);return r.$$set=c=>{e(4,t=Q(Q({},t),_t(c))),e(3,n=yt(t,i)),"menuClass"in c&&e(0,s=c.menuClass),"onClick"in c&&e(1,a=c.onClick)},t=_t(t),[s,a,o,n,t]}class Wu extends Nt{constructor(t){super(),Lt(this,t,Hu,zu,Mt,{menuClass:0,onClick:1})}}function ra(r){let t,e,i,n,s;const a=r[8].default,l=Zt(a,r,r[7],null);let o=[{role:e=r[0]?void 0:"link"},{href:r[0]},r[2],{class:r[1]}],c={};for(let h=0;h<o.length;h+=1)c=Q(c,o[h]);return{c(){t=ft(r[0]?"a":"div"),l&&l.c(),this.h()},l(h){t=ut(h,((r[0]?"a":"div")||"null").toUpperCase(),{role:!0,href:!0,class:!0});var f=at(t);l&&l.l(f),f.forEach(R),this.h()},h(){Hr(r[0]?"a":"div")(t,c)},m(h,f){G(h,t,f),l&&l.m(t,null),i=!0,n||(s=[W(t,"blur",r[9]),W(t,"change",r[10]),W(t,"click",r[11]),W(t,"focus",r[12]),W(t,"keydown",r[13]),W(t,"keypress",r[14]),W(t,"keyup",r[15]),W(t,"mouseenter",r[16]),W(t,"mouseleave",r[17]),W(t,"mouseover",r[18])],n=!0)},p(h,f){l&&l.p&&(!i||f&128)&&$t(l,a,h,h[7],i?ee(a,h[7],f,null):te(h[7]),null),Hr(h[0]?"a":"div")(t,c=Kt(o,[(!i||f&1&&e!==(e=h[0]?void 0:"link"))&&{role:e},(!i||f&1)&&{href:h[0]},f&4&&h[2],(!i||f&2)&&{class:h[1]}]))},i(h){i||(O(l,h),i=!0)},o(h){B(l,h),i=!1},d(h){h&&R(t),l&&l.d(h),n=!1,Ii(s)}}}function ju(r){let t,e=r[0]?"a":"div",i,n=(r[0]?"a":"div")&&ra(r);return{c(){t=ft("li"),n&&n.c()},l(s){t=ut(s,"LI",{});var a=at(t);n&&n.l(a),a.forEach(R)},m(s,a){G(s,t,a),n&&n.m(t,null),i=!0},p(s,[a]){s[0],e?Mt(e,s[0]?"a":"div")?(n.d(1),n=ra(s),e=s[0]?"a":"div",n.c(),n.m(t,null)):n.p(s,a):(n=ra(s),e=s[0]?"a":"div",n.c(),n.m(t,null))},i(s){i||(O(n,s),i=!0)},o(s){B(n,s),i=!1},d(s){s&&R(t),n&&n.d(s)}}}function Xu(r,t,e){let i,n;const s=["href","activeClass","nonActiveClass"];let a=yt(t,s),{$$slots:l={},$$scope:o}=t,{href:c=""}=t,{activeClass:h=void 0}=t,{nonActiveClass:f=void 0}=t;const g=Ae("navbarContext")??{},d=Ae("activeUrl");let p="";d.subscribe(A=>{e(5,p=A)});function v(A){Y.call(this,r,A)}function b(A){Y.call(this,r,A)}function _(A){Y.call(this,r,A)}function w(A){Y.call(this,r,A)}function u(A){Y.call(this,r,A)}function m(A){Y.call(this,r,A)}function y(A){Y.call(this,r,A)}function S(A){Y.call(this,r,A)}function T(A){Y.call(this,r,A)}function C(A){Y.call(this,r,A)}return r.$$set=A=>{e(21,t=Q(Q({},t),_t(A))),e(2,a=yt(t,s)),"href"in A&&e(0,c=A.href),"activeClass"in A&&e(3,h=A.activeClass),"nonActiveClass"in A&&e(4,f=A.nonActiveClass),"$$scope"in A&&e(7,o=A.$$scope)},r.$$.update=()=>{r.$$.dirty&33&&e(6,i=p?c===p:!1),e(1,n=wt("block py-2 pe-4 ps-3 md:p-0 rounded md:border-0",i?h??g.activeClass:f??g.nonActiveClass,t.class))},t=_t(t),[c,n,a,h,f,p,i,o,l,v,b,_,w,u,m,y,S,T,C]}class tl extends Nt{constructor(t){super(),Lt(this,t,Xu,ju,Mt,{href:0,activeClass:3,nonActiveClass:4})}}function Yu(r){let t,e,i;const n=r[13].default,s=Zt(n,r,r[15],null);let a=[r[5],{class:r[2]},{hidden:r[1]}],l={};for(let o=0;o<a.length;o+=1)l=Q(l,a[o]);return{c(){t=ft("div"),e=ft("ul"),s&&s.c(),this.h()},l(o){t=ut(o,"DIV",{class:!0});var c=at(t);e=ut(c,"UL",{class:!0});var h=at(e);s&&s.l(h),h.forEach(R),c.forEach(R),this.h()},h(){J(e,"class",r[3]),_e(t,l)},m(o,c){G(o,t,c),kt(t,e),s&&s.m(e,null),i=!0},p(o,c){s&&s.p&&(!i||c&32768)&&$t(s,n,o,o[15],i?ee(n,o[15],c,null):te(o[15]),null),(!i||c&8)&&J(e,"class",o[3]),_e(t,l=Kt(a,[c&32&&o[5],(!i||c&4)&&{class:o[2]},(!i||c&2)&&{hidden:o[1]}]))},i(o){i||(O(s,o),i=!0)},o(o){B(s,o),i=!1},d(o){o&&R(t),s&&s.d(o)}}}function Ku(r){let t,e,i,n,s,a;e=new ao({props:{tag:"ul",border:!0,rounded:!0,color:"navbarUl",class:r[3],$$slots:{default:[qu]},$$scope:{ctx:r}}});let l=[r[5],{class:r[2]},{role:"button"},{tabindex:"0"}],o={};for(let c=0;c<l.length;c+=1)o=Q(o,l[c]);return{c(){t=ft("div"),tt(e.$$.fragment),this.h()},l(c){t=ut(c,"DIV",{class:!0,role:!0,tabindex:!0});var h=at(t);et(e.$$.fragment,h),h.forEach(R),this.h()},h(){_e(t,o)},m(c,h){G(c,t,h),it(e,t,null),n=!0,s||(a=W(t,"click",r[14]),s=!0)},p(c,h){r=c;const f={};h&8&&(f.class=r[3]),h&32768&&(f.$$scope={dirty:h,ctx:r}),e.$set(f),_e(t,o=Kt(l,[h&32&&r[5],(!n||h&4)&&{class:r[2]},{role:"button"},{tabindex:"0"}]))},i(c){n||(O(e.$$.fragment,c),c&&ff(()=>{n&&(i||(i=Io(t,Bo,r[0],!0)),i.run(1))}),n=!0)},o(c){B(e.$$.fragment,c),c&&(i||(i=Io(t,Bo,r[0],!1)),i.run(0)),n=!1},d(c){c&&R(t),nt(e),c&&i&&i.end(),s=!1,a()}}}function qu(r){let t;const e=r[13].default,i=Zt(e,r,r[15],null);return{c(){i&&i.c()},l(n){i&&i.l(n)},m(n,s){i&&i.m(n,s),t=!0},p(n,s){i&&i.p&&(!t||s&32768)&&$t(i,e,n,n[15],t?ee(e,n[15],s,null):te(n[15]),null)},i(n){t||(O(i,n),t=!0)},o(n){B(i,n),t=!1},d(n){i&&i.d(n)}}}function Ju(r){let t,e,i,n;const s=[Ku,Yu],a=[];function l(o,c){return o[1]?1:0}return t=l(r),e=a[t]=s[t](r),{c(){e.c(),i=It()},l(o){e.l(o),i=It()},m(o,c){a[t].m(o,c),G(o,i,c),n=!0},p(o,[c]){let h=t;t=l(o),t===h?a[t].p(o,c):(ae(),B(a[h],1,1,()=>{a[h]=null}),oe(),e=a[t],e?e.p(o,c):(e=a[t]=s[t](o),e.c()),O(e,1),e.m(i.parentNode,i))},i(o){n||(O(e),n=!0)},o(o){B(e),n=!1},d(o){o&&R(i),a[t].d(o)}}}function Qu(r,t,e){const i=["activeUrl","divClass","ulClass","hidden","slideParams","activeClass","nonActiveClass"];let n=yt(t,i),s,{$$slots:a={},$$scope:l}=t;const o=bn("");let{activeUrl:c=""}=t,{divClass:h="w-full md:block md:w-auto"}=t,{ulClass:f="flex flex-col p-4 mt-4 md:flex-row md:space-x-8 rtl:space-x-reverse md:mt-0 md:text-sm md:font-medium"}=t,{hidden:g=void 0}=t,{slideParams:d={delay:250,duration:500,easing:Rf}}=t,{activeClass:p="text-white bg-primary-700 md:bg-transparent md:text-primary-700 md:dark:text-white dark:bg-primary-600 md:dark:bg-transparent"}=t,{nonActiveClass:v="text-gray-700 hover:bg-gray-100 md:hover:bg-transparent md:border-0 md:hover:text-primary-700 dark:text-gray-400 md:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white md:dark:hover:bg-transparent"}=t;Fi("navbarContext",{activeClass:p,nonActiveClass:v}),Fi("activeUrl",o);let b=Ae("navHidden");hi(r,b,y=>e(12,s=y));let _,w,u;function m(y){Y.call(this,r,y)}return r.$$set=y=>{e(17,t=Q(Q({},t),_t(y))),e(5,n=yt(t,i)),"activeUrl"in y&&e(6,c=y.activeUrl),"divClass"in y&&e(7,h=y.divClass),"ulClass"in y&&e(8,f=y.ulClass),"hidden"in y&&e(9,g=y.hidden),"slideParams"in y&&e(0,d=y.slideParams),"activeClass"in y&&e(10,p=y.activeClass),"nonActiveClass"in y&&e(11,v=y.nonActiveClass),"$$scope"in y&&e(15,l=y.$$scope)},r.$$.update=()=>{r.$$.dirty&64&&o.set(c),r.$$.dirty&4608&&e(1,_=g??s??!0),e(2,w=wt(h,t.class)),e(3,u=wt(f,t.classUl))},t=_t(t),[d,_,w,u,b,n,c,h,f,g,p,v,s,a,m,l]}class Zu extends Nt{constructor(t){super(),Lt(this,t,Qu,Ju,Mt,{activeUrl:6,divClass:7,ulClass:8,hidden:9,slideParams:0,activeClass:10,nonActiveClass:11})}}function $u(r){let t,e,i,n,s,a=[{xmlns:"http://www.w3.org/2000/svg"},{fill:"none"},r[7],{class:i=wt("shrink-0",r[6][r[0]],r[8].class)},{role:r[1]},{"aria-label":r[5]},{viewBox:"0 0 10 7"}],l={};for(let o=0;o<a.length;o+=1)l=Q(l,a[o]);return{c(){t=We("svg"),e=We("path"),this.h()},l(o){t=je(o,"svg",{xmlns:!0,fill:!0,class:!0,role:!0,"aria-label":!0,viewBox:!0});var c=at(t);e=je(c,"path",{stroke:!0,"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),at(e).forEach(R),c.forEach(R),this.h()},h(){J(e,"stroke","currentColor"),J(e,"stroke-linecap",r[2]),J(e,"stroke-linejoin",r[3]),J(e,"stroke-width",r[4]),J(e,"d","m1 1.444 4 3.791 4-3.79"),fi(t,l)},m(o,c){G(o,t,c),kt(t,e),n||(s=[W(t,"click",r[9]),W(t,"keydown",r[10]),W(t,"keyup",r[11]),W(t,"focus",r[12]),W(t,"blur",r[13]),W(t,"mouseenter",r[14]),W(t,"mouseleave",r[15]),W(t,"mouseover",r[16]),W(t,"mouseout",r[17])],n=!0)},p(o,[c]){c&4&&J(e,"stroke-linecap",o[2]),c&8&&J(e,"stroke-linejoin",o[3]),c&16&&J(e,"stroke-width",o[4]),fi(t,l=Kt(a,[{xmlns:"http://www.w3.org/2000/svg"},{fill:"none"},c&128&&o[7],c&257&&i!==(i=wt("shrink-0",o[6][o[0]],o[8].class))&&{class:i},c&2&&{role:o[1]},c&32&&{"aria-label":o[5]},{viewBox:"0 0 10 7"}]))},i:Wt,o:Wt,d(o){o&&R(t),n=!1,Ii(s)}}}function td(r,t,e){const i=["size","role","strokeLinecap","strokeLinejoin","strokeWidth","ariaLabel"];let n=yt(t,i);const s=Ae("iconCtx")??{},a={xs:"w-3 h-3",sm:"w-4 h-4",md:"w-5 h-5",lg:"w-6 h-6",xl:"w-8 h-8"};let{size:l=s.size||"md"}=t,{role:o=s.role||"img"}=t,{strokeLinecap:c=s.strokeLinecap||"round"}=t,{strokeLinejoin:h=s.strokeLinejoin||"round"}=t,{strokeWidth:f=s.strokeWidth||"2"}=t,{ariaLabel:g="chevron down outline"}=t;function d(S){Y.call(this,r,S)}function p(S){Y.call(this,r,S)}function v(S){Y.call(this,r,S)}function b(S){Y.call(this,r,S)}function _(S){Y.call(this,r,S)}function w(S){Y.call(this,r,S)}function u(S){Y.call(this,r,S)}function m(S){Y.call(this,r,S)}function y(S){Y.call(this,r,S)}return r.$$set=S=>{e(8,t=Q(Q({},t),_t(S))),e(7,n=yt(t,i)),"size"in S&&e(0,l=S.size),"role"in S&&e(1,o=S.role),"strokeLinecap"in S&&e(2,c=S.strokeLinecap),"strokeLinejoin"in S&&e(3,h=S.strokeLinejoin),"strokeWidth"in S&&e(4,f=S.strokeWidth),"ariaLabel"in S&&e(5,g=S.ariaLabel)},t=_t(t),[l,o,c,h,f,g,a,n,t,d,p,v,b,_,w,u,m,y]}class rh extends Nt{constructor(t){super(),Lt(this,t,td,$u,Mt,{size:0,role:1,strokeLinecap:2,strokeLinejoin:3,strokeWidth:4,ariaLabel:5})}}function ed(r){let t,e,i,n,s,a=[{xmlns:"http://www.w3.org/2000/svg"},{fill:"currentColor"},r[4],{class:i=wt("shrink-0",r[3][r[0]],r[5].class)},{role:r[1]},{"aria-label":r[2]},{viewBox:"0 0 6 10"}],l={};for(let o=0;o<a.length;o+=1)l=Q(l,a[o]);return{c(){t=We("svg"),e=We("path"),this.h()},l(o){t=je(o,"svg",{xmlns:!0,fill:!0,class:!0,role:!0,"aria-label":!0,viewBox:!0});var c=at(t);e=je(c,"path",{fill:!0,d:!0}),at(e).forEach(R),c.forEach(R),this.h()},h(){J(e,"fill","currentColor"),J(e,"d","M1.01 10a.997.997 0 0 1-.705-1.705L3.59 5.006.305 1.717A.999.999 0 1 1 1.715.305L5.709 4.3a1 1 0 0 1 0 1.412L1.716 9.707A.998.998 0 0 1 1.01 10Z"),fi(t,l)},m(o,c){G(o,t,c),kt(t,e),n||(s=[W(t,"click",r[6]),W(t,"keydown",r[7]),W(t,"keyup",r[8]),W(t,"focus",r[9]),W(t,"blur",r[10]),W(t,"mouseenter",r[11]),W(t,"mouseleave",r[12]),W(t,"mouseover",r[13]),W(t,"mouseout",r[14])],n=!0)},p(o,[c]){fi(t,l=Kt(a,[{xmlns:"http://www.w3.org/2000/svg"},{fill:"currentColor"},c&16&&o[4],c&33&&i!==(i=wt("shrink-0",o[3][o[0]],o[5].class))&&{class:i},c&2&&{role:o[1]},c&4&&{"aria-label":o[2]},{viewBox:"0 0 6 10"}]))},i:Wt,o:Wt,d(o){o&&R(t),n=!1,Ii(s)}}}function id(r,t,e){const i=["size","role","ariaLabel"];let n=yt(t,i);const s=Ae("iconCtx")??{},a={xs:"w-3 h-3",sm:"w-4 h-4",md:"w-5 h-5",lg:"w-6 h-6",xl:"w-8 h-8"};let{size:l=s.size||"md"}=t,{role:o=s.role||"img"}=t,{ariaLabel:c="chevron right solid"}=t;function h(u){Y.call(this,r,u)}function f(u){Y.call(this,r,u)}function g(u){Y.call(this,r,u)}function d(u){Y.call(this,r,u)}function p(u){Y.call(this,r,u)}function v(u){Y.call(this,r,u)}function b(u){Y.call(this,r,u)}function _(u){Y.call(this,r,u)}function w(u){Y.call(this,r,u)}return r.$$set=u=>{e(5,t=Q(Q({},t),_t(u))),e(4,n=yt(t,i)),"size"in u&&e(0,l=u.size),"role"in u&&e(1,o=u.role),"ariaLabel"in u&&e(2,c=u.ariaLabel)},t=_t(t),[l,o,c,a,n,t,h,f,g,d,p,v,b,_,w]}class nd extends Nt{constructor(t){super(),Lt(this,t,id,ed,Mt,{size:0,role:1,ariaLabel:2})}}function rd(r){let t,e,i,n,s,a=[{xmlns:"http://www.w3.org/2000/svg"},{fill:"currentColor"},r[4],{class:i=wt("shrink-0",r[3][r[0]],r[5].class)},{role:r[1]},{"aria-label":r[2]},{viewBox:"0 0 20 14"}],l={};for(let o=0;o<a.length;o+=1)l=Q(l,a[o]);return{c(){t=We("svg"),e=We("path"),this.h()},l(o){t=je(o,"svg",{xmlns:!0,fill:!0,class:!0,role:!0,"aria-label":!0,viewBox:!0});var c=at(t);e=je(c,"path",{fill:!0,d:!0}),at(e).forEach(R),c.forEach(R),this.h()},h(){J(e,"fill","currentColor"),J(e,"d","M11 0H2a2 2 0 0 0-2 2v10a2 2 0 0 0 2 2h9a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2Zm8.585 1.189a.994.994 0 0 0-.9-.138l-2.965.983a1 1 0 0 0-.685.949v8a1 1 0 0 0 .675.946l2.965 1.02a1.013 1.013 0 0 0 1.032-.242A1 1 0 0 0 20 12V2a1 1 0 0 0-.415-.811Z"),fi(t,l)},m(o,c){G(o,t,c),kt(t,e),n||(s=[W(t,"click",r[6]),W(t,"keydown",r[7]),W(t,"keyup",r[8]),W(t,"focus",r[9]),W(t,"blur",r[10]),W(t,"mouseenter",r[11]),W(t,"mouseleave",r[12]),W(t,"mouseover",r[13]),W(t,"mouseout",r[14])],n=!0)},p(o,[c]){fi(t,l=Kt(a,[{xmlns:"http://www.w3.org/2000/svg"},{fill:"currentColor"},c&16&&o[4],c&33&&i!==(i=wt("shrink-0",o[3][o[0]],o[5].class))&&{class:i},c&2&&{role:o[1]},c&4&&{"aria-label":o[2]},{viewBox:"0 0 20 14"}]))},i:Wt,o:Wt,d(o){o&&R(t),n=!1,Ii(s)}}}function sd(r,t,e){const i=["size","role","ariaLabel"];let n=yt(t,i);const s=Ae("iconCtx")??{},a={xs:"w-3 h-3",sm:"w-4 h-4",md:"w-5 h-5",lg:"w-6 h-6",xl:"w-8 h-8"};let{size:l=s.size||"md"}=t,{role:o=s.role||"img"}=t,{ariaLabel:c="video solid"}=t;function h(u){Y.call(this,r,u)}function f(u){Y.call(this,r,u)}function g(u){Y.call(this,r,u)}function d(u){Y.call(this,r,u)}function p(u){Y.call(this,r,u)}function v(u){Y.call(this,r,u)}function b(u){Y.call(this,r,u)}function _(u){Y.call(this,r,u)}function w(u){Y.call(this,r,u)}return r.$$set=u=>{e(5,t=Q(Q({},t),_t(u))),e(4,n=yt(t,i)),"size"in u&&e(0,l=u.size),"role"in u&&e(1,o=u.role),"ariaLabel"in u&&e(2,c=u.ariaLabel)},t=_t(t),[l,o,c,a,n,t,h,f,g,d,p,v,b,_,w]}class ad extends Nt{constructor(t){super(),Lt(this,t,sd,rd,Mt,{size:0,role:1,ariaLabel:2})}}var el=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function od(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var po={exports:{}},ls={},sh={},ct={};(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r._registerNode=r.Konva=r.glob=void 0;const t=Math.PI/180;function e(){return typeof window<"u"&&({}.toString.call(window)==="[object Window]"||{}.toString.call(window)==="[object global]")}r.glob=typeof el<"u"?el:typeof window<"u"?window:typeof WorkerGlobalScope<"u"?self:{},r.Konva={_global:r.glob,version:"9.3.0",isBrowser:e(),isUnminified:/param/.test(function(n){}.toString()),dblClickWindow:400,getAngle(n){return r.Konva.angleDeg?n*t:n},enableTrace:!1,pointerEventsEnabled:!0,autoDrawEnabled:!0,hitOnDragEnabled:!1,capturePointerEventsEnabled:!1,_mouseListenClick:!1,_touchListenClick:!1,_pointerListenClick:!1,_mouseInDblClickWindow:!1,_touchInDblClickWindow:!1,_pointerInDblClickWindow:!1,_mouseDblClickPointerId:null,_touchDblClickPointerId:null,_pointerDblClickPointerId:null,pixelRatio:typeof window<"u"&&window.devicePixelRatio||1,dragDistance:3,angleDeg:!0,showWarnings:!0,dragButtons:[0,1],isDragging(){return r.Konva.DD.isDragging},isDragReady(){return!!r.Konva.DD.node},releaseCanvasOnDestroy:!0,document:r.glob.document,_injectGlobal(n){r.glob.Konva=n}};const i=n=>{r.Konva[n.prototype.getClassName()]=n};r._registerNode=i,r.Konva._injectGlobal(r.Konva)})(ct);var Ot={};(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.Util=r.Transform=void 0;const t=ct;class e{constructor(m=[1,0,0,1,0,0]){this.dirty=!1,this.m=m&&m.slice()||[1,0,0,1,0,0]}reset(){this.m[0]=1,this.m[1]=0,this.m[2]=0,this.m[3]=1,this.m[4]=0,this.m[5]=0}copy(){return new e(this.m)}copyInto(m){m.m[0]=this.m[0],m.m[1]=this.m[1],m.m[2]=this.m[2],m.m[3]=this.m[3],m.m[4]=this.m[4],m.m[5]=this.m[5]}point(m){var y=this.m;return{x:y[0]*m.x+y[2]*m.y+y[4],y:y[1]*m.x+y[3]*m.y+y[5]}}translate(m,y){return this.m[4]+=this.m[0]*m+this.m[2]*y,this.m[5]+=this.m[1]*m+this.m[3]*y,this}scale(m,y){return this.m[0]*=m,this.m[1]*=m,this.m[2]*=y,this.m[3]*=y,this}rotate(m){var y=Math.cos(m),S=Math.sin(m),T=this.m[0]*y+this.m[2]*S,C=this.m[1]*y+this.m[3]*S,A=this.m[0]*-S+this.m[2]*y,P=this.m[1]*-S+this.m[3]*y;return this.m[0]=T,this.m[1]=C,this.m[2]=A,this.m[3]=P,this}getTranslation(){return{x:this.m[4],y:this.m[5]}}skew(m,y){var S=this.m[0]+this.m[2]*y,T=this.m[1]+this.m[3]*y,C=this.m[2]+this.m[0]*m,A=this.m[3]+this.m[1]*m;return this.m[0]=S,this.m[1]=T,this.m[2]=C,this.m[3]=A,this}multiply(m){var y=this.m[0]*m.m[0]+this.m[2]*m.m[1],S=this.m[1]*m.m[0]+this.m[3]*m.m[1],T=this.m[0]*m.m[2]+this.m[2]*m.m[3],C=this.m[1]*m.m[2]+this.m[3]*m.m[3],A=this.m[0]*m.m[4]+this.m[2]*m.m[5]+this.m[4],P=this.m[1]*m.m[4]+this.m[3]*m.m[5]+this.m[5];return this.m[0]=y,this.m[1]=S,this.m[2]=T,this.m[3]=C,this.m[4]=A,this.m[5]=P,this}invert(){var m=1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]),y=this.m[3]*m,S=-this.m[1]*m,T=-this.m[2]*m,C=this.m[0]*m,A=m*(this.m[2]*this.m[5]-this.m[3]*this.m[4]),P=m*(this.m[1]*this.m[4]-this.m[0]*this.m[5]);return this.m[0]=y,this.m[1]=S,this.m[2]=T,this.m[3]=C,this.m[4]=A,this.m[5]=P,this}getMatrix(){return this.m}decompose(){var m=this.m[0],y=this.m[1],S=this.m[2],T=this.m[3],C=this.m[4],A=this.m[5],P=m*T-y*S;let k={x:C,y:A,rotation:0,scaleX:0,scaleY:0,skewX:0,skewY:0};if(m!=0||y!=0){var E=Math.sqrt(m*m+y*y);k.rotation=y>0?Math.acos(m/E):-Math.acos(m/E),k.scaleX=E,k.scaleY=P/E,k.skewX=(m*S+y*T)/P,k.skewY=0}else if(S!=0||T!=0){var M=Math.sqrt(S*S+T*T);k.rotation=Math.PI/2-(T>0?Math.acos(-S/M):-Math.acos(S/M)),k.scaleX=P/M,k.scaleY=M,k.skewX=0,k.skewY=(m*S+y*T)/P}return k.rotation=r.Util._getRotation(k.rotation),k}}r.Transform=e;var i="[object Array]",n="[object Number]",s="[object String]",a="[object Boolean]",l=Math.PI/180,o=180/Math.PI,c="#",h="",f="0",g="Konva warning: ",d="Konva error: ",p="rgb(",v={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,132,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,255,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,203],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[119,128,144],slategrey:[119,128,144],snow:[255,255,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],transparent:[255,255,255,0],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,5]},b=/rgb\((\d{1,3}),(\d{1,3}),(\d{1,3})\)/,_=[];const w=typeof requestAnimationFrame<"u"&&requestAnimationFrame||function(u){setTimeout(u,60)};r.Util={_isElement(u){return!!(u&&u.nodeType==1)},_isFunction(u){return!!(u&&u.constructor&&u.call&&u.apply)},_isPlainObject(u){return!!u&&u.constructor===Object},_isArray(u){return Object.prototype.toString.call(u)===i},_isNumber(u){return Object.prototype.toString.call(u)===n&&!isNaN(u)&&isFinite(u)},_isString(u){return Object.prototype.toString.call(u)===s},_isBoolean(u){return Object.prototype.toString.call(u)===a},isObject(u){return u instanceof Object},isValidSelector(u){if(typeof u!="string")return!1;var m=u[0];return m==="#"||m==="."||m===m.toUpperCase()},_sign(u){return u===0||u>0?1:-1},requestAnimFrame(u){_.push(u),_.length===1&&w(function(){const m=_;_=[],m.forEach(function(y){y()})})},createCanvasElement(){var u=document.createElement("canvas");try{u.style=u.style||{}}catch{}return u},createImageElement(){return document.createElement("img")},_isInDocument(u){for(;u=u.parentNode;)if(u==document)return!0;return!1},_urlToImage(u,m){var y=r.Util.createImageElement();y.onload=function(){m(y)},y.src=u},_rgbToHex(u,m,y){return((1<<24)+(u<<16)+(m<<8)+y).toString(16).slice(1)},_hexToRgb(u){u=u.replace(c,h);var m=parseInt(u,16);return{r:m>>16&255,g:m>>8&255,b:m&255}},getRandomColor(){for(var u=(Math.random()*16777215<<0).toString(16);u.length<6;)u=f+u;return c+u},getRGB(u){var m;return u in v?(m=v[u],{r:m[0],g:m[1],b:m[2]}):u[0]===c?this._hexToRgb(u.substring(1)):u.substr(0,4)===p?(m=b.exec(u.replace(/ /g,"")),{r:parseInt(m[1],10),g:parseInt(m[2],10),b:parseInt(m[3],10)}):{r:0,g:0,b:0}},colorToRGBA(u){return u=u||"black",r.Util._namedColorToRBA(u)||r.Util._hex3ColorToRGBA(u)||r.Util._hex4ColorToRGBA(u)||r.Util._hex6ColorToRGBA(u)||r.Util._hex8ColorToRGBA(u)||r.Util._rgbColorToRGBA(u)||r.Util._rgbaColorToRGBA(u)||r.Util._hslColorToRGBA(u)},_namedColorToRBA(u){var m=v[u.toLowerCase()];return m?{r:m[0],g:m[1],b:m[2],a:1}:null},_rgbColorToRGBA(u){if(u.indexOf("rgb(")===0){u=u.match(/rgb\(([^)]+)\)/)[1];var m=u.split(/ *, */).map(Number);return{r:m[0],g:m[1],b:m[2],a:1}}},_rgbaColorToRGBA(u){if(u.indexOf("rgba(")===0){u=u.match(/rgba\(([^)]+)\)/)[1];var m=u.split(/ *, */).map((y,S)=>y.slice(-1)==="%"?S===3?parseInt(y)/100:parseInt(y)/100*255:Number(y));return{r:m[0],g:m[1],b:m[2],a:m[3]}}},_hex8ColorToRGBA(u){if(u[0]==="#"&&u.length===9)return{r:parseInt(u.slice(1,3),16),g:parseInt(u.slice(3,5),16),b:parseInt(u.slice(5,7),16),a:parseInt(u.slice(7,9),16)/255}},_hex6ColorToRGBA(u){if(u[0]==="#"&&u.length===7)return{r:parseInt(u.slice(1,3),16),g:parseInt(u.slice(3,5),16),b:parseInt(u.slice(5,7),16),a:1}},_hex4ColorToRGBA(u){if(u[0]==="#"&&u.length===5)return{r:parseInt(u[1]+u[1],16),g:parseInt(u[2]+u[2],16),b:parseInt(u[3]+u[3],16),a:parseInt(u[4]+u[4],16)/255}},_hex3ColorToRGBA(u){if(u[0]==="#"&&u.length===4)return{r:parseInt(u[1]+u[1],16),g:parseInt(u[2]+u[2],16),b:parseInt(u[3]+u[3],16),a:1}},_hslColorToRGBA(u){if(/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.test(u)){const[m,...y]=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(u),S=Number(y[0])/360,T=Number(y[1])/100,C=Number(y[2])/100;let A,P,k;if(T===0)return k=C*255,{r:Math.round(k),g:Math.round(k),b:Math.round(k),a:1};C<.5?A=C*(1+T):A=C+T-C*T;const E=2*C-A,M=[0,0,0];for(let F=0;F<3;F++)P=S+1/3*-(F-1),P<0&&P++,P>1&&P--,6*P<1?k=E+(A-E)*6*P:2*P<1?k=A:3*P<2?k=E+(A-E)*(2/3-P)*6:k=E,M[F]=k*255;return{r:Math.round(M[0]),g:Math.round(M[1]),b:Math.round(M[2]),a:1}}},haveIntersection(u,m){return!(m.x>u.x+u.width||m.x+m.width<u.x||m.y>u.y+u.height||m.y+m.height<u.y)},cloneObject(u){var m={};for(var y in u)this._isPlainObject(u[y])?m[y]=this.cloneObject(u[y]):this._isArray(u[y])?m[y]=this.cloneArray(u[y]):m[y]=u[y];return m},cloneArray(u){return u.slice(0)},degToRad(u){return u*l},radToDeg(u){return u*o},_degToRad(u){return r.Util.warn("Util._degToRad is removed. Please use public Util.degToRad instead."),r.Util.degToRad(u)},_radToDeg(u){return r.Util.warn("Util._radToDeg is removed. Please use public Util.radToDeg instead."),r.Util.radToDeg(u)},_getRotation(u){return t.Konva.angleDeg?r.Util.radToDeg(u):u},_capitalize(u){return u.charAt(0).toUpperCase()+u.slice(1)},throw(u){throw new Error(d+u)},error(u){console.error(d+u)},warn(u){t.Konva.showWarnings&&console.warn(g+u)},each(u,m){for(var y in u)m(y,u[y])},_inRange(u,m,y){return m<=u&&u<y},_getProjectionToSegment(u,m,y,S,T,C){var A,P,k,E=(u-y)*(u-y)+(m-S)*(m-S);if(E==0)A=u,P=m,k=(T-y)*(T-y)+(C-S)*(C-S);else{var M=((T-u)*(y-u)+(C-m)*(S-m))/E;M<0?(A=u,P=m,k=(u-T)*(u-T)+(m-C)*(m-C)):M>1?(A=y,P=S,k=(y-T)*(y-T)+(S-C)*(S-C)):(A=u+M*(y-u),P=m+M*(S-m),k=(A-T)*(A-T)+(P-C)*(P-C))}return[A,P,k]},_getProjectionToLine(u,m,y){var S=r.Util.cloneObject(u),T=Number.MAX_VALUE;return m.forEach(function(C,A){if(!(!y&&A===m.length-1)){var P=m[(A+1)%m.length],k=r.Util._getProjectionToSegment(C.x,C.y,P.x,P.y,u.x,u.y),E=k[0],M=k[1],F=k[2];F<T&&(S.x=E,S.y=M,T=F)}}),S},_prepareArrayForTween(u,m,y){var S,T=[],C=[];if(u.length>m.length){var A=m;m=u,u=A}for(S=0;S<u.length;S+=2)T.push({x:u[S],y:u[S+1]});for(S=0;S<m.length;S+=2)C.push({x:m[S],y:m[S+1]});var P=[];return C.forEach(function(k){var E=r.Util._getProjectionToLine(k,T,y);P.push(E.x),P.push(E.y)}),P},_prepareToStringify(u){var m;u.visitedByCircularReferenceRemoval=!0;for(var y in u)if(u.hasOwnProperty(y)&&u[y]&&typeof u[y]=="object"){if(m=Object.getOwnPropertyDescriptor(u,y),u[y].visitedByCircularReferenceRemoval||r.Util._isElement(u[y]))if(m.configurable)delete u[y];else return null;else if(r.Util._prepareToStringify(u[y])===null)if(m.configurable)delete u[y];else return null}return delete u.visitedByCircularReferenceRemoval,u},_assign(u,m){for(var y in m)u[y]=m[y];return u},_getFirstPointerId(u){return u.touches?u.changedTouches[0].identifier:u.pointerId||999},releaseCanvas(...u){t.Konva.releaseCanvasOnDestroy&&u.forEach(m=>{m.width=0,m.height=0})},drawRoundedRectPath(u,m,y,S){let T=0,C=0,A=0,P=0;typeof S=="number"?T=C=A=P=Math.min(S,m/2,y/2):(T=Math.min(S[0]||0,m/2,y/2),C=Math.min(S[1]||0,m/2,y/2),P=Math.min(S[2]||0,m/2,y/2),A=Math.min(S[3]||0,m/2,y/2)),u.moveTo(T,0),u.lineTo(m-C,0),u.arc(m-C,C,C,Math.PI*3/2,0,!1),u.lineTo(m,y-P),u.arc(m-P,y-P,P,0,Math.PI/2,!1),u.lineTo(A,y),u.arc(A,y-A,A,Math.PI/2,Math.PI,!1),u.lineTo(0,T),u.arc(T,T,T,Math.PI,Math.PI*3/2,!1)}}})(Ot);var Ft={},ot={},X={};Object.defineProperty(X,"__esModule",{value:!0});X.getComponentValidator=X.getBooleanValidator=X.getNumberArrayValidator=X.getFunctionValidator=X.getStringOrGradientValidator=X.getStringValidator=X.getNumberOrAutoValidator=X.getNumberOrArrayOfNumbersValidator=X.getNumberValidator=X.alphaComponent=X.RGBComponent=void 0;const Qe=ct,Dt=Ot;function Ze(r){return Dt.Util._isString(r)?'"'+r+'"':Object.prototype.toString.call(r)==="[object Number]"||Dt.Util._isBoolean(r)?r:Object.prototype.toString.call(r)}function ld(r){return r>255?255:r<0?0:Math.round(r)}X.RGBComponent=ld;function cd(r){return r>1?1:r<1e-4?1e-4:r}X.alphaComponent=cd;function hd(){if(Qe.Konva.isUnminified)return function(r,t){return Dt.Util._isNumber(r)||Dt.Util.warn(Ze(r)+' is a not valid value for "'+t+'" attribute. The value should be a number.'),r}}X.getNumberValidator=hd;function fd(r){if(Qe.Konva.isUnminified)return function(t,e){let i=Dt.Util._isNumber(t),n=Dt.Util._isArray(t)&&t.length==r;return!i&&!n&&Dt.Util.warn(Ze(t)+' is a not valid value for "'+e+'" attribute. The value should be a number or Array<number>('+r+")"),t}}X.getNumberOrArrayOfNumbersValidator=fd;function ud(){if(Qe.Konva.isUnminified)return function(r,t){var e=Dt.Util._isNumber(r),i=r==="auto";return e||i||Dt.Util.warn(Ze(r)+' is a not valid value for "'+t+'" attribute. The value should be a number or "auto".'),r}}X.getNumberOrAutoValidator=ud;function dd(){if(Qe.Konva.isUnminified)return function(r,t){return Dt.Util._isString(r)||Dt.Util.warn(Ze(r)+' is a not valid value for "'+t+'" attribute. The value should be a string.'),r}}X.getStringValidator=dd;function gd(){if(Qe.Konva.isUnminified)return function(r,t){const e=Dt.Util._isString(r),i=Object.prototype.toString.call(r)==="[object CanvasGradient]"||r&&r.addColorStop;return e||i||Dt.Util.warn(Ze(r)+' is a not valid value for "'+t+'" attribute. The value should be a string or a native gradient.'),r}}X.getStringOrGradientValidator=gd;function pd(){if(Qe.Konva.isUnminified)return function(r,t){return Dt.Util._isFunction(r)||Dt.Util.warn(Ze(r)+' is a not valid value for "'+t+'" attribute. The value should be a function.'),r}}X.getFunctionValidator=pd;function md(){if(Qe.Konva.isUnminified)return function(r,t){const e=Int8Array?Object.getPrototypeOf(Int8Array):null;return e&&r instanceof e||(Dt.Util._isArray(r)?r.forEach(function(i){Dt.Util._isNumber(i)||Dt.Util.warn('"'+t+'" attribute has non numeric element '+i+". Make sure that all elements are numbers.")}):Dt.Util.warn(Ze(r)+' is a not valid value for "'+t+'" attribute. The value should be a array of numbers.')),r}}X.getNumberArrayValidator=md;function _d(){if(Qe.Konva.isUnminified)return function(r,t){var e=r===!0||r===!1;return e||Dt.Util.warn(Ze(r)+' is a not valid value for "'+t+'" attribute. The value should be a boolean.'),r}}X.getBooleanValidator=_d;function vd(r){if(Qe.Konva.isUnminified)return function(t,e){return t==null||Dt.Util.isObject(t)||Dt.Util.warn(Ze(t)+' is a not valid value for "'+e+'" attribute. The value should be an object with properties '+r),t}}X.getComponentValidator=vd;(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.Factory=void 0;const t=Ot,e=X;var i="get",n="set";r.Factory={addGetterSetter(s,a,l,o,c){r.Factory.addGetter(s,a,l),r.Factory.addSetter(s,a,o,c),r.Factory.addOverloadedGetterSetter(s,a)},addGetter(s,a,l){var o=i+t.Util._capitalize(a);s.prototype[o]=s.prototype[o]||function(){var c=this.attrs[a];return c===void 0?l:c}},addSetter(s,a,l,o){var c=n+t.Util._capitalize(a);s.prototype[c]||r.Factory.overWriteSetter(s,a,l,o)},overWriteSetter(s,a,l,o){var c=n+t.Util._capitalize(a);s.prototype[c]=function(h){return l&&h!==void 0&&h!==null&&(h=l.call(this,h,a)),this._setAttr(a,h),o&&o.call(this),this}},addComponentsGetterSetter(s,a,l,o,c){var h=l.length,f=t.Util._capitalize,g=i+f(a),d=n+f(a),p,v;s.prototype[g]=function(){var _={};for(p=0;p<h;p++)v=l[p],_[v]=this.getAttr(a+f(v));return _};var b=(0,e.getComponentValidator)(l);s.prototype[d]=function(_){var w=this.attrs[a],u;o&&(_=o.call(this,_)),b&&b.call(this,_,a);for(u in _)_.hasOwnProperty(u)&&this._setAttr(a+f(u),_[u]);return _||l.forEach(m=>{this._setAttr(a+f(m),void 0)}),this._fireChangeEvent(a,w,_),c&&c.call(this),this},r.Factory.addOverloadedGetterSetter(s,a)},addOverloadedGetterSetter(s,a){var l=t.Util._capitalize(a),o=n+l,c=i+l;s.prototype[a]=function(){return arguments.length?(this[o](arguments[0]),this):this[c]()}},addDeprecatedGetterSetter(s,a,l,o){t.Util.error("Adding deprecated "+a);var c=i+t.Util._capitalize(a),h=a+" property is deprecated and will be removed soon. Look at Konva change log for more information.";s.prototype[c]=function(){t.Util.error(h);var f=this.attrs[a];return f===void 0?l:f},r.Factory.addSetter(s,a,o,function(){t.Util.error(h)}),r.Factory.addOverloadedGetterSetter(s,a)},backCompat(s,a){t.Util.each(a,function(l,o){var c=s.prototype[o],h=i+t.Util._capitalize(l),f=n+t.Util._capitalize(l);function g(){c.apply(this,arguments),t.Util.error('"'+l+'" method is deprecated and will be removed soon. Use ""'+o+'" instead.')}s.prototype[l]=g,s.prototype[h]=g,s.prototype[f]=g})},afterSetFilter(){this._filterUpToDate=!1}}})(ot);var Ce={},He={};Object.defineProperty(He,"__esModule",{value:!0});He.HitContext=He.SceneContext=He.Context=void 0;const ah=Ot,yd=ct;function bd(r){var t=[],e=r.length,i=ah.Util,n,s;for(n=0;n<e;n++)s=r[n],i._isNumber(s)?s=Math.round(s*1e3)/1e3:i._isString(s)||(s=s+""),t.push(s);return t}var il=",",wd="(",Sd=")",Cd="([",Ad="])",Td=";",Pd="()",kd="=",nl=["arc","arcTo","beginPath","bezierCurveTo","clearRect","clip","closePath","createLinearGradient","createPattern","createRadialGradient","drawImage","ellipse","fill","fillText","getImageData","createImageData","lineTo","moveTo","putImageData","quadraticCurveTo","rect","restore","rotate","save","scale","setLineDash","setTransform","stroke","strokeText","transform","translate"],xd=["fillStyle","strokeStyle","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","letterSpacing","lineCap","lineDashOffset","lineJoin","lineWidth","miterLimit","direction","font","textAlign","textBaseline","globalAlpha","globalCompositeOperation","imageSmoothingEnabled"];const Ed=100;class cs{constructor(t){this.canvas=t,yd.Konva.enableTrace&&(this.traceArr=[],this._enableTrace())}fillShape(t){t.fillEnabled()&&this._fill(t)}_fill(t){}strokeShape(t){t.hasStroke()&&this._stroke(t)}_stroke(t){}fillStrokeShape(t){t.attrs.fillAfterStrokeEnabled?(this.strokeShape(t),this.fillShape(t)):(this.fillShape(t),this.strokeShape(t))}getTrace(t,e){var i=this.traceArr,n=i.length,s="",a,l,o,c;for(a=0;a<n;a++)l=i[a],o=l.method,o?(c=l.args,s+=o,t?s+=Pd:ah.Util._isArray(c[0])?s+=Cd+c.join(il)+Ad:(e&&(c=c.map(h=>typeof h=="number"?Math.floor(h):h)),s+=wd+c.join(il)+Sd)):(s+=l.property,t||(s+=kd+l.val)),s+=Td;return s}clearTrace(){this.traceArr=[]}_trace(t){var e=this.traceArr,i;e.push(t),i=e.length,i>=Ed&&e.shift()}reset(){var t=this.getCanvas().getPixelRatio();this.setTransform(1*t,0,0,1*t,0,0)}getCanvas(){return this.canvas}clear(t){var e=this.getCanvas();t?this.clearRect(t.x||0,t.y||0,t.width||0,t.height||0):this.clearRect(0,0,e.getWidth()/e.pixelRatio,e.getHeight()/e.pixelRatio)}_applyLineCap(t){const e=t.attrs.lineCap;e&&this.setAttr("lineCap",e)}_applyOpacity(t){var e=t.getAbsoluteOpacity();e!==1&&this.setAttr("globalAlpha",e)}_applyLineJoin(t){const e=t.attrs.lineJoin;e&&this.setAttr("lineJoin",e)}setAttr(t,e){this._context[t]=e}arc(t,e,i,n,s,a){this._context.arc(t,e,i,n,s,a)}arcTo(t,e,i,n,s){this._context.arcTo(t,e,i,n,s)}beginPath(){this._context.beginPath()}bezierCurveTo(t,e,i,n,s,a){this._context.bezierCurveTo(t,e,i,n,s,a)}clearRect(t,e,i,n){this._context.clearRect(t,e,i,n)}clip(...t){this._context.clip.apply(this._context,t)}closePath(){this._context.closePath()}createImageData(t,e){var i=arguments;if(i.length===2)return this._context.createImageData(t,e);if(i.length===1)return this._context.createImageData(t)}createLinearGradient(t,e,i,n){return this._context.createLinearGradient(t,e,i,n)}createPattern(t,e){return this._context.createPattern(t,e)}createRadialGradient(t,e,i,n,s,a){return this._context.createRadialGradient(t,e,i,n,s,a)}drawImage(t,e,i,n,s,a,l,o,c){var h=arguments,f=this._context;h.length===3?f.drawImage(t,e,i):h.length===5?f.drawImage(t,e,i,n,s):h.length===9&&f.drawImage(t,e,i,n,s,a,l,o,c)}ellipse(t,e,i,n,s,a,l,o){this._context.ellipse(t,e,i,n,s,a,l,o)}isPointInPath(t,e,i,n){return i?this._context.isPointInPath(i,t,e,n):this._context.isPointInPath(t,e,n)}fill(...t){this._context.fill.apply(this._context,t)}fillRect(t,e,i,n){this._context.fillRect(t,e,i,n)}strokeRect(t,e,i,n){this._context.strokeRect(t,e,i,n)}fillText(t,e,i,n){n?this._context.fillText(t,e,i,n):this._context.fillText(t,e,i)}measureText(t){return this._context.measureText(t)}getImageData(t,e,i,n){return this._context.getImageData(t,e,i,n)}lineTo(t,e){this._context.lineTo(t,e)}moveTo(t,e){this._context.moveTo(t,e)}rect(t,e,i,n){this._context.rect(t,e,i,n)}putImageData(t,e,i){this._context.putImageData(t,e,i)}quadraticCurveTo(t,e,i,n){this._context.quadraticCurveTo(t,e,i,n)}restore(){this._context.restore()}rotate(t){this._context.rotate(t)}save(){this._context.save()}scale(t,e){this._context.scale(t,e)}setLineDash(t){this._context.setLineDash?this._context.setLineDash(t):"mozDash"in this._context?this._context.mozDash=t:"webkitLineDash"in this._context&&(this._context.webkitLineDash=t)}getLineDash(){return this._context.getLineDash()}setTransform(t,e,i,n,s,a){this._context.setTransform(t,e,i,n,s,a)}stroke(t){t?this._context.stroke(t):this._context.stroke()}strokeText(t,e,i,n){this._context.strokeText(t,e,i,n)}transform(t,e,i,n,s,a){this._context.transform(t,e,i,n,s,a)}translate(t,e){this._context.translate(t,e)}_enableTrace(){var t=this,e=nl.length,i=this.setAttr,n,s,a=function(l){var o=t[l],c;t[l]=function(){return s=bd(Array.prototype.slice.call(arguments,0)),c=o.apply(t,arguments),t._trace({method:l,args:s}),c}};for(n=0;n<e;n++)a(nl[n]);t.setAttr=function(){i.apply(t,arguments);var l=arguments[0],o=arguments[1];(l==="shadowOffsetX"||l==="shadowOffsetY"||l==="shadowBlur")&&(o=o/this.canvas.getPixelRatio()),t._trace({property:l,val:o})}}_applyGlobalCompositeOperation(t){const e=t.attrs.globalCompositeOperation;var i=!e||e==="source-over";i||this.setAttr("globalCompositeOperation",e)}}He.Context=cs;xd.forEach(function(r){Object.defineProperty(cs.prototype,r,{get(){return this._context[r]},set(t){this._context[r]=t}})});class Md extends cs{constructor(t,{willReadFrequently:e=!1}={}){super(t),this._context=t._canvas.getContext("2d",{willReadFrequently:e})}_fillColor(t){var e=t.fill();this.setAttr("fillStyle",e),t._fillFunc(this)}_fillPattern(t){this.setAttr("fillStyle",t._getFillPattern()),t._fillFunc(this)}_fillLinearGradient(t){var e=t._getLinearGradient();e&&(this.setAttr("fillStyle",e),t._fillFunc(this))}_fillRadialGradient(t){const e=t._getRadialGradient();e&&(this.setAttr("fillStyle",e),t._fillFunc(this))}_fill(t){const e=t.fill(),i=t.getFillPriority();if(e&&i==="color"){this._fillColor(t);return}const n=t.getFillPatternImage();if(n&&i==="pattern"){this._fillPattern(t);return}const s=t.getFillLinearGradientColorStops();if(s&&i==="linear-gradient"){this._fillLinearGradient(t);return}const a=t.getFillRadialGradientColorStops();if(a&&i==="radial-gradient"){this._fillRadialGradient(t);return}e?this._fillColor(t):n?this._fillPattern(t):s?this._fillLinearGradient(t):a&&this._fillRadialGradient(t)}_strokeLinearGradient(t){const e=t.getStrokeLinearGradientStartPoint(),i=t.getStrokeLinearGradientEndPoint(),n=t.getStrokeLinearGradientColorStops(),s=this.createLinearGradient(e.x,e.y,i.x,i.y);if(n){for(var a=0;a<n.length;a+=2)s.addColorStop(n[a],n[a+1]);this.setAttr("strokeStyle",s)}}_stroke(t){var e=t.dash(),i=t.getStrokeScaleEnabled();if(t.hasStroke()){if(!i){this.save();var n=this.getCanvas().getPixelRatio();this.setTransform(n,0,0,n,0,0)}this._applyLineCap(t),e&&t.dashEnabled()&&(this.setLineDash(e),this.setAttr("lineDashOffset",t.dashOffset())),this.setAttr("lineWidth",t.strokeWidth()),t.getShadowForStrokeEnabled()||this.setAttr("shadowColor","rgba(0,0,0,0)");var s=t.getStrokeLinearGradientColorStops();s?this._strokeLinearGradient(t):this.setAttr("strokeStyle",t.stroke()),t._strokeFunc(this),i||this.restore()}}_applyShadow(t){var e,i,n,s=(e=t.getShadowRGBA())!==null&&e!==void 0?e:"black",a=(i=t.getShadowBlur())!==null&&i!==void 0?i:5,l=(n=t.getShadowOffset())!==null&&n!==void 0?n:{x:0,y:0},o=t.getAbsoluteScale(),c=this.canvas.getPixelRatio(),h=o.x*c,f=o.y*c;this.setAttr("shadowColor",s),this.setAttr("shadowBlur",a*Math.min(Math.abs(h),Math.abs(f))),this.setAttr("shadowOffsetX",l.x*h),this.setAttr("shadowOffsetY",l.y*f)}}He.SceneContext=Md;class Fd extends cs{constructor(t){super(t),this._context=t._canvas.getContext("2d",{willReadFrequently:!0})}_fill(t){this.save(),this.setAttr("fillStyle",t.colorKey),t._fillFuncHit(this),this.restore()}strokeShape(t){t.hasHitStroke()&&this._stroke(t)}_stroke(t){if(t.hasHitStroke()){const s=t.getStrokeScaleEnabled();if(!s){this.save();var e=this.getCanvas().getPixelRatio();this.setTransform(e,0,0,e,0,0)}this._applyLineCap(t);var i=t.hitStrokeWidth(),n=i==="auto"?t.strokeWidth():i;this.setAttr("lineWidth",n),this.setAttr("strokeStyle",t.colorKey),t._strokeFuncHit(this),s||this.restore()}}}He.HitContext=Fd;Object.defineProperty(Ce,"__esModule",{value:!0});Ce.HitCanvas=Ce.SceneCanvas=Ce.Canvas=void 0;const Yr=Ot,oh=He,lh=ct,Rd=ot,Nd=X;var lr;function Ld(){if(lr)return lr;var r=Yr.Util.createCanvasElement(),t=r.getContext("2d");return lr=function(){var e=lh.Konva._global.devicePixelRatio||1,i=t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1;return e/i}(),Yr.Util.releaseCanvas(r),lr}class hs{constructor(t){this.pixelRatio=1,this.width=0,this.height=0,this.isCache=!1;var e=t||{},i=e.pixelRatio||lh.Konva.pixelRatio||Ld();this.pixelRatio=i,this._canvas=Yr.Util.createCanvasElement(),this._canvas.style.padding="0",this._canvas.style.margin="0",this._canvas.style.border="0",this._canvas.style.background="transparent",this._canvas.style.position="absolute",this._canvas.style.top="0",this._canvas.style.left="0"}getContext(){return this.context}getPixelRatio(){return this.pixelRatio}setPixelRatio(t){var e=this.pixelRatio;this.pixelRatio=t,this.setSize(this.getWidth()/e,this.getHeight()/e)}setWidth(t){this.width=this._canvas.width=t*this.pixelRatio,this._canvas.style.width=t+"px";var e=this.pixelRatio,i=this.getContext()._context;i.scale(e,e)}setHeight(t){this.height=this._canvas.height=t*this.pixelRatio,this._canvas.style.height=t+"px";var e=this.pixelRatio,i=this.getContext()._context;i.scale(e,e)}getWidth(){return this.width}getHeight(){return this.height}setSize(t,e){this.setWidth(t||0),this.setHeight(e||0)}toDataURL(t,e){try{return this._canvas.toDataURL(t,e)}catch{try{return this._canvas.toDataURL()}catch(n){return Yr.Util.error("Unable to get data URL. "+n.message+" For more info read https://konvajs.org/docs/posts/Tainted_Canvas.html."),""}}}}Ce.Canvas=hs;Rd.Factory.addGetterSetter(hs,"pixelRatio",void 0,(0,Nd.getNumberValidator)());class Od extends hs{constructor(t={width:0,height:0,willReadFrequently:!1}){super(t),this.context=new oh.SceneContext(this,{willReadFrequently:t.willReadFrequently}),this.setSize(t.width,t.height)}}Ce.SceneCanvas=Od;class Dd extends hs{constructor(t={width:0,height:0}){super(t),this.hitCanvas=!0,this.context=new oh.HitContext(this),this.setSize(t.width,t.height)}}Ce.HitCanvas=Dd;var fs={};(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.DD=void 0;const t=ct,e=Ot;r.DD={get isDragging(){var i=!1;return r.DD._dragElements.forEach(n=>{n.dragStatus==="dragging"&&(i=!0)}),i},justDragged:!1,get node(){var i;return r.DD._dragElements.forEach(n=>{i=n.node}),i},_dragElements:new Map,_drag(i){const n=[];r.DD._dragElements.forEach((s,a)=>{const{node:l}=s,o=l.getStage();o.setPointersPositions(i),s.pointerId===void 0&&(s.pointerId=e.Util._getFirstPointerId(i));const c=o._changedPointerPositions.find(g=>g.id===s.pointerId);if(c){if(s.dragStatus!=="dragging"){var h=l.dragDistance(),f=Math.max(Math.abs(c.x-s.startPointerPos.x),Math.abs(c.y-s.startPointerPos.y));if(f<h||(l.startDrag({evt:i}),!l.isDragging()))return}l._setDragPosition(i,s),n.push(l)}}),n.forEach(s=>{s.fire("dragmove",{type:"dragmove",target:s,evt:i},!0)})},_endDragBefore(i){const n=[];r.DD._dragElements.forEach(s=>{const{node:a}=s,l=a.getStage();if(i&&l.setPointersPositions(i),!l._changedPointerPositions.find(h=>h.id===s.pointerId))return;(s.dragStatus==="dragging"||s.dragStatus==="stopped")&&(r.DD.justDragged=!0,t.Konva._mouseListenClick=!1,t.Konva._touchListenClick=!1,t.Konva._pointerListenClick=!1,s.dragStatus="stopped");const c=s.node.getLayer()||s.node instanceof t.Konva.Stage&&s.node;c&&n.indexOf(c)===-1&&n.push(c)}),n.forEach(s=>{s.draw()})},_endDragAfter(i){r.DD._dragElements.forEach((n,s)=>{n.dragStatus==="stopped"&&n.node.fire("dragend",{type:"dragend",target:n.node,evt:i},!0),n.dragStatus!=="dragging"&&r.DD._dragElements.delete(s)})}},t.Konva.isBrowser&&(window.addEventListener("mouseup",r.DD._endDragBefore,!0),window.addEventListener("touchend",r.DD._endDragBefore,!0),window.addEventListener("mousemove",r.DD._drag),window.addEventListener("touchmove",r.DD._drag),window.addEventListener("mouseup",r.DD._endDragAfter,!1),window.addEventListener("touchend",r.DD._endDragAfter,!1))})(fs);Object.defineProperty(Ft,"__esModule",{value:!0});Ft.Node=void 0;const ht=Ot,tr=ot,cr=Ce,Si=ct,he=fs,zt=X;var Ir="absoluteOpacity",hr="allEventListeners",Ue="absoluteTransform",rl="absoluteScale",Ci="canvas",Id="Change",Gd="children",Bd="konva",Va="listening",sl="mouseenter",al="mouseleave",ol="set",ll="Shape",Gr=" ",cl="stage",si="transform",Ud="Stage",za="visible",Vd=["xChange.konva","yChange.konva","scaleXChange.konva","scaleYChange.konva","skewXChange.konva","skewYChange.konva","rotationChange.konva","offsetXChange.konva","offsetYChange.konva","transformsEnabledChange.konva"].join(Gr);let zd=1,$=class Ha{constructor(t){this._id=zd++,this.eventListeners={},this.attrs={},this.index=0,this._allEventListeners=null,this.parent=null,this._cache=new Map,this._attachedDepsListeners=new Map,this._lastPos=null,this._batchingTransformChange=!1,this._needClearTransformCache=!1,this._filterUpToDate=!1,this._isUnderCache=!1,this._dragEventId=null,this._shouldFireChangeEvents=!1,this.setAttrs(t),this._shouldFireChangeEvents=!0}hasChildren(){return!1}_clearCache(t){(t===si||t===Ue)&&this._cache.get(t)?this._cache.get(t).dirty=!0:t?this._cache.delete(t):this._cache.clear()}_getCache(t,e){var i=this._cache.get(t),n=t===si||t===Ue,s=i===void 0||n&&i.dirty===!0;return s&&(i=e.call(this),this._cache.set(t,i)),i}_calculate(t,e,i){if(!this._attachedDepsListeners.get(t)){const n=e.map(s=>s+"Change.konva").join(Gr);this.on(n,()=>{this._clearCache(t)}),this._attachedDepsListeners.set(t,!0)}return this._getCache(t,i)}_getCanvasCache(){return this._cache.get(Ci)}_clearSelfAndDescendantCache(t){this._clearCache(t),t===Ue&&this.fire("absoluteTransformChange")}clearCache(){if(this._cache.has(Ci)){const{scene:t,filter:e,hit:i}=this._cache.get(Ci);ht.Util.releaseCanvas(t,e,i),this._cache.delete(Ci)}return this._clearSelfAndDescendantCache(),this._requestDraw(),this}cache(t){var e=t||{},i={};(e.x===void 0||e.y===void 0||e.width===void 0||e.height===void 0)&&(i=this.getClientRect({skipTransform:!0,relativeTo:this.getParent()||void 0}));var n=Math.ceil(e.width||i.width),s=Math.ceil(e.height||i.height),a=e.pixelRatio,l=e.x===void 0?Math.floor(i.x):e.x,o=e.y===void 0?Math.floor(i.y):e.y,c=e.offset||0,h=e.drawBorder||!1,f=e.hitCanvasPixelRatio||1;if(!n||!s){ht.Util.error("Can not cache the node. Width or height of the node equals 0. Caching is skipped.");return}n+=c*2+1,s+=c*2+1,l-=c,o-=c;var g=new cr.SceneCanvas({pixelRatio:a,width:n,height:s}),d=new cr.SceneCanvas({pixelRatio:a,width:0,height:0,willReadFrequently:!0}),p=new cr.HitCanvas({pixelRatio:f,width:n,height:s}),v=g.getContext(),b=p.getContext();return p.isCache=!0,g.isCache=!0,this._cache.delete(Ci),this._filterUpToDate=!1,e.imageSmoothingEnabled===!1&&(g.getContext()._context.imageSmoothingEnabled=!1,d.getContext()._context.imageSmoothingEnabled=!1),v.save(),b.save(),v.translate(-l,-o),b.translate(-l,-o),this._isUnderCache=!0,this._clearSelfAndDescendantCache(Ir),this._clearSelfAndDescendantCache(rl),this.drawScene(g,this),this.drawHit(p,this),this._isUnderCache=!1,v.restore(),b.restore(),h&&(v.save(),v.beginPath(),v.rect(0,0,n,s),v.closePath(),v.setAttr("strokeStyle","red"),v.setAttr("lineWidth",5),v.stroke(),v.restore()),this._cache.set(Ci,{scene:g,filter:d,hit:p,x:l,y:o}),this._requestDraw(),this}isCached(){return this._cache.has(Ci)}getClientRect(t){throw new Error('abstract "getClientRect" method call')}_transformedRect(t,e){var i=[{x:t.x,y:t.y},{x:t.x+t.width,y:t.y},{x:t.x+t.width,y:t.y+t.height},{x:t.x,y:t.y+t.height}],n=1/0,s=1/0,a=-1/0,l=-1/0,o=this.getAbsoluteTransform(e);return i.forEach(function(c){var h=o.point(c);n===void 0&&(n=a=h.x,s=l=h.y),n=Math.min(n,h.x),s=Math.min(s,h.y),a=Math.max(a,h.x),l=Math.max(l,h.y)}),{x:n,y:s,width:a-n,height:l-s}}_drawCachedSceneCanvas(t){t.save(),t._applyOpacity(this),t._applyGlobalCompositeOperation(this);const e=this._getCanvasCache();t.translate(e.x,e.y);var i=this._getCachedSceneCanvas(),n=i.pixelRatio;t.drawImage(i._canvas,0,0,i.width/n,i.height/n),t.restore()}_drawCachedHitCanvas(t){var e=this._getCanvasCache(),i=e.hit;t.save(),t.translate(e.x,e.y),t.drawImage(i._canvas,0,0,i.width/i.pixelRatio,i.height/i.pixelRatio),t.restore()}_getCachedSceneCanvas(){var t=this.filters(),e=this._getCanvasCache(),i=e.scene,n=e.filter,s=n.getContext(),a,l,o,c;if(t){if(!this._filterUpToDate){var h=i.pixelRatio;n.setSize(i.width/i.pixelRatio,i.height/i.pixelRatio);try{for(a=t.length,s.clear(),s.drawImage(i._canvas,0,0,i.getWidth()/h,i.getHeight()/h),l=s.getImageData(0,0,n.getWidth(),n.getHeight()),o=0;o<a;o++){if(c=t[o],typeof c!="function"){ht.Util.error("Filter should be type of function, but got "+typeof c+" instead. Please check correct filters");continue}c.call(this,l),s.putImageData(l,0,0)}}catch(f){ht.Util.error("Unable to apply filter. "+f.message+" This post my help you https://konvajs.org/docs/posts/Tainted_Canvas.html.")}this._filterUpToDate=!0}return n}return i}on(t,e){if(this._cache&&this._cache.delete(hr),arguments.length===3)return this._delegate.apply(this,arguments);var i=t.split(Gr),n=i.length,s,a,l,o,c;for(s=0;s<n;s++)a=i[s],l=a.split("."),o=l[0],c=l[1]||"",this.eventListeners[o]||(this.eventListeners[o]=[]),this.eventListeners[o].push({name:c,handler:e});return this}off(t,e){var i=(t||"").split(Gr),n=i.length,s,a,l,o,c,h;if(this._cache&&this._cache.delete(hr),!t)for(a in this.eventListeners)this._off(a);for(s=0;s<n;s++)if(l=i[s],o=l.split("."),c=o[0],h=o[1],c)this.eventListeners[c]&&this._off(c,h,e);else for(a in this.eventListeners)this._off(a,h,e);return this}dispatchEvent(t){var e={target:this,type:t.type,evt:t};return this.fire(t.type,e),this}addEventListener(t,e){return this.on(t,function(i){e.call(this,i.evt)}),this}removeEventListener(t){return this.off(t),this}_delegate(t,e,i){var n=this;this.on(t,function(s){for(var a=s.target.findAncestors(e,!0,n),l=0;l<a.length;l++)s=ht.Util.cloneObject(s),s.currentTarget=a[l],i.call(a[l],s)})}remove(){return this.isDragging()&&this.stopDrag(),he.DD._dragElements.delete(this._id),this._remove(),this}_clearCaches(){this._clearSelfAndDescendantCache(Ue),this._clearSelfAndDescendantCache(Ir),this._clearSelfAndDescendantCache(rl),this._clearSelfAndDescendantCache(cl),this._clearSelfAndDescendantCache(za),this._clearSelfAndDescendantCache(Va)}_remove(){this._clearCaches();var t=this.getParent();t&&t.children&&(t.children.splice(this.index,1),t._setChildrenIndices(),this.parent=null)}destroy(){return this.remove(),this.clearCache(),this}getAttr(t){var e="get"+ht.Util._capitalize(t);return ht.Util._isFunction(this[e])?this[e]():this.attrs[t]}getAncestors(){for(var t=this.getParent(),e=[];t;)e.push(t),t=t.getParent();return e}getAttrs(){return this.attrs||{}}setAttrs(t){return this._batchTransformChanges(()=>{var e,i;if(!t)return this;for(e in t)e!==Gd&&(i=ol+ht.Util._capitalize(e),ht.Util._isFunction(this[i])?this[i](t[e]):this._setAttr(e,t[e]))}),this}isListening(){return this._getCache(Va,this._isListening)}_isListening(t){if(!this.listening())return!1;const i=this.getParent();return i&&i!==t&&this!==t?i._isListening(t):!0}isVisible(){return this._getCache(za,this._isVisible)}_isVisible(t){if(!this.visible())return!1;const i=this.getParent();return i&&i!==t&&this!==t?i._isVisible(t):!0}shouldDrawHit(t,e=!1){if(t)return this._isVisible(t)&&this._isListening(t);var i=this.getLayer(),n=!1;he.DD._dragElements.forEach(a=>{a.dragStatus==="dragging"&&(a.node.nodeType==="Stage"||a.node.getLayer()===i)&&(n=!0)});var s=!e&&!Si.Konva.hitOnDragEnabled&&n;return this.isListening()&&this.isVisible()&&!s}show(){return this.visible(!0),this}hide(){return this.visible(!1),this}getZIndex(){return this.index||0}getAbsoluteZIndex(){var t=this.getDepth(),e=this,i=0,n,s,a,l;function o(h){for(n=[],s=h.length,a=0;a<s;a++)l=h[a],i++,l.nodeType!==ll&&(n=n.concat(l.getChildren().slice())),l._id===e._id&&(a=s);n.length>0&&n[0].getDepth()<=t&&o(n)}const c=this.getStage();return e.nodeType!==Ud&&c&&o(c.getChildren()),i}getDepth(){for(var t=0,e=this.parent;e;)t++,e=e.parent;return t}_batchTransformChanges(t){this._batchingTransformChange=!0,t(),this._batchingTransformChange=!1,this._needClearTransformCache&&(this._clearCache(si),this._clearSelfAndDescendantCache(Ue)),this._needClearTransformCache=!1}setPosition(t){return this._batchTransformChanges(()=>{this.x(t.x),this.y(t.y)}),this}getPosition(){return{x:this.x(),y:this.y()}}getRelativePointerPosition(){const t=this.getStage();if(!t)return null;var e=t.getPointerPosition();if(!e)return null;var i=this.getAbsoluteTransform().copy();return i.invert(),i.point(e)}getAbsolutePosition(t){let e=!1,i=this.parent;for(;i;){if(i.isCached()){e=!0;break}i=i.parent}e&&!t&&(t=!0);var n=this.getAbsoluteTransform(t).getMatrix(),s=new ht.Transform,a=this.offset();return s.m=n.slice(),s.translate(a.x,a.y),s.getTranslation()}setAbsolutePosition(t){const{x:e,y:i,...n}=this._clearTransform();this.attrs.x=e,this.attrs.y=i,this._clearCache(si);var s=this._getAbsoluteTransform().copy();return s.invert(),s.translate(t.x,t.y),t={x:this.attrs.x+s.getTranslation().x,y:this.attrs.y+s.getTranslation().y},this._setTransform(n),this.setPosition({x:t.x,y:t.y}),this._clearCache(si),this._clearSelfAndDescendantCache(Ue),this}_setTransform(t){var e;for(e in t)this.attrs[e]=t[e]}_clearTransform(){var t={x:this.x(),y:this.y(),rotation:this.rotation(),scaleX:this.scaleX(),scaleY:this.scaleY(),offsetX:this.offsetX(),offsetY:this.offsetY(),skewX:this.skewX(),skewY:this.skewY()};return this.attrs.x=0,this.attrs.y=0,this.attrs.rotation=0,this.attrs.scaleX=1,this.attrs.scaleY=1,this.attrs.offsetX=0,this.attrs.offsetY=0,this.attrs.skewX=0,this.attrs.skewY=0,t}move(t){var e=t.x,i=t.y,n=this.x(),s=this.y();return e!==void 0&&(n+=e),i!==void 0&&(s+=i),this.setPosition({x:n,y:s}),this}_eachAncestorReverse(t,e){var i=[],n=this.getParent(),s,a;if(!(e&&e._id===this._id)){for(i.unshift(this);n&&(!e||n._id!==e._id);)i.unshift(n),n=n.parent;for(s=i.length,a=0;a<s;a++)t(i[a])}}rotate(t){return this.rotation(this.rotation()+t),this}moveToTop(){if(!this.parent)return ht.Util.warn("Node has no parent. moveToTop function is ignored."),!1;var t=this.index,e=this.parent.getChildren().length;return t<e-1?(this.parent.children.splice(t,1),this.parent.children.push(this),this.parent._setChildrenIndices(),!0):!1}moveUp(){if(!this.parent)return ht.Util.warn("Node has no parent. moveUp function is ignored."),!1;var t=this.index,e=this.parent.getChildren().length;return t<e-1?(this.parent.children.splice(t,1),this.parent.children.splice(t+1,0,this),this.parent._setChildrenIndices(),!0):!1}moveDown(){if(!this.parent)return ht.Util.warn("Node has no parent. moveDown function is ignored."),!1;var t=this.index;return t>0?(this.parent.children.splice(t,1),this.parent.children.splice(t-1,0,this),this.parent._setChildrenIndices(),!0):!1}moveToBottom(){if(!this.parent)return ht.Util.warn("Node has no parent. moveToBottom function is ignored."),!1;var t=this.index;return t>0?(this.parent.children.splice(t,1),this.parent.children.unshift(this),this.parent._setChildrenIndices(),!0):!1}setZIndex(t){if(!this.parent)return ht.Util.warn("Node has no parent. zIndex parameter is ignored."),this;(t<0||t>=this.parent.children.length)&&ht.Util.warn("Unexpected value "+t+" for zIndex property. zIndex is just index of a node in children of its parent. Expected value is from 0 to "+(this.parent.children.length-1)+".");var e=this.index;return this.parent.children.splice(e,1),this.parent.children.splice(t,0,this),this.parent._setChildrenIndices(),this}getAbsoluteOpacity(){return this._getCache(Ir,this._getAbsoluteOpacity)}_getAbsoluteOpacity(){var t=this.opacity(),e=this.getParent();return e&&!e._isUnderCache&&(t*=e.getAbsoluteOpacity()),t}moveTo(t){return this.getParent()!==t&&(this._remove(),t.add(this)),this}toObject(){var t={},e=this.getAttrs(),i,n,s,a,l;t.attrs={};for(i in e)n=e[i],l=ht.Util.isObject(n)&&!ht.Util._isPlainObject(n)&&!ht.Util._isArray(n),!l&&(s=typeof this[i]=="function"&&this[i],delete e[i],a=s?s.call(this):null,e[i]=n,a!==n&&(t.attrs[i]=n));return t.className=this.getClassName(),ht.Util._prepareToStringify(t)}toJSON(){return JSON.stringify(this.toObject())}getParent(){return this.parent}findAncestors(t,e,i){var n=[];e&&this._isMatch(t)&&n.push(this);for(var s=this.parent;s;){if(s===i)return n;s._isMatch(t)&&n.push(s),s=s.parent}return n}isAncestorOf(t){return!1}findAncestor(t,e,i){return this.findAncestors(t,e,i)[0]}_isMatch(t){if(!t)return!1;if(typeof t=="function")return t(this);var e=t.replace(/ /g,"").split(","),i=e.length,n,s;for(n=0;n<i;n++)if(s=e[n],ht.Util.isValidSelector(s)||(ht.Util.warn('Selector "'+s+'" is invalid. Allowed selectors examples are "#foo", ".bar" or "Group".'),ht.Util.warn('If you have a custom shape with such className, please change it to start with upper letter like "Triangle".'),ht.Util.warn("Konva is awesome, right?")),s.charAt(0)==="#"){if(this.id()===s.slice(1))return!0}else if(s.charAt(0)==="."){if(this.hasName(s.slice(1)))return!0}else if(this.className===s||this.nodeType===s)return!0;return!1}getLayer(){var t=this.getParent();return t?t.getLayer():null}getStage(){return this._getCache(cl,this._getStage)}_getStage(){var t=this.getParent();return t?t.getStage():null}fire(t,e={},i){return e.target=e.target||this,i?this._fireAndBubble(t,e):this._fire(t,e),this}getAbsoluteTransform(t){return t?this._getAbsoluteTransform(t):this._getCache(Ue,this._getAbsoluteTransform)}_getAbsoluteTransform(t){var e;if(t)return e=new ht.Transform,this._eachAncestorReverse(function(n){var s=n.transformsEnabled();s==="all"?e.multiply(n.getTransform()):s==="position"&&e.translate(n.x()-n.offsetX(),n.y()-n.offsetY())},t),e;e=this._cache.get(Ue)||new ht.Transform,this.parent?this.parent.getAbsoluteTransform().copyInto(e):e.reset();var i=this.transformsEnabled();if(i==="all")e.multiply(this.getTransform());else if(i==="position"){const n=this.attrs.x||0,s=this.attrs.y||0,a=this.attrs.offsetX||0,l=this.attrs.offsetY||0;e.translate(n-a,s-l)}return e.dirty=!1,e}getAbsoluteScale(t){for(var e=this;e;)e._isUnderCache&&(t=e),e=e.getParent();const n=this.getAbsoluteTransform(t).decompose();return{x:n.scaleX,y:n.scaleY}}getAbsoluteRotation(){return this.getAbsoluteTransform().decompose().rotation}getTransform(){return this._getCache(si,this._getTransform)}_getTransform(){var t,e,i=this._cache.get(si)||new ht.Transform;i.reset();var n=this.x(),s=this.y(),a=Si.Konva.getAngle(this.rotation()),l=(t=this.attrs.scaleX)!==null&&t!==void 0?t:1,o=(e=this.attrs.scaleY)!==null&&e!==void 0?e:1,c=this.attrs.skewX||0,h=this.attrs.skewY||0,f=this.attrs.offsetX||0,g=this.attrs.offsetY||0;return(n!==0||s!==0)&&i.translate(n,s),a!==0&&i.rotate(a),(c!==0||h!==0)&&i.skew(c,h),(l!==1||o!==1)&&i.scale(l,o),(f!==0||g!==0)&&i.translate(-1*f,-1*g),i.dirty=!1,i}clone(t){var e=ht.Util.cloneObject(this.attrs),i,n,s,a,l;for(i in t)e[i]=t[i];var o=new this.constructor(e);for(i in this.eventListeners)for(n=this.eventListeners[i],s=n.length,a=0;a<s;a++)l=n[a],l.name.indexOf(Bd)<0&&(o.eventListeners[i]||(o.eventListeners[i]=[]),o.eventListeners[i].push(l));return o}_toKonvaCanvas(t){t=t||{};var e=this.getClientRect(),i=this.getStage(),n=t.x!==void 0?t.x:Math.floor(e.x),s=t.y!==void 0?t.y:Math.floor(e.y),a=t.pixelRatio||1,l=new cr.SceneCanvas({width:t.width||Math.ceil(e.width)||(i?i.width():0),height:t.height||Math.ceil(e.height)||(i?i.height():0),pixelRatio:a}),o=l.getContext();return t.imageSmoothingEnabled===!1&&(o._context.imageSmoothingEnabled=!1),o.save(),(n||s)&&o.translate(-1*n,-1*s),this.drawScene(l),o.restore(),l}toCanvas(t){return this._toKonvaCanvas(t)._canvas}toDataURL(t){t=t||{};var e=t.mimeType||null,i=t.quality||null,n=this._toKonvaCanvas(t).toDataURL(e,i);return t.callback&&t.callback(n),n}toImage(t){return new Promise((e,i)=>{try{const n=t?.callback;n&&delete t.callback,ht.Util._urlToImage(this.toDataURL(t),function(s){e(s),n?.(s)})}catch(n){i(n)}})}toBlob(t){return new Promise((e,i)=>{try{const n=t?.callback;n&&delete t.callback,this.toCanvas(t).toBlob(s=>{e(s),n?.(s)},t?.mimeType,t?.quality)}catch(n){i(n)}})}setSize(t){return this.width(t.width),this.height(t.height),this}getSize(){return{width:this.width(),height:this.height()}}getClassName(){return this.className||this.nodeType}getType(){return this.nodeType}getDragDistance(){return this.attrs.dragDistance!==void 0?this.attrs.dragDistance:this.parent?this.parent.getDragDistance():Si.Konva.dragDistance}_off(t,e,i){var n=this.eventListeners[t],s,a,l;for(s=0;s<n.length;s++)if(a=n[s].name,l=n[s].handler,(a!=="konva"||e==="konva")&&(!e||a===e)&&(!i||i===l)){if(n.splice(s,1),n.length===0){delete this.eventListeners[t];break}s--}}_fireChangeEvent(t,e,i){this._fire(t+Id,{oldVal:e,newVal:i})}addName(t){if(!this.hasName(t)){var e=this.name(),i=e?e+" "+t:t;this.name(i)}return this}hasName(t){if(!t)return!1;const e=this.name();if(!e)return!1;var i=(e||"").split(/\s/g);return i.indexOf(t)!==-1}removeName(t){var e=(this.name()||"").split(/\s/g),i=e.indexOf(t);return i!==-1&&(e.splice(i,1),this.name(e.join(" "))),this}setAttr(t,e){var i=this[ol+ht.Util._capitalize(t)];return ht.Util._isFunction(i)?i.call(this,e):this._setAttr(t,e),this}_requestDraw(){if(Si.Konva.autoDrawEnabled){const t=this.getLayer()||this.getStage();t?.batchDraw()}}_setAttr(t,e){var i=this.attrs[t];i===e&&!ht.Util.isObject(e)||(e==null?delete this.attrs[t]:this.attrs[t]=e,this._shouldFireChangeEvents&&this._fireChangeEvent(t,i,e),this._requestDraw())}_setComponentAttr(t,e,i){var n;i!==void 0&&(n=this.attrs[t],n||(this.attrs[t]=this.getAttr(t)),this.attrs[t][e]=i,this._fireChangeEvent(t,n,i))}_fireAndBubble(t,e,i){e&&this.nodeType===ll&&(e.target=this);var n=(t===sl||t===al)&&(i&&(this===i||this.isAncestorOf&&this.isAncestorOf(i))||this.nodeType==="Stage"&&!i);if(!n){this._fire(t,e);var s=(t===sl||t===al)&&i&&i.isAncestorOf&&i.isAncestorOf(this)&&!i.isAncestorOf(this.parent);(e&&!e.cancelBubble||!e)&&this.parent&&this.parent.isListening()&&!s&&(i&&i.parent?this._fireAndBubble.call(this.parent,t,e,i):this._fireAndBubble.call(this.parent,t,e))}}_getProtoListeners(t){var e,i,n;const s=(e=this._cache.get(hr))!==null&&e!==void 0?e:{};let a=s?.[t];if(a===void 0){a=[];let l=Object.getPrototypeOf(this);for(;l;){const o=(n=(i=l.eventListeners)===null||i===void 0?void 0:i[t])!==null&&n!==void 0?n:[];a.push(...o),l=Object.getPrototypeOf(l)}s[t]=a,this._cache.set(hr,s)}return a}_fire(t,e){e=e||{},e.currentTarget=this,e.type=t;const i=this._getProtoListeners(t);if(i)for(var n=0;n<i.length;n++)i[n].handler.call(this,e);const s=this.eventListeners[t];if(s)for(var n=0;n<s.length;n++)s[n].handler.call(this,e)}draw(){return this.drawScene(),this.drawHit(),this}_createDragElement(t){var e=t?t.pointerId:void 0,i=this.getStage(),n=this.getAbsolutePosition();if(i){var s=i._getPointerById(e)||i._changedPointerPositions[0]||n;he.DD._dragElements.set(this._id,{node:this,startPointerPos:s,offset:{x:s.x-n.x,y:s.y-n.y},dragStatus:"ready",pointerId:e})}}startDrag(t,e=!0){he.DD._dragElements.has(this._id)||this._createDragElement(t);const i=he.DD._dragElements.get(this._id);i.dragStatus="dragging",this.fire("dragstart",{type:"dragstart",target:this,evt:t&&t.evt},e)}_setDragPosition(t,e){const i=this.getStage()._getPointerById(e.pointerId);if(i){var n={x:i.x-e.offset.x,y:i.y-e.offset.y},s=this.dragBoundFunc();if(s!==void 0){const a=s.call(this,n,t);a?n=a:ht.Util.warn("dragBoundFunc did not return any value. That is unexpected behavior. You must return new absolute position from dragBoundFunc.")}(!this._lastPos||this._lastPos.x!==n.x||this._lastPos.y!==n.y)&&(this.setAbsolutePosition(n),this._requestDraw()),this._lastPos=n}}stopDrag(t){const e=he.DD._dragElements.get(this._id);e&&(e.dragStatus="stopped"),he.DD._endDragBefore(t),he.DD._endDragAfter(t)}setDraggable(t){this._setAttr("draggable",t),this._dragChange()}isDragging(){const t=he.DD._dragElements.get(this._id);return t?t.dragStatus==="dragging":!1}_listenDrag(){this._dragCleanup(),this.on("mousedown.konva touchstart.konva",function(t){var e=t.evt.button!==void 0,i=!e||Si.Konva.dragButtons.indexOf(t.evt.button)>=0;if(i&&!this.isDragging()){var n=!1;he.DD._dragElements.forEach(s=>{this.isAncestorOf(s.node)&&(n=!0)}),n||this._createDragElement(t)}})}_dragChange(){if(this.attrs.draggable)this._listenDrag();else{this._dragCleanup();var t=this.getStage();if(!t)return;const e=he.DD._dragElements.get(this._id),i=e&&e.dragStatus==="dragging",n=e&&e.dragStatus==="ready";i?this.stopDrag():n&&he.DD._dragElements.delete(this._id)}}_dragCleanup(){this.off("mousedown.konva"),this.off("touchstart.konva")}isClientRectOnScreen(t={x:0,y:0}){const e=this.getStage();if(!e)return!1;const i={x:-t.x,y:-t.y,width:e.width()+2*t.x,height:e.height()+2*t.y};return ht.Util.haveIntersection(i,this.getClientRect())}static create(t,e){return ht.Util._isString(t)&&(t=JSON.parse(t)),this._createNode(t,e)}static _createNode(t,e){var i=Ha.prototype.getClassName.call(t),n=t.children,s,a,l;e&&(t.attrs.container=e),Si.Konva[i]||(ht.Util.warn('Can not find a node with class name "'+i+'". Fallback to "Shape".'),i="Shape");const o=Si.Konva[i];if(s=new o(t.attrs),n)for(a=n.length,l=0;l<a;l++)s.add(Ha._createNode(n[l]));return s}};Ft.Node=$;$.prototype.nodeType="Node";$.prototype._attrsAffectingSize=[];$.prototype.eventListeners={};$.prototype.on.call($.prototype,Vd,function(){if(this._batchingTransformChange){this._needClearTransformCache=!0;return}this._clearCache(si),this._clearSelfAndDescendantCache(Ue)});$.prototype.on.call($.prototype,"visibleChange.konva",function(){this._clearSelfAndDescendantCache(za)});$.prototype.on.call($.prototype,"listeningChange.konva",function(){this._clearSelfAndDescendantCache(Va)});$.prototype.on.call($.prototype,"opacityChange.konva",function(){this._clearSelfAndDescendantCache(Ir)});const Pt=tr.Factory.addGetterSetter;Pt($,"zIndex");Pt($,"absolutePosition");Pt($,"position");Pt($,"x",0,(0,zt.getNumberValidator)());Pt($,"y",0,(0,zt.getNumberValidator)());Pt($,"globalCompositeOperation","source-over",(0,zt.getStringValidator)());Pt($,"opacity",1,(0,zt.getNumberValidator)());Pt($,"name","",(0,zt.getStringValidator)());Pt($,"id","",(0,zt.getStringValidator)());Pt($,"rotation",0,(0,zt.getNumberValidator)());tr.Factory.addComponentsGetterSetter($,"scale",["x","y"]);Pt($,"scaleX",1,(0,zt.getNumberValidator)());Pt($,"scaleY",1,(0,zt.getNumberValidator)());tr.Factory.addComponentsGetterSetter($,"skew",["x","y"]);Pt($,"skewX",0,(0,zt.getNumberValidator)());Pt($,"skewY",0,(0,zt.getNumberValidator)());tr.Factory.addComponentsGetterSetter($,"offset",["x","y"]);Pt($,"offsetX",0,(0,zt.getNumberValidator)());Pt($,"offsetY",0,(0,zt.getNumberValidator)());Pt($,"dragDistance",null,(0,zt.getNumberValidator)());Pt($,"width",0,(0,zt.getNumberValidator)());Pt($,"height",0,(0,zt.getNumberValidator)());Pt($,"listening",!0,(0,zt.getBooleanValidator)());Pt($,"preventDefault",!0,(0,zt.getBooleanValidator)());Pt($,"filters",null,function(r){return this._filterUpToDate=!1,r});Pt($,"visible",!0,(0,zt.getBooleanValidator)());Pt($,"transformsEnabled","all",(0,zt.getStringValidator)());Pt($,"size");Pt($,"dragBoundFunc");Pt($,"draggable",!1,(0,zt.getBooleanValidator)());tr.Factory.backCompat($,{rotateDeg:"rotate",setRotationDeg:"setRotation",getRotationDeg:"getRotation"});var Bi={};Object.defineProperty(Bi,"__esModule",{value:!0});Bi.Container=void 0;const wn=ot,sa=Ft,us=X;let Ui=class extends sa.Node{constructor(){super(...arguments),this.children=[]}getChildren(t){if(!t)return this.children||[];const e=this.children||[];var i=[];return e.forEach(function(n){t(n)&&i.push(n)}),i}hasChildren(){return this.getChildren().length>0}removeChildren(){return this.getChildren().forEach(t=>{t.parent=null,t.index=0,t.remove()}),this.children=[],this._requestDraw(),this}destroyChildren(){return this.getChildren().forEach(t=>{t.parent=null,t.index=0,t.destroy()}),this.children=[],this._requestDraw(),this}add(...t){if(t.length===0)return this;if(t.length>1){for(var e=0;e<t.length;e++)this.add(t[e]);return this}const i=t[0];return i.getParent()?(i.moveTo(this),this):(this._validateAdd(i),i.index=this.getChildren().length,i.parent=this,i._clearCaches(),this.getChildren().push(i),this._fire("add",{child:i}),this._requestDraw(),this)}destroy(){return this.hasChildren()&&this.destroyChildren(),super.destroy(),this}find(t){return this._generalFind(t,!1)}findOne(t){var e=this._generalFind(t,!0);return e.length>0?e[0]:void 0}_generalFind(t,e){var i=[];return this._descendants(n=>{const s=n._isMatch(t);return s&&i.push(n),!!(s&&e)}),i}_descendants(t){let e=!1;const i=this.getChildren();for(const n of i){if(e=t(n),e)return!0;if(n.hasChildren()&&(e=n._descendants(t),e))return!0}return!1}toObject(){var t=sa.Node.prototype.toObject.call(this);return t.children=[],this.getChildren().forEach(e=>{t.children.push(e.toObject())}),t}isAncestorOf(t){for(var e=t.getParent();e;){if(e._id===this._id)return!0;e=e.getParent()}return!1}clone(t){var e=sa.Node.prototype.clone.call(this,t);return this.getChildren().forEach(function(i){e.add(i.clone())}),e}getAllIntersections(t){var e=[];return this.find("Shape").forEach(i=>{i.isVisible()&&i.intersects(t)&&e.push(i)}),e}_clearSelfAndDescendantCache(t){var e;super._clearSelfAndDescendantCache(t),!this.isCached()&&((e=this.children)===null||e===void 0||e.forEach(function(i){i._clearSelfAndDescendantCache(t)}))}_setChildrenIndices(){var t;(t=this.children)===null||t===void 0||t.forEach(function(e,i){e.index=i}),this._requestDraw()}drawScene(t,e){var i=this.getLayer(),n=t||i&&i.getCanvas(),s=n&&n.getContext(),a=this._getCanvasCache(),l=a&&a.scene,o=n&&n.isCache;if(!this.isVisible()&&!o)return this;if(l){s.save();var c=this.getAbsoluteTransform(e).getMatrix();s.transform(c[0],c[1],c[2],c[3],c[4],c[5]),this._drawCachedSceneCanvas(s),s.restore()}else this._drawChildren("drawScene",n,e);return this}drawHit(t,e){if(!this.shouldDrawHit(e))return this;var i=this.getLayer(),n=t||i&&i.hitCanvas,s=n&&n.getContext(),a=this._getCanvasCache(),l=a&&a.hit;if(l){s.save();var o=this.getAbsoluteTransform(e).getMatrix();s.transform(o[0],o[1],o[2],o[3],o[4],o[5]),this._drawCachedHitCanvas(s),s.restore()}else this._drawChildren("drawHit",n,e);return this}_drawChildren(t,e,i){var n,s=e&&e.getContext(),a=this.clipWidth(),l=this.clipHeight(),o=this.clipFunc(),c=a&&l||o;const h=i===this;if(c){s.save();var f=this.getAbsoluteTransform(i),g=f.getMatrix();s.transform(g[0],g[1],g[2],g[3],g[4],g[5]),s.beginPath();let b;if(o)b=o.call(this,s,this);else{var d=this.clipX(),p=this.clipY();s.rect(d,p,a,l)}s.clip.apply(s,b),g=f.copy().invert().getMatrix(),s.transform(g[0],g[1],g[2],g[3],g[4],g[5])}var v=!h&&this.globalCompositeOperation()!=="source-over"&&t==="drawScene";v&&(s.save(),s._applyGlobalCompositeOperation(this)),(n=this.children)===null||n===void 0||n.forEach(function(b){b[t](e,i)}),v&&s.restore(),c&&s.restore()}getClientRect(t={}){var e,i=t.skipTransform,n=t.relativeTo,s,a,l,o,c={x:1/0,y:1/0,width:0,height:0},h=this;(e=this.children)===null||e===void 0||e.forEach(function(v){if(v.visible()){var b=v.getClientRect({relativeTo:h,skipShadow:t.skipShadow,skipStroke:t.skipStroke});b.width===0&&b.height===0||(s===void 0?(s=b.x,a=b.y,l=b.x+b.width,o=b.y+b.height):(s=Math.min(s,b.x),a=Math.min(a,b.y),l=Math.max(l,b.x+b.width),o=Math.max(o,b.y+b.height)))}});for(var f=this.find("Shape"),g=!1,d=0;d<f.length;d++){var p=f[d];if(p._isVisible(this)){g=!0;break}}return g&&s!==void 0?c={x:s,y:a,width:l-s,height:o-a}:c={x:0,y:0,width:0,height:0},i?c:this._transformedRect(c,n)}};Bi.Container=Ui;wn.Factory.addComponentsGetterSetter(Ui,"clip",["x","y","width","height"]);wn.Factory.addGetterSetter(Ui,"clipX",void 0,(0,us.getNumberValidator)());wn.Factory.addGetterSetter(Ui,"clipY",void 0,(0,us.getNumberValidator)());wn.Factory.addGetterSetter(Ui,"clipWidth",void 0,(0,us.getNumberValidator)());wn.Factory.addGetterSetter(Ui,"clipHeight",void 0,(0,us.getNumberValidator)());wn.Factory.addGetterSetter(Ui,"clipFunc");var ch={},ie={};Object.defineProperty(ie,"__esModule",{value:!0});ie.releaseCapture=ie.setPointerCapture=ie.hasPointerCapture=ie.createEvent=ie.getCapturedShape=void 0;const Hd=ct,Xn=new Map,hh=Hd.Konva._global.PointerEvent!==void 0;function Wd(r){return Xn.get(r)}ie.getCapturedShape=Wd;function mo(r){return{evt:r,pointerId:r.pointerId}}ie.createEvent=mo;function jd(r,t){return Xn.get(r)===t}ie.hasPointerCapture=jd;function Xd(r,t){fh(r),t.getStage()&&(Xn.set(r,t),hh&&t._fire("gotpointercapture",mo(new PointerEvent("gotpointercapture"))))}ie.setPointerCapture=Xd;function fh(r,t){const e=Xn.get(r);if(!e)return;const i=e.getStage();i&&i.content,Xn.delete(r),hh&&e._fire("lostpointercapture",mo(new PointerEvent("lostpointercapture")))}ie.releaseCapture=fh;(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.Stage=r.stages=void 0;const t=Ot,e=ot,i=Bi,n=ct,s=Ce,a=fs,l=ct,o=ie;var c="Stage",h="string",f="px",g="mouseout",d="mouseleave",p="mouseover",v="mouseenter",b="mousemove",_="mousedown",w="mouseup",u="pointermove",m="pointerdown",y="pointerup",S="pointercancel",T="lostpointercapture",C="pointerout",A="pointerleave",P="pointerover",k="pointerenter",E="contextmenu",M="touchstart",F="touchend",N="touchmove",D="touchcancel",V="wheel",Z=5,lt=[[v,"_pointerenter"],[_,"_pointerdown"],[b,"_pointermove"],[w,"_pointerup"],[d,"_pointerleave"],[M,"_pointerdown"],[N,"_pointermove"],[F,"_pointerup"],[D,"_pointercancel"],[p,"_pointerover"],[V,"_wheel"],[E,"_contextmenu"],[m,"_pointerdown"],[u,"_pointermove"],[y,"_pointerup"],[S,"_pointercancel"],[T,"_lostpointercapture"]];const K={mouse:{[C]:g,[A]:d,[P]:p,[k]:v,[u]:b,[m]:_,[y]:w,[S]:"mousecancel",pointerclick:"click",pointerdblclick:"dblclick"},touch:{[C]:"touchout",[A]:"touchleave",[P]:"touchover",[k]:"touchenter",[u]:N,[m]:M,[y]:F,[S]:D,pointerclick:"tap",pointerdblclick:"dbltap"},pointer:{[C]:C,[A]:A,[P]:P,[k]:k,[u]:u,[m]:m,[y]:y,[S]:S,pointerclick:"pointerclick",pointerdblclick:"pointerdblclick"}},q=j=>j.indexOf("pointer")>=0?"pointer":j.indexOf("touch")>=0?"touch":"mouse",gt=j=>{const x=q(j);if(x==="pointer")return n.Konva.pointerEventsEnabled&&K.pointer;if(x==="touch")return K.touch;if(x==="mouse")return K.mouse};function St(j={}){return(j.clipFunc||j.clipWidth||j.clipHeight)&&t.Util.warn("Stage does not support clipping. Please use clip for Layers or Groups."),j}const U="Pointer position is missing and not registered by the stage. Looks like it is outside of the stage container. You can set it manually from event: stage.setPointersPositions(event);";r.stages=[];class I extends i.Container{constructor(x){super(St(x)),this._pointerPositions=[],this._changedPointerPositions=[],this._buildDOM(),this._bindContentEvents(),r.stages.push(this),this.on("widthChange.konva heightChange.konva",this._resizeDOM),this.on("visibleChange.konva",this._checkVisibility),this.on("clipWidthChange.konva clipHeightChange.konva clipFuncChange.konva",()=>{St(this.attrs)}),this._checkVisibility()}_validateAdd(x){const L=x.getType()==="Layer",z=x.getType()==="FastLayer";L||z||t.Util.throw("You may only add layers to the stage.")}_checkVisibility(){if(!this.content)return;const x=this.visible()?"":"none";this.content.style.display=x}setContainer(x){if(typeof x===h){if(x.charAt(0)==="."){var L=x.slice(1);x=document.getElementsByClassName(L)[0]}else{var z;x.charAt(0)!=="#"?z=x:z=x.slice(1),x=document.getElementById(z)}if(!x)throw"Can not find container in document with id "+z}return this._setAttr("container",x),this.content&&(this.content.parentElement&&this.content.parentElement.removeChild(this.content),x.appendChild(this.content)),this}shouldDrawHit(){return!0}clear(){var x=this.children,L=x.length,z;for(z=0;z<L;z++)x[z].clear();return this}clone(x){return x||(x={}),x.container=typeof document<"u"&&document.createElement("div"),i.Container.prototype.clone.call(this,x)}destroy(){super.destroy();var x=this.content;x&&t.Util._isInDocument(x)&&this.container().removeChild(x);var L=r.stages.indexOf(this);return L>-1&&r.stages.splice(L,1),t.Util.releaseCanvas(this.bufferCanvas._canvas,this.bufferHitCanvas._canvas),this}getPointerPosition(){const x=this._pointerPositions[0]||this._changedPointerPositions[0];return x?{x:x.x,y:x.y}:(t.Util.warn(U),null)}_getPointerById(x){return this._pointerPositions.find(L=>L.id===x)}getPointersPositions(){return this._pointerPositions}getStage(){return this}getContent(){return this.content}_toKonvaCanvas(x){x=x||{},x.x=x.x||0,x.y=x.y||0,x.width=x.width||this.width(),x.height=x.height||this.height();var L=new s.SceneCanvas({width:x.width,height:x.height,pixelRatio:x.pixelRatio||1}),z=L.getContext()._context,bt=this.children;return(x.x||x.y)&&z.translate(-1*x.x,-1*x.y),bt.forEach(function(rt){if(rt.isVisible()){var Bt=rt._toKonvaCanvas(x);z.drawImage(Bt._canvas,x.x,x.y,Bt.getWidth()/Bt.getPixelRatio(),Bt.getHeight()/Bt.getPixelRatio())}}),L}getIntersection(x){if(!x)return null;var L=this.children,z=L.length,bt=z-1,rt;for(rt=bt;rt>=0;rt--){const Bt=L[rt].getIntersection(x);if(Bt)return Bt}return null}_resizeDOM(){var x=this.width(),L=this.height();this.content&&(this.content.style.width=x+f,this.content.style.height=L+f),this.bufferCanvas.setSize(x,L),this.bufferHitCanvas.setSize(x,L),this.children.forEach(z=>{z.setSize({width:x,height:L}),z.draw()})}add(x,...L){if(arguments.length>1){for(var z=0;z<arguments.length;z++)this.add(arguments[z]);return this}super.add(x);var bt=this.children.length;return bt>Z&&t.Util.warn("The stage has "+bt+" layers. Recommended maximum number of layers is 3-5. Adding more layers into the stage may drop the performance. Rethink your tree structure, you can use Konva.Group."),x.setSize({width:this.width(),height:this.height()}),x.draw(),n.Konva.isBrowser&&this.content.appendChild(x.canvas._canvas),this}getParent(){return null}getLayer(){return null}hasPointerCapture(x){return o.hasPointerCapture(x,this)}setPointerCapture(x){o.setPointerCapture(x,this)}releaseCapture(x){o.releaseCapture(x,this)}getLayers(){return this.children}_bindContentEvents(){n.Konva.isBrowser&&lt.forEach(([x,L])=>{this.content.addEventListener(x,z=>{this[L](z)},{passive:!1})})}_pointerenter(x){this.setPointersPositions(x);const L=gt(x.type);L&&this._fire(L.pointerenter,{evt:x,target:this,currentTarget:this})}_pointerover(x){this.setPointersPositions(x);const L=gt(x.type);L&&this._fire(L.pointerover,{evt:x,target:this,currentTarget:this})}_getTargetShape(x){let L=this[x+"targetShape"];return L&&!L.getStage()&&(L=null),L}_pointerleave(x){const L=gt(x.type),z=q(x.type);if(L){this.setPointersPositions(x);var bt=this._getTargetShape(z),rt=!a.DD.isDragging||n.Konva.hitOnDragEnabled;bt&&rt?(bt._fireAndBubble(L.pointerout,{evt:x}),bt._fireAndBubble(L.pointerleave,{evt:x}),this._fire(L.pointerleave,{evt:x,target:this,currentTarget:this}),this[z+"targetShape"]=null):rt&&(this._fire(L.pointerleave,{evt:x,target:this,currentTarget:this}),this._fire(L.pointerout,{evt:x,target:this,currentTarget:this})),this.pointerPos=null,this._pointerPositions=[]}}_pointerdown(x){const L=gt(x.type),z=q(x.type);if(L){this.setPointersPositions(x);var bt=!1;this._changedPointerPositions.forEach(rt=>{var Bt=this.getIntersection(rt);if(a.DD.justDragged=!1,n.Konva["_"+z+"ListenClick"]=!0,!Bt||!Bt.isListening())return;n.Konva.capturePointerEventsEnabled&&Bt.setPointerCapture(rt.id),this[z+"ClickStartShape"]=Bt,Bt._fireAndBubble(L.pointerdown,{evt:x,pointerId:rt.id}),bt=!0;const ce=x.type.indexOf("touch")>=0;Bt.preventDefault()&&x.cancelable&&ce&&x.preventDefault()}),bt||this._fire(L.pointerdown,{evt:x,target:this,currentTarget:this,pointerId:this._pointerPositions[0].id})}}_pointermove(x){const L=gt(x.type),z=q(x.type);if(!L)return;a.DD.isDragging&&a.DD.node.preventDefault()&&x.cancelable&&x.preventDefault(),this.setPointersPositions(x);var bt=!a.DD.isDragging||n.Konva.hitOnDragEnabled;if(!bt)return;var rt={};let Bt=!1;var ce=this._getTargetShape(z);this._changedPointerPositions.forEach(ei=>{const xt=o.getCapturedShape(ei.id)||this.getIntersection(ei),Ki=ei.id,Le={evt:x,pointerId:Ki};var qi=ce!==xt;if(qi&&ce&&(ce._fireAndBubble(L.pointerout,{...Le},xt),ce._fireAndBubble(L.pointerleave,{...Le},xt)),xt){if(rt[xt._id])return;rt[xt._id]=!0}xt&&xt.isListening()?(Bt=!0,qi&&(xt._fireAndBubble(L.pointerover,{...Le},ce),xt._fireAndBubble(L.pointerenter,{...Le},ce),this[z+"targetShape"]=xt),xt._fireAndBubble(L.pointermove,{...Le})):ce&&(this._fire(L.pointerover,{evt:x,target:this,currentTarget:this,pointerId:Ki}),this[z+"targetShape"]=null)}),Bt||this._fire(L.pointermove,{evt:x,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id})}_pointerup(x){const L=gt(x.type),z=q(x.type);if(!L)return;this.setPointersPositions(x);const bt=this[z+"ClickStartShape"],rt=this[z+"ClickEndShape"];var Bt={};let ce=!1;this._changedPointerPositions.forEach(ei=>{const xt=o.getCapturedShape(ei.id)||this.getIntersection(ei);if(xt){if(xt.releaseCapture(ei.id),Bt[xt._id])return;Bt[xt._id]=!0}const Ki=ei.id,Le={evt:x,pointerId:Ki};let qi=!1;n.Konva["_"+z+"InDblClickWindow"]?(qi=!0,clearTimeout(this[z+"DblTimeout"])):a.DD.justDragged||(n.Konva["_"+z+"InDblClickWindow"]=!0,clearTimeout(this[z+"DblTimeout"])),this[z+"DblTimeout"]=setTimeout(function(){n.Konva["_"+z+"InDblClickWindow"]=!1},n.Konva.dblClickWindow),xt&&xt.isListening()?(ce=!0,this[z+"ClickEndShape"]=xt,xt._fireAndBubble(L.pointerup,{...Le}),n.Konva["_"+z+"ListenClick"]&&bt&&bt===xt&&(xt._fireAndBubble(L.pointerclick,{...Le}),qi&&rt&&rt===xt&&xt._fireAndBubble(L.pointerdblclick,{...Le}))):(this[z+"ClickEndShape"]=null,n.Konva["_"+z+"ListenClick"]&&this._fire(L.pointerclick,{evt:x,target:this,currentTarget:this,pointerId:Ki}),qi&&this._fire(L.pointerdblclick,{evt:x,target:this,currentTarget:this,pointerId:Ki}))}),ce||this._fire(L.pointerup,{evt:x,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id}),n.Konva["_"+z+"ListenClick"]=!1,x.cancelable&&z!=="touch"&&x.preventDefault()}_contextmenu(x){this.setPointersPositions(x);var L=this.getIntersection(this.getPointerPosition());L&&L.isListening()?L._fireAndBubble(E,{evt:x}):this._fire(E,{evt:x,target:this,currentTarget:this})}_wheel(x){this.setPointersPositions(x);var L=this.getIntersection(this.getPointerPosition());L&&L.isListening()?L._fireAndBubble(V,{evt:x}):this._fire(V,{evt:x,target:this,currentTarget:this})}_pointercancel(x){this.setPointersPositions(x);const L=o.getCapturedShape(x.pointerId)||this.getIntersection(this.getPointerPosition());L&&L._fireAndBubble(y,o.createEvent(x)),o.releaseCapture(x.pointerId)}_lostpointercapture(x){o.releaseCapture(x.pointerId)}setPointersPositions(x){var L=this._getContentPosition(),z=null,bt=null;x=x||window.event,x.touches!==void 0?(this._pointerPositions=[],this._changedPointerPositions=[],Array.prototype.forEach.call(x.touches,rt=>{this._pointerPositions.push({id:rt.identifier,x:(rt.clientX-L.left)/L.scaleX,y:(rt.clientY-L.top)/L.scaleY})}),Array.prototype.forEach.call(x.changedTouches||x.touches,rt=>{this._changedPointerPositions.push({id:rt.identifier,x:(rt.clientX-L.left)/L.scaleX,y:(rt.clientY-L.top)/L.scaleY})})):(z=(x.clientX-L.left)/L.scaleX,bt=(x.clientY-L.top)/L.scaleY,this.pointerPos={x:z,y:bt},this._pointerPositions=[{x:z,y:bt,id:t.Util._getFirstPointerId(x)}],this._changedPointerPositions=[{x:z,y:bt,id:t.Util._getFirstPointerId(x)}])}_setPointerPosition(x){t.Util.warn('Method _setPointerPosition is deprecated. Use "stage.setPointersPositions(event)" instead.'),this.setPointersPositions(x)}_getContentPosition(){if(!this.content||!this.content.getBoundingClientRect)return{top:0,left:0,scaleX:1,scaleY:1};var x=this.content.getBoundingClientRect();return{top:x.top,left:x.left,scaleX:x.width/this.content.clientWidth||1,scaleY:x.height/this.content.clientHeight||1}}_buildDOM(){if(this.bufferCanvas=new s.SceneCanvas({width:this.width(),height:this.height()}),this.bufferHitCanvas=new s.HitCanvas({pixelRatio:1,width:this.width(),height:this.height()}),!!n.Konva.isBrowser){var x=this.container();if(!x)throw"Stage has no container. A container is required.";x.innerHTML="",this.content=document.createElement("div"),this.content.style.position="relative",this.content.style.userSelect="none",this.content.className="konvajs-content",this.content.setAttribute("role","presentation"),x.appendChild(this.content),this._resizeDOM()}}cache(){return t.Util.warn("Cache function is not allowed for stage. You may use cache only for layers, groups and shapes."),this}clearCache(){return this}batchDraw(){return this.getChildren().forEach(function(x){x.batchDraw()}),this}}r.Stage=I,I.prototype.nodeType=c,(0,l._registerNode)(I),e.Factory.addGetterSetter(I,"container")})(ch);var er={},Xt={};(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.Shape=r.shapes=void 0;const t=ct,e=Ot,i=ot,n=Ft,s=X,a=ct,l=ie;var o="hasShadow",c="shadowRGBA",h="patternImage",f="linearGradient",g="radialGradient";let d;function p(){return d||(d=e.Util.createCanvasElement().getContext("2d"),d)}r.shapes={};function v(A){const P=this.attrs.fillRule;P?A.fill(P):A.fill()}function b(A){A.stroke()}function _(A){A.fill()}function w(A){A.stroke()}function u(){this._clearCache(o)}function m(){this._clearCache(c)}function y(){this._clearCache(h)}function S(){this._clearCache(f)}function T(){this._clearCache(g)}class C extends n.Node{constructor(P){super(P);let k;for(;k=e.Util.getRandomColor(),!(k&&!(k in r.shapes)););this.colorKey=k,r.shapes[k]=this}getContext(){return e.Util.warn("shape.getContext() method is deprecated. Please do not use it."),this.getLayer().getContext()}getCanvas(){return e.Util.warn("shape.getCanvas() method is deprecated. Please do not use it."),this.getLayer().getCanvas()}getSceneFunc(){return this.attrs.sceneFunc||this._sceneFunc}getHitFunc(){return this.attrs.hitFunc||this._hitFunc}hasShadow(){return this._getCache(o,this._hasShadow)}_hasShadow(){return this.shadowEnabled()&&this.shadowOpacity()!==0&&!!(this.shadowColor()||this.shadowBlur()||this.shadowOffsetX()||this.shadowOffsetY())}_getFillPattern(){return this._getCache(h,this.__getFillPattern)}__getFillPattern(){if(this.fillPatternImage()){var P=p();const k=P.createPattern(this.fillPatternImage(),this.fillPatternRepeat()||"repeat");if(k&&k.setTransform){const E=new e.Transform;E.translate(this.fillPatternX(),this.fillPatternY()),E.rotate(t.Konva.getAngle(this.fillPatternRotation())),E.scale(this.fillPatternScaleX(),this.fillPatternScaleY()),E.translate(-1*this.fillPatternOffsetX(),-1*this.fillPatternOffsetY());const M=E.getMatrix(),F=typeof DOMMatrix>"u"?{a:M[0],b:M[1],c:M[2],d:M[3],e:M[4],f:M[5]}:new DOMMatrix(M);k.setTransform(F)}return k}}_getLinearGradient(){return this._getCache(f,this.__getLinearGradient)}__getLinearGradient(){var P=this.fillLinearGradientColorStops();if(P){for(var k=p(),E=this.fillLinearGradientStartPoint(),M=this.fillLinearGradientEndPoint(),F=k.createLinearGradient(E.x,E.y,M.x,M.y),N=0;N<P.length;N+=2)F.addColorStop(P[N],P[N+1]);return F}}_getRadialGradient(){return this._getCache(g,this.__getRadialGradient)}__getRadialGradient(){var P=this.fillRadialGradientColorStops();if(P){for(var k=p(),E=this.fillRadialGradientStartPoint(),M=this.fillRadialGradientEndPoint(),F=k.createRadialGradient(E.x,E.y,this.fillRadialGradientStartRadius(),M.x,M.y,this.fillRadialGradientEndRadius()),N=0;N<P.length;N+=2)F.addColorStop(P[N],P[N+1]);return F}}getShadowRGBA(){return this._getCache(c,this._getShadowRGBA)}_getShadowRGBA(){if(this.hasShadow()){var P=e.Util.colorToRGBA(this.shadowColor());if(P)return"rgba("+P.r+","+P.g+","+P.b+","+P.a*(this.shadowOpacity()||1)+")"}}hasFill(){return this._calculate("hasFill",["fillEnabled","fill","fillPatternImage","fillLinearGradientColorStops","fillRadialGradientColorStops"],()=>this.fillEnabled()&&!!(this.fill()||this.fillPatternImage()||this.fillLinearGradientColorStops()||this.fillRadialGradientColorStops()))}hasStroke(){return this._calculate("hasStroke",["strokeEnabled","strokeWidth","stroke","strokeLinearGradientColorStops"],()=>this.strokeEnabled()&&this.strokeWidth()&&!!(this.stroke()||this.strokeLinearGradientColorStops()))}hasHitStroke(){const P=this.hitStrokeWidth();return P==="auto"?this.hasStroke():this.strokeEnabled()&&!!P}intersects(P){var k=this.getStage();if(!k)return!1;const E=k.bufferHitCanvas;return E.getContext().clear(),this.drawHit(E,void 0,!0),E.context.getImageData(Math.round(P.x),Math.round(P.y),1,1).data[3]>0}destroy(){return n.Node.prototype.destroy.call(this),delete r.shapes[this.colorKey],delete this.colorKey,this}_useBufferCanvas(P){var k;if(!this.getStage()||!((k=this.attrs.perfectDrawEnabled)!==null&&k!==void 0?k:!0))return!1;const M=P||this.hasFill(),F=this.hasStroke(),N=this.getAbsoluteOpacity()!==1;if(M&&F&&N)return!0;const D=this.hasShadow(),V=this.shadowForStrokeEnabled();return!!(M&&F&&D&&V)}setStrokeHitEnabled(P){e.Util.warn("strokeHitEnabled property is deprecated. Please use hitStrokeWidth instead."),P?this.hitStrokeWidth("auto"):this.hitStrokeWidth(0)}getStrokeHitEnabled(){return this.hitStrokeWidth()!==0}getSelfRect(){var P=this.size();return{x:this._centroid?-P.width/2:0,y:this._centroid?-P.height/2:0,width:P.width,height:P.height}}getClientRect(P={}){const k=P.skipTransform,E=P.relativeTo,M=this.getSelfRect(),N=!P.skipStroke&&this.hasStroke()&&this.strokeWidth()||0,D=M.width+N,V=M.height+N,Z=!P.skipShadow&&this.hasShadow(),lt=Z?this.shadowOffsetX():0,K=Z?this.shadowOffsetY():0,q=D+Math.abs(lt),gt=V+Math.abs(K),St=Z&&this.shadowBlur()||0,U=q+St*2,I=gt+St*2,j={width:U,height:I,x:-(N/2+St)+Math.min(lt,0)+M.x,y:-(N/2+St)+Math.min(K,0)+M.y};return k?j:this._transformedRect(j,E)}drawScene(P,k){var E=this.getLayer(),M=P||E.getCanvas(),F=M.getContext(),N=this._getCanvasCache(),D=this.getSceneFunc(),V=this.hasShadow(),Z,lt,K,q=M.isCache,gt=k===this;if(!this.isVisible()&&!gt)return this;if(N){F.save();var St=this.getAbsoluteTransform(k).getMatrix();return F.transform(St[0],St[1],St[2],St[3],St[4],St[5]),this._drawCachedSceneCanvas(F),F.restore(),this}if(!D)return this;if(F.save(),this._useBufferCanvas()&&!q){Z=this.getStage(),lt=Z.bufferCanvas,K=lt.getContext(),K.clear(),K.save(),K._applyLineJoin(this);var U=this.getAbsoluteTransform(k).getMatrix();K.transform(U[0],U[1],U[2],U[3],U[4],U[5]),D.call(this,K,this),K.restore();var I=lt.pixelRatio;V&&F._applyShadow(this),F._applyOpacity(this),F._applyGlobalCompositeOperation(this),F.drawImage(lt._canvas,0,0,lt.width/I,lt.height/I)}else{if(F._applyLineJoin(this),!gt){var U=this.getAbsoluteTransform(k).getMatrix();F.transform(U[0],U[1],U[2],U[3],U[4],U[5]),F._applyOpacity(this),F._applyGlobalCompositeOperation(this)}V&&F._applyShadow(this),D.call(this,F,this)}return F.restore(),this}drawHit(P,k,E=!1){if(!this.shouldDrawHit(k,E))return this;var M=this.getLayer(),F=P||M.hitCanvas,N=F&&F.getContext(),D=this.hitFunc()||this.sceneFunc(),V=this._getCanvasCache(),Z=V&&V.hit;if(this.colorKey||e.Util.warn("Looks like your canvas has a destroyed shape in it. Do not reuse shape after you destroyed it. If you want to reuse shape you should call remove() instead of destroy()"),Z){N.save();var lt=this.getAbsoluteTransform(k).getMatrix();return N.transform(lt[0],lt[1],lt[2],lt[3],lt[4],lt[5]),this._drawCachedHitCanvas(N),N.restore(),this}if(!D)return this;if(N.save(),N._applyLineJoin(this),!(this===k)){var q=this.getAbsoluteTransform(k).getMatrix();N.transform(q[0],q[1],q[2],q[3],q[4],q[5])}return D.call(this,N,this),N.restore(),this}drawHitFromCache(P=0){var k=this._getCanvasCache(),E=this._getCachedSceneCanvas(),M=k.hit,F=M.getContext(),N=M.getWidth(),D=M.getHeight(),V,Z,lt,K,q,gt;F.clear(),F.drawImage(E._canvas,0,0,N,D);try{for(V=F.getImageData(0,0,N,D),Z=V.data,lt=Z.length,K=e.Util._hexToRgb(this.colorKey),q=0;q<lt;q+=4)gt=Z[q+3],gt>P?(Z[q]=K.r,Z[q+1]=K.g,Z[q+2]=K.b,Z[q+3]=255):Z[q+3]=0;F.putImageData(V,0,0)}catch(St){e.Util.error("Unable to draw hit graph from cached scene canvas. "+St.message)}return this}hasPointerCapture(P){return l.hasPointerCapture(P,this)}setPointerCapture(P){l.setPointerCapture(P,this)}releaseCapture(P){l.releaseCapture(P,this)}}r.Shape=C,C.prototype._fillFunc=v,C.prototype._strokeFunc=b,C.prototype._fillFuncHit=_,C.prototype._strokeFuncHit=w,C.prototype._centroid=!1,C.prototype.nodeType="Shape",(0,a._registerNode)(C),C.prototype.eventListeners={},C.prototype.on.call(C.prototype,"shadowColorChange.konva shadowBlurChange.konva shadowOffsetChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",u),C.prototype.on.call(C.prototype,"shadowColorChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",m),C.prototype.on.call(C.prototype,"fillPriorityChange.konva fillPatternImageChange.konva fillPatternRepeatChange.konva fillPatternScaleXChange.konva fillPatternScaleYChange.konva fillPatternOffsetXChange.konva fillPatternOffsetYChange.konva fillPatternXChange.konva fillPatternYChange.konva fillPatternRotationChange.konva",y),C.prototype.on.call(C.prototype,"fillPriorityChange.konva fillLinearGradientColorStopsChange.konva fillLinearGradientStartPointXChange.konva fillLinearGradientStartPointYChange.konva fillLinearGradientEndPointXChange.konva fillLinearGradientEndPointYChange.konva",S),C.prototype.on.call(C.prototype,"fillPriorityChange.konva fillRadialGradientColorStopsChange.konva fillRadialGradientStartPointXChange.konva fillRadialGradientStartPointYChange.konva fillRadialGradientEndPointXChange.konva fillRadialGradientEndPointYChange.konva fillRadialGradientStartRadiusChange.konva fillRadialGradientEndRadiusChange.konva",T),i.Factory.addGetterSetter(C,"stroke",void 0,(0,s.getStringOrGradientValidator)()),i.Factory.addGetterSetter(C,"strokeWidth",2,(0,s.getNumberValidator)()),i.Factory.addGetterSetter(C,"fillAfterStrokeEnabled",!1),i.Factory.addGetterSetter(C,"hitStrokeWidth","auto",(0,s.getNumberOrAutoValidator)()),i.Factory.addGetterSetter(C,"strokeHitEnabled",!0,(0,s.getBooleanValidator)()),i.Factory.addGetterSetter(C,"perfectDrawEnabled",!0,(0,s.getBooleanValidator)()),i.Factory.addGetterSetter(C,"shadowForStrokeEnabled",!0,(0,s.getBooleanValidator)()),i.Factory.addGetterSetter(C,"lineJoin"),i.Factory.addGetterSetter(C,"lineCap"),i.Factory.addGetterSetter(C,"sceneFunc"),i.Factory.addGetterSetter(C,"hitFunc"),i.Factory.addGetterSetter(C,"dash"),i.Factory.addGetterSetter(C,"dashOffset",0,(0,s.getNumberValidator)()),i.Factory.addGetterSetter(C,"shadowColor",void 0,(0,s.getStringValidator)()),i.Factory.addGetterSetter(C,"shadowBlur",0,(0,s.getNumberValidator)()),i.Factory.addGetterSetter(C,"shadowOpacity",1,(0,s.getNumberValidator)()),i.Factory.addComponentsGetterSetter(C,"shadowOffset",["x","y"]),i.Factory.addGetterSetter(C,"shadowOffsetX",0,(0,s.getNumberValidator)()),i.Factory.addGetterSetter(C,"shadowOffsetY",0,(0,s.getNumberValidator)()),i.Factory.addGetterSetter(C,"fillPatternImage"),i.Factory.addGetterSetter(C,"fill",void 0,(0,s.getStringOrGradientValidator)()),i.Factory.addGetterSetter(C,"fillPatternX",0,(0,s.getNumberValidator)()),i.Factory.addGetterSetter(C,"fillPatternY",0,(0,s.getNumberValidator)()),i.Factory.addGetterSetter(C,"fillLinearGradientColorStops"),i.Factory.addGetterSetter(C,"strokeLinearGradientColorStops"),i.Factory.addGetterSetter(C,"fillRadialGradientStartRadius",0),i.Factory.addGetterSetter(C,"fillRadialGradientEndRadius",0),i.Factory.addGetterSetter(C,"fillRadialGradientColorStops"),i.Factory.addGetterSetter(C,"fillPatternRepeat","repeat"),i.Factory.addGetterSetter(C,"fillEnabled",!0),i.Factory.addGetterSetter(C,"strokeEnabled",!0),i.Factory.addGetterSetter(C,"shadowEnabled",!0),i.Factory.addGetterSetter(C,"dashEnabled",!0),i.Factory.addGetterSetter(C,"strokeScaleEnabled",!0),i.Factory.addGetterSetter(C,"fillPriority","color"),i.Factory.addComponentsGetterSetter(C,"fillPatternOffset",["x","y"]),i.Factory.addGetterSetter(C,"fillPatternOffsetX",0,(0,s.getNumberValidator)()),i.Factory.addGetterSetter(C,"fillPatternOffsetY",0,(0,s.getNumberValidator)()),i.Factory.addComponentsGetterSetter(C,"fillPatternScale",["x","y"]),i.Factory.addGetterSetter(C,"fillPatternScaleX",1,(0,s.getNumberValidator)()),i.Factory.addGetterSetter(C,"fillPatternScaleY",1,(0,s.getNumberValidator)()),i.Factory.addComponentsGetterSetter(C,"fillLinearGradientStartPoint",["x","y"]),i.Factory.addComponentsGetterSetter(C,"strokeLinearGradientStartPoint",["x","y"]),i.Factory.addGetterSetter(C,"fillLinearGradientStartPointX",0),i.Factory.addGetterSetter(C,"strokeLinearGradientStartPointX",0),i.Factory.addGetterSetter(C,"fillLinearGradientStartPointY",0),i.Factory.addGetterSetter(C,"strokeLinearGradientStartPointY",0),i.Factory.addComponentsGetterSetter(C,"fillLinearGradientEndPoint",["x","y"]),i.Factory.addComponentsGetterSetter(C,"strokeLinearGradientEndPoint",["x","y"]),i.Factory.addGetterSetter(C,"fillLinearGradientEndPointX",0),i.Factory.addGetterSetter(C,"strokeLinearGradientEndPointX",0),i.Factory.addGetterSetter(C,"fillLinearGradientEndPointY",0),i.Factory.addGetterSetter(C,"strokeLinearGradientEndPointY",0),i.Factory.addComponentsGetterSetter(C,"fillRadialGradientStartPoint",["x","y"]),i.Factory.addGetterSetter(C,"fillRadialGradientStartPointX",0),i.Factory.addGetterSetter(C,"fillRadialGradientStartPointY",0),i.Factory.addComponentsGetterSetter(C,"fillRadialGradientEndPoint",["x","y"]),i.Factory.addGetterSetter(C,"fillRadialGradientEndPointX",0),i.Factory.addGetterSetter(C,"fillRadialGradientEndPointY",0),i.Factory.addGetterSetter(C,"fillPatternRotation",0),i.Factory.addGetterSetter(C,"fillRule",void 0,(0,s.getStringValidator)()),i.Factory.backCompat(C,{dashArray:"dash",getDashArray:"getDash",setDashArray:"getDash",drawFunc:"sceneFunc",getDrawFunc:"getSceneFunc",setDrawFunc:"setSceneFunc",drawHitFunc:"hitFunc",getDrawHitFunc:"getHitFunc",setDrawHitFunc:"setHitFunc"})})(Xt);Object.defineProperty(er,"__esModule",{value:!0});er.Layer=void 0;const De=Ot,aa=Bi,Ji=Ft,_o=ot,hl=Ce,Yd=X,Kd=Xt,qd=ct;var Jd="#",Qd="beforeDraw",Zd="draw",uh=[{x:0,y:0},{x:-1,y:-1},{x:1,y:-1},{x:1,y:1},{x:-1,y:1}],$d=uh.length;let Sn=class extends aa.Container{constructor(t){super(t),this.canvas=new hl.SceneCanvas,this.hitCanvas=new hl.HitCanvas({pixelRatio:1}),this._waitingForDraw=!1,this.on("visibleChange.konva",this._checkVisibility),this._checkVisibility(),this.on("imageSmoothingEnabledChange.konva",this._setSmoothEnabled),this._setSmoothEnabled()}createPNGStream(){return this.canvas._canvas.createPNGStream()}getCanvas(){return this.canvas}getNativeCanvasElement(){return this.canvas._canvas}getHitCanvas(){return this.hitCanvas}getContext(){return this.getCanvas().getContext()}clear(t){return this.getContext().clear(t),this.getHitCanvas().getContext().clear(t),this}setZIndex(t){super.setZIndex(t);var e=this.getStage();return e&&e.content&&(e.content.removeChild(this.getNativeCanvasElement()),t<e.children.length-1?e.content.insertBefore(this.getNativeCanvasElement(),e.children[t+1].getCanvas()._canvas):e.content.appendChild(this.getNativeCanvasElement())),this}moveToTop(){Ji.Node.prototype.moveToTop.call(this);var t=this.getStage();return t&&t.content&&(t.content.removeChild(this.getNativeCanvasElement()),t.content.appendChild(this.getNativeCanvasElement())),!0}moveUp(){var t=Ji.Node.prototype.moveUp.call(this);if(!t)return!1;var e=this.getStage();return!e||!e.content?!1:(e.content.removeChild(this.getNativeCanvasElement()),this.index<e.children.length-1?e.content.insertBefore(this.getNativeCanvasElement(),e.children[this.index+1].getCanvas()._canvas):e.content.appendChild(this.getNativeCanvasElement()),!0)}moveDown(){if(Ji.Node.prototype.moveDown.call(this)){var t=this.getStage();if(t){var e=t.children;t.content&&(t.content.removeChild(this.getNativeCanvasElement()),t.content.insertBefore(this.getNativeCanvasElement(),e[this.index+1].getCanvas()._canvas))}return!0}return!1}moveToBottom(){if(Ji.Node.prototype.moveToBottom.call(this)){var t=this.getStage();if(t){var e=t.children;t.content&&(t.content.removeChild(this.getNativeCanvasElement()),t.content.insertBefore(this.getNativeCanvasElement(),e[1].getCanvas()._canvas))}return!0}return!1}getLayer(){return this}remove(){var t=this.getNativeCanvasElement();return Ji.Node.prototype.remove.call(this),t&&t.parentNode&&De.Util._isInDocument(t)&&t.parentNode.removeChild(t),this}getStage(){return this.parent}setSize({width:t,height:e}){return this.canvas.setSize(t,e),this.hitCanvas.setSize(t,e),this._setSmoothEnabled(),this}_validateAdd(t){var e=t.getType();e!=="Group"&&e!=="Shape"&&De.Util.throw("You may only add groups and shapes to a layer.")}_toKonvaCanvas(t){return t=t||{},t.width=t.width||this.getWidth(),t.height=t.height||this.getHeight(),t.x=t.x!==void 0?t.x:this.x(),t.y=t.y!==void 0?t.y:this.y(),Ji.Node.prototype._toKonvaCanvas.call(this,t)}_checkVisibility(){this.visible()?this.canvas._canvas.style.display="block":this.canvas._canvas.style.display="none"}_setSmoothEnabled(){this.getContext()._context.imageSmoothingEnabled=this.imageSmoothingEnabled()}getWidth(){if(this.parent)return this.parent.width()}setWidth(){De.Util.warn('Can not change width of layer. Use "stage.width(value)" function instead.')}getHeight(){if(this.parent)return this.parent.height()}setHeight(){De.Util.warn('Can not change height of layer. Use "stage.height(value)" function instead.')}batchDraw(){return this._waitingForDraw||(this._waitingForDraw=!0,De.Util.requestAnimFrame(()=>{this.draw(),this._waitingForDraw=!1})),this}getIntersection(t){if(!this.isListening()||!this.isVisible())return null;for(var e=1,i=!1;;){for(let n=0;n<$d;n++){const s=uh[n],a=this._getIntersection({x:t.x+s.x*e,y:t.y+s.y*e}),l=a.shape;if(l)return l;if(i=!!a.antialiased,!a.antialiased)break}if(i)e+=1;else return null}}_getIntersection(t){const e=this.hitCanvas.pixelRatio,i=this.hitCanvas.context.getImageData(Math.round(t.x*e),Math.round(t.y*e),1,1).data,n=i[3];if(n===255){const s=De.Util._rgbToHex(i[0],i[1],i[2]),a=Kd.shapes[Jd+s];return a?{shape:a}:{antialiased:!0}}else if(n>0)return{antialiased:!0};return{}}drawScene(t,e){var i=this.getLayer(),n=t||i&&i.getCanvas();return this._fire(Qd,{node:this}),this.clearBeforeDraw()&&n.getContext().clear(),aa.Container.prototype.drawScene.call(this,n,e),this._fire(Zd,{node:this}),this}drawHit(t,e){var i=this.getLayer(),n=t||i&&i.hitCanvas;return i&&i.clearBeforeDraw()&&i.getHitCanvas().getContext().clear(),aa.Container.prototype.drawHit.call(this,n,e),this}enableHitGraph(){return this.hitGraphEnabled(!0),this}disableHitGraph(){return this.hitGraphEnabled(!1),this}setHitGraphEnabled(t){De.Util.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening(t)}getHitGraphEnabled(t){return De.Util.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening()}toggleHitCanvas(){if(!(!this.parent||!this.parent.content)){var t=this.parent,e=!!this.hitCanvas._canvas.parentNode;e?t.content.removeChild(this.hitCanvas._canvas):t.content.appendChild(this.hitCanvas._canvas)}}destroy(){return De.Util.releaseCanvas(this.getNativeCanvasElement(),this.getHitCanvas()._canvas),super.destroy()}};er.Layer=Sn;Sn.prototype.nodeType="Layer";(0,qd._registerNode)(Sn);_o.Factory.addGetterSetter(Sn,"imageSmoothingEnabled",!0);_o.Factory.addGetterSetter(Sn,"clearBeforeDraw",!0);_o.Factory.addGetterSetter(Sn,"hitGraphEnabled",!0,(0,Yd.getBooleanValidator)());var ds={};Object.defineProperty(ds,"__esModule",{value:!0});ds.FastLayer=void 0;const t0=Ot,e0=er,i0=ct;class vo extends e0.Layer{constructor(t){super(t),this.listening(!1),t0.Util.warn('Konva.Fast layer is deprecated. Please use "new Konva.Layer({ listening: false })" instead.')}}ds.FastLayer=vo;vo.prototype.nodeType="FastLayer";(0,i0._registerNode)(vo);var Cn={};Object.defineProperty(Cn,"__esModule",{value:!0});Cn.Group=void 0;const n0=Ot,r0=Bi,s0=ct;class yo extends r0.Container{_validateAdd(t){var e=t.getType();e!=="Group"&&e!=="Shape"&&n0.Util.throw("You may only add groups and shapes to groups.")}}Cn.Group=yo;yo.prototype.nodeType="Group";(0,s0._registerNode)(yo);var An={};Object.defineProperty(An,"__esModule",{value:!0});An.Animation=void 0;const oa=ct,fl=Ot,la=function(){return oa.glob.performance&&oa.glob.performance.now?function(){return oa.glob.performance.now()}:function(){return new Date().getTime()}}();class xe{constructor(t,e){this.id=xe.animIdCounter++,this.frame={time:0,timeDiff:0,lastTime:la(),frameRate:0},this.func=t,this.setLayers(e)}setLayers(t){let e=[];return t&&(e=Array.isArray(t)?t:[t]),this.layers=e,this}getLayers(){return this.layers}addLayer(t){const e=this.layers,i=e.length;for(let n=0;n<i;n++)if(e[n]._id===t._id)return!1;return this.layers.push(t),!0}isRunning(){const e=xe.animations,i=e.length;for(let n=0;n<i;n++)if(e[n].id===this.id)return!0;return!1}start(){return this.stop(),this.frame.timeDiff=0,this.frame.lastTime=la(),xe._addAnimation(this),this}stop(){return xe._removeAnimation(this),this}_updateFrameObject(t){this.frame.timeDiff=t-this.frame.lastTime,this.frame.lastTime=t,this.frame.time+=this.frame.timeDiff,this.frame.frameRate=1e3/this.frame.timeDiff}static _addAnimation(t){this.animations.push(t),this._handleAnimation()}static _removeAnimation(t){const e=t.id,i=this.animations,n=i.length;for(let s=0;s<n;s++)if(i[s].id===e){this.animations.splice(s,1);break}}static _runFrames(){const t={},e=this.animations;for(let i=0;i<e.length;i++){const n=e[i],s=n.layers,a=n.func;n._updateFrameObject(la());const l=s.length;let o;if(a?o=a.call(n,n.frame)!==!1:o=!0,!!o)for(let c=0;c<l;c++){const h=s[c];h._id!==void 0&&(t[h._id]=h)}}for(let i in t)t.hasOwnProperty(i)&&t[i].batchDraw()}static _animationLoop(){const t=xe;t.animations.length?(t._runFrames(),fl.Util.requestAnimFrame(t._animationLoop)):t.animRunning=!1}static _handleAnimation(){this.animRunning||(this.animRunning=!0,fl.Util.requestAnimFrame(this._animationLoop))}}An.Animation=xe;xe.animations=[];xe.animIdCounter=0;xe.animRunning=!1;var dh={};(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.Easings=r.Tween=void 0;const t=Ot,e=An,i=Ft,n=ct;var s={node:1,duration:1,easing:1,onFinish:1,yoyo:1},a=1,l=2,o=3,c=0,h=["fill","stroke","shadowColor"];class f{constructor(p,v,b,_,w,u,m){this.prop=p,this.propFunc=v,this.begin=_,this._pos=_,this.duration=u,this._change=0,this.prevPos=0,this.yoyo=m,this._time=0,this._position=0,this._startTime=0,this._finish=0,this.func=b,this._change=w-this.begin,this.pause()}fire(p){var v=this[p];v&&v()}setTime(p){p>this.duration?this.yoyo?(this._time=this.duration,this.reverse()):this.finish():p<0?this.yoyo?(this._time=0,this.play()):this.reset():(this._time=p,this.update())}getTime(){return this._time}setPosition(p){this.prevPos=this._pos,this.propFunc(p),this._pos=p}getPosition(p){return p===void 0&&(p=this._time),this.func(p,this.begin,this._change,this.duration)}play(){this.state=l,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onPlay")}reverse(){this.state=o,this._time=this.duration-this._time,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onReverse")}seek(p){this.pause(),this._time=p,this.update(),this.fire("onSeek")}reset(){this.pause(),this._time=0,this.update(),this.fire("onReset")}finish(){this.pause(),this._time=this.duration,this.update(),this.fire("onFinish")}update(){this.setPosition(this.getPosition(this._time)),this.fire("onUpdate")}onEnterFrame(){var p=this.getTimer()-this._startTime;this.state===l?this.setTime(p):this.state===o&&this.setTime(this.duration-p)}pause(){this.state=a,this.fire("onPause")}getTimer(){return new Date().getTime()}}class g{constructor(p){var v=this,b=p.node,_=b._id,w,u=p.easing||r.Easings.Linear,m=!!p.yoyo,y;typeof p.duration>"u"?w=.3:p.duration===0?w=.001:w=p.duration,this.node=b,this._id=c++;var S=b.getLayer()||(b instanceof n.Konva.Stage?b.getLayers():null);S||t.Util.error("Tween constructor have `node` that is not in a layer. Please add node into layer first."),this.anim=new e.Animation(function(){v.tween.onEnterFrame()},S),this.tween=new f(y,function(T){v._tweenFunc(T)},u,0,1,w*1e3,m),this._addListeners(),g.attrs[_]||(g.attrs[_]={}),g.attrs[_][this._id]||(g.attrs[_][this._id]={}),g.tweens[_]||(g.tweens[_]={});for(y in p)s[y]===void 0&&this._addAttr(y,p[y]);this.reset(),this.onFinish=p.onFinish,this.onReset=p.onReset,this.onUpdate=p.onUpdate}_addAttr(p,v){var b=this.node,_=b._id,w,u,m,y,S,T,C,A;if(m=g.tweens[_][p],m&&delete g.attrs[_][m][p],w=b.getAttr(p),t.Util._isArray(v))if(u=[],S=Math.max(v.length,w.length),p==="points"&&v.length!==w.length&&(v.length>w.length?(C=w,w=t.Util._prepareArrayForTween(w,v,b.closed())):(T=v,v=t.Util._prepareArrayForTween(v,w,b.closed()))),p.indexOf("fill")===0)for(y=0;y<S;y++)if(y%2===0)u.push(v[y]-w[y]);else{var P=t.Util.colorToRGBA(w[y]);A=t.Util.colorToRGBA(v[y]),w[y]=P,u.push({r:A.r-P.r,g:A.g-P.g,b:A.b-P.b,a:A.a-P.a})}else for(y=0;y<S;y++)u.push(v[y]-w[y]);else h.indexOf(p)!==-1?(w=t.Util.colorToRGBA(w),A=t.Util.colorToRGBA(v),u={r:A.r-w.r,g:A.g-w.g,b:A.b-w.b,a:A.a-w.a}):u=v-w;g.attrs[_][this._id][p]={start:w,diff:u,end:v,trueEnd:T,trueStart:C},g.tweens[_][p]=this._id}_tweenFunc(p){var v=this.node,b=g.attrs[v._id][this._id],_,w,u,m,y,S,T,C;for(_ in b){if(w=b[_],u=w.start,m=w.diff,C=w.end,t.Util._isArray(u))if(y=[],T=Math.max(u.length,C.length),_.indexOf("fill")===0)for(S=0;S<T;S++)S%2===0?y.push((u[S]||0)+m[S]*p):y.push("rgba("+Math.round(u[S].r+m[S].r*p)+","+Math.round(u[S].g+m[S].g*p)+","+Math.round(u[S].b+m[S].b*p)+","+(u[S].a+m[S].a*p)+")");else for(S=0;S<T;S++)y.push((u[S]||0)+m[S]*p);else h.indexOf(_)!==-1?y="rgba("+Math.round(u.r+m.r*p)+","+Math.round(u.g+m.g*p)+","+Math.round(u.b+m.b*p)+","+(u.a+m.a*p)+")":y=u+m*p;v.setAttr(_,y)}}_addListeners(){this.tween.onPlay=()=>{this.anim.start()},this.tween.onReverse=()=>{this.anim.start()},this.tween.onPause=()=>{this.anim.stop()},this.tween.onFinish=()=>{var p=this.node,v=g.attrs[p._id][this._id];v.points&&v.points.trueEnd&&p.setAttr("points",v.points.trueEnd),this.onFinish&&this.onFinish.call(this)},this.tween.onReset=()=>{var p=this.node,v=g.attrs[p._id][this._id];v.points&&v.points.trueStart&&p.points(v.points.trueStart),this.onReset&&this.onReset()},this.tween.onUpdate=()=>{this.onUpdate&&this.onUpdate.call(this)}}play(){return this.tween.play(),this}reverse(){return this.tween.reverse(),this}reset(){return this.tween.reset(),this}seek(p){return this.tween.seek(p*1e3),this}pause(){return this.tween.pause(),this}finish(){return this.tween.finish(),this}destroy(){var p=this.node._id,v=this._id,b=g.tweens[p],_;this.pause();for(_ in b)delete g.tweens[p][_];delete g.attrs[p][v]}}r.Tween=g,g.attrs={},g.tweens={},i.Node.prototype.to=function(d){var p=d.onFinish;d.node=this,d.onFinish=function(){this.destroy(),p&&p()};var v=new g(d);v.play()},r.Easings={BackEaseIn(d,p,v,b){var _=1.70158;return v*(d/=b)*d*((_+1)*d-_)+p},BackEaseOut(d,p,v,b){var _=1.70158;return v*((d=d/b-1)*d*((_+1)*d+_)+1)+p},BackEaseInOut(d,p,v,b){var _=1.70158;return(d/=b/2)<1?v/2*(d*d*(((_*=1.525)+1)*d-_))+p:v/2*((d-=2)*d*(((_*=1.525)+1)*d+_)+2)+p},ElasticEaseIn(d,p,v,b,_,w){var u=0;return d===0?p:(d/=b)===1?p+v:(w||(w=b*.3),!_||_<Math.abs(v)?(_=v,u=w/4):u=w/(2*Math.PI)*Math.asin(v/_),-(_*Math.pow(2,10*(d-=1))*Math.sin((d*b-u)*(2*Math.PI)/w))+p)},ElasticEaseOut(d,p,v,b,_,w){var u=0;return d===0?p:(d/=b)===1?p+v:(w||(w=b*.3),!_||_<Math.abs(v)?(_=v,u=w/4):u=w/(2*Math.PI)*Math.asin(v/_),_*Math.pow(2,-10*d)*Math.sin((d*b-u)*(2*Math.PI)/w)+v+p)},ElasticEaseInOut(d,p,v,b,_,w){var u=0;return d===0?p:(d/=b/2)===2?p+v:(w||(w=b*(.3*1.5)),!_||_<Math.abs(v)?(_=v,u=w/4):u=w/(2*Math.PI)*Math.asin(v/_),d<1?-.5*(_*Math.pow(2,10*(d-=1))*Math.sin((d*b-u)*(2*Math.PI)/w))+p:_*Math.pow(2,-10*(d-=1))*Math.sin((d*b-u)*(2*Math.PI)/w)*.5+v+p)},BounceEaseOut(d,p,v,b){return(d/=b)<1/2.75?v*(7.5625*d*d)+p:d<2/2.75?v*(7.5625*(d-=1.5/2.75)*d+.75)+p:d<2.5/2.75?v*(7.5625*(d-=2.25/2.75)*d+.9375)+p:v*(7.5625*(d-=2.625/2.75)*d+.984375)+p},BounceEaseIn(d,p,v,b){return v-r.Easings.BounceEaseOut(b-d,0,v,b)+p},BounceEaseInOut(d,p,v,b){return d<b/2?r.Easings.BounceEaseIn(d*2,0,v,b)*.5+p:r.Easings.BounceEaseOut(d*2-b,0,v,b)*.5+v*.5+p},EaseIn(d,p,v,b){return v*(d/=b)*d+p},EaseOut(d,p,v,b){return-v*(d/=b)*(d-2)+p},EaseInOut(d,p,v,b){return(d/=b/2)<1?v/2*d*d+p:-v/2*(--d*(d-2)-1)+p},StrongEaseIn(d,p,v,b){return v*(d/=b)*d*d*d*d+p},StrongEaseOut(d,p,v,b){return v*((d=d/b-1)*d*d*d*d+1)+p},StrongEaseInOut(d,p,v,b){return(d/=b/2)<1?v/2*d*d*d*d*d+p:v/2*((d-=2)*d*d*d*d+2)+p},Linear(d,p,v,b){return v*d/b+p}}})(dh);(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.Konva=void 0;const t=ct,e=Ot,i=Ft,n=Bi,s=ch,a=er,l=ds,o=Cn,c=fs,h=Xt,f=An,g=dh,d=He,p=Ce;r.Konva=e.Util._assign(t.Konva,{Util:e.Util,Transform:e.Transform,Node:i.Node,Container:n.Container,Stage:s.Stage,stages:s.stages,Layer:a.Layer,FastLayer:l.FastLayer,Group:o.Group,DD:c.DD,Shape:h.Shape,shapes:h.shapes,Animation:f.Animation,Tween:g.Tween,Easings:g.Easings,Context:d.Context,Canvas:p.Canvas}),r.default=r.Konva})(sh);var gs={};Object.defineProperty(gs,"__esModule",{value:!0});gs.Arc=void 0;const ps=ot,a0=Xt,ul=ct,ms=X,o0=ct;class $e extends a0.Shape{_sceneFunc(t){var e=ul.Konva.getAngle(this.angle()),i=this.clockwise();t.beginPath(),t.arc(0,0,this.outerRadius(),0,e,i),t.arc(0,0,this.innerRadius(),e,0,!i),t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(t){this.outerRadius(t/2)}setHeight(t){this.outerRadius(t/2)}getSelfRect(){const t=this.innerRadius(),e=this.outerRadius(),i=this.clockwise(),n=ul.Konva.getAngle(i?360-this.angle():this.angle()),s=Math.cos(Math.min(n,Math.PI)),a=1,l=Math.sin(Math.min(Math.max(Math.PI,n),3*Math.PI/2)),o=Math.sin(Math.min(n,Math.PI/2)),c=s*(s>0?t:e),h=a*e,f=l*(l>0?t:e),g=o*(o>0?e:t);return{x:c,y:i?-1*g:f,width:h-c,height:g-f}}}gs.Arc=$e;$e.prototype._centroid=!0;$e.prototype.className="Arc";$e.prototype._attrsAffectingSize=["innerRadius","outerRadius"];(0,o0._registerNode)($e);ps.Factory.addGetterSetter($e,"innerRadius",0,(0,ms.getNumberValidator)());ps.Factory.addGetterSetter($e,"outerRadius",0,(0,ms.getNumberValidator)());ps.Factory.addGetterSetter($e,"angle",0,(0,ms.getNumberValidator)());ps.Factory.addGetterSetter($e,"clockwise",!1,(0,ms.getBooleanValidator)());var _s={},ir={};Object.defineProperty(ir,"__esModule",{value:!0});ir.Line=void 0;const vs=ot,l0=Xt,gh=X,c0=ct;function Wa(r,t,e,i,n,s,a){var l=Math.sqrt(Math.pow(e-r,2)+Math.pow(i-t,2)),o=Math.sqrt(Math.pow(n-e,2)+Math.pow(s-i,2)),c=a*l/(l+o),h=a*o/(l+o),f=e-c*(n-r),g=i-c*(s-t),d=e+h*(n-r),p=i+h*(s-t);return[f,g,d,p]}function dl(r,t){var e=r.length,i=[],n,s;for(n=2;n<e-2;n+=2)s=Wa(r[n-2],r[n-1],r[n],r[n+1],r[n+2],r[n+3],t),!isNaN(s[0])&&(i.push(s[0]),i.push(s[1]),i.push(r[n]),i.push(r[n+1]),i.push(s[2]),i.push(s[3]));return i}class _i extends l0.Shape{constructor(t){super(t),this.on("pointsChange.konva tensionChange.konva closedChange.konva bezierChange.konva",function(){this._clearCache("tensionPoints")})}_sceneFunc(t){var e=this.points(),i=e.length,n=this.tension(),s=this.closed(),a=this.bezier(),l,o,c;if(i){if(t.beginPath(),t.moveTo(e[0],e[1]),n!==0&&i>4){for(l=this.getTensionPoints(),o=l.length,c=s?0:4,s||t.quadraticCurveTo(l[0],l[1],l[2],l[3]);c<o-2;)t.bezierCurveTo(l[c++],l[c++],l[c++],l[c++],l[c++],l[c++]);s||t.quadraticCurveTo(l[o-2],l[o-1],e[i-2],e[i-1])}else if(a)for(c=2;c<i;)t.bezierCurveTo(e[c++],e[c++],e[c++],e[c++],e[c++],e[c++]);else for(c=2;c<i;c+=2)t.lineTo(e[c],e[c+1]);s?(t.closePath(),t.fillStrokeShape(this)):t.strokeShape(this)}}getTensionPoints(){return this._getCache("tensionPoints",this._getTensionPoints)}_getTensionPoints(){return this.closed()?this._getTensionPointsClosed():dl(this.points(),this.tension())}_getTensionPointsClosed(){var t=this.points(),e=t.length,i=this.tension(),n=Wa(t[e-2],t[e-1],t[0],t[1],t[2],t[3],i),s=Wa(t[e-4],t[e-3],t[e-2],t[e-1],t[0],t[1],i),a=dl(t,i),l=[n[2],n[3]].concat(a).concat([s[0],s[1],t[e-2],t[e-1],s[2],s[3],n[0],n[1],t[0],t[1]]);return l}getWidth(){return this.getSelfRect().width}getHeight(){return this.getSelfRect().height}getSelfRect(){var t=this.points();if(t.length<4)return{x:t[0]||0,y:t[1]||0,width:0,height:0};this.tension()!==0?t=[t[0],t[1],...this._getTensionPoints(),t[t.length-2],t[t.length-1]]:t=this.points();for(var e=t[0],i=t[0],n=t[1],s=t[1],a,l,o=0;o<t.length/2;o++)a=t[o*2],l=t[o*2+1],e=Math.min(e,a),i=Math.max(i,a),n=Math.min(n,l),s=Math.max(s,l);return{x:e,y:n,width:i-e,height:s-n}}}ir.Line=_i;_i.prototype.className="Line";_i.prototype._attrsAffectingSize=["points","bezier","tension"];(0,c0._registerNode)(_i);vs.Factory.addGetterSetter(_i,"closed",!1);vs.Factory.addGetterSetter(_i,"bezier",!1);vs.Factory.addGetterSetter(_i,"tension",0,(0,gh.getNumberValidator)());vs.Factory.addGetterSetter(_i,"points",[],(0,gh.getNumberArrayValidator)());var Tn={},ph={};(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.t2length=r.getQuadraticArcLength=r.getCubicArcLength=r.binomialCoefficients=r.cValues=r.tValues=void 0,r.tValues=[[],[],[-.5773502691896257,.5773502691896257],[0,-.7745966692414834,.7745966692414834],[-.33998104358485626,.33998104358485626,-.8611363115940526,.8611363115940526],[0,-.5384693101056831,.5384693101056831,-.906179845938664,.906179845938664],[.6612093864662645,-.6612093864662645,-.2386191860831969,.2386191860831969,-.932469514203152,.932469514203152],[0,.4058451513773972,-.4058451513773972,-.7415311855993945,.7415311855993945,-.9491079123427585,.9491079123427585],[-.1834346424956498,.1834346424956498,-.525532409916329,.525532409916329,-.7966664774136267,.7966664774136267,-.9602898564975363,.9602898564975363],[0,-.8360311073266358,.8360311073266358,-.9681602395076261,.9681602395076261,-.3242534234038089,.3242534234038089,-.6133714327005904,.6133714327005904],[-.14887433898163122,.14887433898163122,-.4333953941292472,.4333953941292472,-.6794095682990244,.6794095682990244,-.8650633666889845,.8650633666889845,-.9739065285171717,.9739065285171717],[0,-.26954315595234496,.26954315595234496,-.5190961292068118,.5190961292068118,-.7301520055740494,.7301520055740494,-.8870625997680953,.8870625997680953,-.978228658146057,.978228658146057],[-.1252334085114689,.1252334085114689,-.3678314989981802,.3678314989981802,-.5873179542866175,.5873179542866175,-.7699026741943047,.7699026741943047,-.9041172563704749,.9041172563704749,-.9815606342467192,.9815606342467192],[0,-.2304583159551348,.2304583159551348,-.44849275103644687,.44849275103644687,-.6423493394403402,.6423493394403402,-.8015780907333099,.8015780907333099,-.9175983992229779,.9175983992229779,-.9841830547185881,.9841830547185881],[-.10805494870734367,.10805494870734367,-.31911236892788974,.31911236892788974,-.5152486363581541,.5152486363581541,-.6872929048116855,.6872929048116855,-.827201315069765,.827201315069765,-.9284348836635735,.9284348836635735,-.9862838086968123,.9862838086968123],[0,-.20119409399743451,.20119409399743451,-.3941513470775634,.3941513470775634,-.5709721726085388,.5709721726085388,-.7244177313601701,.7244177313601701,-.8482065834104272,.8482065834104272,-.937273392400706,.937273392400706,-.9879925180204854,.9879925180204854],[-.09501250983763744,.09501250983763744,-.2816035507792589,.2816035507792589,-.45801677765722737,.45801677765722737,-.6178762444026438,.6178762444026438,-.755404408355003,.755404408355003,-.8656312023878318,.8656312023878318,-.9445750230732326,.9445750230732326,-.9894009349916499,.9894009349916499],[0,-.17848418149584785,.17848418149584785,-.3512317634538763,.3512317634538763,-.5126905370864769,.5126905370864769,-.6576711592166907,.6576711592166907,-.7815140038968014,.7815140038968014,-.8802391537269859,.8802391537269859,-.9506755217687678,.9506755217687678,-.9905754753144174,.9905754753144174],[-.0847750130417353,.0847750130417353,-.2518862256915055,.2518862256915055,-.41175116146284263,.41175116146284263,-.5597708310739475,.5597708310739475,-.6916870430603532,.6916870430603532,-.8037049589725231,.8037049589725231,-.8926024664975557,.8926024664975557,-.9558239495713977,.9558239495713977,-.9915651684209309,.9915651684209309],[0,-.16035864564022537,.16035864564022537,-.31656409996362983,.31656409996362983,-.46457074137596094,.46457074137596094,-.600545304661681,.600545304661681,-.7209661773352294,.7209661773352294,-.8227146565371428,.8227146565371428,-.9031559036148179,.9031559036148179,-.96020815213483,.96020815213483,-.9924068438435844,.9924068438435844],[-.07652652113349734,.07652652113349734,-.22778585114164507,.22778585114164507,-.37370608871541955,.37370608871541955,-.5108670019508271,.5108670019508271,-.636053680726515,.636053680726515,-.7463319064601508,.7463319064601508,-.8391169718222188,.8391169718222188,-.912234428251326,.912234428251326,-.9639719272779138,.9639719272779138,-.9931285991850949,.9931285991850949],[0,-.1455618541608951,.1455618541608951,-.2880213168024011,.2880213168024011,-.4243421202074388,.4243421202074388,-.5516188358872198,.5516188358872198,-.6671388041974123,.6671388041974123,-.7684399634756779,.7684399634756779,-.8533633645833173,.8533633645833173,-.9200993341504008,.9200993341504008,-.9672268385663063,.9672268385663063,-.9937521706203895,.9937521706203895],[-.06973927331972223,.06973927331972223,-.20786042668822127,.20786042668822127,-.34193582089208424,.34193582089208424,-.469355837986757,.469355837986757,-.5876404035069116,.5876404035069116,-.6944872631866827,.6944872631866827,-.7878168059792081,.7878168059792081,-.8658125777203002,.8658125777203002,-.926956772187174,.926956772187174,-.9700604978354287,.9700604978354287,-.9942945854823992,.9942945854823992],[0,-.1332568242984661,.1332568242984661,-.26413568097034495,.26413568097034495,-.3903010380302908,.3903010380302908,-.5095014778460075,.5095014778460075,-.6196098757636461,.6196098757636461,-.7186613631319502,.7186613631319502,-.8048884016188399,.8048884016188399,-.8767523582704416,.8767523582704416,-.9329710868260161,.9329710868260161,-.9725424712181152,.9725424712181152,-.9947693349975522,.9947693349975522],[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213]],r.cValues=[[],[],[1,1],[.8888888888888888,.5555555555555556,.5555555555555556],[.6521451548625461,.6521451548625461,.34785484513745385,.34785484513745385],[.5688888888888889,.47862867049936647,.47862867049936647,.23692688505618908,.23692688505618908],[.3607615730481386,.3607615730481386,.46791393457269104,.46791393457269104,.17132449237917036,.17132449237917036],[.4179591836734694,.3818300505051189,.3818300505051189,.27970539148927664,.27970539148927664,.1294849661688697,.1294849661688697],[.362683783378362,.362683783378362,.31370664587788727,.31370664587788727,.22238103445337448,.22238103445337448,.10122853629037626,.10122853629037626],[.3302393550012598,.1806481606948574,.1806481606948574,.08127438836157441,.08127438836157441,.31234707704000286,.31234707704000286,.26061069640293544,.26061069640293544],[.29552422471475287,.29552422471475287,.26926671930999635,.26926671930999635,.21908636251598204,.21908636251598204,.1494513491505806,.1494513491505806,.06667134430868814,.06667134430868814],[.2729250867779006,.26280454451024665,.26280454451024665,.23319376459199048,.23319376459199048,.18629021092773426,.18629021092773426,.1255803694649046,.1255803694649046,.05566856711617366,.05566856711617366],[.24914704581340277,.24914704581340277,.2334925365383548,.2334925365383548,.20316742672306592,.20316742672306592,.16007832854334622,.16007832854334622,.10693932599531843,.10693932599531843,.04717533638651183,.04717533638651183],[.2325515532308739,.22628318026289723,.22628318026289723,.2078160475368885,.2078160475368885,.17814598076194574,.17814598076194574,.13887351021978725,.13887351021978725,.09212149983772845,.09212149983772845,.04048400476531588,.04048400476531588],[.2152638534631578,.2152638534631578,.2051984637212956,.2051984637212956,.18553839747793782,.18553839747793782,.15720316715819355,.15720316715819355,.12151857068790319,.12151857068790319,.08015808715976021,.08015808715976021,.03511946033175186,.03511946033175186],[.2025782419255613,.19843148532711158,.19843148532711158,.1861610000155622,.1861610000155622,.16626920581699392,.16626920581699392,.13957067792615432,.13957067792615432,.10715922046717194,.10715922046717194,.07036604748810812,.07036604748810812,.03075324199611727,.03075324199611727],[.1894506104550685,.1894506104550685,.18260341504492358,.18260341504492358,.16915651939500254,.16915651939500254,.14959598881657674,.14959598881657674,.12462897125553388,.12462897125553388,.09515851168249279,.09515851168249279,.062253523938647894,.062253523938647894,.027152459411754096,.027152459411754096],[.17944647035620653,.17656270536699264,.17656270536699264,.16800410215645004,.16800410215645004,.15404576107681028,.15404576107681028,.13513636846852548,.13513636846852548,.11188384719340397,.11188384719340397,.08503614831717918,.08503614831717918,.0554595293739872,.0554595293739872,.02414830286854793,.02414830286854793],[.1691423829631436,.1691423829631436,.16427648374583273,.16427648374583273,.15468467512626524,.15468467512626524,.14064291467065065,.14064291467065065,.12255520671147846,.12255520671147846,.10094204410628717,.10094204410628717,.07642573025488905,.07642573025488905,.0497145488949698,.0497145488949698,.02161601352648331,.02161601352648331],[.1610544498487837,.15896884339395434,.15896884339395434,.15276604206585967,.15276604206585967,.1426067021736066,.1426067021736066,.12875396253933621,.12875396253933621,.11156664554733399,.11156664554733399,.09149002162245,.09149002162245,.06904454273764123,.06904454273764123,.0448142267656996,.0448142267656996,.019461788229726478,.019461788229726478],[.15275338713072584,.15275338713072584,.14917298647260374,.14917298647260374,.14209610931838204,.14209610931838204,.13168863844917664,.13168863844917664,.11819453196151841,.11819453196151841,.10193011981724044,.10193011981724044,.08327674157670475,.08327674157670475,.06267204833410907,.06267204833410907,.04060142980038694,.04060142980038694,.017614007139152118,.017614007139152118],[.14608113364969041,.14452440398997005,.14452440398997005,.13988739479107315,.13988739479107315,.13226893863333747,.13226893863333747,.12183141605372853,.12183141605372853,.10879729916714838,.10879729916714838,.09344442345603386,.09344442345603386,.0761001136283793,.0761001136283793,.057134425426857205,.057134425426857205,.036953789770852494,.036953789770852494,.016017228257774335,.016017228257774335],[.13925187285563198,.13925187285563198,.13654149834601517,.13654149834601517,.13117350478706238,.13117350478706238,.12325237681051242,.12325237681051242,.11293229608053922,.11293229608053922,.10041414444288096,.10041414444288096,.08594160621706773,.08594160621706773,.06979646842452049,.06979646842452049,.052293335152683286,.052293335152683286,.03377490158481415,.03377490158481415,.0146279952982722,.0146279952982722],[.13365457218610619,.1324620394046966,.1324620394046966,.12890572218808216,.12890572218808216,.12304908430672953,.12304908430672953,.11499664022241136,.11499664022241136,.10489209146454141,.10489209146454141,.09291576606003515,.09291576606003515,.07928141177671895,.07928141177671895,.06423242140852585,.06423242140852585,.04803767173108467,.04803767173108467,.030988005856979445,.030988005856979445,.013411859487141771,.013411859487141771],[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872]],r.binomialCoefficients=[[1],[1,1],[1,2,1],[1,3,3,1]];const t=(a,l,o)=>{let c,h,f;c=o/2,h=0;for(let d=0;d<20;d++)f=c*r.tValues[20][d]+c,h+=r.cValues[20][d]*i(a,l,f);return c*h};r.getCubicArcLength=t;const e=(a,l,o)=>{o===void 0&&(o=1);const c=a[0]-2*a[1]+a[2],h=l[0]-2*l[1]+l[2],f=2*a[1]-2*a[0],g=2*l[1]-2*l[0],d=4*(c*c+h*h),p=4*(c*f+h*g),v=f*f+g*g;if(d===0)return o*Math.sqrt(Math.pow(a[2]-a[0],2)+Math.pow(l[2]-l[0],2));const b=p/(2*d),_=v/d,w=o+b,u=_-b*b,m=w*w+u>0?Math.sqrt(w*w+u):0,y=b*b+u>0?Math.sqrt(b*b+u):0,S=b+Math.sqrt(b*b+u)!==0?u*Math.log(Math.abs((w+m)/(b+y))):0;return Math.sqrt(d)/2*(w*m-b*y+S)};r.getQuadraticArcLength=e;function i(a,l,o){const c=n(1,o,a),h=n(1,o,l),f=c*c+h*h;return Math.sqrt(f)}const n=(a,l,o)=>{const c=o.length-1;let h,f;if(c===0)return 0;if(a===0){f=0;for(let g=0;g<=c;g++)f+=r.binomialCoefficients[c][g]*Math.pow(1-l,c-g)*Math.pow(l,g)*o[g];return f}else{h=new Array(c);for(let g=0;g<c;g++)h[g]=c*(o[g+1]-o[g]);return n(a-1,l,h)}},s=(a,l,o)=>{let c=1,h=a/l,f=(a-o(h))/l,g=0;for(;c>.001;){const d=o(h+f),p=Math.abs(a-d)/l;if(p<c)c=p,h+=f;else{const v=o(h-f),b=Math.abs(a-v)/l;b<c?(c=b,h-=f):f/=2}if(g++,g>500)break}return h};r.t2length=s})(ph);Object.defineProperty(Tn,"__esModule",{value:!0});Tn.Path=void 0;const h0=ot,f0=Xt,u0=ct,Qi=ph;class jt extends f0.Shape{constructor(t){super(t),this.dataArray=[],this.pathLength=0,this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute()})}_readDataAttribute(){this.dataArray=jt.parsePathData(this.data()),this.pathLength=jt.getPathLength(this.dataArray)}_sceneFunc(t){var e=this.dataArray;t.beginPath();for(var i=!1,n=0;n<e.length;n++){var s=e[n].command,a=e[n].points;switch(s){case"L":t.lineTo(a[0],a[1]);break;case"M":t.moveTo(a[0],a[1]);break;case"C":t.bezierCurveTo(a[0],a[1],a[2],a[3],a[4],a[5]);break;case"Q":t.quadraticCurveTo(a[0],a[1],a[2],a[3]);break;case"A":var l=a[0],o=a[1],c=a[2],h=a[3],f=a[4],g=a[5],d=a[6],p=a[7],v=c>h?c:h,b=c>h?1:c/h,_=c>h?h/c:1;t.translate(l,o),t.rotate(d),t.scale(b,_),t.arc(0,0,v,f,f+g,1-p),t.scale(1/b,1/_),t.rotate(-d),t.translate(-l,-o);break;case"z":i=!0,t.closePath();break}}!i&&!this.hasFill()?t.strokeShape(this):t.fillStrokeShape(this)}getSelfRect(){var t=[];this.dataArray.forEach(function(c){if(c.command==="A"){var h=c.points[4],f=c.points[5],g=c.points[4]+f,d=Math.PI/180;if(Math.abs(h-g)<d&&(d=Math.abs(h-g)),f<0)for(let p=h-d;p>g;p-=d){const v=jt.getPointOnEllipticalArc(c.points[0],c.points[1],c.points[2],c.points[3],p,0);t.push(v.x,v.y)}else for(let p=h+d;p<g;p+=d){const v=jt.getPointOnEllipticalArc(c.points[0],c.points[1],c.points[2],c.points[3],p,0);t.push(v.x,v.y)}}else if(c.command==="C")for(let p=0;p<=1;p+=.01){const v=jt.getPointOnCubicBezier(p,c.start.x,c.start.y,c.points[0],c.points[1],c.points[2],c.points[3],c.points[4],c.points[5]);t.push(v.x,v.y)}else t=t.concat(c.points)});for(var e=t[0],i=t[0],n=t[1],s=t[1],a,l,o=0;o<t.length/2;o++)a=t[o*2],l=t[o*2+1],isNaN(a)||(e=Math.min(e,a),i=Math.max(i,a)),isNaN(l)||(n=Math.min(n,l),s=Math.max(s,l));return{x:e,y:n,width:i-e,height:s-n}}getLength(){return this.pathLength}getPointAtLength(t){return jt.getPointAtLengthOfDataArray(t,this.dataArray)}static getLineLength(t,e,i,n){return Math.sqrt((i-t)*(i-t)+(n-e)*(n-e))}static getPathLength(t){let e=0;for(var i=0;i<t.length;++i)e+=t[i].pathLength;return e}static getPointAtLengthOfDataArray(t,e){var i,n=0,s=e.length;if(!s)return null;for(;n<s&&t>e[n].pathLength;)t-=e[n].pathLength,++n;if(n===s)return i=e[n-1].points.slice(-2),{x:i[0],y:i[1]};if(t<.01)return i=e[n].points.slice(0,2),{x:i[0],y:i[1]};var a=e[n],l=a.points;switch(a.command){case"L":return jt.getPointOnLine(t,a.start.x,a.start.y,l[0],l[1]);case"C":return jt.getPointOnCubicBezier((0,Qi.t2length)(t,jt.getPathLength(e),v=>(0,Qi.getCubicArcLength)([a.start.x,l[0],l[2],l[4]],[a.start.y,l[1],l[3],l[5]],v)),a.start.x,a.start.y,l[0],l[1],l[2],l[3],l[4],l[5]);case"Q":return jt.getPointOnQuadraticBezier((0,Qi.t2length)(t,jt.getPathLength(e),v=>(0,Qi.getQuadraticArcLength)([a.start.x,l[0],l[2]],[a.start.y,l[1],l[3]],v)),a.start.x,a.start.y,l[0],l[1],l[2],l[3]);case"A":var o=l[0],c=l[1],h=l[2],f=l[3],g=l[4],d=l[5],p=l[6];return g+=d*t/a.pathLength,jt.getPointOnEllipticalArc(o,c,h,f,g,p)}return null}static getPointOnLine(t,e,i,n,s,a,l){a===void 0&&(a=e),l===void 0&&(l=i);var o=(s-i)/(n-e+1e-8),c=Math.sqrt(t*t/(1+o*o));n<e&&(c*=-1);var h=o*c,f;if(n===e)f={x:a,y:l+h};else if((l-i)/(a-e+1e-8)===o)f={x:a+c,y:l+h};else{var g,d,p=this.getLineLength(e,i,n,s),v=(a-e)*(n-e)+(l-i)*(s-i);v=v/(p*p),g=e+v*(n-e),d=i+v*(s-i);var b=this.getLineLength(a,l,g,d),_=Math.sqrt(t*t-b*b);c=Math.sqrt(_*_/(1+o*o)),n<e&&(c*=-1),h=o*c,f={x:g+c,y:d+h}}return f}static getPointOnCubicBezier(t,e,i,n,s,a,l,o,c){function h(b){return b*b*b}function f(b){return 3*b*b*(1-b)}function g(b){return 3*b*(1-b)*(1-b)}function d(b){return(1-b)*(1-b)*(1-b)}var p=o*h(t)+a*f(t)+n*g(t)+e*d(t),v=c*h(t)+l*f(t)+s*g(t)+i*d(t);return{x:p,y:v}}static getPointOnQuadraticBezier(t,e,i,n,s,a,l){function o(d){return d*d}function c(d){return 2*d*(1-d)}function h(d){return(1-d)*(1-d)}var f=a*o(t)+n*c(t)+e*h(t),g=l*o(t)+s*c(t)+i*h(t);return{x:f,y:g}}static getPointOnEllipticalArc(t,e,i,n,s,a){var l=Math.cos(a),o=Math.sin(a),c={x:i*Math.cos(s),y:n*Math.sin(s)};return{x:t+(c.x*l-c.y*o),y:e+(c.x*o+c.y*l)}}static parsePathData(t){if(!t)return[];var e=t,i=["m","M","l","L","v","V","h","H","z","Z","c","C","q","Q","t","T","s","S","a","A"];e=e.replace(new RegExp(" ","g"),",");for(var n=0;n<i.length;n++)e=e.replace(new RegExp(i[n],"g"),"|"+i[n]);var s=e.split("|"),a=[],l=[],o=0,c=0,h=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:e[-+]?\d+)?)/gi,f;for(n=1;n<s.length;n++){var g=s[n],d=g.charAt(0);for(g=g.slice(1),l.length=0;f=h.exec(g);)l.push(f[0]);for(var p=[],v=0,b=l.length;v<b;v++){if(l[v]==="00"){p.push(0,0);continue}var _=parseFloat(l[v]);isNaN(_)?p.push(0):p.push(_)}for(;p.length>0&&!isNaN(p[0]);){var w="",u=[],m=o,y=c,S,T,C,A,P,k,E,M,F,N;switch(d){case"l":o+=p.shift(),c+=p.shift(),w="L",u.push(o,c);break;case"L":o=p.shift(),c=p.shift(),u.push(o,c);break;case"m":var D=p.shift(),V=p.shift();if(o+=D,c+=V,w="M",a.length>2&&a[a.length-1].command==="z"){for(var Z=a.length-2;Z>=0;Z--)if(a[Z].command==="M"){o=a[Z].points[0]+D,c=a[Z].points[1]+V;break}}u.push(o,c),d="l";break;case"M":o=p.shift(),c=p.shift(),w="M",u.push(o,c),d="L";break;case"h":o+=p.shift(),w="L",u.push(o,c);break;case"H":o=p.shift(),w="L",u.push(o,c);break;case"v":c+=p.shift(),w="L",u.push(o,c);break;case"V":c=p.shift(),w="L",u.push(o,c);break;case"C":u.push(p.shift(),p.shift(),p.shift(),p.shift()),o=p.shift(),c=p.shift(),u.push(o,c);break;case"c":u.push(o+p.shift(),c+p.shift(),o+p.shift(),c+p.shift()),o+=p.shift(),c+=p.shift(),w="C",u.push(o,c);break;case"S":T=o,C=c,S=a[a.length-1],S.command==="C"&&(T=o+(o-S.points[2]),C=c+(c-S.points[3])),u.push(T,C,p.shift(),p.shift()),o=p.shift(),c=p.shift(),w="C",u.push(o,c);break;case"s":T=o,C=c,S=a[a.length-1],S.command==="C"&&(T=o+(o-S.points[2]),C=c+(c-S.points[3])),u.push(T,C,o+p.shift(),c+p.shift()),o+=p.shift(),c+=p.shift(),w="C",u.push(o,c);break;case"Q":u.push(p.shift(),p.shift()),o=p.shift(),c=p.shift(),u.push(o,c);break;case"q":u.push(o+p.shift(),c+p.shift()),o+=p.shift(),c+=p.shift(),w="Q",u.push(o,c);break;case"T":T=o,C=c,S=a[a.length-1],S.command==="Q"&&(T=o+(o-S.points[0]),C=c+(c-S.points[1])),o=p.shift(),c=p.shift(),w="Q",u.push(T,C,o,c);break;case"t":T=o,C=c,S=a[a.length-1],S.command==="Q"&&(T=o+(o-S.points[0]),C=c+(c-S.points[1])),o+=p.shift(),c+=p.shift(),w="Q",u.push(T,C,o,c);break;case"A":A=p.shift(),P=p.shift(),k=p.shift(),E=p.shift(),M=p.shift(),F=o,N=c,o=p.shift(),c=p.shift(),w="A",u=this.convertEndpointToCenterParameterization(F,N,o,c,E,M,A,P,k);break;case"a":A=p.shift(),P=p.shift(),k=p.shift(),E=p.shift(),M=p.shift(),F=o,N=c,o+=p.shift(),c+=p.shift(),w="A",u=this.convertEndpointToCenterParameterization(F,N,o,c,E,M,A,P,k);break}a.push({command:w||d,points:u,start:{x:m,y},pathLength:this.calcLength(m,y,w||d,u)})}(d==="z"||d==="Z")&&a.push({command:"z",points:[],start:void 0,pathLength:0})}return a}static calcLength(t,e,i,n){var s,a,l,o,c=jt;switch(i){case"L":return c.getLineLength(t,e,n[0],n[1]);case"C":return(0,Qi.getCubicArcLength)([t,n[0],n[2],n[4]],[e,n[1],n[3],n[5]],1);case"Q":return(0,Qi.getQuadraticArcLength)([t,n[0],n[2]],[e,n[1],n[3]],1);case"A":s=0;var h=n[4],f=n[5],g=n[4]+f,d=Math.PI/180;if(Math.abs(h-g)<d&&(d=Math.abs(h-g)),a=c.getPointOnEllipticalArc(n[0],n[1],n[2],n[3],h,0),f<0)for(o=h-d;o>g;o-=d)l=c.getPointOnEllipticalArc(n[0],n[1],n[2],n[3],o,0),s+=c.getLineLength(a.x,a.y,l.x,l.y),a=l;else for(o=h+d;o<g;o+=d)l=c.getPointOnEllipticalArc(n[0],n[1],n[2],n[3],o,0),s+=c.getLineLength(a.x,a.y,l.x,l.y),a=l;return l=c.getPointOnEllipticalArc(n[0],n[1],n[2],n[3],g,0),s+=c.getLineLength(a.x,a.y,l.x,l.y),s}return 0}static convertEndpointToCenterParameterization(t,e,i,n,s,a,l,o,c){var h=c*(Math.PI/180),f=Math.cos(h)*(t-i)/2+Math.sin(h)*(e-n)/2,g=-1*Math.sin(h)*(t-i)/2+Math.cos(h)*(e-n)/2,d=f*f/(l*l)+g*g/(o*o);d>1&&(l*=Math.sqrt(d),o*=Math.sqrt(d));var p=Math.sqrt((l*l*(o*o)-l*l*(g*g)-o*o*(f*f))/(l*l*(g*g)+o*o*(f*f)));s===a&&(p*=-1),isNaN(p)&&(p=0);var v=p*l*g/o,b=p*-o*f/l,_=(t+i)/2+Math.cos(h)*v-Math.sin(h)*b,w=(e+n)/2+Math.sin(h)*v+Math.cos(h)*b,u=function(P){return Math.sqrt(P[0]*P[0]+P[1]*P[1])},m=function(P,k){return(P[0]*k[0]+P[1]*k[1])/(u(P)*u(k))},y=function(P,k){return(P[0]*k[1]<P[1]*k[0]?-1:1)*Math.acos(m(P,k))},S=y([1,0],[(f-v)/l,(g-b)/o]),T=[(f-v)/l,(g-b)/o],C=[(-1*f-v)/l,(-1*g-b)/o],A=y(T,C);return m(T,C)<=-1&&(A=Math.PI),m(T,C)>=1&&(A=0),a===0&&A>0&&(A=A-2*Math.PI),a===1&&A<0&&(A=A+2*Math.PI),[_,w,l,o,S,A,h,a]}}Tn.Path=jt;jt.prototype.className="Path";jt.prototype._attrsAffectingSize=["data"];(0,u0._registerNode)(jt);h0.Factory.addGetterSetter(jt,"data");Object.defineProperty(_s,"__esModule",{value:!0});_s.Arrow=void 0;const ys=ot,d0=ir,mh=X,g0=ct,gl=Tn;class Vi extends d0.Line{_sceneFunc(t){super._sceneFunc(t);var e=Math.PI*2,i=this.points(),n=i,s=this.tension()!==0&&i.length>4;s&&(n=this.getTensionPoints());var a=this.pointerLength(),l=i.length,o,c;if(s){const g=[n[n.length-4],n[n.length-3],n[n.length-2],n[n.length-1],i[l-2],i[l-1]],d=gl.Path.calcLength(n[n.length-4],n[n.length-3],"C",g),p=gl.Path.getPointOnQuadraticBezier(Math.min(1,1-a/d),g[0],g[1],g[2],g[3],g[4],g[5]);o=i[l-2]-p.x,c=i[l-1]-p.y}else o=i[l-2]-i[l-4],c=i[l-1]-i[l-3];var h=(Math.atan2(c,o)+e)%e,f=this.pointerWidth();this.pointerAtEnding()&&(t.save(),t.beginPath(),t.translate(i[l-2],i[l-1]),t.rotate(h),t.moveTo(0,0),t.lineTo(-a,f/2),t.lineTo(-a,-f/2),t.closePath(),t.restore(),this.__fillStroke(t)),this.pointerAtBeginning()&&(t.save(),t.beginPath(),t.translate(i[0],i[1]),s?(o=(n[0]+n[2])/2-i[0],c=(n[1]+n[3])/2-i[1]):(o=i[2]-i[0],c=i[3]-i[1]),t.rotate((Math.atan2(-c,-o)+e)%e),t.moveTo(0,0),t.lineTo(-a,f/2),t.lineTo(-a,-f/2),t.closePath(),t.restore(),this.__fillStroke(t))}__fillStroke(t){var e=this.dashEnabled();e&&(this.attrs.dashEnabled=!1,t.setLineDash([])),t.fillStrokeShape(this),e&&(this.attrs.dashEnabled=!0)}getSelfRect(){const t=super.getSelfRect(),e=this.pointerWidth()/2;return{x:t.x-e,y:t.y-e,width:t.width+e*2,height:t.height+e*2}}}_s.Arrow=Vi;Vi.prototype.className="Arrow";(0,g0._registerNode)(Vi);ys.Factory.addGetterSetter(Vi,"pointerLength",10,(0,mh.getNumberValidator)());ys.Factory.addGetterSetter(Vi,"pointerWidth",10,(0,mh.getNumberValidator)());ys.Factory.addGetterSetter(Vi,"pointerAtBeginning",!1);ys.Factory.addGetterSetter(Vi,"pointerAtEnding",!0);var bs={};Object.defineProperty(bs,"__esModule",{value:!0});bs.Circle=void 0;const p0=ot,m0=Xt,_0=X,v0=ct;let Pn=class extends m0.Shape{_sceneFunc(t){t.beginPath(),t.arc(0,0,this.attrs.radius||0,0,Math.PI*2,!1),t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(t){this.radius()!==t/2&&this.radius(t/2)}setHeight(t){this.radius()!==t/2&&this.radius(t/2)}};bs.Circle=Pn;Pn.prototype._centroid=!0;Pn.prototype.className="Circle";Pn.prototype._attrsAffectingSize=["radius"];(0,v0._registerNode)(Pn);p0.Factory.addGetterSetter(Pn,"radius",0,(0,_0.getNumberValidator)());var ws={};Object.defineProperty(ws,"__esModule",{value:!0});ws.Ellipse=void 0;const bo=ot,y0=Xt,_h=X,b0=ct;class vi extends y0.Shape{_sceneFunc(t){var e=this.radiusX(),i=this.radiusY();t.beginPath(),t.save(),e!==i&&t.scale(1,i/e),t.arc(0,0,e,0,Math.PI*2,!1),t.restore(),t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.radiusX()*2}getHeight(){return this.radiusY()*2}setWidth(t){this.radiusX(t/2)}setHeight(t){this.radiusY(t/2)}}ws.Ellipse=vi;vi.prototype.className="Ellipse";vi.prototype._centroid=!0;vi.prototype._attrsAffectingSize=["radiusX","radiusY"];(0,b0._registerNode)(vi);bo.Factory.addComponentsGetterSetter(vi,"radius",["x","y"]);bo.Factory.addGetterSetter(vi,"radiusX",0,(0,_h.getNumberValidator)());bo.Factory.addGetterSetter(vi,"radiusY",0,(0,_h.getNumberValidator)());var Ss={};Object.defineProperty(Ss,"__esModule",{value:!0});Ss.Image=void 0;const ca=Ot,zi=ot,w0=Xt,S0=ct,nr=X;let Re=class vh extends w0.Shape{constructor(t){super(t),this.on("imageChange.konva",()=>{this._setImageLoad()}),this._setImageLoad()}_setImageLoad(){const t=this.image();t&&t.complete||t&&t.readyState===4||t&&t.addEventListener&&t.addEventListener("load",()=>{this._requestDraw()})}_useBufferCanvas(){return super._useBufferCanvas(!0)}_sceneFunc(t){const e=this.getWidth(),i=this.getHeight(),n=this.cornerRadius(),s=this.attrs.image;let a;if(s){const l=this.attrs.cropWidth,o=this.attrs.cropHeight;l&&o?a=[s,this.cropX(),this.cropY(),l,o,0,0,e,i]:a=[s,0,0,e,i]}(this.hasFill()||this.hasStroke()||n)&&(t.beginPath(),n?ca.Util.drawRoundedRectPath(t,e,i,n):t.rect(0,0,e,i),t.closePath(),t.fillStrokeShape(this)),s&&(n&&t.clip(),t.drawImage.apply(t,a))}_hitFunc(t){var e=this.width(),i=this.height(),n=this.cornerRadius();t.beginPath(),n?ca.Util.drawRoundedRectPath(t,e,i,n):t.rect(0,0,e,i),t.closePath(),t.fillStrokeShape(this)}getWidth(){var t,e;return(t=this.attrs.width)!==null&&t!==void 0?t:(e=this.image())===null||e===void 0?void 0:e.width}getHeight(){var t,e;return(t=this.attrs.height)!==null&&t!==void 0?t:(e=this.image())===null||e===void 0?void 0:e.height}static fromURL(t,e,i=null){var n=ca.Util.createImageElement();n.onload=function(){var s=new vh({image:n});e(s)},n.onerror=i,n.crossOrigin="Anonymous",n.src=t}};Ss.Image=Re;Re.prototype.className="Image";(0,S0._registerNode)(Re);zi.Factory.addGetterSetter(Re,"cornerRadius",0,(0,nr.getNumberOrArrayOfNumbersValidator)(4));zi.Factory.addGetterSetter(Re,"image");zi.Factory.addComponentsGetterSetter(Re,"crop",["x","y","width","height"]);zi.Factory.addGetterSetter(Re,"cropX",0,(0,nr.getNumberValidator)());zi.Factory.addGetterSetter(Re,"cropY",0,(0,nr.getNumberValidator)());zi.Factory.addGetterSetter(Re,"cropWidth",0,(0,nr.getNumberValidator)());zi.Factory.addGetterSetter(Re,"cropHeight",0,(0,nr.getNumberValidator)());var pn={};Object.defineProperty(pn,"__esModule",{value:!0});pn.Tag=pn.Label=void 0;const Cs=ot,C0=Xt,A0=Cn,wo=X,yh=ct;var bh=["fontFamily","fontSize","fontStyle","padding","lineHeight","text","width","height","pointerDirection","pointerWidth","pointerHeight"],T0="Change.konva",P0="none",ja="up",Xa="right",Ya="down",Ka="left",k0=bh.length;class So extends A0.Group{constructor(t){super(t),this.on("add.konva",function(e){this._addListeners(e.child),this._sync()})}getText(){return this.find("Text")[0]}getTag(){return this.find("Tag")[0]}_addListeners(t){var e=this,i,n=function(){e._sync()};for(i=0;i<k0;i++)t.on(bh[i]+T0,n)}getWidth(){return this.getText().width()}getHeight(){return this.getText().height()}_sync(){var t=this.getText(),e=this.getTag(),i,n,s,a,l,o,c;if(t&&e){switch(i=t.width(),n=t.height(),s=e.pointerDirection(),a=e.pointerWidth(),c=e.pointerHeight(),l=0,o=0,s){case ja:l=i/2,o=-1*c;break;case Xa:l=i+a,o=n/2;break;case Ya:l=i/2,o=n+c;break;case Ka:l=-1*a,o=n/2;break}e.setAttrs({x:-1*l,y:-1*o,width:i,height:n}),t.setAttrs({x:-1*l,y:-1*o})}}}pn.Label=So;So.prototype.className="Label";(0,yh._registerNode)(So);class Hi extends C0.Shape{_sceneFunc(t){var e=this.width(),i=this.height(),n=this.pointerDirection(),s=this.pointerWidth(),a=this.pointerHeight(),l=this.cornerRadius();let o=0,c=0,h=0,f=0;typeof l=="number"?o=c=h=f=Math.min(l,e/2,i/2):(o=Math.min(l[0]||0,e/2,i/2),c=Math.min(l[1]||0,e/2,i/2),f=Math.min(l[2]||0,e/2,i/2),h=Math.min(l[3]||0,e/2,i/2)),t.beginPath(),t.moveTo(o,0),n===ja&&(t.lineTo((e-s)/2,0),t.lineTo(e/2,-1*a),t.lineTo((e+s)/2,0)),t.lineTo(e-c,0),t.arc(e-c,c,c,Math.PI*3/2,0,!1),n===Xa&&(t.lineTo(e,(i-a)/2),t.lineTo(e+s,i/2),t.lineTo(e,(i+a)/2)),t.lineTo(e,i-f),t.arc(e-f,i-f,f,0,Math.PI/2,!1),n===Ya&&(t.lineTo((e+s)/2,i),t.lineTo(e/2,i+a),t.lineTo((e-s)/2,i)),t.lineTo(h,i),t.arc(h,i-h,h,Math.PI/2,Math.PI,!1),n===Ka&&(t.lineTo(0,(i+a)/2),t.lineTo(-1*s,i/2),t.lineTo(0,(i-a)/2)),t.lineTo(0,o),t.arc(o,o,o,Math.PI,Math.PI*3/2,!1),t.closePath(),t.fillStrokeShape(this)}getSelfRect(){var t=0,e=0,i=this.pointerWidth(),n=this.pointerHeight(),s=this.pointerDirection(),a=this.width(),l=this.height();return s===ja?(e-=n,l+=n):s===Ya?l+=n:s===Ka?(t-=i*1.5,a+=i):s===Xa&&(a+=i*1.5),{x:t,y:e,width:a,height:l}}}pn.Tag=Hi;Hi.prototype.className="Tag";(0,yh._registerNode)(Hi);Cs.Factory.addGetterSetter(Hi,"pointerDirection",P0);Cs.Factory.addGetterSetter(Hi,"pointerWidth",0,(0,wo.getNumberValidator)());Cs.Factory.addGetterSetter(Hi,"pointerHeight",0,(0,wo.getNumberValidator)());Cs.Factory.addGetterSetter(Hi,"cornerRadius",0,(0,wo.getNumberOrArrayOfNumbersValidator)(4));var rr={};Object.defineProperty(rr,"__esModule",{value:!0});rr.Rect=void 0;const x0=ot,E0=Xt,M0=ct,F0=Ot,R0=X;let As=class extends E0.Shape{_sceneFunc(t){var e=this.cornerRadius(),i=this.width(),n=this.height();t.beginPath(),e?F0.Util.drawRoundedRectPath(t,i,n,e):t.rect(0,0,i,n),t.closePath(),t.fillStrokeShape(this)}};rr.Rect=As;As.prototype.className="Rect";(0,M0._registerNode)(As);x0.Factory.addGetterSetter(As,"cornerRadius",0,(0,R0.getNumberOrArrayOfNumbersValidator)(4));var Ts={};Object.defineProperty(Ts,"__esModule",{value:!0});Ts.RegularPolygon=void 0;const wh=ot,N0=Xt,Sh=X,L0=ct;class Wi extends N0.Shape{_sceneFunc(t){const e=this._getPoints();t.beginPath(),t.moveTo(e[0].x,e[0].y);for(var i=1;i<e.length;i++)t.lineTo(e[i].x,e[i].y);t.closePath(),t.fillStrokeShape(this)}_getPoints(){const t=this.attrs.sides,e=this.attrs.radius||0,i=[];for(var n=0;n<t;n++)i.push({x:e*Math.sin(n*2*Math.PI/t),y:-1*e*Math.cos(n*2*Math.PI/t)});return i}getSelfRect(){const t=this._getPoints();var e=t[0].x,i=t[0].y,n=t[0].x,s=t[0].y;return t.forEach(a=>{e=Math.min(e,a.x),i=Math.max(i,a.x),n=Math.min(n,a.y),s=Math.max(s,a.y)}),{x:e,y:n,width:i-e,height:s-n}}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(t){this.radius(t/2)}setHeight(t){this.radius(t/2)}}Ts.RegularPolygon=Wi;Wi.prototype.className="RegularPolygon";Wi.prototype._centroid=!0;Wi.prototype._attrsAffectingSize=["radius"];(0,L0._registerNode)(Wi);wh.Factory.addGetterSetter(Wi,"radius",0,(0,Sh.getNumberValidator)());wh.Factory.addGetterSetter(Wi,"sides",0,(0,Sh.getNumberValidator)());var Ps={};Object.defineProperty(Ps,"__esModule",{value:!0});Ps.Ring=void 0;const Ch=ot,O0=Xt,Ah=X,D0=ct;var pl=Math.PI*2;class ji extends O0.Shape{_sceneFunc(t){t.beginPath(),t.arc(0,0,this.innerRadius(),0,pl,!1),t.moveTo(this.outerRadius(),0),t.arc(0,0,this.outerRadius(),pl,0,!0),t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(t){this.outerRadius(t/2)}setHeight(t){this.outerRadius(t/2)}}Ps.Ring=ji;ji.prototype.className="Ring";ji.prototype._centroid=!0;ji.prototype._attrsAffectingSize=["innerRadius","outerRadius"];(0,D0._registerNode)(ji);Ch.Factory.addGetterSetter(ji,"innerRadius",0,(0,Ah.getNumberValidator)());Ch.Factory.addGetterSetter(ji,"outerRadius",0,(0,Ah.getNumberValidator)());var ks={};Object.defineProperty(ks,"__esModule",{value:!0});ks.Sprite=void 0;const Xi=ot,I0=Xt,G0=An,Th=X,B0=ct;class Ne extends I0.Shape{constructor(t){super(t),this._updated=!0,this.anim=new G0.Animation(()=>{var e=this._updated;return this._updated=!1,e}),this.on("animationChange.konva",function(){this.frameIndex(0)}),this.on("frameIndexChange.konva",function(){this._updated=!0}),this.on("frameRateChange.konva",function(){this.anim.isRunning()&&(clearInterval(this.interval),this._setInterval())})}_sceneFunc(t){var e=this.animation(),i=this.frameIndex(),n=i*4,s=this.animations()[e],a=this.frameOffsets(),l=s[n+0],o=s[n+1],c=s[n+2],h=s[n+3],f=this.image();if((this.hasFill()||this.hasStroke())&&(t.beginPath(),t.rect(0,0,c,h),t.closePath(),t.fillStrokeShape(this)),f)if(a){var g=a[e],d=i*2;t.drawImage(f,l,o,c,h,g[d+0],g[d+1],c,h)}else t.drawImage(f,l,o,c,h,0,0,c,h)}_hitFunc(t){var e=this.animation(),i=this.frameIndex(),n=i*4,s=this.animations()[e],a=this.frameOffsets(),l=s[n+2],o=s[n+3];if(t.beginPath(),a){var c=a[e],h=i*2;t.rect(c[h+0],c[h+1],l,o)}else t.rect(0,0,l,o);t.closePath(),t.fillShape(this)}_useBufferCanvas(){return super._useBufferCanvas(!0)}_setInterval(){var t=this;this.interval=setInterval(function(){t._updateIndex()},1e3/this.frameRate())}start(){if(!this.isRunning()){var t=this.getLayer();this.anim.setLayers(t),this._setInterval(),this.anim.start()}}stop(){this.anim.stop(),clearInterval(this.interval)}isRunning(){return this.anim.isRunning()}_updateIndex(){var t=this.frameIndex(),e=this.animation(),i=this.animations(),n=i[e],s=n.length/4;t<s-1?this.frameIndex(t+1):this.frameIndex(0)}}ks.Sprite=Ne;Ne.prototype.className="Sprite";(0,B0._registerNode)(Ne);Xi.Factory.addGetterSetter(Ne,"animation");Xi.Factory.addGetterSetter(Ne,"animations");Xi.Factory.addGetterSetter(Ne,"frameOffsets");Xi.Factory.addGetterSetter(Ne,"image");Xi.Factory.addGetterSetter(Ne,"frameIndex",0,(0,Th.getNumberValidator)());Xi.Factory.addGetterSetter(Ne,"frameRate",17,(0,Th.getNumberValidator)());Xi.Factory.backCompat(Ne,{index:"frameIndex",getIndex:"getFrameIndex",setIndex:"setFrameIndex"});var xs={};Object.defineProperty(xs,"__esModule",{value:!0});xs.Star=void 0;const Co=ot,U0=Xt,Ao=X,V0=ct;class yi extends U0.Shape{_sceneFunc(t){var e=this.innerRadius(),i=this.outerRadius(),n=this.numPoints();t.beginPath(),t.moveTo(0,0-i);for(var s=1;s<n*2;s++){var a=s%2===0?i:e,l=a*Math.sin(s*Math.PI/n),o=-1*a*Math.cos(s*Math.PI/n);t.lineTo(l,o)}t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(t){this.outerRadius(t/2)}setHeight(t){this.outerRadius(t/2)}}xs.Star=yi;yi.prototype.className="Star";yi.prototype._centroid=!0;yi.prototype._attrsAffectingSize=["innerRadius","outerRadius"];(0,V0._registerNode)(yi);Co.Factory.addGetterSetter(yi,"numPoints",5,(0,Ao.getNumberValidator)());Co.Factory.addGetterSetter(yi,"innerRadius",0,(0,Ao.getNumberValidator)());Co.Factory.addGetterSetter(yi,"outerRadius",0,(0,Ao.getNumberValidator)());var Oi={};Object.defineProperty(Oi,"__esModule",{value:!0});Oi.Text=Oi.stringToArray=void 0;const qa=Ot,qt=ot,z0=Xt,bi=X,H0=ct;function Ph(r){return Array.from(r)}Oi.stringToArray=Ph;var Zi="auto",W0="center",kh="inherit",En="justify",j0="Change.konva",X0="2d",ml="-",xh="left",Y0="text",K0="Text",q0="top",J0="bottom",_l="middle",Eh="normal",Q0="px ",fr=" ",Z0="right",vl="rtl",$0="word",t1="char",yl="none",ha="",Mh=["direction","fontFamily","fontSize","fontStyle","fontVariant","padding","align","verticalAlign","lineHeight","text","width","height","wrap","ellipsis","letterSpacing"],e1=Mh.length;function i1(r){return r.split(",").map(t=>{t=t.trim();const e=t.indexOf(" ")>=0,i=t.indexOf('"')>=0||t.indexOf("'")>=0;return e&&!i&&(t=`"${t}"`),t}).join(", ")}var ur;function fa(){return ur||(ur=qa.Util.createCanvasElement().getContext(X0),ur)}function n1(r){r.fillText(this._partialText,this._partialTextX,this._partialTextY)}function r1(r){r.setAttr("miterLimit",2),r.strokeText(this._partialText,this._partialTextX,this._partialTextY)}function s1(r){return r=r||{},!r.fillLinearGradientColorStops&&!r.fillRadialGradientColorStops&&!r.fillPatternImage&&(r.fill=r.fill||"black"),r}class Gt extends z0.Shape{constructor(t){super(s1(t)),this._partialTextX=0,this._partialTextY=0;for(var e=0;e<e1;e++)this.on(Mh[e]+j0,this._setTextData);this._setTextData()}_sceneFunc(t){var e=this.textArr,i=e.length;if(this.text()){var n=this.padding(),s=this.fontSize(),a=this.lineHeight()*s,l=this.verticalAlign(),o=this.direction(),c=0,h=this.align(),f=this.getWidth(),g=this.letterSpacing(),d=this.fill(),p=this.textDecoration(),v=p.indexOf("underline")!==-1,b=p.indexOf("line-through")!==-1,_;o=o===kh?t.direction:o;var w=0,w=a/2,u=0,m=0;for(o===vl&&t.setAttr("direction",o),t.setAttr("font",this._getContextFont()),t.setAttr("textBaseline",_l),t.setAttr("textAlign",xh),l===_l?c=(this.getHeight()-i*a-n*2)/2:l===J0&&(c=this.getHeight()-i*a-n*2),t.translate(n,c+n),_=0;_<i;_++){var u=0,m=0,y=e[_],S=y.text,T=y.width,C=y.lastInParagraph,A,P,k;if(t.save(),h===Z0?u+=f-T-n*2:h===W0&&(u+=(f-T-n*2)/2),v){t.save(),t.beginPath(),t.moveTo(u,w+m+Math.round(s/2)),A=S.split(" ").length-1,P=A===0,k=h===En&&!C?f-n*2:T,t.lineTo(u+Math.round(k),w+m+Math.round(s/2)),t.lineWidth=s/15;const V=this._getLinearGradient();t.strokeStyle=V||d,t.stroke(),t.restore()}if(b){t.save(),t.beginPath(),t.moveTo(u,w+m),A=S.split(" ").length-1,P=A===0,k=h===En&&C&&!P?f-n*2:T,t.lineTo(u+Math.round(k),w+m),t.lineWidth=s/15;const V=this._getLinearGradient();t.strokeStyle=V||d,t.stroke(),t.restore()}if(o!==vl&&(g!==0||h===En)){A=S.split(" ").length-1;for(var E=Ph(S),M=0;M<E.length;M++){var F=E[M];F===" "&&!C&&h===En&&(u+=(f-n*2-T)/A),this._partialTextX=u,this._partialTextY=w+m,this._partialText=F,t.fillStrokeShape(this),u+=this.measureSize(F).width+g}}else g!==0&&t.setAttr("letterSpacing",`${g}px`),this._partialTextX=u,this._partialTextY=w+m,this._partialText=S,t.fillStrokeShape(this);t.restore(),i>1&&(w+=a)}}}_hitFunc(t){var e=this.getWidth(),i=this.getHeight();t.beginPath(),t.rect(0,0,e,i),t.closePath(),t.fillStrokeShape(this)}setText(t){var e=qa.Util._isString(t)?t:t==null?"":t+"";return this._setAttr(Y0,e),this}getWidth(){var t=this.attrs.width===Zi||this.attrs.width===void 0;return t?this.getTextWidth()+this.padding()*2:this.attrs.width}getHeight(){var t=this.attrs.height===Zi||this.attrs.height===void 0;return t?this.fontSize()*this.textArr.length*this.lineHeight()+this.padding()*2:this.attrs.height}getTextWidth(){return this.textWidth}getTextHeight(){return qa.Util.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}measureSize(t){var e=fa(),i=this.fontSize(),n;return e.save(),e.font=this._getContextFont(),n=e.measureText(t),e.restore(),{width:n.width,height:i}}_getContextFont(){return this.fontStyle()+fr+this.fontVariant()+fr+(this.fontSize()+Q0)+i1(this.fontFamily())}_addTextLine(t){this.align()===En&&(t=t.trim());var i=this._getTextWidth(t);return this.textArr.push({text:t,width:i,lastInParagraph:!1})}_getTextWidth(t){var e=this.letterSpacing(),i=t.length;return fa().measureText(t).width+(i?e*(i-1):0)}_setTextData(){var t=this.text().split(`
`),e=+this.fontSize(),i=0,n=this.lineHeight()*e,s=this.attrs.width,a=this.attrs.height,l=s!==Zi&&s!==void 0,o=a!==Zi&&a!==void 0,c=this.padding(),h=s-c*2,f=a-c*2,g=0,d=this.wrap(),p=d!==yl,v=d!==t1&&p,b=this.ellipsis();this.textArr=[],fa().font=this._getContextFont();for(var _=b?this._getTextWidth(ha):0,w=0,u=t.length;w<u;++w){var m=t[w],y=this._getTextWidth(m);if(l&&y>h)for(;m.length>0;){for(var S=0,T=m.length,C="",A=0;S<T;){var P=S+T>>>1,k=m.slice(0,P+1),E=this._getTextWidth(k)+_;E<=h?(S=P+1,C=k,A=E):T=P}if(C){if(v){var M,F=m[C.length],N=F===fr||F===ml;N&&A<=h?M=C.length:M=Math.max(C.lastIndexOf(fr),C.lastIndexOf(ml))+1,M>0&&(S=M,C=C.slice(0,S),A=this._getTextWidth(C))}C=C.trimRight(),this._addTextLine(C),i=Math.max(i,A),g+=n;var D=this._shouldHandleEllipsis(g);if(D){this._tryToAddEllipsisToLastLine();break}if(m=m.slice(S),m=m.trimLeft(),m.length>0&&(y=this._getTextWidth(m),y<=h)){this._addTextLine(m),g+=n,i=Math.max(i,y);break}}else break}else this._addTextLine(m),g+=n,i=Math.max(i,y),this._shouldHandleEllipsis(g)&&w<u-1&&this._tryToAddEllipsisToLastLine();if(this.textArr[this.textArr.length-1]&&(this.textArr[this.textArr.length-1].lastInParagraph=!0),o&&g+n>f)break}this.textHeight=e,this.textWidth=i}_shouldHandleEllipsis(t){var e=+this.fontSize(),i=this.lineHeight()*e,n=this.attrs.height,s=n!==Zi&&n!==void 0,a=this.padding(),l=n-a*2,o=this.wrap(),c=o!==yl;return!c||s&&t+i>l}_tryToAddEllipsisToLastLine(){var t=this.attrs.width,e=t!==Zi&&t!==void 0,i=this.padding(),n=t-i*2,s=this.ellipsis(),a=this.textArr[this.textArr.length-1];if(!(!a||!s)){if(e){var l=this._getTextWidth(a.text+ha)<n;l||(a.text=a.text.slice(0,a.text.length-3))}this.textArr.splice(this.textArr.length-1,1),this._addTextLine(a.text+ha)}}getStrokeScaleEnabled(){return!0}_useBufferCanvas(){const t=this.textDecoration().indexOf("underline")!==-1||this.textDecoration().indexOf("line-through")!==-1,e=this.hasShadow();return t&&e?!0:super._useBufferCanvas()}}Oi.Text=Gt;Gt.prototype._fillFunc=n1;Gt.prototype._strokeFunc=r1;Gt.prototype.className=K0;Gt.prototype._attrsAffectingSize=["text","fontSize","padding","wrap","lineHeight","letterSpacing"];(0,H0._registerNode)(Gt);qt.Factory.overWriteSetter(Gt,"width",(0,bi.getNumberOrAutoValidator)());qt.Factory.overWriteSetter(Gt,"height",(0,bi.getNumberOrAutoValidator)());qt.Factory.addGetterSetter(Gt,"direction",kh);qt.Factory.addGetterSetter(Gt,"fontFamily","Arial");qt.Factory.addGetterSetter(Gt,"fontSize",12,(0,bi.getNumberValidator)());qt.Factory.addGetterSetter(Gt,"fontStyle",Eh);qt.Factory.addGetterSetter(Gt,"fontVariant",Eh);qt.Factory.addGetterSetter(Gt,"padding",0,(0,bi.getNumberValidator)());qt.Factory.addGetterSetter(Gt,"align",xh);qt.Factory.addGetterSetter(Gt,"verticalAlign",q0);qt.Factory.addGetterSetter(Gt,"lineHeight",1,(0,bi.getNumberValidator)());qt.Factory.addGetterSetter(Gt,"wrap",$0);qt.Factory.addGetterSetter(Gt,"ellipsis",!1,(0,bi.getBooleanValidator)());qt.Factory.addGetterSetter(Gt,"letterSpacing",0,(0,bi.getNumberValidator)());qt.Factory.addGetterSetter(Gt,"text","",(0,bi.getStringValidator)());qt.Factory.addGetterSetter(Gt,"textDecoration","");var Es={};Object.defineProperty(Es,"__esModule",{value:!0});Es.TextPath=void 0;const ua=Ot,Pe=ot,a1=Xt,Mn=Tn,da=Oi,Fh=X,o1=ct;var l1="",Rh="normal";function Nh(r){r.fillText(this.partialText,0,0)}function Lh(r){r.strokeText(this.partialText,0,0)}class Yt extends a1.Shape{constructor(t){super(t),this.dummyCanvas=ua.Util.createCanvasElement(),this.dataArray=[],this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute(),this._setTextData()}),this.on("textChange.konva alignChange.konva letterSpacingChange.konva kerningFuncChange.konva fontSizeChange.konva fontFamilyChange.konva",this._setTextData),this._setTextData()}_getTextPathLength(){return Mn.Path.getPathLength(this.dataArray)}_getPointAtLength(t){if(!this.attrs.data)return null;const e=this.pathLength;return t-1>e?null:Mn.Path.getPointAtLengthOfDataArray(t,this.dataArray)}_readDataAttribute(){this.dataArray=Mn.Path.parsePathData(this.attrs.data),this.pathLength=this._getTextPathLength()}_sceneFunc(t){t.setAttr("font",this._getContextFont()),t.setAttr("textBaseline",this.textBaseline()),t.setAttr("textAlign","left"),t.save();var e=this.textDecoration(),i=this.fill(),n=this.fontSize(),s=this.glyphInfo;e==="underline"&&t.beginPath();for(var a=0;a<s.length;a++){t.save();var l=s[a].p0;t.translate(l.x,l.y),t.rotate(s[a].rotation),this.partialText=s[a].text,t.fillStrokeShape(this),e==="underline"&&(a===0&&t.moveTo(0,n/2+1),t.lineTo(n,n/2+1)),t.restore()}e==="underline"&&(t.strokeStyle=i,t.lineWidth=n/20,t.stroke()),t.restore()}_hitFunc(t){t.beginPath();var e=this.glyphInfo;if(e.length>=1){var i=e[0].p0;t.moveTo(i.x,i.y)}for(var n=0;n<e.length;n++){var s=e[n].p1;t.lineTo(s.x,s.y)}t.setAttr("lineWidth",this.fontSize()),t.setAttr("strokeStyle",this.colorKey),t.stroke()}getTextWidth(){return this.textWidth}getTextHeight(){return ua.Util.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}setText(t){return da.Text.prototype.setText.call(this,t)}_getContextFont(){return da.Text.prototype._getContextFont.call(this)}_getTextSize(t){var e=this.dummyCanvas,i=e.getContext("2d");i.save(),i.font=this._getContextFont();var n=i.measureText(t);return i.restore(),{width:n.width,height:parseInt(`${this.fontSize()}`,10)}}_setTextData(){const{width:t,height:e}=this._getTextSize(this.attrs.text);if(this.textWidth=t,this.textHeight=e,this.glyphInfo=[],!this.attrs.data)return null;const i=this.letterSpacing(),n=this.align(),s=this.kerningFunc(),a=Math.max(this.textWidth+((this.attrs.text||"").length-1)*i,0);let l=0;n==="center"&&(l=Math.max(0,this.pathLength/2-a/2)),n==="right"&&(l=Math.max(0,this.pathLength-a));const o=(0,da.stringToArray)(this.text());let c=l;for(var h=0;h<o.length;h++){const f=this._getPointAtLength(c);if(!f)return;let g=this._getTextSize(o[h]).width+i;if(o[h]===" "&&n==="justify"){const w=this.text().split(" ").length-1;g+=(this.pathLength-a)/w}const d=this._getPointAtLength(c+g);if(!d)return;const p=Mn.Path.getLineLength(f.x,f.y,d.x,d.y);let v=0;if(s)try{v=s(o[h-1],o[h])*this.fontSize()}catch{v=0}f.x+=v,d.x+=v,this.textWidth+=v;const b=Mn.Path.getPointOnLine(v+p/2,f.x,f.y,d.x,d.y),_=Math.atan2(d.y-f.y,d.x-f.x);this.glyphInfo.push({transposeX:b.x,transposeY:b.y,text:o[h],rotation:_,p0:f,p1:d}),c+=g}}getSelfRect(){if(!this.glyphInfo.length)return{x:0,y:0,width:0,height:0};var t=[];this.glyphInfo.forEach(function(h){t.push(h.p0.x),t.push(h.p0.y),t.push(h.p1.x),t.push(h.p1.y)});for(var e=t[0]||0,i=t[0]||0,n=t[1]||0,s=t[1]||0,a,l,o=0;o<t.length/2;o++)a=t[o*2],l=t[o*2+1],e=Math.min(e,a),i=Math.max(i,a),n=Math.min(n,l),s=Math.max(s,l);var c=this.fontSize();return{x:e-c/2,y:n-c/2,width:i-e+c,height:s-n+c}}destroy(){return ua.Util.releaseCanvas(this.dummyCanvas),super.destroy()}}Es.TextPath=Yt;Yt.prototype._fillFunc=Nh;Yt.prototype._strokeFunc=Lh;Yt.prototype._fillFuncHit=Nh;Yt.prototype._strokeFuncHit=Lh;Yt.prototype.className="TextPath";Yt.prototype._attrsAffectingSize=["text","fontSize","data"];(0,o1._registerNode)(Yt);Pe.Factory.addGetterSetter(Yt,"data");Pe.Factory.addGetterSetter(Yt,"fontFamily","Arial");Pe.Factory.addGetterSetter(Yt,"fontSize",12,(0,Fh.getNumberValidator)());Pe.Factory.addGetterSetter(Yt,"fontStyle",Rh);Pe.Factory.addGetterSetter(Yt,"align","left");Pe.Factory.addGetterSetter(Yt,"letterSpacing",0,(0,Fh.getNumberValidator)());Pe.Factory.addGetterSetter(Yt,"textBaseline","middle");Pe.Factory.addGetterSetter(Yt,"fontVariant",Rh);Pe.Factory.addGetterSetter(Yt,"text",l1);Pe.Factory.addGetterSetter(Yt,"textDecoration",null);Pe.Factory.addGetterSetter(Yt,"kerningFunc",null);var Ms={};Object.defineProperty(Ms,"__esModule",{value:!0});Ms.Transformer=void 0;const Ct=Ot,vt=ot,bl=Ft,c1=Xt,h1=rr,wl=Cn,we=ct,wi=X,f1=ct;var Oh="tr-konva",u1=["resizeEnabledChange","rotateAnchorOffsetChange","rotateEnabledChange","enabledAnchorsChange","anchorSizeChange","borderEnabledChange","borderStrokeChange","borderStrokeWidthChange","borderDashChange","anchorStrokeChange","anchorStrokeWidthChange","anchorFillChange","anchorCornerRadiusChange","ignoreStrokeChange","anchorStyleFuncChange"].map(r=>r+`.${Oh}`).join(" "),Sl="nodesRect",d1=["widthChange","heightChange","scaleXChange","scaleYChange","skewXChange","skewYChange","rotationChange","offsetXChange","offsetYChange","transformsEnabledChange","strokeWidthChange"],g1={"top-left":-45,"top-center":0,"top-right":45,"middle-right":-90,"middle-left":90,"bottom-left":-135,"bottom-center":180,"bottom-right":135};const p1="ontouchstart"in we.Konva._global;function m1(r,t,e){if(r==="rotater")return e;t+=Ct.Util.degToRad(g1[r]||0);var i=(Ct.Util.radToDeg(t)%360+360)%360;return Ct.Util._inRange(i,315+22.5,360)||Ct.Util._inRange(i,0,22.5)?"ns-resize":Ct.Util._inRange(i,45-22.5,45+22.5)?"nesw-resize":Ct.Util._inRange(i,90-22.5,90+22.5)?"ew-resize":Ct.Util._inRange(i,135-22.5,135+22.5)?"nwse-resize":Ct.Util._inRange(i,180-22.5,180+22.5)?"ns-resize":Ct.Util._inRange(i,225-22.5,225+22.5)?"nesw-resize":Ct.Util._inRange(i,270-22.5,270+22.5)?"ew-resize":Ct.Util._inRange(i,315-22.5,315+22.5)?"nwse-resize":(Ct.Util.error("Transformer has unknown angle for cursor detection: "+i),"pointer")}var Kr=["top-left","top-center","top-right","middle-right","middle-left","bottom-left","bottom-center","bottom-right"],Cl=1e8;function _1(r){return{x:r.x+r.width/2*Math.cos(r.rotation)+r.height/2*Math.sin(-r.rotation),y:r.y+r.height/2*Math.cos(r.rotation)+r.width/2*Math.sin(r.rotation)}}function Dh(r,t,e){const i=e.x+(r.x-e.x)*Math.cos(t)-(r.y-e.y)*Math.sin(t),n=e.y+(r.x-e.x)*Math.sin(t)+(r.y-e.y)*Math.cos(t);return{...r,rotation:r.rotation+t,x:i,y:n}}function v1(r,t){const e=_1(r);return Dh(r,t,e)}function y1(r,t,e){let i=t;for(let n=0;n<r.length;n++){const s=we.Konva.getAngle(r[n]),a=Math.abs(s-t)%(Math.PI*2);Math.min(a,Math.PI*2-a)<e&&(i=s)}return i}class dt extends wl.Group{constructor(t){super(t),this._movingAnchorName=null,this._transforming=!1,this._createElements(),this._handleMouseMove=this._handleMouseMove.bind(this),this._handleMouseUp=this._handleMouseUp.bind(this),this.update=this.update.bind(this),this.on(u1,this.update),this.getNode()&&this.update()}attachTo(t){return this.setNode(t),this}setNode(t){return Ct.Util.warn("tr.setNode(shape), tr.node(shape) and tr.attachTo(shape) methods are deprecated. Please use tr.nodes(nodesArray) instead."),this.setNodes([t])}getNode(){return this._nodes&&this._nodes[0]}_getEventNamespace(){return Oh+this._id}setNodes(t=[]){this._nodes&&this._nodes.length&&this.detach();const e=t.filter(n=>n.isAncestorOf(this)?(Ct.Util.error("Konva.Transformer cannot be an a child of the node you are trying to attach"),!1):!0);this._nodes=t=e,t.length===1&&this.useSingleNodeRotation()?this.rotation(t[0].getAbsoluteRotation()):this.rotation(0),this._nodes.forEach(n=>{const s=()=>{this.nodes().length===1&&this.useSingleNodeRotation()&&this.rotation(this.nodes()[0].getAbsoluteRotation()),this._resetTransformCache(),!this._transforming&&!this.isDragging()&&this.update()},a=n._attrsAffectingSize.map(l=>l+"Change."+this._getEventNamespace()).join(" ");n.on(a,s),n.on(d1.map(l=>l+`.${this._getEventNamespace()}`).join(" "),s),n.on(`absoluteTransformChange.${this._getEventNamespace()}`,s),this._proxyDrag(n)}),this._resetTransformCache();var i=!!this.findOne(".top-left");return i&&this.update(),this}_proxyDrag(t){let e;t.on(`dragstart.${this._getEventNamespace()}`,i=>{e=t.getAbsolutePosition(),!this.isDragging()&&t!==this.findOne(".back")&&this.startDrag(i,!1)}),t.on(`dragmove.${this._getEventNamespace()}`,i=>{if(!e)return;const n=t.getAbsolutePosition(),s=n.x-e.x,a=n.y-e.y;this.nodes().forEach(l=>{if(l===t||l.isDragging())return;const o=l.getAbsolutePosition();l.setAbsolutePosition({x:o.x+s,y:o.y+a}),l.startDrag(i)}),e=null})}getNodes(){return this._nodes||[]}getActiveAnchor(){return this._movingAnchorName}detach(){this._nodes&&this._nodes.forEach(t=>{t.off("."+this._getEventNamespace())}),this._nodes=[],this._resetTransformCache()}_resetTransformCache(){this._clearCache(Sl),this._clearCache("transform"),this._clearSelfAndDescendantCache("absoluteTransform")}_getNodeRect(){return this._getCache(Sl,this.__getNodeRect)}__getNodeShape(t,e=this.rotation(),i){var n=t.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),s=t.getAbsoluteScale(i),a=t.getAbsolutePosition(i),l=n.x*s.x-t.offsetX()*s.x,o=n.y*s.y-t.offsetY()*s.y;const c=(we.Konva.getAngle(t.getAbsoluteRotation())+Math.PI*2)%(Math.PI*2),h={x:a.x+l*Math.cos(c)+o*Math.sin(-c),y:a.y+o*Math.cos(c)+l*Math.sin(c),width:n.width*s.x,height:n.height*s.y,rotation:c};return Dh(h,-we.Konva.getAngle(e),{x:0,y:0})}__getNodeRect(){var t=this.getNode();if(!t)return{x:-Cl,y:-Cl,width:0,height:0,rotation:0};const e=[];this.nodes().map(c=>{const h=c.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()});var f=[{x:h.x,y:h.y},{x:h.x+h.width,y:h.y},{x:h.x+h.width,y:h.y+h.height},{x:h.x,y:h.y+h.height}],g=c.getAbsoluteTransform();f.forEach(function(d){var p=g.point(d);e.push(p)})});const i=new Ct.Transform;i.rotate(-we.Konva.getAngle(this.rotation()));var n=1/0,s=1/0,a=-1/0,l=-1/0;e.forEach(function(c){var h=i.point(c);n===void 0&&(n=a=h.x,s=l=h.y),n=Math.min(n,h.x),s=Math.min(s,h.y),a=Math.max(a,h.x),l=Math.max(l,h.y)}),i.invert();const o=i.point({x:n,y:s});return{x:o.x,y:o.y,width:a-n,height:l-s,rotation:we.Konva.getAngle(this.rotation())}}getX(){return this._getNodeRect().x}getY(){return this._getNodeRect().y}getWidth(){return this._getNodeRect().width}getHeight(){return this._getNodeRect().height}_createElements(){this._createBack(),Kr.forEach(t=>{this._createAnchor(t)}),this._createAnchor("rotater")}_createAnchor(t){var e=new h1.Rect({stroke:"rgb(0, 161, 255)",fill:"white",strokeWidth:1,name:t+" _anchor",dragDistance:0,draggable:!0,hitStrokeWidth:p1?10:"auto"}),i=this;e.on("mousedown touchstart",function(n){i._handleMouseDown(n)}),e.on("dragstart",n=>{e.stopDrag(),n.cancelBubble=!0}),e.on("dragend",n=>{n.cancelBubble=!0}),e.on("mouseenter",()=>{var n=we.Konva.getAngle(this.rotation()),s=this.rotateAnchorCursor(),a=m1(t,n,s);e.getStage().content&&(e.getStage().content.style.cursor=a),this._cursorChange=!0}),e.on("mouseout",()=>{e.getStage().content&&(e.getStage().content.style.cursor=""),this._cursorChange=!1}),this.add(e)}_createBack(){var t=new c1.Shape({name:"back",width:0,height:0,draggable:!0,sceneFunc(e,i){var n=i.getParent(),s=n.padding();e.beginPath(),e.rect(-s,-s,i.width()+s*2,i.height()+s*2),e.moveTo(i.width()/2,-s),n.rotateEnabled()&&n.rotateLineVisible()&&e.lineTo(i.width()/2,-n.rotateAnchorOffset()*Ct.Util._sign(i.height())-s),e.fillStrokeShape(i)},hitFunc:(e,i)=>{if(this.shouldOverdrawWholeArea()){var n=this.padding();e.beginPath(),e.rect(-n,-n,i.width()+n*2,i.height()+n*2),e.fillStrokeShape(i)}}});this.add(t),this._proxyDrag(t),t.on("dragstart",e=>{e.cancelBubble=!0}),t.on("dragmove",e=>{e.cancelBubble=!0}),t.on("dragend",e=>{e.cancelBubble=!0}),this.on("dragmove",e=>{this.update()})}_handleMouseDown(t){this._movingAnchorName=t.target.name().split(" ")[0];var e=this._getNodeRect(),i=e.width,n=e.height,s=Math.sqrt(Math.pow(i,2)+Math.pow(n,2));this.sin=Math.abs(n/s),this.cos=Math.abs(i/s),typeof window<"u"&&(window.addEventListener("mousemove",this._handleMouseMove),window.addEventListener("touchmove",this._handleMouseMove),window.addEventListener("mouseup",this._handleMouseUp,!0),window.addEventListener("touchend",this._handleMouseUp,!0)),this._transforming=!0;var a=t.target.getAbsolutePosition(),l=t.target.getStage().getPointerPosition();this._anchorDragOffset={x:l.x-a.x,y:l.y-a.y},this._fire("transformstart",{evt:t.evt,target:this.getNode()}),this._nodes.forEach(o=>{o._fire("transformstart",{evt:t.evt,target:o})})}_handleMouseMove(t){var e,i,n,s=this.findOne("."+this._movingAnchorName),a=s.getStage();a.setPointersPositions(t);const l=a.getPointerPosition();let o={x:l.x-this._anchorDragOffset.x,y:l.y-this._anchorDragOffset.y};const c=s.getAbsolutePosition();this.anchorDragBoundFunc()&&(o=this.anchorDragBoundFunc()(c,o,t)),s.setAbsolutePosition(o);const h=s.getAbsolutePosition();if(!(c.x===h.x&&c.y===h.y)){if(this._movingAnchorName==="rotater"){var f=this._getNodeRect();e=s.x()-f.width/2,i=-s.y()+f.height/2;let M=Math.atan2(-i,e)+Math.PI/2;f.height<0&&(M-=Math.PI);var g=we.Konva.getAngle(this.rotation());const F=g+M,N=we.Konva.getAngle(this.rotationSnapTolerance()),V=y1(this.rotationSnaps(),F,N)-f.rotation,Z=v1(f,V);this._fitNodesInto(Z,t);return}var d=this.shiftBehavior(),p;d==="inverted"?p=this.keepRatio()&&!t.shiftKey:d==="none"?p=this.keepRatio():p=this.keepRatio()||t.shiftKey;var u=this.centeredScaling()||t.altKey;if(this._movingAnchorName==="top-left"){if(p){var v=u?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-right").x(),y:this.findOne(".bottom-right").y()};n=Math.sqrt(Math.pow(v.x-s.x(),2)+Math.pow(v.y-s.y(),2));var b=this.findOne(".top-left").x()>v.x?-1:1,_=this.findOne(".top-left").y()>v.y?-1:1;e=n*this.cos*b,i=n*this.sin*_,this.findOne(".top-left").x(v.x-e),this.findOne(".top-left").y(v.y-i)}}else if(this._movingAnchorName==="top-center")this.findOne(".top-left").y(s.y());else if(this._movingAnchorName==="top-right"){if(p){var v=u?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-left").x(),y:this.findOne(".bottom-left").y()};n=Math.sqrt(Math.pow(s.x()-v.x,2)+Math.pow(v.y-s.y(),2));var b=this.findOne(".top-right").x()<v.x?-1:1,_=this.findOne(".top-right").y()>v.y?-1:1;e=n*this.cos*b,i=n*this.sin*_,this.findOne(".top-right").x(v.x+e),this.findOne(".top-right").y(v.y-i)}var w=s.position();this.findOne(".top-left").y(w.y),this.findOne(".bottom-right").x(w.x)}else if(this._movingAnchorName==="middle-left")this.findOne(".top-left").x(s.x());else if(this._movingAnchorName==="middle-right")this.findOne(".bottom-right").x(s.x());else if(this._movingAnchorName==="bottom-left"){if(p){var v=u?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-right").x(),y:this.findOne(".top-right").y()};n=Math.sqrt(Math.pow(v.x-s.x(),2)+Math.pow(s.y()-v.y,2));var b=v.x<s.x()?-1:1,_=s.y()<v.y?-1:1;e=n*this.cos*b,i=n*this.sin*_,s.x(v.x-e),s.y(v.y+i)}w=s.position(),this.findOne(".top-left").x(w.x),this.findOne(".bottom-right").y(w.y)}else if(this._movingAnchorName==="bottom-center")this.findOne(".bottom-right").y(s.y());else if(this._movingAnchorName==="bottom-right"){if(p){var v=u?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-left").x(),y:this.findOne(".top-left").y()};n=Math.sqrt(Math.pow(s.x()-v.x,2)+Math.pow(s.y()-v.y,2));var b=this.findOne(".bottom-right").x()<v.x?-1:1,_=this.findOne(".bottom-right").y()<v.y?-1:1;e=n*this.cos*b,i=n*this.sin*_,this.findOne(".bottom-right").x(v.x+e),this.findOne(".bottom-right").y(v.y+i)}}else console.error(new Error("Wrong position argument of selection resizer: "+this._movingAnchorName));var u=this.centeredScaling()||t.altKey;if(u){var m=this.findOne(".top-left"),y=this.findOne(".bottom-right"),S=m.x(),T=m.y(),C=this.getWidth()-y.x(),A=this.getHeight()-y.y();y.move({x:-S,y:-T}),m.move({x:C,y:A})}var P=this.findOne(".top-left").getAbsolutePosition();e=P.x,i=P.y;var k=this.findOne(".bottom-right").x()-this.findOne(".top-left").x(),E=this.findOne(".bottom-right").y()-this.findOne(".top-left").y();this._fitNodesInto({x:e,y:i,width:k,height:E,rotation:we.Konva.getAngle(this.rotation())},t)}}_handleMouseUp(t){this._removeEvents(t)}getAbsoluteTransform(){return this.getTransform()}_removeEvents(t){if(this._transforming){this._transforming=!1,typeof window<"u"&&(window.removeEventListener("mousemove",this._handleMouseMove),window.removeEventListener("touchmove",this._handleMouseMove),window.removeEventListener("mouseup",this._handleMouseUp,!0),window.removeEventListener("touchend",this._handleMouseUp,!0));var e=this.getNode();this._fire("transformend",{evt:t,target:e}),e&&this._nodes.forEach(i=>{i._fire("transformend",{evt:t,target:i})}),this._movingAnchorName=null}}_fitNodesInto(t,e){var i=this._getNodeRect();const n=1;if(Ct.Util._inRange(t.width,-this.padding()*2-n,n)){this.update();return}if(Ct.Util._inRange(t.height,-this.padding()*2-n,n)){this.update();return}var s=new Ct.Transform;if(s.rotate(we.Konva.getAngle(this.rotation())),this._movingAnchorName&&t.width<0&&this._movingAnchorName.indexOf("left")>=0){const g=s.point({x:-this.padding()*2,y:0});t.x+=g.x,t.y+=g.y,t.width+=this.padding()*2,this._movingAnchorName=this._movingAnchorName.replace("left","right"),this._anchorDragOffset.x-=g.x,this._anchorDragOffset.y-=g.y}else if(this._movingAnchorName&&t.width<0&&this._movingAnchorName.indexOf("right")>=0){const g=s.point({x:this.padding()*2,y:0});this._movingAnchorName=this._movingAnchorName.replace("right","left"),this._anchorDragOffset.x-=g.x,this._anchorDragOffset.y-=g.y,t.width+=this.padding()*2}if(this._movingAnchorName&&t.height<0&&this._movingAnchorName.indexOf("top")>=0){const g=s.point({x:0,y:-this.padding()*2});t.x+=g.x,t.y+=g.y,this._movingAnchorName=this._movingAnchorName.replace("top","bottom"),this._anchorDragOffset.x-=g.x,this._anchorDragOffset.y-=g.y,t.height+=this.padding()*2}else if(this._movingAnchorName&&t.height<0&&this._movingAnchorName.indexOf("bottom")>=0){const g=s.point({x:0,y:this.padding()*2});this._movingAnchorName=this._movingAnchorName.replace("bottom","top"),this._anchorDragOffset.x-=g.x,this._anchorDragOffset.y-=g.y,t.height+=this.padding()*2}if(this.boundBoxFunc()){const g=this.boundBoxFunc()(i,t);g?t=g:Ct.Util.warn("boundBoxFunc returned falsy. You should return new bound rect from it!")}const a=1e7,l=new Ct.Transform;l.translate(i.x,i.y),l.rotate(i.rotation),l.scale(i.width/a,i.height/a);const o=new Ct.Transform,c=t.width/a,h=t.height/a;this.flipEnabled()===!1?(o.translate(t.x,t.y),o.rotate(t.rotation),o.translate(t.width<0?t.width:0,t.height<0?t.height:0),o.scale(Math.abs(c),Math.abs(h))):(o.translate(t.x,t.y),o.rotate(t.rotation),o.scale(c,h));const f=o.multiply(l.invert());this._nodes.forEach(g=>{var d;const p=g.getParent().getAbsoluteTransform(),v=g.getTransform().copy();v.translate(g.offsetX(),g.offsetY());const b=new Ct.Transform;b.multiply(p.copy().invert()).multiply(f).multiply(p).multiply(v);const _=b.decompose();g.setAttrs(_),this._fire("transform",{evt:e,target:g}),g._fire("transform",{evt:e,target:g}),(d=g.getLayer())===null||d===void 0||d.batchDraw()}),this.rotation(Ct.Util._getRotation(t.rotation)),this._resetTransformCache(),this.update(),this.getLayer().batchDraw()}forceUpdate(){this._resetTransformCache(),this.update()}_batchChangeChild(t,e){this.findOne(t).setAttrs(e)}update(){var t,e=this._getNodeRect();this.rotation(Ct.Util._getRotation(e.rotation));var i=e.width,n=e.height,s=this.enabledAnchors(),a=this.resizeEnabled(),l=this.padding(),o=this.anchorSize();const c=this.find("._anchor");c.forEach(f=>{f.setAttrs({width:o,height:o,offsetX:o/2,offsetY:o/2,stroke:this.anchorStroke(),strokeWidth:this.anchorStrokeWidth(),fill:this.anchorFill(),cornerRadius:this.anchorCornerRadius()})}),this._batchChangeChild(".top-left",{x:0,y:0,offsetX:o/2+l,offsetY:o/2+l,visible:a&&s.indexOf("top-left")>=0}),this._batchChangeChild(".top-center",{x:i/2,y:0,offsetY:o/2+l,visible:a&&s.indexOf("top-center")>=0}),this._batchChangeChild(".top-right",{x:i,y:0,offsetX:o/2-l,offsetY:o/2+l,visible:a&&s.indexOf("top-right")>=0}),this._batchChangeChild(".middle-left",{x:0,y:n/2,offsetX:o/2+l,visible:a&&s.indexOf("middle-left")>=0}),this._batchChangeChild(".middle-right",{x:i,y:n/2,offsetX:o/2-l,visible:a&&s.indexOf("middle-right")>=0}),this._batchChangeChild(".bottom-left",{x:0,y:n,offsetX:o/2+l,offsetY:o/2-l,visible:a&&s.indexOf("bottom-left")>=0}),this._batchChangeChild(".bottom-center",{x:i/2,y:n,offsetY:o/2-l,visible:a&&s.indexOf("bottom-center")>=0}),this._batchChangeChild(".bottom-right",{x:i,y:n,offsetX:o/2-l,offsetY:o/2-l,visible:a&&s.indexOf("bottom-right")>=0}),this._batchChangeChild(".rotater",{x:i/2,y:-this.rotateAnchorOffset()*Ct.Util._sign(n)-l,visible:this.rotateEnabled()}),this._batchChangeChild(".back",{width:i,height:n,visible:this.borderEnabled(),stroke:this.borderStroke(),strokeWidth:this.borderStrokeWidth(),dash:this.borderDash(),x:0,y:0});const h=this.anchorStyleFunc();h&&c.forEach(f=>{h(f)}),(t=this.getLayer())===null||t===void 0||t.batchDraw()}isTransforming(){return this._transforming}stopTransform(){if(this._transforming){this._removeEvents();var t=this.findOne("."+this._movingAnchorName);t&&t.stopDrag()}}destroy(){return this.getStage()&&this._cursorChange&&this.getStage().content&&(this.getStage().content.style.cursor=""),wl.Group.prototype.destroy.call(this),this.detach(),this._removeEvents(),this}toObject(){return bl.Node.prototype.toObject.call(this)}clone(t){var e=bl.Node.prototype.clone.call(this,t);return e}getClientRect(){return this.nodes().length>0?super.getClientRect():{x:0,y:0,width:0,height:0}}}Ms.Transformer=dt;function b1(r){return r instanceof Array||Ct.Util.warn("enabledAnchors value should be an array"),r instanceof Array&&r.forEach(function(t){Kr.indexOf(t)===-1&&Ct.Util.warn("Unknown anchor name: "+t+". Available names are: "+Kr.join(", "))}),r||[]}dt.prototype.className="Transformer";(0,f1._registerNode)(dt);vt.Factory.addGetterSetter(dt,"enabledAnchors",Kr,b1);vt.Factory.addGetterSetter(dt,"flipEnabled",!0,(0,wi.getBooleanValidator)());vt.Factory.addGetterSetter(dt,"resizeEnabled",!0);vt.Factory.addGetterSetter(dt,"anchorSize",10,(0,wi.getNumberValidator)());vt.Factory.addGetterSetter(dt,"rotateEnabled",!0);vt.Factory.addGetterSetter(dt,"rotateLineVisible",!0);vt.Factory.addGetterSetter(dt,"rotationSnaps",[]);vt.Factory.addGetterSetter(dt,"rotateAnchorOffset",50,(0,wi.getNumberValidator)());vt.Factory.addGetterSetter(dt,"rotateAnchorCursor","crosshair");vt.Factory.addGetterSetter(dt,"rotationSnapTolerance",5,(0,wi.getNumberValidator)());vt.Factory.addGetterSetter(dt,"borderEnabled",!0);vt.Factory.addGetterSetter(dt,"anchorStroke","rgb(0, 161, 255)");vt.Factory.addGetterSetter(dt,"anchorStrokeWidth",1,(0,wi.getNumberValidator)());vt.Factory.addGetterSetter(dt,"anchorFill","white");vt.Factory.addGetterSetter(dt,"anchorCornerRadius",0,(0,wi.getNumberValidator)());vt.Factory.addGetterSetter(dt,"borderStroke","rgb(0, 161, 255)");vt.Factory.addGetterSetter(dt,"borderStrokeWidth",1,(0,wi.getNumberValidator)());vt.Factory.addGetterSetter(dt,"borderDash");vt.Factory.addGetterSetter(dt,"keepRatio",!0);vt.Factory.addGetterSetter(dt,"shiftBehavior","default");vt.Factory.addGetterSetter(dt,"centeredScaling",!1);vt.Factory.addGetterSetter(dt,"ignoreStroke",!1);vt.Factory.addGetterSetter(dt,"padding",0,(0,wi.getNumberValidator)());vt.Factory.addGetterSetter(dt,"node");vt.Factory.addGetterSetter(dt,"nodes");vt.Factory.addGetterSetter(dt,"boundBoxFunc");vt.Factory.addGetterSetter(dt,"anchorDragBoundFunc");vt.Factory.addGetterSetter(dt,"anchorStyleFunc");vt.Factory.addGetterSetter(dt,"shouldOverdrawWholeArea",!1);vt.Factory.addGetterSetter(dt,"useSingleNodeRotation",!0);vt.Factory.backCompat(dt,{lineEnabled:"borderEnabled",rotateHandlerOffset:"rotateAnchorOffset",enabledHandlers:"enabledAnchors"});var Fs={};Object.defineProperty(Fs,"__esModule",{value:!0});Fs.Wedge=void 0;const Rs=ot,w1=Xt,S1=ct,Ih=X,C1=ct;class ti extends w1.Shape{_sceneFunc(t){t.beginPath(),t.arc(0,0,this.radius(),0,S1.Konva.getAngle(this.angle()),this.clockwise()),t.lineTo(0,0),t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(t){this.radius(t/2)}setHeight(t){this.radius(t/2)}}Fs.Wedge=ti;ti.prototype.className="Wedge";ti.prototype._centroid=!0;ti.prototype._attrsAffectingSize=["radius"];(0,C1._registerNode)(ti);Rs.Factory.addGetterSetter(ti,"radius",0,(0,Ih.getNumberValidator)());Rs.Factory.addGetterSetter(ti,"angle",0,(0,Ih.getNumberValidator)());Rs.Factory.addGetterSetter(ti,"clockwise",!1);Rs.Factory.backCompat(ti,{angleDeg:"angle",getAngleDeg:"getAngle",setAngleDeg:"setAngle"});var Ns={};Object.defineProperty(Ns,"__esModule",{value:!0});Ns.Blur=void 0;const Al=ot,A1=Ft,T1=X;function Tl(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}var P1=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],k1=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];function x1(r,t){var e=r.data,i=r.width,n=r.height,s,a,l,o,c,h,f,g,d,p,v,b,_,w,u,m,y,S,T,C,A,P,k,E,M=t+t+1,F=i-1,N=n-1,D=t+1,V=D*(D+1)/2,Z=new Tl,lt=null,K=Z,q=null,gt=null,St=P1[t],U=k1[t];for(l=1;l<M;l++)K=K.next=new Tl,l===D&&(lt=K);for(K.next=Z,f=h=0,a=0;a<n;a++){for(m=y=S=T=g=d=p=v=0,b=D*(C=e[h]),_=D*(A=e[h+1]),w=D*(P=e[h+2]),u=D*(k=e[h+3]),g+=V*C,d+=V*A,p+=V*P,v+=V*k,K=Z,l=0;l<D;l++)K.r=C,K.g=A,K.b=P,K.a=k,K=K.next;for(l=1;l<D;l++)o=h+((F<l?F:l)<<2),g+=(K.r=C=e[o])*(E=D-l),d+=(K.g=A=e[o+1])*E,p+=(K.b=P=e[o+2])*E,v+=(K.a=k=e[o+3])*E,m+=C,y+=A,S+=P,T+=k,K=K.next;for(q=Z,gt=lt,s=0;s<i;s++)e[h+3]=k=v*St>>U,k!==0?(k=255/k,e[h]=(g*St>>U)*k,e[h+1]=(d*St>>U)*k,e[h+2]=(p*St>>U)*k):e[h]=e[h+1]=e[h+2]=0,g-=b,d-=_,p-=w,v-=u,b-=q.r,_-=q.g,w-=q.b,u-=q.a,o=f+((o=s+t+1)<F?o:F)<<2,m+=q.r=e[o],y+=q.g=e[o+1],S+=q.b=e[o+2],T+=q.a=e[o+3],g+=m,d+=y,p+=S,v+=T,q=q.next,b+=C=gt.r,_+=A=gt.g,w+=P=gt.b,u+=k=gt.a,m-=C,y-=A,S-=P,T-=k,gt=gt.next,h+=4;f+=i}for(s=0;s<i;s++){for(y=S=T=m=d=p=v=g=0,h=s<<2,b=D*(C=e[h]),_=D*(A=e[h+1]),w=D*(P=e[h+2]),u=D*(k=e[h+3]),g+=V*C,d+=V*A,p+=V*P,v+=V*k,K=Z,l=0;l<D;l++)K.r=C,K.g=A,K.b=P,K.a=k,K=K.next;for(c=i,l=1;l<=t;l++)h=c+s<<2,g+=(K.r=C=e[h])*(E=D-l),d+=(K.g=A=e[h+1])*E,p+=(K.b=P=e[h+2])*E,v+=(K.a=k=e[h+3])*E,m+=C,y+=A,S+=P,T+=k,K=K.next,l<N&&(c+=i);for(h=s,q=Z,gt=lt,a=0;a<n;a++)o=h<<2,e[o+3]=k=v*St>>U,k>0?(k=255/k,e[o]=(g*St>>U)*k,e[o+1]=(d*St>>U)*k,e[o+2]=(p*St>>U)*k):e[o]=e[o+1]=e[o+2]=0,g-=b,d-=_,p-=w,v-=u,b-=q.r,_-=q.g,w-=q.b,u-=q.a,o=s+((o=a+D)<N?o:N)*i<<2,g+=m+=q.r=e[o],d+=y+=q.g=e[o+1],p+=S+=q.b=e[o+2],v+=T+=q.a=e[o+3],q=q.next,b+=C=gt.r,_+=A=gt.g,w+=P=gt.b,u+=k=gt.a,m-=C,y-=A,S-=P,T-=k,gt=gt.next,h+=i}}const E1=function(t){var e=Math.round(this.blurRadius());e>0&&x1(t,e)};Ns.Blur=E1;Al.Factory.addGetterSetter(A1.Node,"blurRadius",0,(0,T1.getNumberValidator)(),Al.Factory.afterSetFilter);var Ls={};Object.defineProperty(Ls,"__esModule",{value:!0});Ls.Brighten=void 0;const Pl=ot,M1=Ft,F1=X,R1=function(r){var t=this.brightness()*255,e=r.data,i=e.length,n;for(n=0;n<i;n+=4)e[n]+=t,e[n+1]+=t,e[n+2]+=t};Ls.Brighten=R1;Pl.Factory.addGetterSetter(M1.Node,"brightness",0,(0,F1.getNumberValidator)(),Pl.Factory.afterSetFilter);var Os={};Object.defineProperty(Os,"__esModule",{value:!0});Os.Contrast=void 0;const kl=ot,N1=Ft,L1=X,O1=function(r){var t=Math.pow((this.contrast()+100)/100,2),e=r.data,i=e.length,n=150,s=150,a=150,l;for(l=0;l<i;l+=4)n=e[l],s=e[l+1],a=e[l+2],n/=255,n-=.5,n*=t,n+=.5,n*=255,s/=255,s-=.5,s*=t,s+=.5,s*=255,a/=255,a-=.5,a*=t,a+=.5,a*=255,n=n<0?0:n>255?255:n,s=s<0?0:s>255?255:s,a=a<0?0:a>255?255:a,e[l]=n,e[l+1]=s,e[l+2]=a};Os.Contrast=O1;kl.Factory.addGetterSetter(N1.Node,"contrast",0,(0,L1.getNumberValidator)(),kl.Factory.afterSetFilter);var Ds={};Object.defineProperty(Ds,"__esModule",{value:!0});Ds.Emboss=void 0;const gi=ot,Is=Ft,D1=Ot,Gh=X,I1=function(r){var t=this.embossStrength()*10,e=this.embossWhiteLevel()*255,i=this.embossDirection(),n=this.embossBlend(),s=0,a=0,l=r.data,o=r.width,c=r.height,h=o*4,f=c;switch(i){case"top-left":s=-1,a=-1;break;case"top":s=-1,a=0;break;case"top-right":s=-1,a=1;break;case"right":s=0,a=1;break;case"bottom-right":s=1,a=1;break;case"bottom":s=1,a=0;break;case"bottom-left":s=1,a=-1;break;case"left":s=0,a=-1;break;default:D1.Util.error("Unknown emboss direction: "+i)}do{var g=(f-1)*h,d=s;f+d<1&&(d=0),f+d>c&&(d=0);var p=(f-1+d)*o*4,v=o;do{var b=g+(v-1)*4,_=a;v+_<1&&(_=0),v+_>o&&(_=0);var w=p+(v-1+_)*4,u=l[b]-l[w],m=l[b+1]-l[w+1],y=l[b+2]-l[w+2],S=u,T=S>0?S:-S,C=m>0?m:-m,A=y>0?y:-y;if(C>T&&(S=m),A>T&&(S=y),S*=t,n){var P=l[b]+S,k=l[b+1]+S,E=l[b+2]+S;l[b]=P>255?255:P<0?0:P,l[b+1]=k>255?255:k<0?0:k,l[b+2]=E>255?255:E<0?0:E}else{var M=e-S;M<0?M=0:M>255&&(M=255),l[b]=l[b+1]=l[b+2]=M}}while(--v)}while(--f)};Ds.Emboss=I1;gi.Factory.addGetterSetter(Is.Node,"embossStrength",.5,(0,Gh.getNumberValidator)(),gi.Factory.afterSetFilter);gi.Factory.addGetterSetter(Is.Node,"embossWhiteLevel",.5,(0,Gh.getNumberValidator)(),gi.Factory.afterSetFilter);gi.Factory.addGetterSetter(Is.Node,"embossDirection","top-left",null,gi.Factory.afterSetFilter);gi.Factory.addGetterSetter(Is.Node,"embossBlend",!1,null,gi.Factory.afterSetFilter);var Gs={};Object.defineProperty(Gs,"__esModule",{value:!0});Gs.Enhance=void 0;const xl=ot,G1=Ft,B1=X;function ga(r,t,e,i,n){var s=e-t,a=n-i,l;return s===0?i+a/2:a===0?i:(l=(r-t)/s,l=a*l+i,l)}const U1=function(r){var t=r.data,e=t.length,i=t[0],n=i,s,a=t[1],l=a,o,c=t[2],h=c,f,g,d=this.enhance();if(d!==0){for(g=0;g<e;g+=4)s=t[g+0],s<i?i=s:s>n&&(n=s),o=t[g+1],o<a?a=o:o>l&&(l=o),f=t[g+2],f<c?c=f:f>h&&(h=f);n===i&&(n=255,i=0),l===a&&(l=255,a=0),h===c&&(h=255,c=0);var p,v,b,_,w,u,m,y,S;for(d>0?(v=n+d*(255-n),b=i-d*(i-0),w=l+d*(255-l),u=a-d*(a-0),y=h+d*(255-h),S=c-d*(c-0)):(p=(n+i)*.5,v=n+d*(n-p),b=i+d*(i-p),_=(l+a)*.5,w=l+d*(l-_),u=a+d*(a-_),m=(h+c)*.5,y=h+d*(h-m),S=c+d*(c-m)),g=0;g<e;g+=4)t[g+0]=ga(t[g+0],i,n,b,v),t[g+1]=ga(t[g+1],a,l,u,w),t[g+2]=ga(t[g+2],c,h,S,y)}};Gs.Enhance=U1;xl.Factory.addGetterSetter(G1.Node,"enhance",0,(0,B1.getNumberValidator)(),xl.Factory.afterSetFilter);var Bs={};Object.defineProperty(Bs,"__esModule",{value:!0});Bs.Grayscale=void 0;const V1=function(r){var t=r.data,e=t.length,i,n;for(i=0;i<e;i+=4)n=.34*t[i]+.5*t[i+1]+.16*t[i+2],t[i]=n,t[i+1]=n,t[i+2]=n};Bs.Grayscale=V1;var Us={};Object.defineProperty(Us,"__esModule",{value:!0});Us.HSL=void 0;const mn=ot,To=Ft,Po=X;mn.Factory.addGetterSetter(To.Node,"hue",0,(0,Po.getNumberValidator)(),mn.Factory.afterSetFilter);mn.Factory.addGetterSetter(To.Node,"saturation",0,(0,Po.getNumberValidator)(),mn.Factory.afterSetFilter);mn.Factory.addGetterSetter(To.Node,"luminance",0,(0,Po.getNumberValidator)(),mn.Factory.afterSetFilter);const z1=function(r){var t=r.data,e=t.length,i=1,n=Math.pow(2,this.saturation()),s=Math.abs(this.hue()+360)%360,a=this.luminance()*127,l,o=i*n*Math.cos(s*Math.PI/180),c=i*n*Math.sin(s*Math.PI/180),h=.299*i+.701*o+.167*c,f=.587*i-.587*o+.33*c,g=.114*i-.114*o-.497*c,d=.299*i-.299*o-.328*c,p=.587*i+.413*o+.035*c,v=.114*i-.114*o+.293*c,b=.299*i-.3*o+1.25*c,_=.587*i-.586*o-1.05*c,w=.114*i+.886*o-.2*c,u,m,y,S;for(l=0;l<e;l+=4)u=t[l+0],m=t[l+1],y=t[l+2],S=t[l+3],t[l+0]=h*u+f*m+g*y+a,t[l+1]=d*u+p*m+v*y+a,t[l+2]=b*u+_*m+w*y+a,t[l+3]=S};Us.HSL=z1;var Vs={};Object.defineProperty(Vs,"__esModule",{value:!0});Vs.HSV=void 0;const _n=ot,ko=Ft,xo=X,H1=function(r){var t=r.data,e=t.length,i=Math.pow(2,this.value()),n=Math.pow(2,this.saturation()),s=Math.abs(this.hue()+360)%360,a,l=i*n*Math.cos(s*Math.PI/180),o=i*n*Math.sin(s*Math.PI/180),c=.299*i+.701*l+.167*o,h=.587*i-.587*l+.33*o,f=.114*i-.114*l-.497*o,g=.299*i-.299*l-.328*o,d=.587*i+.413*l+.035*o,p=.114*i-.114*l+.293*o,v=.299*i-.3*l+1.25*o,b=.587*i-.586*l-1.05*o,_=.114*i+.886*l-.2*o,w,u,m,y;for(a=0;a<e;a+=4)w=t[a+0],u=t[a+1],m=t[a+2],y=t[a+3],t[a+0]=c*w+h*u+f*m,t[a+1]=g*w+d*u+p*m,t[a+2]=v*w+b*u+_*m,t[a+3]=y};Vs.HSV=H1;_n.Factory.addGetterSetter(ko.Node,"hue",0,(0,xo.getNumberValidator)(),_n.Factory.afterSetFilter);_n.Factory.addGetterSetter(ko.Node,"saturation",0,(0,xo.getNumberValidator)(),_n.Factory.afterSetFilter);_n.Factory.addGetterSetter(ko.Node,"value",0,(0,xo.getNumberValidator)(),_n.Factory.afterSetFilter);var zs={};Object.defineProperty(zs,"__esModule",{value:!0});zs.Invert=void 0;const W1=function(r){var t=r.data,e=t.length,i;for(i=0;i<e;i+=4)t[i]=255-t[i],t[i+1]=255-t[i+1],t[i+2]=255-t[i+2]};zs.Invert=W1;var Hs={};Object.defineProperty(Hs,"__esModule",{value:!0});Hs.Kaleidoscope=void 0;const qr=ot,Bh=Ft,El=Ot,Uh=X;var j1=function(r,t,e){var i=r.data,n=t.data,s=r.width,a=r.height,l=e.polarCenterX||s/2,o=e.polarCenterY||a/2,c,h,f,g=0,d=0,p=0,v=0,b,_=Math.sqrt(l*l+o*o);h=s-l,f=a-o,b=Math.sqrt(h*h+f*f),_=b>_?b:_;var w=a,u=s,m,y,S=360/u*Math.PI/180,T,C;for(y=0;y<u;y+=1)for(T=Math.sin(y*S),C=Math.cos(y*S),m=0;m<w;m+=1)h=Math.floor(l+_*m/w*C),f=Math.floor(o+_*m/w*T),c=(f*s+h)*4,g=i[c+0],d=i[c+1],p=i[c+2],v=i[c+3],c=(y+m*s)*4,n[c+0]=g,n[c+1]=d,n[c+2]=p,n[c+3]=v},X1=function(r,t,e){var i=r.data,n=t.data,s=r.width,a=r.height,l=e.polarCenterX||s/2,o=e.polarCenterY||a/2,c,h,f,g,d,p=0,v=0,b=0,_=0,w,u=Math.sqrt(l*l+o*o);h=s-l,f=a-o,w=Math.sqrt(h*h+f*f),u=w>u?w:u;var m=a,y=s,S,T,C=e.polarRotation||0,A,P;for(h=0;h<s;h+=1)for(f=0;f<a;f+=1)g=h-l,d=f-o,S=Math.sqrt(g*g+d*d)*m/u,T=(Math.atan2(d,g)*180/Math.PI+360+C)%360,T=T*y/360,A=Math.floor(T),P=Math.floor(S),c=(P*s+A)*4,p=i[c+0],v=i[c+1],b=i[c+2],_=i[c+3],c=(f*s+h)*4,n[c+0]=p,n[c+1]=v,n[c+2]=b,n[c+3]=_};const Y1=function(r){var t=r.width,e=r.height,i,n,s,a,l,o,c,h,f,g,d=Math.round(this.kaleidoscopePower()),p=Math.round(this.kaleidoscopeAngle()),v=Math.floor(t*(p%360)/360);if(!(d<1)){var b=El.Util.createCanvasElement();b.width=t,b.height=e;var _=b.getContext("2d").getImageData(0,0,t,e);El.Util.releaseCanvas(b),j1(r,_,{polarCenterX:t/2,polarCenterY:e/2});for(var w=t/Math.pow(2,d);w<=8;)w=w*2,d-=1;w=Math.ceil(w);var u=w,m=0,y=u,S=1;for(v+w>t&&(m=u,y=0,S=-1),n=0;n<e;n+=1)for(i=m;i!==y;i+=S)s=Math.round(i+v)%t,f=(t*n+s)*4,l=_.data[f+0],o=_.data[f+1],c=_.data[f+2],h=_.data[f+3],g=(t*n+i)*4,_.data[g+0]=l,_.data[g+1]=o,_.data[g+2]=c,_.data[g+3]=h;for(n=0;n<e;n+=1)for(u=Math.floor(w),a=0;a<d;a+=1){for(i=0;i<u+1;i+=1)f=(t*n+i)*4,l=_.data[f+0],o=_.data[f+1],c=_.data[f+2],h=_.data[f+3],g=(t*n+u*2-i-1)*4,_.data[g+0]=l,_.data[g+1]=o,_.data[g+2]=c,_.data[g+3]=h;u*=2}X1(_,r,{polarRotation:0})}};Hs.Kaleidoscope=Y1;qr.Factory.addGetterSetter(Bh.Node,"kaleidoscopePower",2,(0,Uh.getNumberValidator)(),qr.Factory.afterSetFilter);qr.Factory.addGetterSetter(Bh.Node,"kaleidoscopeAngle",0,(0,Uh.getNumberValidator)(),qr.Factory.afterSetFilter);var Ws={};Object.defineProperty(Ws,"__esModule",{value:!0});Ws.Mask=void 0;const Ml=ot,K1=Ft,q1=X;function dr(r,t,e){var i=(e*r.width+t)*4,n=[];return n.push(r.data[i++],r.data[i++],r.data[i++],r.data[i++]),n}function Fn(r,t){return Math.sqrt(Math.pow(r[0]-t[0],2)+Math.pow(r[1]-t[1],2)+Math.pow(r[2]-t[2],2))}function J1(r){for(var t=[0,0,0],e=0;e<r.length;e++)t[0]+=r[e][0],t[1]+=r[e][1],t[2]+=r[e][2];return t[0]/=r.length,t[1]/=r.length,t[2]/=r.length,t}function Q1(r,t){var e=dr(r,0,0),i=dr(r,r.width-1,0),n=dr(r,0,r.height-1),s=dr(r,r.width-1,r.height-1),a=t||10;if(Fn(e,i)<a&&Fn(i,s)<a&&Fn(s,n)<a&&Fn(n,e)<a){for(var l=J1([i,e,s,n]),o=[],c=0;c<r.width*r.height;c++){var h=Fn(l,[r.data[c*4],r.data[c*4+1],r.data[c*4+2]]);o[c]=h<a?0:255}return o}}function Z1(r,t){for(var e=0;e<r.width*r.height;e++)r.data[4*e+3]=t[e]}function $1(r,t,e){for(var i=[1,1,1,1,0,1,1,1,1],n=Math.round(Math.sqrt(i.length)),s=Math.floor(n/2),a=[],l=0;l<e;l++)for(var o=0;o<t;o++){for(var c=l*t+o,h=0,f=0;f<n;f++)for(var g=0;g<n;g++){var d=l+f-s,p=o+g-s;if(d>=0&&d<e&&p>=0&&p<t){var v=d*t+p,b=i[f*n+g];h+=r[v]*b}}a[c]=h===255*8?255:0}return a}function tg(r,t,e){for(var i=[1,1,1,1,1,1,1,1,1],n=Math.round(Math.sqrt(i.length)),s=Math.floor(n/2),a=[],l=0;l<e;l++)for(var o=0;o<t;o++){for(var c=l*t+o,h=0,f=0;f<n;f++)for(var g=0;g<n;g++){var d=l+f-s,p=o+g-s;if(d>=0&&d<e&&p>=0&&p<t){var v=d*t+p,b=i[f*n+g];h+=r[v]*b}}a[c]=h>=255*4?255:0}return a}function eg(r,t,e){for(var i=[.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111],n=Math.round(Math.sqrt(i.length)),s=Math.floor(n/2),a=[],l=0;l<e;l++)for(var o=0;o<t;o++){for(var c=l*t+o,h=0,f=0;f<n;f++)for(var g=0;g<n;g++){var d=l+f-s,p=o+g-s;if(d>=0&&d<e&&p>=0&&p<t){var v=d*t+p,b=i[f*n+g];h+=r[v]*b}}a[c]=h}return a}const ig=function(r){var t=this.threshold(),e=Q1(r,t);return e&&(e=$1(e,r.width,r.height),e=tg(e,r.width,r.height),e=eg(e,r.width,r.height),Z1(r,e)),r};Ws.Mask=ig;Ml.Factory.addGetterSetter(K1.Node,"threshold",0,(0,q1.getNumberValidator)(),Ml.Factory.afterSetFilter);var js={};Object.defineProperty(js,"__esModule",{value:!0});js.Noise=void 0;const Fl=ot,ng=Ft,rg=X,sg=function(r){var t=this.noise()*255,e=r.data,i=e.length,n=t/2,s;for(s=0;s<i;s+=4)e[s+0]+=n-2*n*Math.random(),e[s+1]+=n-2*n*Math.random(),e[s+2]+=n-2*n*Math.random()};js.Noise=sg;Fl.Factory.addGetterSetter(ng.Node,"noise",.2,(0,rg.getNumberValidator)(),Fl.Factory.afterSetFilter);var Xs={};Object.defineProperty(Xs,"__esModule",{value:!0});Xs.Pixelate=void 0;const Rl=ot,ag=Ot,og=Ft,lg=X,cg=function(r){var t=Math.ceil(this.pixelSize()),e=r.width,i=r.height,n,s,a,l,o,c,h,f=Math.ceil(e/t),g=Math.ceil(i/t),d,p,v,b,_,w,u,m=r.data;if(t<=0){ag.Util.error("pixelSize value can not be <= 0");return}for(_=0;_<f;_+=1)for(w=0;w<g;w+=1){for(l=0,o=0,c=0,h=0,d=_*t,p=d+t,v=w*t,b=v+t,u=0,n=d;n<p;n+=1)if(!(n>=e))for(s=v;s<b;s+=1)s>=i||(a=(e*s+n)*4,l+=m[a+0],o+=m[a+1],c+=m[a+2],h+=m[a+3],u+=1);for(l=l/u,o=o/u,c=c/u,h=h/u,n=d;n<p;n+=1)if(!(n>=e))for(s=v;s<b;s+=1)s>=i||(a=(e*s+n)*4,m[a+0]=l,m[a+1]=o,m[a+2]=c,m[a+3]=h)}};Xs.Pixelate=cg;Rl.Factory.addGetterSetter(og.Node,"pixelSize",8,(0,lg.getNumberValidator)(),Rl.Factory.afterSetFilter);var Ys={};Object.defineProperty(Ys,"__esModule",{value:!0});Ys.Posterize=void 0;const Nl=ot,hg=Ft,fg=X,ug=function(r){var t=Math.round(this.levels()*254)+1,e=r.data,i=e.length,n=255/t,s;for(s=0;s<i;s+=1)e[s]=Math.floor(e[s]/n)*n};Ys.Posterize=ug;Nl.Factory.addGetterSetter(hg.Node,"levels",.5,(0,fg.getNumberValidator)(),Nl.Factory.afterSetFilter);var Ks={};Object.defineProperty(Ks,"__esModule",{value:!0});Ks.RGB=void 0;const Jr=ot,Eo=Ft,dg=X,gg=function(r){var t=r.data,e=t.length,i=this.red(),n=this.green(),s=this.blue(),a,l;for(a=0;a<e;a+=4)l=(.34*t[a]+.5*t[a+1]+.16*t[a+2])/255,t[a]=l*i,t[a+1]=l*n,t[a+2]=l*s,t[a+3]=t[a+3]};Ks.RGB=gg;Jr.Factory.addGetterSetter(Eo.Node,"red",0,function(r){return this._filterUpToDate=!1,r>255?255:r<0?0:Math.round(r)});Jr.Factory.addGetterSetter(Eo.Node,"green",0,function(r){return this._filterUpToDate=!1,r>255?255:r<0?0:Math.round(r)});Jr.Factory.addGetterSetter(Eo.Node,"blue",0,dg.RGBComponent,Jr.Factory.afterSetFilter);var qs={};Object.defineProperty(qs,"__esModule",{value:!0});qs.RGBA=void 0;const Yn=ot,Js=Ft,pg=X,mg=function(r){var t=r.data,e=t.length,i=this.red(),n=this.green(),s=this.blue(),a=this.alpha(),l,o;for(l=0;l<e;l+=4)o=1-a,t[l]=i*a+t[l]*o,t[l+1]=n*a+t[l+1]*o,t[l+2]=s*a+t[l+2]*o};qs.RGBA=mg;Yn.Factory.addGetterSetter(Js.Node,"red",0,function(r){return this._filterUpToDate=!1,r>255?255:r<0?0:Math.round(r)});Yn.Factory.addGetterSetter(Js.Node,"green",0,function(r){return this._filterUpToDate=!1,r>255?255:r<0?0:Math.round(r)});Yn.Factory.addGetterSetter(Js.Node,"blue",0,pg.RGBComponent,Yn.Factory.afterSetFilter);Yn.Factory.addGetterSetter(Js.Node,"alpha",1,function(r){return this._filterUpToDate=!1,r>1?1:r<0?0:r});var Qs={};Object.defineProperty(Qs,"__esModule",{value:!0});Qs.Sepia=void 0;const _g=function(r){var t=r.data,e=t.length,i,n,s,a;for(i=0;i<e;i+=4)n=t[i+0],s=t[i+1],a=t[i+2],t[i+0]=Math.min(255,n*.393+s*.769+a*.189),t[i+1]=Math.min(255,n*.349+s*.686+a*.168),t[i+2]=Math.min(255,n*.272+s*.534+a*.131)};Qs.Sepia=_g;var Zs={};Object.defineProperty(Zs,"__esModule",{value:!0});Zs.Solarize=void 0;const vg=function(r){var t=r.data,e=r.width,i=r.height,n=e*4,s=i;do{var a=(s-1)*n,l=e;do{var o=a+(l-1)*4,c=t[o],h=t[o+1],f=t[o+2];c>127&&(c=255-c),h>127&&(h=255-h),f>127&&(f=255-f),t[o]=c,t[o+1]=h,t[o+2]=f}while(--l)}while(--s)};Zs.Solarize=vg;var $s={};Object.defineProperty($s,"__esModule",{value:!0});$s.Threshold=void 0;const Ll=ot,yg=Ft,bg=X,wg=function(r){var t=this.threshold()*255,e=r.data,i=e.length,n;for(n=0;n<i;n+=1)e[n]=e[n]<t?0:255};$s.Threshold=wg;Ll.Factory.addGetterSetter(yg.Node,"threshold",.5,(0,bg.getNumberValidator)(),Ll.Factory.afterSetFilter);Object.defineProperty(ls,"__esModule",{value:!0});ls.Konva=void 0;const Ol=sh,Sg=gs,Cg=_s,Ag=bs,Tg=ws,Pg=Ss,Dl=pn,kg=ir,xg=Tn,Eg=rr,Mg=Ts,Fg=Ps,Rg=ks,Ng=xs,Lg=Oi,Og=Es,Dg=Ms,Ig=Fs,Gg=Ns,Bg=Ls,Ug=Os,Vg=Ds,zg=Gs,Hg=Bs,Wg=Us,jg=Vs,Xg=zs,Yg=Hs,Kg=Ws,qg=js,Jg=Xs,Qg=Ys,Zg=Ks,$g=qs,t2=Qs,e2=Zs,i2=$s;ls.Konva=Ol.Konva.Util._assign(Ol.Konva,{Arc:Sg.Arc,Arrow:Cg.Arrow,Circle:Ag.Circle,Ellipse:Tg.Ellipse,Image:Pg.Image,Label:Dl.Label,Tag:Dl.Tag,Line:kg.Line,Path:xg.Path,Rect:Eg.Rect,RegularPolygon:Mg.RegularPolygon,Ring:Fg.Ring,Sprite:Rg.Sprite,Star:Ng.Star,Text:Lg.Text,TextPath:Og.TextPath,Transformer:Dg.Transformer,Wedge:Ig.Wedge,Filters:{Blur:Gg.Blur,Brighten:Bg.Brighten,Contrast:Ug.Contrast,Emboss:Vg.Emboss,Enhance:zg.Enhance,Grayscale:Hg.Grayscale,HSL:Wg.HSL,HSV:jg.HSV,Invert:Xg.Invert,Kaleidoscope:Yg.Kaleidoscope,Mask:Kg.Mask,Noise:qg.Noise,Pixelate:Jg.Pixelate,Posterize:Qg.Posterize,RGB:Zg.RGB,RGBA:$g.RGBA,Sepia:t2.Sepia,Solarize:e2.Solarize,Threshold:i2.Threshold}});var n2=po.exports;Object.defineProperty(n2,"__esModule",{value:!0});const r2=ls;po.exports=r2.Konva;var s2=po.exports;const sr=od(s2),a2=["mouseover","mouseout","mouseenter","mouseleave","mousemove","mousedown","mouseup","wheel","click","dblclick","touchstart","touchmove","touchend","tap","dbltap","pointerdown","pointermove","pointerup","pointercancel","pointerover","pointerenter","pointerout","pointerleave","pointerclick","pointerdblclick","dragstart","dragmove","dragend","transformstart","transform","transformend"];function ar(r,t){a2.forEach(e=>{t.on(e,i=>{r(e,i,{cancelable:!0})||(i.cancelBubble=!0)})})}const Qr=["svelte-konva-stage","svelte-konva-layer","svelte-konva-group","svelte-konva-label"];var Kn;(function(r){r[r.Stage=0]="Stage",r[r.Layer=1]="Layer",r[r.Group=2]="Group",r[r.Label=3]="Label"})(Kn||(Kn={}));const o2="svelte-konva: Component does not have any parent container. Please make sure that the component is wrapped inside a Layer or Group.",l2="svelte-konva: A Layer needs to have a Stage as parent.";function Vh(r,t){Qr.forEach(e=>{Fi(e,null)}),Fi(Qr[r],t)}function Mo(){for(let r=1;r<4;r++){const t=Ae(Qr[r]);if(t)return t}throw new Error(o2)}function c2(){const r=Ae(Qr[Kn.Stage]);if(r)return r;throw new Error(l2)}function Ke(r,t){for(const e in r)Object.prototype.hasOwnProperty.call(t,e)&&(r[e]=t[e])}function h2(r,t,e){let i,{config:n}=t,{handle:s=new sr.Circle(n)}=t,{staticConfig:a=!1}=t,l=Mo();hi(r,l,c=>e(4,i=c));let o=yn();return Di(()=>{i.add(s),a||(s.on("transformend",()=>{Ke(n,s.getAttrs()),e(1,n)}),s.on("dragend",()=>{Ke(n,s.getAttrs()),e(1,n)})),ar(o,s)}),Jn(()=>{s.destroy()}),r.$$set=c=>{"config"in c&&e(1,n=c.config),"handle"in c&&e(2,s=c.handle),"staticConfig"in c&&e(3,a=c.staticConfig)},r.$$.update=()=>{r.$$.dirty&6&&s.setAttrs(n)},[l,n,s,a]}class f2 extends Nt{constructor(t){super(),Lt(this,t,h2,null,Mt,{config:1,handle:2,staticConfig:3})}}function u2(r,t,e){let i,{config:n}=t,{handle:s=new sr.Image(n)}=t,{staticConfig:a=!1}=t,l=Mo();hi(r,l,c=>e(4,i=c));let o=yn();return Di(()=>{i.add(s),a||(s.on("transformend",()=>{Ke(n,s.getAttrs()),e(1,n)}),s.on("dragend",()=>{Ke(n,s.getAttrs()),e(1,n)})),ar(o,s)}),Jn(()=>{s.destroy()}),r.$$set=c=>{"config"in c&&e(1,n=c.config),"handle"in c&&e(2,s=c.handle),"staticConfig"in c&&e(3,a=c.staticConfig)},r.$$.update=()=>{r.$$.dirty&6&&s.setAttrs(n)},[l,n,s,a]}class d2 extends Nt{constructor(t){super(),Lt(this,t,u2,null,Mt,{config:1,handle:2,staticConfig:3})}}function Il(r){let t;const e=r[6].default,i=Zt(e,r,r[5],null);return{c(){i&&i.c()},l(n){i&&i.l(n)},m(n,s){i&&i.m(n,s),t=!0},p(n,s){i&&i.p&&(!t||s&32)&&$t(i,e,n,n[5],t?ee(e,n[5],s,null):te(n[5]),null)},i(n){t||(O(i,n),t=!0)},o(n){B(i,n),t=!1},d(n){i&&i.d(n)}}}function g2(r){let t,e,i=r[0]&&Il(r);return{c(){i&&i.c(),t=It()},l(n){i&&i.l(n),t=It()},m(n,s){i&&i.m(n,s),G(n,t,s),e=!0},p(n,[s]){n[0]?i?(i.p(n,s),s&1&&O(i,1)):(i=Il(n),i.c(),O(i,1),i.m(t.parentNode,t)):i&&(ae(),B(i,1,1,()=>{i=null}),oe())},i(n){e||(O(i),e=!0)},o(n){B(i),e=!1},d(n){n&&R(t),i&&i.d(n)}}}function p2(r,t,e){let i,{$$slots:n={},$$scope:s}=t,{config:a={}}=t,{handle:l=new sr.Layer(a)}=t,{staticConfig:o=!1}=t,c=bn(null),h=yn(),f=!1,g=c2();return hi(r,g,d=>e(7,i=d)),Di(()=>{i.add(l),o||(l.on("transformend",()=>{Ke(a,l.getAttrs()),e(2,a)}),l.on("dragend",()=>{Ke(a,l.getAttrs()),e(2,a)})),ar(h,l),c.set(l),e(0,f=!0)}),Jn(()=>{l&&l.destroy()}),Vh(Kn.Layer,c),r.$$set=d=>{"config"in d&&e(2,a=d.config),"handle"in d&&e(3,l=d.handle),"staticConfig"in d&&e(4,o=d.staticConfig),"$$scope"in d&&e(5,s=d.$$scope)},r.$$.update=()=>{r.$$.dirty&12&&l&&l.setAttrs(a)},[f,g,a,l,o,s,n]}class m2 extends Nt{constructor(t){super(),Lt(this,t,p2,g2,Mt,{config:2,handle:3,staticConfig:4})}}function _2(r,t,e){let i,{config:n}=t,{handle:s=new sr.Rect(n)}=t,{staticConfig:a=!1}=t,l=Mo();hi(r,l,c=>e(4,i=c));let o=yn();return Di(()=>{i.add(s),a||(s.on("transformend",()=>{Ke(n,s.getAttrs()),e(1,n)}),s.on("dragend",()=>{Ke(n,s.getAttrs()),e(1,n)})),ar(o,s)}),Jn(()=>{s.destroy()}),r.$$set=c=>{"config"in c&&e(1,n=c.config),"handle"in c&&e(2,s=c.handle),"staticConfig"in c&&e(3,a=c.staticConfig)},r.$$.update=()=>{r.$$.dirty&6&&s.setAttrs(n)},[l,n,s,a]}class zh extends Nt{constructor(t){super(),Lt(this,t,_2,null,Mt,{config:1,handle:2,staticConfig:3})}}function Gl(r){let t;const e=r[7].default,i=Zt(e,r,r[6],null);return{c(){i&&i.c()},l(n){i&&i.l(n)},m(n,s){i&&i.m(n,s),t=!0},p(n,s){i&&i.p&&(!t||s&64)&&$t(i,e,n,n[6],t?ee(e,n[6],s,null):te(n[6]),null)},i(n){t||(O(i,n),t=!0)},o(n){B(i,n),t=!1},d(n){i&&i.d(n)}}}function v2(r){let t,e,i=r[1]&&Gl(r),n=[r[2]],s={};for(let a=0;a<n.length;a+=1)s=Q(s,n[a]);return{c(){t=ft("div"),i&&i.c(),this.h()},l(a){t=ut(a,"DIV",{});var l=at(t);i&&i.l(l),l.forEach(R),this.h()},h(){_e(t,s)},m(a,l){G(a,t,l),i&&i.m(t,null),r[8](t),e=!0},p(a,[l]){a[1]?i?(i.p(a,l),l&2&&O(i,1)):(i=Gl(a),i.c(),O(i,1),i.m(t,null)):i&&(ae(),B(i,1,1,()=>{i=null}),oe()),_e(t,s=Kt(n,[l&4&&a[2]]))},i(a){e||(O(i),e=!0)},o(a){B(i),e=!1},d(a){a&&R(t),i&&i.d(),r[8](null)}}}function y2(r,t,e){const i=["config","handle","staticConfig"];let n=yt(t,i),{$$slots:s={},$$scope:a}=t,{config:l}=t,{handle:o=null}=t,{staticConfig:c=!1}=t,h=bn(null),f,g=yn(),d=!1;Di(()=>{e(4,o=new sr.Stage({container:f,...l})),c||o.on("dragend",()=>{Ke(l,o.getAttrs()),e(3,l)}),ar(g,o),h.set(o),e(1,d=!0)}),Jn(()=>{o&&o.destroy()}),Vh(Kn.Stage,h);function p(v){mi[v?"unshift":"push"](()=>{f=v,e(0,f)})}return r.$$set=v=>{t=Q(Q({},t),_t(v)),e(2,n=yt(t,i)),"config"in v&&e(3,l=v.config),"handle"in v&&e(4,o=v.handle),"staticConfig"in v&&e(5,c=v.staticConfig),"$$scope"in v&&e(6,a=v.$$scope)},r.$$.update=()=>{r.$$.dirty&24&&o&&o.setAttrs(l)},[f,d,n,l,o,c,a,s,p]}class b2 extends Nt{constructor(t){super(),Lt(this,t,y2,v2,Mt,{config:3,handle:4,staticConfig:5})}}function Bl(r,t,e){const i=r.slice();return i[9]=t[e],i}function Ul(r){let t,e,i=ke(r[0]),n=[];for(let s=0;s<i.length;s+=1)n[s]=Vl(Bl(r,i,s));return{c(){t=ft("nav"),e=ft("ul");for(let s=0;s<n.length;s+=1)n[s].c();this.h()},l(s){t=ut(s,"NAV",{class:!0,style:!0});var a=at(t);e=ut(a,"UL",{class:!0});var l=at(e);for(let o=0;o<n.length;o+=1)n[o].l(l);l.forEach(R),a.forEach(R),this.h()},h(){J(e,"class","svelte-clk954"),J(t,"class","navbar svelte-clk954"),xn(t,"position","absolute"),xn(t,"top",r[2]+"px"),xn(t,"left",r[1]+"px")},m(s,a){G(s,t,a),kt(t,e);for(let l=0;l<n.length;l+=1)n[l]&&n[l].m(e,null)},p(s,a){if(a&9){i=ke(s[0]);let l;for(l=0;l<i.length;l+=1){const o=Bl(s,i,l);n[l]?n[l].p(o,a):(n[l]=Vl(o),n[l].c(),n[l].m(e,null))}for(;l<n.length;l+=1)n[l].d(1);n.length=i.length}a&4&&xn(t,"top",s[2]+"px"),a&2&&xn(t,"left",s[1]+"px")},d(s){s&&R(t),zn(n,s)}}}function w2(r){let t,e,i=r[9].name+"",n,s,a,l;function o(){return r[8](r[9])}return{c(){t=ft("li"),e=ft("button"),n=At(i),s=pt(),this.h()},l(c){t=ut(c,"LI",{class:!0});var h=at(t);e=ut(h,"BUTTON",{class:!0});var f=at(e);n=Tt(f,i),f.forEach(R),s=mt(h),h.forEach(R),this.h()},h(){J(e,"class","svelte-clk954"),J(t,"class","svelte-clk954")},m(c,h){G(c,t,h),kt(t,e),kt(e,n),kt(t,s),a||(l=W(e,"click",o),a=!0)},p(c,h){r=c,h&1&&i!==(i=r[9].name+"")&&Xe(n,i)},d(c){c&&R(t),a=!1,l()}}}function S2(r){let t,e=r[9].name+"",i;return{c(){t=ft("li"),i=At(e),this.h()},l(n){t=ut(n,"LI",{class:!0});var s=at(t);i=Tt(s,e),s.forEach(R),this.h()},h(){J(t,"class","group svelte-clk954")},m(n,s){G(n,t,s),kt(t,i)},p(n,s){s&1&&e!==(e=n[9].name+"")&&Xe(i,e)},d(n){n&&R(t)}}}function C2(r){let t;return{c(){t=ft("hr"),this.h()},l(e){t=ut(e,"HR",{class:!0}),this.h()},h(){J(t,"class","svelte-clk954")},m(e,i){G(e,t,i)},p:Wt,d(e){e&&R(t)}}}function Vl(r){let t;function e(s,a){return s[9].name===""?C2:s[9].onClick?w2:S2}let i=e(r),n=i(r);return{c(){n.c(),t=It()},l(s){n.l(s),t=It()},m(s,a){n.m(s,a),G(s,t,a)},p(s,a){i===(i=e(s))&&n?n.p(s,a):(n.d(1),n=i(s),n&&(n.c(),n.m(t.parentNode,t)))},d(s){s&&R(t),n.d(s)}}}function A2(r){let t,e,i,n=r[3]&&Ul(r);return{c(){n&&n.c(),t=It()},l(s){n&&n.l(s),t=It()},m(s,a){n&&n.m(s,a),G(s,t,a),e||(i=[W(window,"contextmenu",uf(r[6])),W(window,"click",r[7])],e=!0)},p(s,[a]){s[3]?n?n.p(s,a):(n=Ul(s),n.c(),n.m(t.parentNode,t)):n&&(n.d(1),n=null)},i:Wt,o:Wt,d(s){s&&R(t),n&&n.d(s),e=!1,Ii(i)}}}const zl=16;function T2(r,t,e){let i;const n=(g,d)=>{i.length!==0&&(e(1,a=g-zl),e(2,l=d-zl),e(3,o=!o))},s=g=>e(0,i=g);let a=0,l=0,o=!1;return[i,a,l,o,n,s,()=>e(3,o=!1),()=>e(3,o=!1),g=>{g.onClick&&(e(3,o=!1),g.onClick(g.extra))}]}class P2 extends Nt{constructor(t){super(),Lt(this,t,T2,A2,Mt,{toggleAt:4,setItems:5})}get toggleAt(){return this.$$.ctx[4]}get setItems(){return this.$$.ctx[5]}}function k2(r){let t,e,i,n,s,a,l,o;return{c(){t=ft("p"),e=At(r[0]),i=pt(),n=We("svg"),s=We("path"),a=pt(),l=ft("p"),o=At(r[1]),this.h()},l(c){t=ut(c,"P",{class:!0});var h=at(t);e=Tt(h,r[0]),h.forEach(R),i=mt(c),n=je(c,"svg",{"aria-hidden":!0,class:!0,fill:!0,stroke:!0,viewBox:!0,xmlns:!0});var f=at(n);s=je(f,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),at(s).forEach(R),f.forEach(R),a=mt(c),l=ut(c,"P",{class:!0});var g=at(l);o=Tt(g,r[1]),g.forEach(R),this.h()},h(){J(t,"class","mb-2 text-lg text-gray-500 dark:text-gray-400 font-semibold"),J(s,"stroke-linecap","round"),J(s,"stroke-linejoin","round"),J(s,"stroke-width","2"),J(s,"d","M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"),J(n,"aria-hidden","true"),J(n,"class","mb-3 w-10 h-10 text-gray-400"),J(n,"fill","none"),J(n,"stroke","currentColor"),J(n,"viewBox","0 0 24 24"),J(n,"xmlns","http://www.w3.org/2000/svg"),J(l,"class","mb-2 text-sm text-gray-500 dark:text-gray-400")},m(c,h){G(c,t,h),kt(t,e),G(c,i,h),G(c,n,h),kt(n,s),G(c,a,h),G(c,l,h),kt(l,o)},p(c,h){h&1&&Xe(e,c[0]),h&2&&Xe(o,c[1])},d(c){c&&(R(t),R(i),R(n),R(a),R(l))}}}function x2(r){let t,e;return t=new Pu({props:{class:"m-4",$$slots:{default:[k2]},$$scope:{ctx:r}}}),t.$on("dragover",E2),t.$on("drop",r[2]),t.$on("change",r[3]),{c(){tt(t.$$.fragment)},l(i){et(t.$$.fragment,i)},m(i,n){it(t,i,n),e=!0},p(i,[n]){const s={};n&67&&(s.$$scope={dirty:n,ctx:i}),t.$set(s)},i(i){e||(O(t.$$.fragment,i),e=!0)},o(i){B(t.$$.fragment,i),e=!1},d(i){nt(t,i)}}}const E2=r=>r.preventDefault();function M2(r,t,e){let{title:i}=t,{description:n}=t,{onUpload:s}=t;const a=c=>{const h=new FileReader;h.addEventListener("load",f=>{f.target&&f.target.result&&!(f.target.result instanceof ArrayBuffer)&&s(f.target.result,c.name)}),h.readAsDataURL(c)},l=c=>{if(c.preventDefault(),c.dataTransfer){if(c.dataTransfer.items&&c.dataTransfer.items.length>0){if(c.dataTransfer.items[0].kind==="file"){const h=c.dataTransfer.items[0].getAsFile();h&&a(h)}}else if(c.dataTransfer.files&&c.dataTransfer.files.length>0){const h=c.dataTransfer.files[0];h&&a(h)}}},o=c=>{const h=c.target.files;h&&h.length>0&&a(h[0])};return r.$$set=c=>{"title"in c&&e(0,i=c.title),"description"in c&&e(1,n=c.description),"onUpload"in c&&e(4,s=c.onUpload)},[i,n,l,o,s]}class F2 extends Nt{constructor(t){super(),Lt(this,t,M2,x2,Mt,{title:0,description:1,onUpload:4})}}const Hh=0,R2=1,N2=2,Hl=2,pa=1.25,Wl=1,Br=6*4+4+4,ta=65535,L2=Math.pow(2,-24),ma=Symbol("SKIP_GENERATION");function O2(r){return r.index?r.index.count:r.attributes.position.count}function kn(r){return O2(r)/3}function D2(r,t=ArrayBuffer){return r>65535?new Uint32Array(new t(4*r)):new Uint16Array(new t(2*r))}function I2(r,t){if(!r.index){const e=r.attributes.position.count,i=t.useSharedArrayBuffer?SharedArrayBuffer:ArrayBuffer,n=D2(e,i);r.setIndex(new rs(n,1));for(let s=0;s<e;s++)n[s]=s}}function Wh(r){const t=kn(r),e=r.drawRange,i=e.start/3,n=(e.start+e.count)/3,s=Math.max(0,i),a=Math.min(t,n)-s;return[{offset:Math.floor(s),count:Math.floor(a)}]}function jh(r){if(!r.groups||!r.groups.length)return Wh(r);const t=[],e=new Set,i=r.drawRange,n=i.start/3,s=(i.start+i.count)/3;for(const l of r.groups){const o=l.start/3,c=(l.start+l.count)/3;e.add(Math.max(n,o)),e.add(Math.min(s,c))}const a=Array.from(e.values()).sort((l,o)=>l-o);for(let l=0;l<a.length-1;l++){const o=a[l],c=a[l+1];t.push({offset:Math.floor(o),count:Math.floor(c-o)})}return t}function G2(r){if(r.groups.length===0)return!1;const t=kn(r),e=jh(r).sort((s,a)=>s.offset-a.offset),i=e[e.length-1];i.count=Math.min(t-i.offset,i.count);let n=0;return e.forEach(({count:s})=>n+=s),t!==n}function Rt(r,t,e){return e.min.x=t[r],e.min.y=t[r+1],e.min.z=t[r+2],e.max.x=t[r+3],e.max.y=t[r+4],e.max.z=t[r+5],e}function B2(r){r[0]=r[1]=r[2]=1/0,r[3]=r[4]=r[5]=-1/0}function jl(r){let t=-1,e=-1/0;for(let i=0;i<3;i++){const n=r[i+3]-r[i];n>e&&(e=n,t=i)}return t}function Xl(r,t){t.set(r)}function Yl(r,t,e){let i,n;for(let s=0;s<3;s++){const a=s+3;i=r[s],n=t[s],e[s]=i<n?i:n,i=r[a],n=t[a],e[a]=i>n?i:n}}function gr(r,t,e){for(let i=0;i<3;i++){const n=t[r+2*i],s=t[r+2*i+1],a=n-s,l=n+s;a<e[i]&&(e[i]=a),l>e[i+3]&&(e[i+3]=l)}}function Rn(r){const t=r[3]-r[0],e=r[4]-r[1],i=r[5]-r[2];return 2*(t*e+e*i+i*t)}function _a(r,t,e,i,n=null){let s=1/0,a=1/0,l=1/0,o=-1/0,c=-1/0,h=-1/0,f=1/0,g=1/0,d=1/0,p=-1/0,v=-1/0,b=-1/0;const _=n!==null;for(let w=t*6,u=(t+e)*6;w<u;w+=6){const m=r[w+0],y=r[w+1],S=m-y,T=m+y;S<s&&(s=S),T>o&&(o=T),_&&m<f&&(f=m),_&&m>p&&(p=m);const C=r[w+2],A=r[w+3],P=C-A,k=C+A;P<a&&(a=P),k>c&&(c=k),_&&C<g&&(g=C),_&&C>v&&(v=C);const E=r[w+4],M=r[w+5],F=E-M,N=E+M;F<l&&(l=F),N>h&&(h=N),_&&E<d&&(d=E),_&&E>b&&(b=E)}i[0]=s,i[1]=a,i[2]=l,i[3]=o,i[4]=c,i[5]=h,_&&(n[0]=f,n[1]=g,n[2]=d,n[3]=p,n[4]=v,n[5]=b)}function U2(r,t,e,i){let n=1/0,s=1/0,a=1/0,l=-1/0,o=-1/0,c=-1/0;for(let h=t*6,f=(t+e)*6;h<f;h+=6){const g=r[h+0];g<n&&(n=g),g>l&&(l=g);const d=r[h+2];d<s&&(s=d),d>o&&(o=d);const p=r[h+4];p<a&&(a=p),p>c&&(c=p)}i[0]=n,i[1]=s,i[2]=a,i[3]=l,i[4]=o,i[5]=c}function V2(r,t){B2(t);const e=r.attributes.position,i=r.index?r.index.array:null,n=kn(r),s=new Float32Array(n*6),a=e.normalized,l=e.array,o=e.offset||0;let c=3;e.isInterleavedBufferAttribute&&(c=e.data.stride);const h=["getX","getY","getZ"];for(let f=0;f<n;f++){const g=f*3,d=f*6;let p=g+0,v=g+1,b=g+2;i&&(p=i[p],v=i[v],b=i[b]),a||(p=p*c+o,v=v*c+o,b=b*c+o);for(let _=0;_<3;_++){let w,u,m;a?(w=e[h[_]](p),u=e[h[_]](v),m=e[h[_]](b)):(w=l[p+_],u=l[v+_],m=l[b+_]);let y=w;u<y&&(y=u),m<y&&(y=m);let S=w;u>S&&(S=u),m>S&&(S=m);const T=(S-y)/2,C=_*2;s[d+C+0]=y+T,s[d+C+1]=T+(Math.abs(y)+T)*L2,y<t[_]&&(t[_]=y),S>t[_+3]&&(t[_+3]=S)}}return s}const Ve=32,z2=(r,t)=>r.candidate-t.candidate,ni=new Array(Ve).fill().map(()=>({count:0,bounds:new Float32Array(6),rightCacheBounds:new Float32Array(6),leftCacheBounds:new Float32Array(6),candidate:0})),pr=new Float32Array(6);function H2(r,t,e,i,n,s){let a=-1,l=0;if(s===Hh)a=jl(t),a!==-1&&(l=(t[a]+t[a+3])/2);else if(s===R2)a=jl(r),a!==-1&&(l=W2(e,i,n,a));else if(s===N2){const o=Rn(r);let c=pa*n;const h=i*6,f=(i+n)*6;for(let g=0;g<3;g++){const d=t[g],b=(t[g+3]-d)/Ve;if(n<Ve/4){const _=[...ni];_.length=n;let w=0;for(let m=h;m<f;m+=6,w++){const y=_[w];y.candidate=e[m+2*g],y.count=0;const{bounds:S,leftCacheBounds:T,rightCacheBounds:C}=y;for(let A=0;A<3;A++)C[A]=1/0,C[A+3]=-1/0,T[A]=1/0,T[A+3]=-1/0,S[A]=1/0,S[A+3]=-1/0;gr(m,e,S)}_.sort(z2);let u=n;for(let m=0;m<u;m++){const y=_[m];for(;m+1<u&&_[m+1].candidate===y.candidate;)_.splice(m+1,1),u--}for(let m=h;m<f;m+=6){const y=e[m+2*g];for(let S=0;S<u;S++){const T=_[S];y>=T.candidate?gr(m,e,T.rightCacheBounds):(gr(m,e,T.leftCacheBounds),T.count++)}}for(let m=0;m<u;m++){const y=_[m],S=y.count,T=n-y.count,C=y.leftCacheBounds,A=y.rightCacheBounds;let P=0;S!==0&&(P=Rn(C)/o);let k=0;T!==0&&(k=Rn(A)/o);const E=Wl+pa*(P*S+k*T);E<c&&(a=g,c=E,l=y.candidate)}}else{for(let u=0;u<Ve;u++){const m=ni[u];m.count=0,m.candidate=d+b+u*b;const y=m.bounds;for(let S=0;S<3;S++)y[S]=1/0,y[S+3]=-1/0}for(let u=h;u<f;u+=6){let S=~~((e[u+2*g]-d)/b);S>=Ve&&(S=Ve-1);const T=ni[S];T.count++,gr(u,e,T.bounds)}const _=ni[Ve-1];Xl(_.bounds,_.rightCacheBounds);for(let u=Ve-2;u>=0;u--){const m=ni[u],y=ni[u+1];Yl(m.bounds,y.rightCacheBounds,m.rightCacheBounds)}let w=0;for(let u=0;u<Ve-1;u++){const m=ni[u],y=m.count,S=m.bounds,C=ni[u+1].rightCacheBounds;y!==0&&(w===0?Xl(S,pr):Yl(S,pr,pr)),w+=y;let A=0,P=0;w!==0&&(A=Rn(pr)/o);const k=n-w;k!==0&&(P=Rn(C)/o);const E=Wl+pa*(A*w+P*k);E<c&&(a=g,c=E,l=m.candidate)}}}}else console.warn(`MeshBVH: Invalid build strategy value ${s} used.`);return{axis:a,pos:l}}function W2(r,t,e,i){let n=0;for(let s=t,a=t+e;s<a;s++)n+=r[s*6+i*2];return n/e}class mr{constructor(){}}function j2(r,t,e,i,n,s){let a=i,l=i+n-1;const o=s.pos,c=s.axis*2;for(;;){for(;a<=l&&e[a*6+c]<o;)a++;for(;a<=l&&e[l*6+c]>=o;)l--;if(a<l){for(let h=0;h<3;h++){let f=t[a*3+h];t[a*3+h]=t[l*3+h],t[l*3+h]=f}for(let h=0;h<6;h++){let f=e[a*6+h];e[a*6+h]=e[l*6+h],e[l*6+h]=f}a++,l--}else return a}}function X2(r,t,e,i,n,s){let a=i,l=i+n-1;const o=s.pos,c=s.axis*2;for(;;){for(;a<=l&&e[a*6+c]<o;)a++;for(;a<=l&&e[l*6+c]>=o;)l--;if(a<l){let h=r[a];r[a]=r[l],r[l]=h;for(let f=0;f<6;f++){let g=e[a*6+f];e[a*6+f]=e[l*6+f],e[l*6+f]=g}a++,l--}else return a}}function Y2(r,t){const e=(r.index?r.index.count:r.attributes.position.count)/3,i=e>2**16,n=i?4:2,s=t?new SharedArrayBuffer(e*n):new ArrayBuffer(e*n),a=i?new Uint32Array(s):new Uint16Array(s);for(let l=0,o=a.length;l<o;l++)a[l]=l;return a}function K2(r,t){const e=r.geometry,i=e.index?e.index.array:null,n=t.maxDepth,s=t.verbose,a=t.maxLeafTris,l=t.strategy,o=t.onProgress,c=kn(e),h=r._indirectBuffer;let f=!1;const g=new Float32Array(6),d=new Float32Array(6),p=V2(e,g),v=t.indirect?X2:j2,b=[],_=t.indirect?Wh(e):jh(e);if(_.length===1){const m=_[0],y=new mr;y.boundingData=g,U2(p,m.offset,m.count,d),u(y,m.offset,m.count,d),b.push(y)}else for(let m of _){const y=new mr;y.boundingData=new Float32Array(6),_a(p,m.offset,m.count,y.boundingData,d),u(y,m.offset,m.count,d),b.push(y)}return b;function w(m){o&&o(m/c)}function u(m,y,S,T=null,C=0){if(!f&&C>=n&&(f=!0,s&&(console.warn(`MeshBVH: Max depth of ${n} reached when generating BVH. Consider increasing maxDepth.`),console.warn(e))),S<=a||C>=n)return w(y+S),m.offset=y,m.count=S,m;const A=H2(m.boundingData,T,p,y,S,l);if(A.axis===-1)return w(y+S),m.offset=y,m.count=S,m;const P=v(h,i,p,y,S,A);if(P===y||P===y+S)w(y+S),m.offset=y,m.count=S;else{m.splitAxis=A.axis;const k=new mr,E=y,M=P-y;m.left=k,k.boundingData=new Float32Array(6),_a(p,E,M,k.boundingData,d),u(k,E,M,d,C+1);const F=new mr,N=P,D=S-M;m.right=F,F.boundingData=new Float32Array(6),_a(p,N,D,F.boundingData,d),u(F,N,D,d,C+1)}return m}}function q2(r,t){const e=r.geometry;t.indirect&&(r._indirectBuffer=Y2(e,t.useSharedArrayBuffer),G2(e)&&!t.verbose&&console.warn('MeshBVH: Provided geometry contains groups that do not fully span the vertex contents while using the "indirect" option. BVH may incorrectly report intersections on unrendered portions of the geometry.')),r._indirectBuffer||I2(e,t);const i=K2(r,t);let n,s,a;const l=[],o=t.useSharedArrayBuffer?SharedArrayBuffer:ArrayBuffer;for(let f=0;f<i.length;f++){const g=i[f];let d=c(g);const p=new o(Br*d);n=new Float32Array(p),s=new Uint32Array(p),a=new Uint16Array(p),h(0,g),l.push(p)}r._roots=l;return;function c(f){return f.count?1:1+c(f.left)+c(f.right)}function h(f,g){const d=f/4,p=f/2,v=!!g.count,b=g.boundingData;for(let _=0;_<6;_++)n[d+_]=b[_];if(v){const _=g.offset,w=g.count;return s[d+6]=_,a[p+14]=w,a[p+15]=ta,f+Br}else{const _=g.left,w=g.right,u=g.splitAxis;let m;if(m=h(f+Br,_),m/4>Math.pow(2,32))throw new Error("MeshBVH: Cannot store child pointer greater than 32 bits.");return s[d+6]=m/4,m=h(m,w),s[d+7]=u,m}}}class qe{constructor(){this.min=1/0,this.max=-1/0}setFromPointsField(t,e){let i=1/0,n=-1/0;for(let s=0,a=t.length;s<a;s++){const o=t[s][e];i=o<i?o:i,n=o>n?o:n}this.min=i,this.max=n}setFromPoints(t,e){let i=1/0,n=-1/0;for(let s=0,a=e.length;s<a;s++){const l=e[s],o=t.dot(l);i=o<i?o:i,n=o>n?o:n}this.min=i,this.max=n}isSeparated(t){return this.min>t.max||t.min>this.max}}qe.prototype.setFromBox=function(){const r=new H;return function(e,i){const n=i.min,s=i.max;let a=1/0,l=-1/0;for(let o=0;o<=1;o++)for(let c=0;c<=1;c++)for(let h=0;h<=1;h++){r.x=n.x*o+s.x*(1-o),r.y=n.y*c+s.y*(1-c),r.z=n.z*h+s.z*(1-h);const f=e.dot(r);a=Math.min(f,a),l=Math.max(f,l)}this.min=a,this.max=l}}();const J2=function(){const r=new H,t=new H,e=new H;return function(n,s,a){const l=n.start,o=r,c=s.start,h=t;e.subVectors(l,c),r.subVectors(n.end,n.start),t.subVectors(s.end,s.start);const f=e.dot(h),g=h.dot(o),d=h.dot(h),p=e.dot(o),b=o.dot(o)*d-g*g;let _,w;b!==0?_=(f*g-p*d)/b:_=0,w=(f+_*g)/d,a.x=_,a.y=w}}(),Fo=function(){const r=new Ri,t=new H,e=new H;return function(n,s,a,l){J2(n,s,r);let o=r.x,c=r.y;if(o>=0&&o<=1&&c>=0&&c<=1){n.at(o,a),s.at(c,l);return}else if(o>=0&&o<=1){c<0?s.at(0,l):s.at(1,l),n.closestPointToPoint(l,!0,a);return}else if(c>=0&&c<=1){o<0?n.at(0,a):n.at(1,a),s.closestPointToPoint(a,!0,l);return}else{let h;o<0?h=n.start:h=n.end;let f;c<0?f=s.start:f=s.end;const g=t,d=e;if(n.closestPointToPoint(f,!0,t),s.closestPointToPoint(h,!0,e),g.distanceToSquared(f)<=d.distanceToSquared(h)){a.copy(g),l.copy(f);return}else{a.copy(h),l.copy(d);return}}}}(),Q2=function(){const r=new H,t=new H,e=new oo,i=new me;return function(s,a){const{radius:l,center:o}=s,{a:c,b:h,c:f}=a;if(i.start=c,i.end=h,i.closestPointToPoint(o,!0,r).distanceTo(o)<=l||(i.start=c,i.end=f,i.closestPointToPoint(o,!0,r).distanceTo(o)<=l)||(i.start=h,i.end=f,i.closestPointToPoint(o,!0,r).distanceTo(o)<=l))return!0;const v=a.getPlane(e);if(Math.abs(v.distanceToPoint(o))<=l){const _=v.projectPoint(o,t);if(a.containsPoint(_))return!0}return!1}}(),Z2=1e-15;function va(r){return Math.abs(r)<Z2}class ye extends re{constructor(...t){super(...t),this.isExtendedTriangle=!0,this.satAxes=new Array(4).fill().map(()=>new H),this.satBounds=new Array(4).fill().map(()=>new qe),this.points=[this.a,this.b,this.c],this.sphere=new vf,this.plane=new oo,this.needsUpdate=!0}intersectsSphere(t){return Q2(t,this)}update(){const t=this.a,e=this.b,i=this.c,n=this.points,s=this.satAxes,a=this.satBounds,l=s[0],o=a[0];this.getNormal(l),o.setFromPoints(l,n);const c=s[1],h=a[1];c.subVectors(t,e),h.setFromPoints(c,n);const f=s[2],g=a[2];f.subVectors(e,i),g.setFromPoints(f,n);const d=s[3],p=a[3];d.subVectors(i,t),p.setFromPoints(d,n),this.sphere.setFromPoints(this.points),this.plane.setFromNormalAndCoplanarPoint(l,t),this.needsUpdate=!1}}ye.prototype.closestPointToSegment=function(){const r=new H,t=new H,e=new me;return function(n,s=null,a=null){const{start:l,end:o}=n,c=this.points;let h,f=1/0;for(let g=0;g<3;g++){const d=(g+1)%3;e.start.copy(c[g]),e.end.copy(c[d]),Fo(e,n,r,t),h=r.distanceToSquared(t),h<f&&(f=h,s&&s.copy(r),a&&a.copy(t))}return this.closestPointToPoint(l,r),h=l.distanceToSquared(r),h<f&&(f=h,s&&s.copy(r),a&&a.copy(l)),this.closestPointToPoint(o,r),h=o.distanceToSquared(r),h<f&&(f=h,s&&s.copy(r),a&&a.copy(o)),Math.sqrt(f)}}();ye.prototype.intersectsTriangle=function(){const r=new ye,t=new Array(3),e=new Array(3),i=new qe,n=new qe,s=new H,a=new H,l=new H,o=new H,c=new H,h=new me,f=new me,g=new me,d=new H;function p(v,b,_){const w=v.points;let u=0,m=-1;for(let y=0;y<3;y++){const{start:S,end:T}=h;S.copy(w[y]),T.copy(w[(y+1)%3]),h.delta(a);const C=va(b.distanceToPoint(S));if(va(b.normal.dot(a))&&C){_.copy(h),u=2;break}const A=b.intersectLine(h,d);if(!A&&C&&d.copy(S),(A||C)&&!va(d.distanceTo(T))){if(u<=1)(u===1?_.start:_.end).copy(d),C&&(m=u);else if(u>=2){(m===1?_.start:_.end).copy(d),u=2;break}if(u++,u===2&&m===-1)break}}return u}return function(b,_=null,w=!1){this.needsUpdate&&this.update(),b.isExtendedTriangle?b.needsUpdate&&b.update():(r.copy(b),r.update(),b=r);const u=this.plane,m=b.plane;if(Math.abs(u.normal.dot(m.normal))>1-1e-10){const y=this.satBounds,S=this.satAxes;e[0]=b.a,e[1]=b.b,e[2]=b.c;for(let A=0;A<4;A++){const P=y[A],k=S[A];if(i.setFromPoints(k,e),P.isSeparated(i))return!1}const T=b.satBounds,C=b.satAxes;t[0]=this.a,t[1]=this.b,t[2]=this.c;for(let A=0;A<4;A++){const P=T[A],k=C[A];if(i.setFromPoints(k,t),P.isSeparated(i))return!1}for(let A=0;A<4;A++){const P=S[A];for(let k=0;k<4;k++){const E=C[k];if(s.crossVectors(P,E),i.setFromPoints(s,t),n.setFromPoints(s,e),i.isSeparated(n))return!1}}return _&&(w||console.warn("ExtendedTriangle.intersectsTriangle: Triangles are coplanar which does not support an output edge. Setting edge to 0, 0, 0."),_.start.set(0,0,0),_.end.set(0,0,0)),!0}else{const y=p(this,m,f);if(y===1&&b.containsPoint(f.end))return _&&(_.start.copy(f.end),_.end.copy(f.end)),!0;if(y!==2)return!1;const S=p(b,u,g);if(S===1&&this.containsPoint(g.end))return _&&(_.start.copy(g.end),_.end.copy(g.end)),!0;if(S!==2)return!1;if(f.delta(l),g.delta(o),l.dot(o)<0){let M=g.start;g.start=g.end,g.end=M}const T=f.start.dot(l),C=f.end.dot(l),A=g.start.dot(l),P=g.end.dot(l),k=C<A,E=T<P;return T!==P&&A!==C&&k===E?!1:(_&&(c.subVectors(f.start,g.start),c.dot(l)>0?_.start.copy(f.start):_.start.copy(g.start),c.subVectors(f.end,g.end),c.dot(l)<0?_.end.copy(f.end):_.end.copy(g.end)),!0)}}}();ye.prototype.distanceToPoint=function(){const r=new H;return function(e){return this.closestPointToPoint(e,r),e.distanceTo(r)}}();ye.prototype.distanceToTriangle=function(){const r=new H,t=new H,e=["a","b","c"],i=new me,n=new me;return function(a,l=null,o=null){const c=l||o?i:null;if(this.intersectsTriangle(a,c))return(l||o)&&(l&&c.getCenter(l),o&&c.getCenter(o)),0;let h=1/0;for(let f=0;f<3;f++){let g;const d=e[f],p=a[d];this.closestPointToPoint(p,r),g=p.distanceToSquared(r),g<h&&(h=g,l&&l.copy(r),o&&o.copy(p));const v=this[d];a.closestPointToPoint(v,r),g=v.distanceToSquared(r),g<h&&(h=g,l&&l.copy(v),o&&o.copy(r))}for(let f=0;f<3;f++){const g=e[f],d=e[(f+1)%3];i.set(this[g],this[d]);for(let p=0;p<3;p++){const v=e[p],b=e[(p+1)%3];n.set(a[v],a[b]),Fo(i,n,r,t);const _=r.distanceToSquared(t);_<h&&(h=_,l&&l.copy(r),o&&o.copy(t))}}return Math.sqrt(h)}}();class Qt{constructor(t,e,i){this.isOrientedBox=!0,this.min=new H,this.max=new H,this.matrix=new Me,this.invMatrix=new Me,this.points=new Array(8).fill().map(()=>new H),this.satAxes=new Array(3).fill().map(()=>new H),this.satBounds=new Array(3).fill().map(()=>new qe),this.alignedSatBounds=new Array(3).fill().map(()=>new qe),this.needsUpdate=!1,t&&this.min.copy(t),e&&this.max.copy(e),i&&this.matrix.copy(i)}set(t,e,i){this.min.copy(t),this.max.copy(e),this.matrix.copy(i),this.needsUpdate=!0}copy(t){this.min.copy(t.min),this.max.copy(t.max),this.matrix.copy(t.matrix),this.needsUpdate=!0}}Qt.prototype.update=function(){return function(){const t=this.matrix,e=this.min,i=this.max,n=this.points;for(let c=0;c<=1;c++)for(let h=0;h<=1;h++)for(let f=0;f<=1;f++){const g=1*c|2*h|4*f,d=n[g];d.x=c?i.x:e.x,d.y=h?i.y:e.y,d.z=f?i.z:e.z,d.applyMatrix4(t)}const s=this.satBounds,a=this.satAxes,l=n[0];for(let c=0;c<3;c++){const h=a[c],f=s[c],g=1<<c,d=n[g];h.subVectors(l,d),f.setFromPoints(h,n)}const o=this.alignedSatBounds;o[0].setFromPointsField(n,"x"),o[1].setFromPointsField(n,"y"),o[2].setFromPointsField(n,"z"),this.invMatrix.copy(this.matrix).invert(),this.needsUpdate=!1}}();Qt.prototype.intersectsBox=function(){const r=new qe;return function(e){this.needsUpdate&&this.update();const i=e.min,n=e.max,s=this.satBounds,a=this.satAxes,l=this.alignedSatBounds;if(r.min=i.x,r.max=n.x,l[0].isSeparated(r)||(r.min=i.y,r.max=n.y,l[1].isSeparated(r))||(r.min=i.z,r.max=n.z,l[2].isSeparated(r)))return!1;for(let o=0;o<3;o++){const c=a[o],h=s[o];if(r.setFromBox(c,e),h.isSeparated(r))return!1}return!0}}();Qt.prototype.intersectsTriangle=function(){const r=new ye,t=new Array(3),e=new qe,i=new qe,n=new H;return function(a){this.needsUpdate&&this.update(),a.isExtendedTriangle?a.needsUpdate&&a.update():(r.copy(a),r.update(),a=r);const l=this.satBounds,o=this.satAxes;t[0]=a.a,t[1]=a.b,t[2]=a.c;for(let g=0;g<3;g++){const d=l[g],p=o[g];if(e.setFromPoints(p,t),d.isSeparated(e))return!1}const c=a.satBounds,h=a.satAxes,f=this.points;for(let g=0;g<3;g++){const d=c[g],p=h[g];if(e.setFromPoints(p,f),d.isSeparated(e))return!1}for(let g=0;g<3;g++){const d=o[g];for(let p=0;p<4;p++){const v=h[p];if(n.crossVectors(d,v),e.setFromPoints(n,t),i.setFromPoints(n,f),e.isSeparated(i))return!1}}return!0}}();Qt.prototype.closestPointToPoint=function(){return function(t,e){return this.needsUpdate&&this.update(),e.copy(t).applyMatrix4(this.invMatrix).clamp(this.min,this.max).applyMatrix4(this.matrix),e}}();Qt.prototype.distanceToPoint=function(){const r=new H;return function(e){return this.closestPointToPoint(e,r),e.distanceTo(r)}}();Qt.prototype.distanceToBox=function(){const r=["x","y","z"],t=new Array(12).fill().map(()=>new me),e=new Array(12).fill().map(()=>new me),i=new H,n=new H;return function(a,l=0,o=null,c=null){if(this.needsUpdate&&this.update(),this.intersectsBox(a))return(o||c)&&(a.getCenter(n),this.closestPointToPoint(n,i),a.closestPointToPoint(i,n),o&&o.copy(i),c&&c.copy(n)),0;const h=l*l,f=a.min,g=a.max,d=this.points;let p=1/0;for(let b=0;b<8;b++){const _=d[b];n.copy(_).clamp(f,g);const w=_.distanceToSquared(n);if(w<p&&(p=w,o&&o.copy(_),c&&c.copy(n),w<h))return Math.sqrt(w)}let v=0;for(let b=0;b<3;b++)for(let _=0;_<=1;_++)for(let w=0;w<=1;w++){const u=(b+1)%3,m=(b+2)%3,y=_<<u|w<<m,S=1<<b|_<<u|w<<m,T=d[y],C=d[S];t[v].set(T,C);const P=r[b],k=r[u],E=r[m],M=e[v],F=M.start,N=M.end;F[P]=f[P],F[k]=_?f[k]:g[k],F[E]=w?f[E]:g[k],N[P]=g[P],N[k]=_?f[k]:g[k],N[E]=w?f[E]:g[k],v++}for(let b=0;b<=1;b++)for(let _=0;_<=1;_++)for(let w=0;w<=1;w++){n.x=b?g.x:f.x,n.y=_?g.y:f.y,n.z=w?g.z:f.z,this.closestPointToPoint(n,i);const u=n.distanceToSquared(i);if(u<p&&(p=u,o&&o.copy(i),c&&c.copy(n),u<h))return Math.sqrt(u)}for(let b=0;b<12;b++){const _=t[b];for(let w=0;w<12;w++){const u=e[w];Fo(_,u,i,n);const m=i.distanceToSquared(n);if(m<p&&(p=m,o&&o.copy(i),c&&c.copy(n),m<h))return Math.sqrt(m)}}return Math.sqrt(p)}}();class Ro{constructor(t){this._getNewPrimitive=t,this._primitives=[]}getPrimitive(){const t=this._primitives;return t.length===0?this._getNewPrimitive():t.pop()}releasePrimitive(t){this._primitives.push(t)}}class $2 extends Ro{constructor(){super(()=>new ye)}}const ue=new $2;function ne(r,t){return t[r+15]===65535}function se(r,t){return t[r+6]}function de(r,t){return t[r+14]}function ge(r){return r+8}function pe(r,t){return t[r+6]}function Xh(r,t){return t[r+7]}class t3{constructor(){this.float32Array=null,this.uint16Array=null,this.uint32Array=null;const t=[];let e=null;this.setBuffer=i=>{e&&t.push(e),e=i,this.float32Array=new Float32Array(i),this.uint16Array=new Uint16Array(i),this.uint32Array=new Uint32Array(i)},this.clearBuffer=()=>{e=null,this.float32Array=null,this.uint16Array=null,this.uint32Array=null,t.length!==0&&this.setBuffer(t.pop())}}}const Et=new t3;let li,fn;const $i=[],_r=new Ro(()=>new Te);function e3(r,t,e,i,n,s){li=_r.getPrimitive(),fn=_r.getPrimitive(),$i.push(li,fn),Et.setBuffer(r._roots[t]);const a=Ja(0,r.geometry,e,i,n,s);Et.clearBuffer(),_r.releasePrimitive(li),_r.releasePrimitive(fn),$i.pop(),$i.pop();const l=$i.length;return l>0&&(fn=$i[l-1],li=$i[l-2]),a}function Ja(r,t,e,i,n=null,s=0,a=0){const{float32Array:l,uint16Array:o,uint32Array:c}=Et;let h=r*2;if(ne(h,o)){const g=se(r,c),d=de(h,o);return Rt(r,l,li),i(g,d,!1,a,s+r,li)}else{let P=function(E){const{uint16Array:M,uint32Array:F}=Et;let N=E*2;for(;!ne(N,M);)E=ge(E),N=E*2;return se(E,F)},k=function(E){const{uint16Array:M,uint32Array:F}=Et;let N=E*2;for(;!ne(N,M);)E=pe(E,F),N=E*2;return se(E,F)+de(N,M)};const g=ge(r),d=pe(r,c);let p=g,v=d,b,_,w,u;if(n&&(w=li,u=fn,Rt(p,l,w),Rt(v,l,u),b=n(w),_=n(u),_<b)){p=d,v=g;const E=b;b=_,_=E,w=u}w||(w=li,Rt(p,l,w));const m=ne(p*2,o),y=e(w,m,b,a+1,s+p);let S;if(y===Hl){const E=P(p),F=k(p)-E;S=i(E,F,!0,a+1,s+p,w)}else S=y&&Ja(p,t,e,i,n,s,a+1);if(S)return!0;u=fn,Rt(v,l,u);const T=ne(v*2,o),C=e(u,T,_,a+1,s+v);let A;if(C===Hl){const E=P(v),F=k(v)-E;A=i(E,F,!0,a+1,s+v,u)}else A=C&&Ja(v,t,e,i,n,s,a+1);return!!A}}const Nn=new H,ya=new H;function i3(r,t,e={},i=0,n=1/0){const s=i*i,a=n*n;let l=1/0,o=null;if(r.shapecast({boundsTraverseOrder:h=>(Nn.copy(t).clamp(h.min,h.max),Nn.distanceToSquared(t)),intersectsBounds:(h,f,g)=>g<l&&g<a,intersectsTriangle:(h,f)=>{h.closestPointToPoint(t,Nn);const g=t.distanceToSquared(Nn);return g<l&&(ya.copy(Nn),l=g,o=f),g<s}}),l===1/0)return null;const c=Math.sqrt(l);return e.point?e.point.copy(ya):e.point=ya.clone(),e.distance=c,e.faceIndex=o,e}const tn=new H,en=new H,nn=new H,vr=new Ri,yr=new Ri,br=new Ri,Kl=new H,ql=new H,Jl=new H,wr=new H;function n3(r,t,e,i,n,s){let a;return s===yf?a=r.intersectTriangle(i,e,t,!0,n):a=r.intersectTriangle(t,e,i,s!==lo,n),a===null?null:{distance:r.origin.distanceTo(n),point:n.clone()}}function r3(r,t,e,i,n,s,a,l,o){tn.fromBufferAttribute(t,s),en.fromBufferAttribute(t,a),nn.fromBufferAttribute(t,l);const c=n3(r,tn,en,nn,wr,o);if(c){i&&(vr.fromBufferAttribute(i,s),yr.fromBufferAttribute(i,a),br.fromBufferAttribute(i,l),c.uv=re.getInterpolation(wr,tn,en,nn,vr,yr,br,new Ri)),n&&(vr.fromBufferAttribute(n,s),yr.fromBufferAttribute(n,a),br.fromBufferAttribute(n,l),c.uv1=re.getInterpolation(wr,tn,en,nn,vr,yr,br,new Ri)),e&&(Kl.fromBufferAttribute(e,s),ql.fromBufferAttribute(e,a),Jl.fromBufferAttribute(e,l),c.normal=re.getInterpolation(wr,tn,en,nn,Kl,ql,Jl,new H),c.normal.dot(r.direction)>0&&c.normal.multiplyScalar(-1));const h={a:s,b:a,c:l,normal:new H,materialIndex:0};re.getNormal(tn,en,nn,h.normal),c.face=h,c.faceIndex=s}return c}function ea(r,t,e,i,n){const s=i*3;let a=s+0,l=s+1,o=s+2;const c=r.index;r.index&&(a=c.getX(a),l=c.getX(l),o=c.getX(o));const{position:h,normal:f,uv:g,uv1:d}=r.attributes,p=r3(e,h,f,g,d,a,l,o,t);return p?(p.faceIndex=i,n&&n.push(p),p):null}function Ht(r,t,e,i){const n=r.a,s=r.b,a=r.c;let l=t,o=t+1,c=t+2;e&&(l=e.getX(l),o=e.getX(o),c=e.getX(c)),n.x=i.getX(l),n.y=i.getY(l),n.z=i.getZ(l),s.x=i.getX(o),s.y=i.getY(o),s.z=i.getZ(o),a.x=i.getX(c),a.y=i.getY(c),a.z=i.getZ(c)}function s3(r,t,e,i,n,s){const{geometry:a,_indirectBuffer:l}=r;for(let o=i,c=i+n;o<c;o++)ea(a,t,e,o,s)}function a3(r,t,e,i,n){const{geometry:s,_indirectBuffer:a}=r;let l=1/0,o=null;for(let c=i,h=i+n;c<h;c++){let f;f=ea(s,t,e,c),f&&f.distance<l&&(o=f,l=f.distance)}return o}function o3(r,t,e,i,n,s,a){const{geometry:l}=e,{index:o}=l,c=l.attributes.position;for(let h=r,f=t+r;h<f;h++){let g;if(g=h,Ht(a,g*3,o,c),a.needsUpdate=!0,i(a,g,n,s))return!0}return!1}function l3(r,t=null){t&&Array.isArray(t)&&(t=new Set(t));const e=r.geometry,i=e.index?e.index.array:null,n=e.attributes.position;let s,a,l,o,c=0;const h=r._roots;for(let g=0,d=h.length;g<d;g++)s=h[g],a=new Uint32Array(s),l=new Uint16Array(s),o=new Float32Array(s),f(0,c),c+=s.byteLength;function f(g,d,p=!1){const v=g*2;if(l[v+15]===ta){const _=a[g+6],w=l[v+14];let u=1/0,m=1/0,y=1/0,S=-1/0,T=-1/0,C=-1/0;for(let A=3*_,P=3*(_+w);A<P;A++){let k=i[A];const E=n.getX(k),M=n.getY(k),F=n.getZ(k);E<u&&(u=E),E>S&&(S=E),M<m&&(m=M),M>T&&(T=M),F<y&&(y=F),F>C&&(C=F)}return o[g+0]!==u||o[g+1]!==m||o[g+2]!==y||o[g+3]!==S||o[g+4]!==T||o[g+5]!==C?(o[g+0]=u,o[g+1]=m,o[g+2]=y,o[g+3]=S,o[g+4]=T,o[g+5]=C,!0):!1}else{const _=g+8,w=a[g+6],u=_+d,m=w+d;let y=p,S=!1,T=!1;t?y||(S=t.has(u),T=t.has(m),y=!S&&!T):(S=!0,T=!0);const C=y||S,A=y||T;let P=!1;C&&(P=f(_,d,y));let k=!1;A&&(k=f(w,d,y));const E=P||k;if(E)for(let M=0;M<3;M++){const F=_+M,N=w+M,D=o[F],V=o[F+3],Z=o[N],lt=o[N+3];o[g+M]=D<Z?D:Z,o[g+M+3]=V>lt?V:lt}return E}}}const Ql=new Te;function pi(r,t,e,i){return Rt(r,t,Ql),e.intersectBox(Ql,i)}function c3(r,t,e,i,n,s){const{geometry:a,_indirectBuffer:l}=r;for(let o=i,c=i+n;o<c;o++){let h=l?l[o]:o;ea(a,t,e,h,s)}}function h3(r,t,e,i,n){const{geometry:s,_indirectBuffer:a}=r;let l=1/0,o=null;for(let c=i,h=i+n;c<h;c++){let f;f=ea(s,t,e,a?a[c]:c),f&&f.distance<l&&(o=f,l=f.distance)}return o}function f3(r,t,e,i,n,s,a){const{geometry:l}=e,{index:o}=l,c=l.attributes.position;for(let h=r,f=t+r;h<f;h++){let g;if(g=e.resolveTriangleIndex(h),Ht(a,g*3,o,c),a.needsUpdate=!0,i(a,g,n,s))return!0}return!1}const Zl=new H;function u3(r,t,e,i,n){Et.setBuffer(r._roots[t]),Qa(0,r,e,i,n),Et.clearBuffer()}function Qa(r,t,e,i,n){const{float32Array:s,uint16Array:a,uint32Array:l}=Et,o=r*2;if(ne(o,a)){const h=se(r,l),f=de(o,a);s3(t,e,i,h,f,n)}else{const h=ge(r);pi(h,s,i,Zl)&&Qa(h,t,e,i,n);const f=pe(r,l);pi(f,s,i,Zl)&&Qa(f,t,e,i,n)}}const $l=new H,d3=["x","y","z"];function g3(r,t,e,i){Et.setBuffer(r._roots[t]);const n=Za(0,r,e,i);return Et.clearBuffer(),n}function Za(r,t,e,i){const{float32Array:n,uint16Array:s,uint32Array:a}=Et;let l=r*2;if(ne(l,s)){const c=se(r,a),h=de(l,s);return a3(t,e,i,c,h)}else{const c=Xh(r,a),h=d3[c],g=i.direction[h]>=0;let d,p;g?(d=ge(r),p=pe(r,a)):(d=pe(r,a),p=ge(r));const b=pi(d,n,i,$l)?Za(d,t,e,i):null;if(b){const u=b.point[h];if(g?u<=n[p+c]:u>=n[p+c+3])return b}const w=pi(p,n,i,$l)?Za(p,t,e,i):null;return b&&w?b.distance<=w.distance?b:w:b||w||null}}const Sr=new Te,rn=new ye,sn=new ye,Ln=new Me,tc=new Qt,Cr=new Qt;function p3(r,t,e,i){Et.setBuffer(r._roots[t]);const n=$a(0,r,e,i);return Et.clearBuffer(),n}function $a(r,t,e,i,n=null){const{float32Array:s,uint16Array:a,uint32Array:l}=Et;let o=r*2;if(n===null&&(e.boundingBox||e.computeBoundingBox(),tc.set(e.boundingBox.min,e.boundingBox.max,i),n=tc),ne(o,a)){const h=t.geometry,f=h.index,g=h.attributes.position,d=e.index,p=e.attributes.position,v=se(r,l),b=de(o,a);if(Ln.copy(i).invert(),e.boundsTree)return Rt(r,s,Cr),Cr.matrix.copy(Ln),Cr.needsUpdate=!0,e.boundsTree.shapecast({intersectsBounds:w=>Cr.intersectsBox(w),intersectsTriangle:w=>{w.a.applyMatrix4(i),w.b.applyMatrix4(i),w.c.applyMatrix4(i),w.needsUpdate=!0;for(let u=v*3,m=(b+v)*3;u<m;u+=3)if(Ht(sn,u,f,g),sn.needsUpdate=!0,w.intersectsTriangle(sn))return!0;return!1}});for(let _=v*3,w=(b+v)*3;_<w;_+=3){Ht(rn,_,f,g),rn.a.applyMatrix4(Ln),rn.b.applyMatrix4(Ln),rn.c.applyMatrix4(Ln),rn.needsUpdate=!0;for(let u=0,m=d.count;u<m;u+=3)if(Ht(sn,u,d,p),sn.needsUpdate=!0,rn.intersectsTriangle(sn))return!0}}else{const h=r+8,f=l[r+6];return Rt(h,s,Sr),!!(n.intersectsBox(Sr)&&$a(h,t,e,i,n)||(Rt(f,s,Sr),n.intersectsBox(Sr)&&$a(f,t,e,i,n)))}}const Ar=new Me,ba=new Qt,On=new Qt,m3=new H,_3=new H,v3=new H,y3=new H;function b3(r,t,e,i={},n={},s=0,a=1/0){t.boundingBox||t.computeBoundingBox(),ba.set(t.boundingBox.min,t.boundingBox.max,e),ba.needsUpdate=!0;const l=r.geometry,o=l.attributes.position,c=l.index,h=t.attributes.position,f=t.index,g=ue.getPrimitive(),d=ue.getPrimitive();let p=m3,v=_3,b=null,_=null;n&&(b=v3,_=y3);let w=1/0,u=null,m=null;return Ar.copy(e).invert(),On.matrix.copy(Ar),r.shapecast({boundsTraverseOrder:y=>ba.distanceToBox(y),intersectsBounds:(y,S,T)=>T<w&&T<a?(S&&(On.min.copy(y.min),On.max.copy(y.max),On.needsUpdate=!0),!0):!1,intersectsRange:(y,S)=>{if(t.boundsTree)return t.boundsTree.shapecast({boundsTraverseOrder:C=>On.distanceToBox(C),intersectsBounds:(C,A,P)=>P<w&&P<a,intersectsRange:(C,A)=>{for(let P=C,k=C+A;P<k;P++){Ht(d,3*P,f,h),d.a.applyMatrix4(e),d.b.applyMatrix4(e),d.c.applyMatrix4(e),d.needsUpdate=!0;for(let E=y,M=y+S;E<M;E++){Ht(g,3*E,c,o),g.needsUpdate=!0;const F=g.distanceToTriangle(d,p,b);if(F<w&&(v.copy(p),_&&_.copy(b),w=F,u=E,m=P),F<s)return!0}}}});{const T=kn(t);for(let C=0,A=T;C<A;C++){Ht(d,3*C,f,h),d.a.applyMatrix4(e),d.b.applyMatrix4(e),d.c.applyMatrix4(e),d.needsUpdate=!0;for(let P=y,k=y+S;P<k;P++){Ht(g,3*P,c,o),g.needsUpdate=!0;const E=g.distanceToTriangle(d,p,b);if(E<w&&(v.copy(p),_&&_.copy(b),w=E,u=P,m=C),E<s)return!0}}}}}),ue.releasePrimitive(g),ue.releasePrimitive(d),w===1/0?null:(i.point?i.point.copy(v):i.point=v.clone(),i.distance=w,i.faceIndex=u,n&&(n.point?n.point.copy(_):n.point=_.clone(),n.point.applyMatrix4(Ar),v.applyMatrix4(Ar),n.distance=v.sub(n.point).length(),n.faceIndex=m),i)}function w3(r,t=null){t&&Array.isArray(t)&&(t=new Set(t));const e=r.geometry,i=e.index?e.index.array:null,n=e.attributes.position;let s,a,l,o,c=0;const h=r._roots;for(let g=0,d=h.length;g<d;g++)s=h[g],a=new Uint32Array(s),l=new Uint16Array(s),o=new Float32Array(s),f(0,c),c+=s.byteLength;function f(g,d,p=!1){const v=g*2;if(l[v+15]===ta){const _=a[g+6],w=l[v+14];let u=1/0,m=1/0,y=1/0,S=-1/0,T=-1/0,C=-1/0;for(let A=_,P=_+w;A<P;A++){const k=3*r.resolveTriangleIndex(A);for(let E=0;E<3;E++){let M=k+E;M=i?i[M]:M;const F=n.getX(M),N=n.getY(M),D=n.getZ(M);F<u&&(u=F),F>S&&(S=F),N<m&&(m=N),N>T&&(T=N),D<y&&(y=D),D>C&&(C=D)}}return o[g+0]!==u||o[g+1]!==m||o[g+2]!==y||o[g+3]!==S||o[g+4]!==T||o[g+5]!==C?(o[g+0]=u,o[g+1]=m,o[g+2]=y,o[g+3]=S,o[g+4]=T,o[g+5]=C,!0):!1}else{const _=g+8,w=a[g+6],u=_+d,m=w+d;let y=p,S=!1,T=!1;t?y||(S=t.has(u),T=t.has(m),y=!S&&!T):(S=!0,T=!0);const C=y||S,A=y||T;let P=!1;C&&(P=f(_,d,y));let k=!1;A&&(k=f(w,d,y));const E=P||k;if(E)for(let M=0;M<3;M++){const F=_+M,N=w+M,D=o[F],V=o[F+3],Z=o[N],lt=o[N+3];o[g+M]=D<Z?D:Z,o[g+M+3]=V>lt?V:lt}return E}}}const ec=new H;function S3(r,t,e,i,n){Et.setBuffer(r._roots[t]),to(0,r,e,i,n),Et.clearBuffer()}function to(r,t,e,i,n){const{float32Array:s,uint16Array:a,uint32Array:l}=Et,o=r*2;if(ne(o,a)){const h=se(r,l),f=de(o,a);c3(t,e,i,h,f,n)}else{const h=ge(r);pi(h,s,i,ec)&&to(h,t,e,i,n);const f=pe(r,l);pi(f,s,i,ec)&&to(f,t,e,i,n)}}const ic=new H,C3=["x","y","z"];function A3(r,t,e,i){Et.setBuffer(r._roots[t]);const n=eo(0,r,e,i);return Et.clearBuffer(),n}function eo(r,t,e,i){const{float32Array:n,uint16Array:s,uint32Array:a}=Et;let l=r*2;if(ne(l,s)){const c=se(r,a),h=de(l,s);return h3(t,e,i,c,h)}else{const c=Xh(r,a),h=C3[c],g=i.direction[h]>=0;let d,p;g?(d=ge(r),p=pe(r,a)):(d=pe(r,a),p=ge(r));const b=pi(d,n,i,ic)?eo(d,t,e,i):null;if(b){const u=b.point[h];if(g?u<=n[p+c]:u>=n[p+c+3])return b}const w=pi(p,n,i,ic)?eo(p,t,e,i):null;return b&&w?b.distance<=w.distance?b:w:b||w||null}}const Tr=new Te,an=new ye,on=new ye,Dn=new Me,nc=new Qt,Pr=new Qt;function T3(r,t,e,i){Et.setBuffer(r._roots[t]);const n=io(0,r,e,i);return Et.clearBuffer(),n}function io(r,t,e,i,n=null){const{float32Array:s,uint16Array:a,uint32Array:l}=Et;let o=r*2;if(n===null&&(e.boundingBox||e.computeBoundingBox(),nc.set(e.boundingBox.min,e.boundingBox.max,i),n=nc),ne(o,a)){const h=t.geometry,f=h.index,g=h.attributes.position,d=e.index,p=e.attributes.position,v=se(r,l),b=de(o,a);if(Dn.copy(i).invert(),e.boundsTree)return Rt(r,s,Pr),Pr.matrix.copy(Dn),Pr.needsUpdate=!0,e.boundsTree.shapecast({intersectsBounds:w=>Pr.intersectsBox(w),intersectsTriangle:w=>{w.a.applyMatrix4(i),w.b.applyMatrix4(i),w.c.applyMatrix4(i),w.needsUpdate=!0;for(let u=v,m=b+v;u<m;u++)if(Ht(on,3*t.resolveTriangleIndex(u),f,g),on.needsUpdate=!0,w.intersectsTriangle(on))return!0;return!1}});for(let _=v,w=b+v;_<w;_++){const u=t.resolveTriangleIndex(_);Ht(an,3*u,f,g),an.a.applyMatrix4(Dn),an.b.applyMatrix4(Dn),an.c.applyMatrix4(Dn),an.needsUpdate=!0;for(let m=0,y=d.count;m<y;m+=3)if(Ht(on,m,d,p),on.needsUpdate=!0,an.intersectsTriangle(on))return!0}}else{const h=r+8,f=l[r+6];return Rt(h,s,Tr),!!(n.intersectsBox(Tr)&&io(h,t,e,i,n)||(Rt(f,s,Tr),n.intersectsBox(Tr)&&io(f,t,e,i,n)))}}const kr=new Me,wa=new Qt,In=new Qt,P3=new H,k3=new H,x3=new H,E3=new H;function M3(r,t,e,i={},n={},s=0,a=1/0){t.boundingBox||t.computeBoundingBox(),wa.set(t.boundingBox.min,t.boundingBox.max,e),wa.needsUpdate=!0;const l=r.geometry,o=l.attributes.position,c=l.index,h=t.attributes.position,f=t.index,g=ue.getPrimitive(),d=ue.getPrimitive();let p=P3,v=k3,b=null,_=null;n&&(b=x3,_=E3);let w=1/0,u=null,m=null;return kr.copy(e).invert(),In.matrix.copy(kr),r.shapecast({boundsTraverseOrder:y=>wa.distanceToBox(y),intersectsBounds:(y,S,T)=>T<w&&T<a?(S&&(In.min.copy(y.min),In.max.copy(y.max),In.needsUpdate=!0),!0):!1,intersectsRange:(y,S)=>{if(t.boundsTree){const T=t.boundsTree;return T.shapecast({boundsTraverseOrder:C=>In.distanceToBox(C),intersectsBounds:(C,A,P)=>P<w&&P<a,intersectsRange:(C,A)=>{for(let P=C,k=C+A;P<k;P++){const E=T.resolveTriangleIndex(P);Ht(d,3*E,f,h),d.a.applyMatrix4(e),d.b.applyMatrix4(e),d.c.applyMatrix4(e),d.needsUpdate=!0;for(let M=y,F=y+S;M<F;M++){const N=r.resolveTriangleIndex(M);Ht(g,3*N,c,o),g.needsUpdate=!0;const D=g.distanceToTriangle(d,p,b);if(D<w&&(v.copy(p),_&&_.copy(b),w=D,u=M,m=P),D<s)return!0}}}})}else{const T=kn(t);for(let C=0,A=T;C<A;C++){Ht(d,3*C,f,h),d.a.applyMatrix4(e),d.b.applyMatrix4(e),d.c.applyMatrix4(e),d.needsUpdate=!0;for(let P=y,k=y+S;P<k;P++){const E=r.resolveTriangleIndex(P);Ht(g,3*E,c,o),g.needsUpdate=!0;const M=g.distanceToTriangle(d,p,b);if(M<w&&(v.copy(p),_&&_.copy(b),w=M,u=P,m=C),M<s)return!0}}}}}),ue.releasePrimitive(g),ue.releasePrimitive(d),w===1/0?null:(i.point?i.point.copy(v):i.point=v.clone(),i.distance=w,i.faceIndex=u,n&&(n.point?n.point.copy(_):n.point=_.clone(),n.point.applyMatrix4(kr),v.applyMatrix4(kr),n.distance=v.sub(n.point).length(),n.faceIndex=m),i)}function F3(){return typeof SharedArrayBuffer<"u"}const Hn=new Et.constructor,Zr=new Et.constructor,ai=new Ro(()=>new Te),ln=new Te,cn=new Te,Sa=new Te,Ca=new Te;let Aa=!1;function R3(r,t,e,i){if(Aa)throw new Error("MeshBVH: Recursive calls to bvhcast not supported.");Aa=!0;const n=r._roots,s=t._roots;let a,l=0,o=0;const c=new Me().copy(e).invert();for(let h=0,f=n.length;h<f;h++){Hn.setBuffer(n[h]),o=0;const g=ai.getPrimitive();Rt(0,Hn.float32Array,g),g.applyMatrix4(c);for(let d=0,p=s.length;d<p&&(Zr.setBuffer(s[h]),a=be(0,0,e,c,i,l,o,0,0,g),Zr.clearBuffer(),o+=s[d].length,!a);d++);if(ai.releasePrimitive(g),Hn.clearBuffer(),l+=n[h].length,a)break}return Aa=!1,a}function be(r,t,e,i,n,s=0,a=0,l=0,o=0,c=null,h=!1){let f,g;h?(f=Zr,g=Hn):(f=Hn,g=Zr);const d=f.float32Array,p=f.uint32Array,v=f.uint16Array,b=g.float32Array,_=g.uint32Array,w=g.uint16Array,u=r*2,m=t*2,y=ne(u,v),S=ne(m,w);let T=!1;if(S&&y)h?T=n(se(t,_),de(t*2,w),se(r,p),de(r*2,v),o,a+t,l,s+r):T=n(se(r,p),de(r*2,v),se(t,_),de(t*2,w),l,s+r,o,a+t);else if(S){const C=ai.getPrimitive();Rt(t,b,C),C.applyMatrix4(e);const A=ge(r),P=pe(r,p);Rt(A,d,ln),Rt(P,d,cn);const k=C.intersectsBox(ln),E=C.intersectsBox(cn);T=k&&be(t,A,i,e,n,a,s,o,l+1,C,!h)||E&&be(t,P,i,e,n,a,s,o,l+1,C,!h),ai.releasePrimitive(C)}else{const C=ge(t),A=pe(t,_);Rt(C,b,Sa),Rt(A,b,Ca);const P=c.intersectsBox(Sa),k=c.intersectsBox(Ca);if(P&&k)T=be(r,C,e,i,n,s,a,l,o+1,c,h)||be(r,A,e,i,n,s,a,l,o+1,c,h);else if(P)if(y)T=be(r,C,e,i,n,s,a,l,o+1,c,h);else{const E=ai.getPrimitive();E.copy(Sa).applyMatrix4(e);const M=ge(r),F=pe(r,p);Rt(M,d,ln),Rt(F,d,cn);const N=E.intersectsBox(ln),D=E.intersectsBox(cn);T=N&&be(C,M,i,e,n,a,s,o,l+1,E,!h)||D&&be(C,F,i,e,n,a,s,o,l+1,E,!h),ai.releasePrimitive(E)}else if(k)if(y)T=be(r,A,e,i,n,s,a,l,o+1,c,h);else{const E=ai.getPrimitive();E.copy(Ca).applyMatrix4(e);const M=ge(r),F=pe(r,p);Rt(M,d,ln),Rt(F,d,cn);const N=E.intersectsBox(ln),D=E.intersectsBox(cn);T=N&&be(A,M,i,e,n,a,s,o,l+1,E,!h)||D&&be(A,F,i,e,n,a,s,o,l+1,E,!h),ai.releasePrimitive(E)}}return T}const xr=new Qt,rc=new Te;class No{static serialize(t,e={}){e={cloneBuffers:!0,...e};const i=t.geometry,n=t._roots,s=t._indirectBuffer,a=i.getIndex();let l;return e.cloneBuffers?l={roots:n.map(o=>o.slice()),index:a.array.slice(),indirectBuffer:s?s.slice():null}:l={roots:n,index:a.array,indirectBuffer:s},l}static deserialize(t,e,i={}){i={setIndex:!0,indirect:!!t.indirectBuffer,...i};const{index:n,roots:s,indirectBuffer:a}=t,l=new No(e,{...i,[ma]:!0});if(l._roots=s,l._indirectBuffer=a||null,i.setIndex){const o=e.getIndex();if(o===null){const c=new rs(t.index,1,!1);e.setIndex(c)}else o.array!==n&&(o.array.set(n),o.needsUpdate=!0)}return l}get indirect(){return!!this._indirectBuffer}constructor(t,e={}){if(t.isBufferGeometry){if(t.index&&t.index.isInterleavedBufferAttribute)throw new Error("MeshBVH: InterleavedBufferAttribute is not supported for the index attribute.")}else throw new Error("MeshBVH: Only BufferGeometries are supported.");if(e=Object.assign({strategy:Hh,maxDepth:40,maxLeafTris:10,verbose:!0,useSharedArrayBuffer:!1,setBoundingBox:!0,onProgress:null,indirect:!1,[ma]:!1},e),e.useSharedArrayBuffer&&!F3())throw new Error("MeshBVH: SharedArrayBuffer is not available.");this.geometry=t,this._roots=null,this._indirectBuffer=null,e[ma]||(q2(this,e),!t.boundingBox&&e.setBoundingBox&&(t.boundingBox=this.getBoundingBox(new Te)));const{_indirectBuffer:i}=this;this.resolveTriangleIndex=e.indirect?n=>i[n]:n=>n}refit(t=null){return(this.indirect?w3:l3)(this,t)}traverse(t,e=0){const i=this._roots[e],n=new Uint32Array(i),s=new Uint16Array(i);a(0);function a(l,o=0){const c=l*2,h=s[c+15]===ta;if(h){const f=n[l+6],g=s[c+14];t(o,h,new Float32Array(i,l*4,6),f,g)}else{const f=l+Br/4,g=n[l+6],d=n[l+7];t(o,h,new Float32Array(i,l*4,6),d)||(a(f,o+1),a(g,o+1))}}}raycast(t,e=Go){const i=this._roots,n=this.geometry,s=[],a=e.isMaterial,l=Array.isArray(e),o=n.groups,c=a?e.side:e,h=this.indirect?S3:u3;for(let f=0,g=i.length;f<g;f++){const d=l?e[o[f].materialIndex].side:c,p=s.length;if(h(this,f,d,t,s),l){const v=o[f].materialIndex;for(let b=p,_=s.length;b<_;b++)s[b].face.materialIndex=v}}return s}raycastFirst(t,e=Go){const i=this._roots,n=this.geometry,s=e.isMaterial,a=Array.isArray(e);let l=null;const o=n.groups,c=s?e.side:e,h=this.indirect?A3:g3;for(let f=0,g=i.length;f<g;f++){const d=a?e[o[f].materialIndex].side:c,p=h(this,f,d,t);p!=null&&(l==null||p.distance<l.distance)&&(l=p,a&&(p.face.materialIndex=o[f].materialIndex))}return l}intersectsGeometry(t,e){let i=!1;const n=this._roots,s=this.indirect?T3:p3;for(let a=0,l=n.length;a<l&&(i=s(this,a,t,e),!i);a++);return i}shapecast(t){const e=ue.getPrimitive(),i=this.indirect?f3:o3;let{boundsTraverseOrder:n,intersectsBounds:s,intersectsRange:a,intersectsTriangle:l}=t;if(a&&l){const f=a;a=(g,d,p,v,b)=>f(g,d,p,v,b)?!0:i(g,d,this,l,p,v,e)}else a||(l?a=(f,g,d,p)=>i(f,g,this,l,d,p,e):a=(f,g,d)=>d);let o=!1,c=0;const h=this._roots;for(let f=0,g=h.length;f<g;f++){const d=h[f];if(o=e3(this,f,s,a,n,c),o)break;c+=d.byteLength}return ue.releasePrimitive(e),o}bvhcast(t,e,i){let{intersectsRanges:n,intersectsTriangles:s}=i;const a=ue.getPrimitive(),l=this.geometry.index,o=this.geometry.attributes.position,c=this.indirect?p=>{const v=this.resolveTriangleIndex(p);Ht(a,v*3,l,o)}:p=>{Ht(a,p*3,l,o)},h=ue.getPrimitive(),f=t.geometry.index,g=t.geometry.attributes.position,d=t.indirect?p=>{const v=t.resolveTriangleIndex(p);Ht(h,v*3,f,g)}:p=>{Ht(h,p*3,f,g)};if(s){const p=(v,b,_,w,u,m,y,S)=>{for(let T=_,C=_+w;T<C;T++){d(T),h.a.applyMatrix4(e),h.b.applyMatrix4(e),h.c.applyMatrix4(e),h.needsUpdate=!0;for(let A=v,P=v+b;A<P;A++)if(c(A),a.needsUpdate=!0,s(a,h,A,T,u,m,y,S))return!0}return!1};if(n){const v=n;n=function(b,_,w,u,m,y,S,T){return v(b,_,w,u,m,y,S,T)?!0:p(b,_,w,u,m,y,S,T)}}else n=p}return R3(this,t,e,n)}intersectsBox(t,e){return xr.set(t.min,t.max,e),xr.needsUpdate=!0,this.shapecast({intersectsBounds:i=>xr.intersectsBox(i),intersectsTriangle:i=>xr.intersectsTriangle(i)})}intersectsSphere(t){return this.shapecast({intersectsBounds:e=>t.intersectsBox(e),intersectsTriangle:e=>e.intersectsSphere(t)})}closestPointToGeometry(t,e,i={},n={},s=0,a=1/0){return(this.indirect?M3:b3)(this,t,e,i,n,s,a)}closestPointToPoint(t,e={},i=0,n=1/0){return i3(this,t,e,i,n)}getBoundingBox(t){return t.makeEmpty(),this._roots.forEach(i=>{Rt(0,new Float32Array(i),rc),t.union(rc)}),t}}const Yh=1e-6,N3=Yh*.5,Kh=Math.pow(10,-Math.log10(Yh)),L3=N3*Kh;function Ee(r){return~~(r*Kh+L3)}function O3(r){return`${Ee(r.x)},${Ee(r.y)}`}function sc(r){return`${Ee(r.x)},${Ee(r.y)},${Ee(r.z)}`}function D3(r){return`${Ee(r.x)},${Ee(r.y)},${Ee(r.z)},${Ee(r.w)}`}function I3(r,t,e){e.direction.subVectors(t,r).normalize();const i=r.dot(e.direction);return e.origin.copy(r).addScaledVector(e.direction,-i),e}function qh(){return typeof SharedArrayBuffer<"u"}function G3(r){if(r.buffer instanceof SharedArrayBuffer)return r;const t=r.constructor,e=r.buffer,i=new SharedArrayBuffer(e.byteLength),n=new Uint8Array(e);return new Uint8Array(i).set(n,0),new t(i)}function B3(r,t=ArrayBuffer){return r>65535?new Uint32Array(new t(4*r)):new Uint16Array(new t(2*r))}function U3(r,t){if(!r.index){const e=r.attributes.position.count,i=t.useSharedArrayBuffer?SharedArrayBuffer:ArrayBuffer,n=B3(e,i);r.setIndex(new rs(n,1));for(let s=0;s<e;s++)n[s]=s}}function V3(r){return r.index?r.index.count:r.attributes.position.count}function Lo(r){return V3(r)/3}const z3=1e-8,H3=new H;function W3(r){return~~(r/3)}function j3(r){return r%3}function ac(r,t){return r.start-t.start}function oc(r,t){return H3.subVectors(t,r.origin).dot(r.direction)}function X3(r,t,e,i=z3){r.sort(ac),t.sort(ac);for(let l=0;l<r.length;l++){const o=r[l];for(let c=0;c<t.length;c++){const h=t[c];if(!(h.start>o.end)){if(o.end<h.start||h.end<o.start)continue;if(o.start<=h.start&&o.end>=h.end)s(h.end,o.end)||r.splice(l+1,0,{start:h.end,end:o.end,index:o.index}),o.end=h.start,h.start=0,h.end=0;else if(o.start>=h.start&&o.end<=h.end)s(o.end,h.end)||t.splice(c+1,0,{start:o.end,end:h.end,index:h.index}),h.end=o.start,o.start=0,o.end=0;else if(o.start<=h.start&&o.end<=h.end){const f=o.end;o.end=h.start,h.start=f}else if(o.start>=h.start&&o.end>=h.end){const f=h.end;h.end=o.start,o.start=f}else throw new Error}if(e.has(o.index)||e.set(o.index,[]),e.has(h.index)||e.set(h.index,[]),e.get(o.index).push(h.index),e.get(h.index).push(o.index),a(h)&&(t.splice(c,1),c--),a(o)){r.splice(l,1),l--;break}}}n(r),n(t);function n(l){for(let o=0;o<l.length;o++)a(l[o])&&(l.splice(o,1),o--)}function s(l,o){return Math.abs(o-l)<i}function a(l){return Math.abs(l.end-l.start)<i}}const lc=1e-5,cc=1e-4;class Y3{constructor(){this._rays=[]}addRay(t){this._rays.push(t)}findClosestRay(t){const e=this._rays,i=t.clone();i.direction.multiplyScalar(-1);let n=1/0,s=null;for(let o=0,c=e.length;o<c;o++){const h=e[o];if(a(h,t)&&a(h,i))continue;const f=l(h,t),g=l(h,i),d=Math.min(f,g);d<n&&(n=d,s=h)}return s;function a(o,c){const h=o.origin.distanceTo(c.origin)>lc;return o.direction.angleTo(c.direction)>cc||h}function l(o,c){const h=o.origin.distanceTo(c.origin),f=o.direction.angleTo(c.direction);return h/lc+f/cc}}}const Ta=new H,Pa=new H,Er=new Gc;function K3(r,t,e){const i=r.attributes,n=r.index,s=i.position,a=new Map,l=new Map,o=Array.from(t),c=new Y3;for(let h=0,f=o.length;h<f;h++){const g=o[h],d=W3(g),p=j3(g);let v=3*d+p,b=3*d+(p+1)%3;n&&(v=n.getX(v),b=n.getX(b)),Ta.fromBufferAttribute(s,v),Pa.fromBufferAttribute(s,b),I3(Ta,Pa,Er);let _,w=c.findClosestRay(Er);w===null&&(w=Er.clone(),c.addRay(w)),l.has(w)||l.set(w,{forward:[],reverse:[],ray:w}),_=l.get(w);let u=oc(w,Ta),m=oc(w,Pa);u>m&&([u,m]=[m,u]),Er.direction.dot(w.direction)<0?_.reverse.push({start:u,end:m,index:g}):_.forward.push({start:u,end:m,index:g})}return l.forEach(({forward:h,reverse:f},g)=>{X3(h,f,a,e),h.length===0&&f.length===0&&l.delete(g)}),{disjointConnectivityMap:a,fragmentMap:l}}const q3=new Ri,ka=new H,J3=new Gi,xa=["","",""];class Q3{constructor(t=null){this.data=null,this.disjointConnections=null,this.unmatchedDisjointEdges=null,this.unmatchedEdges=-1,this.matchedEdges=-1,this.useDrawRange=!0,this.useAllAttributes=!1,this.matchDisjointEdges=!1,this.degenerateEpsilon=1e-8,t&&this.updateFrom(t)}getSiblingTriangleIndex(t,e){const i=this.data[t*3+e];return i===-1?-1:~~(i/3)}getSiblingEdgeIndex(t,e){const i=this.data[t*3+e];return i===-1?-1:i%3}getDisjointSiblingTriangleIndices(t,e){const i=t*3+e,n=this.disjointConnections.get(i);return n?n.map(s=>~~(s/3)):[]}getDisjointSiblingEdgeIndices(t,e){const i=t*3+e,n=this.disjointConnections.get(i);return n?n.map(s=>s%3):[]}isFullyConnected(){return this.unmatchedEdges===0}updateFrom(t){const{useAllAttributes:e,useDrawRange:i,matchDisjointEdges:n,degenerateEpsilon:s}=this,a=e?u:w,l=new Map,{attributes:o}=t,c=e?Object.keys(o):null,h=t.index,f=o.position;let g=Lo(t);const d=g;let p=0;i&&(p=t.drawRange.start,t.drawRange.count!==1/0&&(g=~~(t.drawRange.count/3)));let v=this.data;(!v||v.length<3*d)&&(v=new Int32Array(3*d)),v.fill(-1);let b=0,_=new Set;for(let m=p,y=g*3+p;m<y;m+=3){const S=m;for(let T=0;T<3;T++){let C=S+T;h&&(C=h.getX(C)),xa[T]=a(C)}for(let T=0;T<3;T++){const C=(T+1)%3,A=xa[T],P=xa[C],k=`${P}_${A}`;if(l.has(k)){const E=S+T,M=l.get(k);v[E]=M,v[M]=E,l.delete(k),b+=2,_.delete(M)}else{const E=`${A}_${P}`,M=S+T;l.set(E,M),_.add(M)}}}if(n){const{fragmentMap:m,disjointConnectivityMap:y}=K3(t,_,s);_.clear(),m.forEach(({forward:S,reverse:T})=>{S.forEach(({index:C})=>_.add(C)),T.forEach(({index:C})=>_.add(C))}),this.unmatchedDisjointEdges=m,this.disjointConnections=y,b=g*3-_.size}this.matchedEdges=b,this.unmatchedEdges=_.size,this.data=v;function w(m){return ka.fromBufferAttribute(f,m),sc(ka)}function u(m){let y="";for(let S=0,T=c.length;S<T;S++){const C=o[c[S]];let A;switch(C.itemSize){case 1:A=Ee(C.getX(m));break;case 2:A=O3(q3.fromBufferAttribute(C,m));break;case 3:A=sc(ka.fromBufferAttribute(C,m));break;case 4:A=D3(J3.fromBufferAttribute(C,m));break}y!==""&&(y+="|"),y+=A}return y}}}class no extends bf{constructor(...t){super(...t),this.isBrush=!0,this._previousMatrix=new Me,this._previousMatrix.elements.fill(0)}markUpdated(){this._previousMatrix.copy(this.matrix)}isDirty(){const{matrix:t,_previousMatrix:e}=this,i=t.elements,n=e.elements;for(let s=0;s<16;s++)if(i[s]!==n[s])return!0;return!1}prepareGeometry(){const t=this.geometry,e=t.attributes,i=qh();if(i)for(const n in e){const s=e[n];if(s.isInterleavedBufferAttribute)throw new Error("Brush: InterleavedBufferAttributes are not supported.");s.array=G3(s.array)}if(t.boundsTree||(U3(t,{useSharedArrayBuffer:i}),t.boundsTree=new No(t,{maxLeafTris:3,indirect:!0,useSharedArrayBuffer:i})),t.halfEdges||(t.halfEdges=new Q3(t)),!t.groupIndices){const n=Lo(t),s=new Uint16Array(n),a=t.groups;for(let l=0,o=a.length;l<o;l++){const{start:c,count:h}=a[l];for(let f=c/3,g=(c+h)/3;f<g;f++)s[f]=l}t.groupIndices=s}}disposeCacheData(){const{geometry:t}=this;t.halfEdges=null,t.boundsTree=null,t.groupIndices=null}}const Z3=1e-14,Ea=new H,hc=new H,fc=new H;function oi(r,t=Z3){Ea.subVectors(r.b,r.a),hc.subVectors(r.c,r.a),fc.subVectors(r.b,r.c);const e=Ea.angleTo(hc),i=Ea.angleTo(fc),n=Math.PI-e-i;return Math.abs(e)<t||Math.abs(i)<t||Math.abs(n)<t||r.a.distanceToSquared(r.b)<t||r.a.distanceToSquared(r.c)<t||r.b.distanceToSquared(r.c)<t}const Ma=1e-10,Gn=1e-10,$3=1e-10,Ie=new me,Ut=new me,Ge=new H,Fa=new H,uc=new H,Mr=new oo,Ra=new ye;class t5{constructor(){this._pool=[],this._index=0}getTriangle(){return this._index>=this._pool.length&&this._pool.push(new re),this._pool[this._index++]}clear(){this._index=0}reset(){this._pool.length=0,this._index=0}}class e5{constructor(){this.trianglePool=new t5,this.triangles=[],this.normal=new H,this.coplanarTriangleUsed=!1}initialize(t){this.reset();const{triangles:e,trianglePool:i,normal:n}=this;if(Array.isArray(t))for(let s=0,a=t.length;s<a;s++){const l=t[s];if(s===0)l.getNormal(n);else if(Math.abs(1-l.getNormal(Ge).dot(n))>Ma)throw new Error("Triangle Splitter: Cannot initialize with triangles that have different normals.");const o=i.getTriangle();o.copy(l),e.push(o)}else{t.getNormal(n);const s=i.getTriangle();s.copy(t),e.push(s)}}splitByTriangle(t){const{normal:e,triangles:i}=this;if(t.getNormal(Fa).normalize(),Math.abs(1-Math.abs(Fa.dot(e)))<$3){this.coplanarTriangleUsed=!0;for(let s=0,a=i.length;s<a;s++){const l=i[s];l.coplanarCount=0}const n=[t.a,t.b,t.c];for(let s=0;s<3;s++){const a=(s+1)%3,l=n[s],o=n[a];Ge.subVectors(o,l).normalize(),uc.crossVectors(Fa,Ge),Mr.setFromNormalAndCoplanarPoint(uc,l),this.splitByPlane(Mr,t)}}else t.getPlane(Mr),this.splitByPlane(Mr,t)}splitByPlane(t,e){const{triangles:i,trianglePool:n}=this;Ra.copy(e),Ra.needsUpdate=!0;for(let s=0,a=i.length;s<a;s++){const l=i[s];if(!Ra.intersectsTriangle(l,Ie,!0))continue;const{a:o,b:c,c:h}=l;let f=0,g=-1,d=!1,p=[],v=[];const b=[o,c,h];for(let _=0;_<3;_++){const w=(_+1)%3;Ie.start.copy(b[_]),Ie.end.copy(b[w]);const u=t.distanceToPoint(Ie.start),m=t.distanceToPoint(Ie.end);if(Math.abs(u)<Gn&&Math.abs(m)<Gn){d=!0;break}if(u>0?p.push(_):v.push(_),Math.abs(u)<Gn)continue;let y=!!t.intersectLine(Ie,Ge);!y&&Math.abs(m)<Gn&&(Ge.copy(Ie.end),y=!0),y&&!(Ge.distanceTo(Ie.start)<Ma)&&(Ge.distanceTo(Ie.end)<Ma&&(g=_),f===0?Ut.start.copy(Ge):Ut.end.copy(Ge),f++)}if(!d&&f===2&&Ut.distance()>Gn)if(g!==-1){g=(g+1)%3;let _=0;_===g&&(_=(_+1)%3);let w=_+1;w===g&&(w=(w+1)%3);const u=n.getTriangle();u.a.copy(b[w]),u.b.copy(Ut.end),u.c.copy(Ut.start),oi(u)||i.push(u),l.a.copy(b[_]),l.b.copy(Ut.start),l.c.copy(Ut.end),oi(l)&&(i.splice(s,1),s--,a--)}else{const _=p.length>=2?v[0]:p[0];if(_===0){let S=Ut.start;Ut.start=Ut.end,Ut.end=S}const w=(_+1)%3,u=(_+2)%3,m=n.getTriangle(),y=n.getTriangle();b[w].distanceToSquared(Ut.start)<b[u].distanceToSquared(Ut.end)?(m.a.copy(b[w]),m.b.copy(Ut.start),m.c.copy(Ut.end),y.a.copy(b[w]),y.b.copy(b[u]),y.c.copy(Ut.start)):(m.a.copy(b[u]),m.b.copy(Ut.start),m.c.copy(Ut.end),y.a.copy(b[w]),y.b.copy(b[u]),y.c.copy(Ut.end)),l.a.copy(b[_]),l.b.copy(Ut.end),l.c.copy(Ut.start),oi(m)||i.push(m),oi(y)||i.push(y),oi(l)&&(i.splice(s,1),s--,a--)}else f===3&&console.warn("TriangleClipper: Coplanar clip not handled")}}reset(){this.triangles.length=0,this.trianglePool.clear(),this.coplanarTriangleUsed=!1}}function i5(r){return r=~~r,r+4-r%4}class dc{constructor(t,e=500){this.expansionFactor=1.5,this.type=t,this.length=0,this.array=null,this.setSize(e)}setType(t){if(this.length!==0)throw new Error("TypeBackedArray: Cannot change the type while there is used data in the buffer.");const e=this.array.buffer;this.array=new t(e),this.type=t}setSize(t){if(this.array&&t===this.array.length)return;const e=this.type,i=qh()?SharedArrayBuffer:ArrayBuffer,n=new e(new i(i5(t*e.BYTES_PER_ELEMENT)));this.array&&n.set(this.array,0),this.array=n}expand(){const{array:t,expansionFactor:e}=this;this.setSize(t.length*e)}push(...t){let{array:e,length:i}=this;i+t.length>e.length&&(this.expand(),e=this.array);for(let n=0,s=t.length;n<s;n++)e[i+n]=t[n];this.length+=t.length}clear(){this.length=0}}class n5{constructor(){this.groupAttributes=[{}],this.groupCount=0}getType(t){return this.groupAttributes[0][t].type}getItemSize(t){return this.groupAttributes[0][t].itemSize}getNormalized(t){return this.groupAttributes[0][t].normalized}getCount(t){if(this.groupCount<=t)return 0;const e=this.getGroupAttrArray("position",t);return e.length/e.itemSize}getTotalLength(t){const{groupCount:e,groupAttributes:i}=this;let n=0;for(let s=0;s<e;s++){const a=i[s];n+=a[t].length}return n}getGroupAttrSet(t=0){const{groupAttributes:e}=this;if(e[t])return this.groupCount=Math.max(this.groupCount,t+1),e[t];const i=e[0];for(this.groupCount=Math.max(this.groupCount,t+1);t>=e.length;){const n={};e.push(n);for(const s in i){const a=i[s],l=new dc(a.type);l.itemSize=a.itemSize,l.normalized=a.normalized,n[s]=l}}return e[t]}getGroupAttrArray(t,e=0){const{groupAttributes:i}=this;if(!i[0][t])throw new Error(`TypedAttributeData: Attribute with "${t}" has not been initialized`);return this.getGroupAttrSet(e)[t]}initializeArray(t,e,i,n){const{groupAttributes:s}=this,l=s[0][t];if(l){if(l.type!==e)for(let o=0,c=s.length;o<c;o++){const h=s[o][t];h.setType(e),h.itemSize=i,h.normalized=n}}else for(let o=0,c=s.length;o<c;o++){const h=new dc(e);h.itemSize=i,h.normalized=n,s[o][t]=h}}clear(){this.groupCount=0;const{groupAttributes:t}=this;t.forEach(e=>{for(const i in e)e[i].clear()})}delete(t){this.groupAttributes.forEach(e=>{delete e[t]})}reset(){this.groupAttributes=[],this.groupCount=0}}class gc{constructor(){this.intersectionSet={},this.ids=[]}add(t,e){const{intersectionSet:i,ids:n}=this;i[t]||(i[t]=[],n.push(t)),i[t].push(e)}}const Jh=0,Vn=1,r5=2,s5=3,a5=4,Qh=5,Zh=6,fe=new Gc,pc=new Me,Jt=new re,Be=new H,mc=new Gi,_c=new Gi,vc=new Gi,Na=new Gi,Fr=new Gi,Rr=new Gi,yc=new me,La=new H,Oa=1e-8,o5=1e-15,ki=-1,xi=1,Ur=-2,Vr=2,Wn=0,Ai=1,Oo=2,l5=1e-14;let zr=null;function bc(r){zr=r}function $h(r,t){r.getMidpoint(fe.origin),r.getNormal(fe.direction);const e=t.raycastFirst(fe,lo);return!!(e&&fe.direction.dot(e.face.normal)>0)?ki:xi}function c5(r,t){function e(){return Math.random()-.5}r.getNormal(La),fe.direction.copy(La),r.getMidpoint(fe.origin);const i=3;let n=0,s=1/0;for(let a=0;a<i;a++){fe.direction.x+=e()*Oa,fe.direction.y+=e()*Oa,fe.direction.z+=e()*Oa,fe.direction.multiplyScalar(-1);const l=t.raycastFirst(fe,lo);if(!!(l&&fe.direction.dot(l.face.normal)>0)&&n++,l!==null&&(s=Math.min(s,l.distance)),s<=o5)return l.face.normal.dot(La)>0?Vr:Ur;if(n/i>.5||(a-n+1)/i>.5)break}return n/i>.5?ki:xi}function h5(r,t){const e=new gc,i=new gc;return pc.copy(r.matrixWorld).invert().multiply(t.matrixWorld),r.geometry.boundsTree.bvhcast(t.geometry.boundsTree,pc,{intersectsTriangles(n,s,a,l){if(!oi(n)&&!oi(s)){let o=n.intersectsTriangle(s,yc,!0);if(!o){const c=n.plane,h=s.plane,f=c.normal,g=h.normal;f.dot(g)===1&&Math.abs(c.constant-h.constant)<l5&&(o=!0)}if(o){let c=r.geometry.boundsTree.resolveTriangleIndex(a),h=t.geometry.boundsTree.resolveTriangleIndex(l);e.add(c,h),i.add(h,c),zr&&(zr.addEdge(yc),zr.addIntersectingTriangles(a,n,l,s))}}return!1}}),{aIntersections:e,bIntersections:i}}function f5(r,t,e,i,n,s,a=!1){const l=e.attributes,o=e.index,c=r*3,h=o.getX(c+0),f=o.getX(c+1),g=o.getX(c+2);for(const d in s){const p=l[d],v=s[d];if(!(d in l))throw new Error(`CSG Operations: Attribute ${d} not available on geometry.`);const b=p.itemSize;d==="position"?(Jt.a.fromBufferAttribute(p,h).applyMatrix4(i),Jt.b.fromBufferAttribute(p,f).applyMatrix4(i),Jt.c.fromBufferAttribute(p,g).applyMatrix4(i),Da(Jt.a,Jt.b,Jt.c,t,3,v,a)):d==="normal"?(Jt.a.fromBufferAttribute(p,h).applyNormalMatrix(n),Jt.b.fromBufferAttribute(p,f).applyNormalMatrix(n),Jt.c.fromBufferAttribute(p,g).applyNormalMatrix(n),a&&(Jt.a.multiplyScalar(-1),Jt.b.multiplyScalar(-1),Jt.c.multiplyScalar(-1)),Da(Jt.a,Jt.b,Jt.c,t,3,v,a,!0)):(mc.fromBufferAttribute(p,h),_c.fromBufferAttribute(p,f),vc.fromBufferAttribute(p,g),Da(mc,_c,vc,t,b,v,a))}}function u5(r,t,e,i,n,s,a,l=!1){Ia(r,i,n,s,a,l),Ia(l?e:t,i,n,s,a,l),Ia(l?t:e,i,n,s,a,l)}function tf(r,t,e=!1){switch(r){case Jh:if(t===xi||t===Vr&&!e)return Ai;break;case Vn:if(e){if(t===ki)return Wn}else if(t===xi||t===Ur)return Ai;break;case r5:if(e){if(t===xi||t===Ur)return Ai}else if(t===ki)return Wn;break;case a5:if(t===ki)return Wn;if(t===xi)return Ai;break;case s5:if(t===ki||t===Vr&&!e)return Ai;break;case Qh:if(!e&&(t===xi||t===Ur))return Ai;break;case Zh:if(!e&&(t===ki||t===Vr))return Ai;break;default:throw new Error(`Unrecognized CSG operation enum "${r}".`)}return Oo}function Da(r,t,e,i,n,s,a=!1,l=!1){const o=c=>{s.push(c.x),n>1&&s.push(c.y),n>2&&s.push(c.z),n>3&&s.push(c.w)};Na.set(0,0,0,0).addScaledVector(r,i.a.x).addScaledVector(t,i.a.y).addScaledVector(e,i.a.z),Fr.set(0,0,0,0).addScaledVector(r,i.b.x).addScaledVector(t,i.b.y).addScaledVector(e,i.b.z),Rr.set(0,0,0,0).addScaledVector(r,i.c.x).addScaledVector(t,i.c.y).addScaledVector(e,i.c.z),l&&(Na.normalize(),Fr.normalize(),Rr.normalize()),o(Na),a?(o(Rr),o(Fr)):(o(Fr),o(Rr))}function Ia(r,t,e,i,n,s=!1){for(const a in n){const l=t[a],o=n[a];if(!(a in t))throw new Error(`CSG Operations: Attribute ${a} no available on geometry.`);const c=l.itemSize;a==="position"?(Be.fromBufferAttribute(l,r).applyMatrix4(e),o.push(Be.x,Be.y,Be.z)):a==="normal"?(Be.fromBufferAttribute(l,r).applyNormalMatrix(i),s&&Be.multiplyScalar(-1),o.push(Be.x,Be.y,Be.z)):(o.push(l.getX(r)),c>1&&o.push(l.getY(r)),c>2&&o.push(l.getZ(r)),c>3&&o.push(l.getW(r)))}}class d5{constructor(t){this.triangle=new re().copy(t),this.intersects={}}addTriangle(t,e){this.intersects[t]=new re().copy(e)}getIntersectArray(){const t=[],{intersects:e}=this;for(const i in e)t.push(e[i]);return t}}class wc{constructor(){this.data={}}addTriangleIntersection(t,e,i,n){const{data:s}=this;s[t]||(s[t]=new d5(e)),s[t].addTriangle(i,n)}getTrianglesAsArray(t=null){const{data:e}=this,i=[];if(t!==null)t in e&&i.push(e[t].triangle);else for(const n in e)i.push(e[n].triangle);return i}getTriangleIndices(){return Object.keys(this.data).map(t=>parseInt(t))}getIntersectionIndices(t){const{data:e}=this;return e[t]?Object.keys(e[t].intersects).map(i=>parseInt(i)):[]}getIntersectionsAsArray(t=null,e=null){const{data:i}=this,n=new Set,s=[],a=l=>{if(i[l])if(e!==null)i[l].intersects[e]&&s.push(i[l].intersects[e]);else{const o=i[l].intersects;for(const c in o)n.has(c)||(n.add(c),s.push(o[c]))}};if(t!==null)a(t);else for(const l in i)a(l);return s}reset(){this.data={}}}class g5{constructor(){this.enabled=!1,this.triangleIntersectsA=new wc,this.triangleIntersectsB=new wc,this.intersectionEdges=[]}addIntersectingTriangles(t,e,i,n){const{triangleIntersectsA:s,triangleIntersectsB:a}=this;s.addTriangleIntersection(t,e,i,n),a.addTriangleIntersection(i,n,t,e)}addEdge(t){this.intersectionEdges.push(t.clone())}reset(){this.triangleIntersectsA.reset(),this.triangleIntersectsB.reset(),this.intersectionEdges=[]}init(){this.enabled&&(this.reset(),bc(this))}complete(){this.enabled&&bc(null)}}const ci=new Me,$r=new wf,Ti=new re,Nr=new re,ri=new re,Lr=new re,Se=[],Mi=[];function p5(r){for(const t of r)return t}function m5(r,t,e,i,n,s={}){const{useGroups:a=!0}=s,{aIntersections:l,bIntersections:o}=h5(r,t),c=[];let h=null,f;return f=a?0:-1,Sc(r,t,l,e,!1,i,n,f),Cc(r,t,l,e,!1,n,f),e.findIndex(d=>d!==Zh&&d!==Qh)!==-1&&(f=a?r.geometry.groups.length||1:-1,Sc(t,r,o,e,!0,i,n,f),Cc(t,r,o,e,!0,n,f)),Se.length=0,Mi.length=0,{groups:c,materials:h}}function Sc(r,t,e,i,n,s,a,l=0){const o=r.matrixWorld.determinant()<0;ci.copy(t.matrixWorld).invert().multiply(r.matrixWorld),$r.getNormalMatrix(r.matrixWorld).multiplyScalar(o?-1:1);const c=r.geometry.groupIndices,h=r.geometry.index,f=r.geometry.attributes.position,g=t.geometry.boundsTree,d=t.geometry.index,p=t.geometry.attributes.position,v=e.ids,b=e.intersectionSet;for(let _=0,w=v.length;_<w;_++){const u=v[_],m=l===-1?0:c[u]+l,y=3*u,S=h.getX(y+0),T=h.getX(y+1),C=h.getX(y+2);Ti.a.fromBufferAttribute(f,S).applyMatrix4(ci),Ti.b.fromBufferAttribute(f,T).applyMatrix4(ci),Ti.c.fromBufferAttribute(f,C).applyMatrix4(ci),s.reset(),s.initialize(Ti);const A=b[u];for(let k=0,E=A.length;k<E;k++){const M=3*A[k],F=d.getX(M+0),N=d.getX(M+1),D=d.getX(M+2);Nr.a.fromBufferAttribute(p,F),Nr.b.fromBufferAttribute(p,N),Nr.c.fromBufferAttribute(p,D),s.splitByTriangle(Nr)}const P=s.triangles;for(let k=0,E=P.length;k<E;k++){const M=P[k],F=s.coplanarTriangleUsed?c5(M,g):$h(M,g);Se.length=0,Mi.length=0;for(let N=0,D=i.length;N<D;N++){const V=tf(i[N],F,n);V!==Oo&&(Mi.push(V),Se.push(a[N].getGroupAttrSet(m)))}if(Se.length!==0){Ti.getBarycoord(M.a,Lr.a),Ti.getBarycoord(M.b,Lr.b),Ti.getBarycoord(M.c,Lr.c);for(let N=0,D=Se.length;N<D;N++){const V=Se[N],lt=Mi[N]===Wn;f5(u,Lr,r.geometry,r.matrixWorld,$r,V,o!==lt)}}}}return v.length}function Cc(r,t,e,i,n,s,a=0){const l=r.matrixWorld.determinant()<0;ci.copy(t.matrixWorld).invert().multiply(r.matrixWorld),$r.getNormalMatrix(r.matrixWorld).multiplyScalar(l?-1:1);const o=t.geometry.boundsTree,c=r.geometry.groupIndices,h=r.geometry.index,f=r.geometry.attributes,g=f.position,d=[],p=r.geometry.halfEdges,v=new Set,b=Lo(r.geometry);for(let _=0,w=b;_<w;_++)_ in e.intersectionSet||v.add(_);for(;v.size>0;){const _=p5(v);v.delete(_),d.push(_);const w=3*_,u=h.getX(w+0),m=h.getX(w+1),y=h.getX(w+2);ri.a.fromBufferAttribute(g,u).applyMatrix4(ci),ri.b.fromBufferAttribute(g,m).applyMatrix4(ci),ri.c.fromBufferAttribute(g,y).applyMatrix4(ci);const S=$h(ri,o);Mi.length=0,Se.length=0;for(let T=0,C=i.length;T<C;T++){const A=tf(i[T],S,n);A!==Oo&&(Mi.push(A),Se.push(s[T]))}for(;d.length>0;){const T=d.pop();for(let C=0;C<3;C++){const A=p.getSiblingTriangleIndex(T,C);A!==-1&&v.has(A)&&(d.push(A),v.delete(A))}if(Se.length!==0){const C=3*T,A=h.getX(C+0),P=h.getX(C+1),k=h.getX(C+2),E=a===-1?0:c[T]+a;if(ri.a.fromBufferAttribute(g,A),ri.b.fromBufferAttribute(g,P),ri.c.fromBufferAttribute(g,k),!oi(ri))for(let M=0,F=Se.length;M<F;M++){const N=Mi[M],D=Se[M].getGroupAttrSet(E),V=N===Wn;u5(A,P,k,f,r.matrixWorld,$r,D,V!==l)}}}}}function _5(r){for(let t=0;t<r.length-1;t++){const e=r[t],i=r[t+1];if(e.materialIndex===i.materialIndex){const n=e.start,s=i.start+i.count;i.start=n,i.count=s-n,r.splice(t,1),t--}}}function v5(r,t,e,i){e.clear();const n=r.attributes;for(let s=0,a=i.length;s<a;s++){const l=i[s],o=n[l];e.initializeArray(l,o.array.constructor,o.itemSize,o.normalized)}for(const s in e.attributes)i.includes(s)||e.delete(s);for(const s in t.attributes)i.includes(s)||(t.deleteAttribute(s),t.dispose())}function y5(r,t,e){let i=!1,n=-1;const s=r.attributes,a=t.groupAttributes[0];for(const o in a){const c=t.getTotalLength(o),h=t.getType(o),f=t.getItemSize(o),g=t.getNormalized(o);let d=s[o];(!d||d.array.length<c)&&(d=new rs(new h(c),f,g),r.setAttribute(o,d),i=!0);let p=0;for(let v=0,b=Math.min(e.length,t.groupCount);v<b;v++){const _=e[v].index,{array:w,type:u,length:m}=t.groupAttributes[_][o],y=new u(w.buffer,0,m);d.array.set(y,p),p+=y.length}d.needsUpdate=!0,n=c/d.itemSize}if(r.index){const o=r.index.array;if(o.length<n)r.index=null,i=!0;else for(let c=0,h=o.length;c<h;c++)o[c]=c}let l=0;r.clearGroups();for(let o=0,c=Math.min(e.length,t.groupCount);o<c;o++){const{index:h,materialIndex:f}=e[o],g=t.getCount(h);g!==0&&(r.addGroup(l,g,f),l+=g)}r.setDrawRange(0,n),r.boundsTree=null,i&&r.dispose()}function Ac(r,t){let e=t;return Array.isArray(t)||(e=[],r.forEach(i=>{e[i.materialIndex]=t})),e}class b5{constructor(){this.triangleSplitter=new e5,this.attributeData=[],this.attributes=["position","uv","normal"],this.useGroups=!0,this.consolidateGroups=!0,this.debug=new g5}getGroupRanges(t){return!this.useGroups||t.groups.length===0?[{start:0,count:1/0,materialIndex:0}]:t.groups.map(e=>({...e}))}evaluate(t,e,i,n=new no){let s=!0;if(Array.isArray(i)||(i=[i]),Array.isArray(n)||(n=[n],s=!1),n.length!==i.length)throw new Error("Evaluator: operations and target array passed as different sizes.");t.prepareGeometry(),e.prepareGeometry();const{triangleSplitter:a,attributeData:l,attributes:o,useGroups:c,consolidateGroups:h,debug:f}=this;for(;l.length<n.length;)l.push(new n5);n.forEach((_,w)=>{v5(t.geometry,_.geometry,l[w],o)}),f.init(),m5(t,e,i,a,l,{useGroups:c}),f.complete();const g=this.getGroupRanges(t.geometry),d=Ac(g,t.material),p=this.getGroupRanges(e.geometry),v=Ac(p,e.material);p.forEach(_=>_.materialIndex+=d.length);let b=[...g,...p].map((_,w)=>({..._,index:w}));if(c){const _=[...d,...v];h&&(b=b.map(u=>{const m=_[u.materialIndex];return u.materialIndex=_.indexOf(m),u}).sort((u,m)=>u.materialIndex-m.materialIndex));const w=[];for(let u=0,m=_.length;u<m;u++){let y=!1;for(let S=0,T=b.length;S<T;S++){const C=b[S];C.materialIndex===u&&(y=!0,C.materialIndex=w.length)}y&&w.push(_[u])}n.forEach(u=>{u.material=w})}else b=[{start:0,count:1/0,index:0,materialIndex:0}],n.forEach(_=>{_.material=d[0]});return n.forEach((_,w)=>{const u=_.geometry;y5(u,l[w],b),h&&_5(u.groups)}),s?n:n[0]}evaluateHierarchy(t,e=new no){t.updateMatrixWorld(!0);const i=(s,a)=>{const l=s.children;for(let o=0,c=l.length;o<c;o++){const h=l[o];h.isOperationGroup?i(h,a):a(h)}},n=s=>{const a=s.children;let l=!1;for(let c=0,h=a.length;c<h;c++){const f=a[c];l=n(f)||l}const o=s.isDirty();if(o&&s.markUpdated(),l&&!s.isOperationGroup){let c;return i(s,h=>{c?c=this.evaluate(c,h,h.operation):c=this.evaluate(s,h,h.operation)}),s._cachedGeometry=c.geometry,s._cachedMaterials=c.material,!0}else return l||o};return n(t),e.geometry=t._cachedGeometry,e.material=t._cachedMaterials,e}reset(){this.triangleSplitter.reset()}}const Pi=2,Or=2,Dr=1,hn=r=>{const t=new no(r.translate(0,0,0));return r instanceof Bc?t.position.z=r.parameters.depth/2:r instanceof Uc&&(t.position.z=r.parameters.height/2,t.rotateX(Math.PI/2)),t.updateMatrixWorld(),t},Bn=(r,t,e)=>new Bc(r,t,e),w5=(r,t)=>new Uc(r,r,t,32),S5=r=>{const t=r.panelSettings,e=t.pcbThickness+t.smdHeight,i=Math.max(t.smdHeight,...r.rectangles.map(c=>c.depth),...r.circles.map(c=>c.depth)),n=t.pcbThickness+i;let s=hn(Bn(t.width+2*Or,t.height+2*Or,n+Pi));const a=new b5,l=hn(Bn(t.width,t.height,e+Dr));l.position.z+=Pi+n-e,l.updateMatrixWorld(),s=a.evaluate(s,l,Vn);const o=hn(Bn(t.width/3,t.height/3,e+Dr));{o.position.z+=Pi+n-e,o.updateMatrixWorld();const c=[{dx:t.width/2,dy:0},{dx:-t.width/2,dy:0},{dx:0,dy:t.height/2},{dx:0,dy:-t.height/2}];for(const h of c){o.position.x+=h.dx,o.position.y+=h.dy;try{o.updateMatrixWorld(),s=a.evaluate(s,o,Vn)}finally{o.position.x-=h.dx,o.position.y-=h.dy}}}for(const c of r.rectangles){const h=hn(Bn(c.width,c.height,c.depth+Dr));h.position.x+=c.x+c.width/2-t.width/2,h.position.y-=c.y+c.height/2-t.height/2,h.position.z+=Pi+(i-c.depth),h.updateMatrixWorld(),s=a.evaluate(s,h,Vn)}for(const c of r.circles){const h=hn(w5(c.radius,c.depth+Dr));h.position.x+=c.x-t.width/2,h.position.y-=c.y-t.height/2,h.position.z+=Pi+(i-c.depth),h.updateMatrixWorld(),s=a.evaluate(s,h,Vn)}for(const c of r.legs){const h=hn(Bn(c.width,c.height,i));h.position.x+=c.x+c.width/2-t.width/2,h.position.y-=c.y+c.height/2-t.height/2,h.position.z+=Pi,h.updateMatrixWorld(),s=a.evaluate(s,h,Jh)}return{vertexArray:new Float32Array(s.geometry.attributes.position.array),dimensions:{x:t.width+2*Or,y:t.height+2*Or,depth:n+Pi}}},C5=async r=>new Promise((t,e)=>setTimeout(()=>{try{t(S5(r))}catch(i){e(i instanceof Error?i.message:i)}}));let Do=(r=21)=>crypto.getRandomValues(new Uint8Array(r)).reduce((t,e)=>(e&=63,e<36?t+=e.toString(36):e<62?t+=(e-26).toString(36).toUpperCase():e>62?t+="-":t+="_",t),"");const A5=st.object({depth:st.number(),id:st.string(),x:st.number(),y:st.number(),radius:st.number(),fill:st.literal("orange").default("orange"),draggable:st.literal(!0).default(!0),opacity:st.literal(.75).default(.75)}),T5=["fill","draggable","opacity"],ts=2,P5=st.object({id:st.string(),x:st.number(),y:st.number(),width:st.number(),height:st.number(),fill:st.literal("gray").default("gray"),draggable:st.literal(!0).default(!0),opacity:st.literal(.75).default(.75)}),k5=["fill","draggable","opacity"],x5=st.object({width:st.number(),height:st.number(),pcbThickness:st.number(),smdHeight:st.number()}),E5=st.object({depth:st.number(),id:st.string(),x:st.number(),y:st.number(),width:st.number(),height:st.number(),fill:st.literal("green").default("green"),draggable:st.literal(!0).default(!0),opacity:st.literal(.75).default(.75)}),M5=["fill","draggable","opacity"],ef=st.object({image:st.string(),filename:st.string(),panelSettings:x5,circles:st.array(A5),rectangles:st.array(E5),legs:st.array(P5)}),nf={image:"",filename:"",panelSettings:{width:100,height:100,pcbThickness:1.6,smdHeight:3},circles:[],rectangles:[],legs:[]},rf={parse:r=>{try{return ef.parse(JSON.parse(r))}catch{return nf}},stringify:r=>JSON.stringify(r,(t,e)=>{if(![...T5,...M5,...k5].includes(t))return e},2)},Vt=Sf("project",nf,{syncTabs:!0,storage:"local",serializer:rf}),Yi=()=>Ic(Vt),ro=async r=>{const t=Yi(),e={depth:r?.depth||5,id:Do(),x:t.panelSettings.width/2,y:t.panelSettings.height/2,radius:r?.radius||10,fill:"orange",draggable:!0,opacity:.75};if(t.circles.push(e),qn(t.circles),!r){const{confirmed:i,settings:n}=await Vc(e);i&&(e.radius=n.radius,e.depth=n.depth,qn())}},F5=r=>ro(r),R5=async r=>{const{confirmed:t,name:e}=await zc("circle");if(t){const i=Hc();i.push({name:e,type:"circle",radius:r.radius,depth:r.depth}),Wc(i)}},sf=async r=>{const{confirmed:t,settings:e}=await Vc(r);t&&(r.radius=e.radius,r.depth=e.depth,qn())},qn=r=>Vt.update(t=>(r&&(t.circles=r),t)),N5=r=>{const t=Yi(),e=t.circles.find(i=>i.id===r);if(e)return[{name:`Circle ${e.radius}x${e.depth}mm`},{name:"Properties...",onClick:()=>sf(e)},{name:"Duplicate",onClick:()=>F5(e)},{name:"Add to library...",onClick:()=>R5(e)},{name:""},{name:"Delete",onClick:()=>{t.circles=t.circles.filter(i=>i!=e),qn()}}]},L5=()=>{const r=Yi(),t={id:Do(),x:r.panelSettings.width/2,y:r.panelSettings.height/2,width:ts,height:ts,fill:"gray",draggable:!0,opacity:.75};r.legs.push(t),ia(r.legs)},O5=r=>{const t=Yi();t.legs=t.legs.filter(e=>e!=r),ia(t.legs)},ia=r=>Vt.update(t=>(r&&(t.legs=r),t)),D5=r=>{const t=Yi(),e=t.legs.find(i=>i.id===r);if(e)return[{name:"Leg"},{name:"Delete",onClick:()=>{t.legs=t.legs.filter(i=>i!=e),ia()}}]},so=async r=>{const t=Yi(),e={depth:r?.depth||5,id:Do(),x:t.panelSettings.width/2,y:t.panelSettings.height/2,width:r?.width||10,height:r?.height||5,fill:"green",draggable:!0,opacity:.75};if(t.rectangles.push(e),vn(t.rectangles),!r){const{confirmed:i,settings:n}=await jc(e);i&&(e.width=n.width,e.height=n.height,e.depth=n.depth,vn())}},I5=r=>so(r),G5=r=>{const t=r.width;r.width=r.height,r.height=t,vn()},B5=async r=>{const{confirmed:t,name:e}=await zc("rectangle");if(t){const i=Hc();i.push({name:e,type:"rectangle",width:r.width,height:r.height,depth:r.depth}),Wc(i)}},af=async r=>{const{confirmed:t,settings:e}=await jc(r);t&&(r.width=e.width,r.height=e.height,r.depth=e.depth,vn())},vn=r=>Vt.update(t=>(r&&(t.rectangles=r),t)),U5=r=>{const t=Yi(),e=t.rectangles.find(i=>i.id===r);if(e)return[{name:`Rectangle ${e.width}x${e.height}x${e.depth}mm`},{name:"Properties...",onClick:()=>af(e)},{name:"Rotate",onClick:()=>G5(e)},{name:"Duplicate",onClick:()=>I5(e)},{name:"Add to library...",onClick:()=>B5(e)},{name:""},{name:"Delete",onClick:()=>{t.rectangles=t.rectangles.filter(i=>i!=e),vn()}}]};function Tc(r,t,e){const i=r.slice();return i[38]=t[e],i[39]=t,i[40]=e,i}function Pc(r,t,e){const i=r.slice();return i[41]=t[e],i[42]=t,i[43]=e,i}function kc(r,t,e){const i=r.slice();return i[44]=t[e],i[45]=t,i[46]=e,i}function xc(r,t,e){const i=r.slice();return i[47]=t[e],i}function V5(r){let t,e,i,n,s="PCB THT Holder",a,l,o,c;return{c(){t=ft("img"),i=pt(),n=ft("span"),n.textContent=s,a=pt(),l=ft("span"),o=At("v"),c=At(r[5]),this.h()},l(h){t=ut(h,"IMG",{src:!0,class:!0,alt:!0}),i=mt(h),n=ut(h,"SPAN",{class:!0,"data-svelte-h":!0}),df(n)!=="svelte-yf58ke"&&(n.textContent=s),a=mt(h),l=ut(h,"SPAN",{class:!0});var f=at(l);o=Tt(f,"v"),c=Tt(f,r[5]),f.forEach(R),this.h()},h(){gf(t.src,e=Mf+"/favicon.png")||J(t,"src",e),J(t,"class","me-3 h-6 sm:h-9"),J(t,"alt","PCB THT Holder Logo"),J(n,"class","self-center whitespace-nowrap text-xl font-semibold dark:text-white"),J(l,"class","ml-2 self-center whitespace-nowrap text-sm dark:text-white")},m(h,f){G(h,t,f),G(h,i,f),G(h,n,f),G(h,a,f),G(h,l,f),kt(l,o),kt(l,c)},p:Wt,d(h){h&&(R(t),R(i),R(n),R(a),R(l))}}}function z5(r){let t,e,i;return t=new ad({props:{class:"mr-2"}}),{c(){tt(t.$$.fragment),e=At(" Display 3D")},l(n){et(t.$$.fragment,n),e=Tt(n," Display 3D")},m(n,s){it(t,n,s),G(n,e,s),i=!0},p:Wt,i(n){i||(O(t.$$.fragment,n),i=!0)},o(n){B(t.$$.fragment,n),i=!1},d(n){n&&R(e),nt(t,n)}}}function Ec(r){let t,e,i,n,s,a,l,o;return t=new tl({props:{class:"cursor-pointer",$$slots:{default:[H5]},$$scope:{ctx:r}}}),i=new Ua({props:{class:"w-44 z-20",$$slots:{default:[Y5]},$$scope:{ctx:r}}}),s=new tl({props:{class:"cursor-pointer",$$slots:{default:[K5]},$$scope:{ctx:r}}}),l=new Ua({props:{class:"w-44 z-20",$$slots:{default:[i4]},$$scope:{ctx:r}}}),{c(){tt(t.$$.fragment),e=pt(),tt(i.$$.fragment),n=pt(),tt(s.$$.fragment),a=pt(),tt(l.$$.fragment)},l(c){et(t.$$.fragment,c),e=mt(c),et(i.$$.fragment,c),n=mt(c),et(s.$$.fragment,c),a=mt(c),et(l.$$.fragment,c)},m(c,h){it(t,c,h),G(c,e,h),it(i,c,h),G(c,n,h),it(s,c,h),G(c,a,h),it(l,c,h),o=!0},p(c,h){const f={};h[1]&524288&&(f.$$scope={dirty:h,ctx:c}),t.$set(f);const g={};h[1]&524288&&(g.$$scope={dirty:h,ctx:c}),i.$set(g);const d={};h[1]&524288&&(d.$$scope={dirty:h,ctx:c}),s.$set(d);const p={};h[0]&16|h[1]&524288&&(p.$$scope={dirty:h,ctx:c}),l.$set(p)},i(c){o||(O(t.$$.fragment,c),O(i.$$.fragment,c),O(s.$$.fragment,c),O(l.$$.fragment,c),o=!0)},o(c){B(t.$$.fragment,c),B(i.$$.fragment,c),B(s.$$.fragment,c),B(l.$$.fragment,c),o=!1},d(c){c&&(R(e),R(n),R(a)),nt(t,c),nt(i,c),nt(s,c),nt(l,c)}}}function H5(r){let t,e,i;return e=new rh({props:{class:"w-3 h-3 ms-2 text-primary-800 dark:text-white inline"}}),{c(){t=At("File"),tt(e.$$.fragment)},l(n){t=Tt(n,"File"),et(e.$$.fragment,n)},m(n,s){G(n,t,s),it(e,n,s),i=!0},p:Wt,i(n){i||(O(e.$$.fragment,n),i=!0)},o(n){B(e.$$.fragment,n),i=!1},d(n){n&&R(t),nt(e,n)}}}function W5(r){let t;return{c(){t=At("New")},l(e){t=Tt(e,"New")},m(e,i){G(e,t,i)},d(e){e&&R(t)}}}function j5(r){let t;return{c(){t=At("Save project...")},l(e){t=Tt(e,"Save project...")},m(e,i){G(e,t,i)},d(e){e&&R(t)}}}function X5(r){let t;return{c(){t=At("Panel settings")},l(e){t=Tt(e,"Panel settings")},m(e,i){G(e,t,i)},d(e){e&&R(t)}}}function Y5(r){let t,e,i,n,s,a,l,o;return t=new ze({props:{href:"#",$$slots:{default:[W5]},$$scope:{ctx:r}}}),t.$on("click",r[16]),i=new ze({props:{href:"#",$$slots:{default:[j5]},$$scope:{ctx:r}}}),i.$on("click",r[17]),s=new ih({}),l=new ze({props:{href:"#",$$slots:{default:[X5]},$$scope:{ctx:r}}}),l.$on("click",r[18]),{c(){tt(t.$$.fragment),e=pt(),tt(i.$$.fragment),n=pt(),tt(s.$$.fragment),a=pt(),tt(l.$$.fragment)},l(c){et(t.$$.fragment,c),e=mt(c),et(i.$$.fragment,c),n=mt(c),et(s.$$.fragment,c),a=mt(c),et(l.$$.fragment,c)},m(c,h){it(t,c,h),G(c,e,h),it(i,c,h),G(c,n,h),it(s,c,h),G(c,a,h),it(l,c,h),o=!0},p(c,h){const f={};h[1]&524288&&(f.$$scope={dirty:h,ctx:c}),t.$set(f);const g={};h[1]&524288&&(g.$$scope={dirty:h,ctx:c}),i.$set(g);const d={};h[1]&524288&&(d.$$scope={dirty:h,ctx:c}),l.$set(d)},i(c){o||(O(t.$$.fragment,c),O(i.$$.fragment,c),O(s.$$.fragment,c),O(l.$$.fragment,c),o=!0)},o(c){B(t.$$.fragment,c),B(i.$$.fragment,c),B(s.$$.fragment,c),B(l.$$.fragment,c),o=!1},d(c){c&&(R(e),R(n),R(a)),nt(t,c),nt(i,c),nt(s,c),nt(l,c)}}}function K5(r){let t,e,i;return e=new rh({props:{class:"w-3 h-3 ms-2 text-primary-800 dark:text-white inline"}}),{c(){t=At("Component"),tt(e.$$.fragment)},l(n){t=Tt(n,"Component"),et(e.$$.fragment,n)},m(n,s){G(n,t,s),it(e,n,s),i=!0},p:Wt,i(n){i||(O(e.$$.fragment,n),i=!0)},o(n){B(e.$$.fragment,n),i=!1},d(n){n&&R(t),nt(e,n)}}}function q5(r){let t;return{c(){t=At("Add circle...")},l(e){t=Tt(e,"Add circle...")},m(e,i){G(e,t,i)},d(e){e&&R(t)}}}function J5(r){let t;return{c(){t=At("Add rectangle...")},l(e){t=Tt(e,"Add rectangle...")},m(e,i){G(e,t,i)},d(e){e&&R(t)}}}function Q5(r){let t;return{c(){t=At("Add leg")},l(e){t=Tt(e,"Add leg")},m(e,i){G(e,t,i)},d(e){e&&R(t)}}}function Mc(r){let t,e,i,n;return t=new ze({props:{class:"flex items-center justify-between",$$slots:{default:[Z5]},$$scope:{ctx:r}}}),i=new Ua({props:{class:"w-auto min-w-44 z-20",placement:"right-start",$$slots:{default:[t4]},$$scope:{ctx:r}}}),{c(){tt(t.$$.fragment),e=pt(),tt(i.$$.fragment)},l(s){et(t.$$.fragment,s),e=mt(s),et(i.$$.fragment,s)},m(s,a){it(t,s,a),G(s,e,a),it(i,s,a),n=!0},p(s,a){const l={};a[1]&524288&&(l.$$scope={dirty:a,ctx:s}),t.$set(l);const o={};a[0]&16|a[1]&524288&&(o.$$scope={dirty:a,ctx:s}),i.$set(o)},i(s){n||(O(t.$$.fragment,s),O(i.$$.fragment,s),n=!0)},o(s){B(t.$$.fragment,s),B(i.$$.fragment,s),n=!1},d(s){s&&R(e),nt(t,s),nt(i,s)}}}function Z5(r){let t,e,i;return e=new nd({props:{class:"w-3 h-3 ms-2 text-primary-700 dark:text-white"}}),{c(){t=At("Add from library"),tt(e.$$.fragment)},l(n){t=Tt(n,"Add from library"),et(e.$$.fragment,n)},m(n,s){G(n,t,s),it(e,n,s),i=!0},p:Wt,i(n){i||(O(e.$$.fragment,n),i=!0)},o(n){B(e.$$.fragment,n),i=!1},d(n){n&&R(t),nt(e,n)}}}function $5(r){let t=r[47].name+"",e,i,n=r[47].type+"",s,a;return{c(){e=At(t),i=At(" ("),s=At(n),a=At(")")},l(l){e=Tt(l,t),i=Tt(l," ("),s=Tt(l,n),a=Tt(l,")")},m(l,o){G(l,e,o),G(l,i,o),G(l,s,o),G(l,a,o)},p(l,o){o[0]&16&&t!==(t=l[47].name+"")&&Xe(e,t),o[0]&16&&n!==(n=l[47].type+"")&&Xe(s,n)},d(l){l&&(R(e),R(i),R(s),R(a))}}}function Fc(r){let t,e;function i(){return r[22](r[47])}return t=new ze({props:{$$slots:{default:[$5]},$$scope:{ctx:r}}}),t.$on("click",i),{c(){tt(t.$$.fragment)},l(n){et(t.$$.fragment,n)},m(n,s){it(t,n,s),e=!0},p(n,s){r=n;const a={};s[0]&16|s[1]&524288&&(a.$$scope={dirty:s,ctx:r}),t.$set(a)},i(n){e||(O(t.$$.fragment,n),e=!0)},o(n){B(t.$$.fragment,n),e=!1},d(n){nt(t,n)}}}function t4(r){let t,e,i=ke(r[4].sort(Dc)),n=[];for(let a=0;a<i.length;a+=1)n[a]=Fc(xc(r,i,a));const s=a=>B(n[a],1,1,()=>{n[a]=null});return{c(){for(let a=0;a<n.length;a+=1)n[a].c();t=It()},l(a){for(let l=0;l<n.length;l+=1)n[l].l(a);t=It()},m(a,l){for(let o=0;o<n.length;o+=1)n[o]&&n[o].m(a,l);G(a,t,l),e=!0},p(a,l){if(l[0]&1040){i=ke(a[4].sort(Dc));let o;for(o=0;o<i.length;o+=1){const c=xc(a,i,o);n[o]?(n[o].p(c,l),O(n[o],1)):(n[o]=Fc(c),n[o].c(),O(n[o],1),n[o].m(t.parentNode,t))}for(ae(),o=i.length;o<n.length;o+=1)s(o);oe()}},i(a){if(!e){for(let l=0;l<i.length;l+=1)O(n[l]);e=!0}},o(a){n=n.filter(Boolean);for(let l=0;l<n.length;l+=1)B(n[l]);e=!1},d(a){a&&R(t),zn(n,a)}}}function e4(r){let t;return{c(){t=At("Library...")},l(e){t=Tt(e,"Library...")},m(e,i){G(e,t,i)},d(e){e&&R(t)}}}function i4(r){let t,e,i,n,s,a,l,o,c,h,f;t=new ze({props:{href:"#",$$slots:{default:[q5]},$$scope:{ctx:r}}}),t.$on("click",r[19]),i=new ze({props:{href:"#",$$slots:{default:[J5]},$$scope:{ctx:r}}}),i.$on("click",r[20]),s=new ze({props:{href:"#",$$slots:{default:[Q5]},$$scope:{ctx:r}}}),s.$on("click",r[21]);let g=r[4].length&&Mc(r);return o=new ih({}),h=new ze({props:{href:"#",$$slots:{default:[e4]},$$scope:{ctx:r}}}),h.$on("click",r[23]),{c(){tt(t.$$.fragment),e=pt(),tt(i.$$.fragment),n=pt(),tt(s.$$.fragment),a=pt(),g&&g.c(),l=pt(),tt(o.$$.fragment),c=pt(),tt(h.$$.fragment)},l(d){et(t.$$.fragment,d),e=mt(d),et(i.$$.fragment,d),n=mt(d),et(s.$$.fragment,d),a=mt(d),g&&g.l(d),l=mt(d),et(o.$$.fragment,d),c=mt(d),et(h.$$.fragment,d)},m(d,p){it(t,d,p),G(d,e,p),it(i,d,p),G(d,n,p),it(s,d,p),G(d,a,p),g&&g.m(d,p),G(d,l,p),it(o,d,p),G(d,c,p),it(h,d,p),f=!0},p(d,p){const v={};p[1]&524288&&(v.$$scope={dirty:p,ctx:d}),t.$set(v);const b={};p[1]&524288&&(b.$$scope={dirty:p,ctx:d}),i.$set(b);const _={};p[1]&524288&&(_.$$scope={dirty:p,ctx:d}),s.$set(_),d[4].length?g?(g.p(d,p),p[0]&16&&O(g,1)):(g=Mc(d),g.c(),O(g,1),g.m(l.parentNode,l)):g&&(ae(),B(g,1,1,()=>{g=null}),oe());const w={};p[1]&524288&&(w.$$scope={dirty:p,ctx:d}),h.$set(w)},i(d){f||(O(t.$$.fragment,d),O(i.$$.fragment,d),O(s.$$.fragment,d),O(g),O(o.$$.fragment,d),O(h.$$.fragment,d),f=!0)},o(d){B(t.$$.fragment,d),B(i.$$.fragment,d),B(s.$$.fragment,d),B(g),B(o.$$.fragment,d),B(h.$$.fragment,d),f=!1},d(d){d&&(R(e),R(n),R(a),R(l),R(c)),nt(t,d),nt(i,d),nt(s,d),g&&g.d(d),nt(o,d),nt(h,d)}}}function n4(r){let t,e,i=r[0]&&Ec(r);return{c(){i&&i.c(),t=It()},l(n){i&&i.l(n),t=It()},m(n,s){i&&i.m(n,s),G(n,t,s),e=!0},p(n,s){n[0]?i?(i.p(n,s),s[0]&1&&O(i,1)):(i=Ec(n),i.c(),O(i,1),i.m(t.parentNode,t)):i&&(ae(),B(i,1,1,()=>{i=null}),oe())},i(n){e||(O(i),e=!0)},o(n){B(i),e=!1},d(n){n&&R(t),i&&i.d(n)}}}function r4(r){let t,e,i,n,s,a,l,o,c;return t=new Iu({props:{href:"#",$$slots:{default:[V5]},$$scope:{ctx:r}}}),n=new Cf({props:{disabled:!r[0],$$slots:{default:[z5]},$$scope:{ctx:r}}}),n.$on("click",r[15]),a=new Wu({}),o=new Zu({props:{class:"order-1",$$slots:{default:[n4]},$$scope:{ctx:r}}}),{c(){tt(t.$$.fragment),e=pt(),i=ft("div"),tt(n.$$.fragment),s=pt(),tt(a.$$.fragment),l=pt(),tt(o.$$.fragment),this.h()},l(h){et(t.$$.fragment,h),e=mt(h),i=ut(h,"DIV",{class:!0});var f=at(i);et(n.$$.fragment,f),s=mt(f),et(a.$$.fragment,f),f.forEach(R),l=mt(h),et(o.$$.fragment,h),this.h()},h(){J(i,"class","flex md:order-2")},m(h,f){it(t,h,f),G(h,e,f),G(h,i,f),it(n,i,null),kt(i,s),it(a,i,null),G(h,l,f),it(o,h,f),c=!0},p(h,f){const g={};f[1]&524288&&(g.$$scope={dirty:f,ctx:h}),t.$set(g);const d={};f[0]&1&&(d.disabled=!h[0]),f[1]&524288&&(d.$$scope={dirty:f,ctx:h}),n.$set(d);const p={};f[0]&17|f[1]&524288&&(p.$$scope={dirty:f,ctx:h}),o.$set(p)},i(h){c||(O(t.$$.fragment,h),O(n.$$.fragment,h),O(a.$$.fragment,h),O(o.$$.fragment,h),c=!0)},o(h){B(t.$$.fragment,h),B(n.$$.fragment,h),B(a.$$.fragment,h),B(o.$$.fragment,h),c=!1},d(h){h&&(R(e),R(i),R(l)),nt(t,h),nt(n),nt(a),nt(o,h)}}}function Rc(r){let t,e,i=r[1].width+"",n,s,a=r[1].height+"",l,o;return{c(){t=ft("p"),e=At("("),n=At(i),s=At("x"),l=At(a),o=At(")"),this.h()},l(c){t=ut(c,"P",{class:!0});var h=at(t);e=Tt(h,"("),n=Tt(h,i),s=Tt(h,"x"),l=Tt(h,a),o=Tt(h,")"),h.forEach(R),this.h()},h(){J(t,"class","text-sm text-gray-500")},m(c,h){G(c,t,h),kt(t,e),kt(t,n),kt(t,s),kt(t,l),kt(t,o)},p(c,h){h[0]&2&&i!==(i=c[1].width+"")&&Xe(n,i),h[0]&2&&a!==(a=c[1].height+"")&&Xe(l,a)},d(c){c&&R(t)}}}function s4(r){let t,e;return t=new b2({props:{config:{width:r[1].width,height:r[1].height,scaleX:r[1].width/r[3].panelSettings.width,scaleY:r[1].height/r[3].panelSettings.height},$$slots:{default:[l4]},$$scope:{ctx:r}}}),t.$on("click",r[14]),{c(){tt(t.$$.fragment)},l(i){et(t.$$.fragment,i)},m(i,n){it(t,i,n),e=!0},p(i,n){const s={};n[0]&10&&(s.config={width:i[1].width,height:i[1].height,scaleX:i[1].width/i[3].panelSettings.width,scaleY:i[1].height/i[3].panelSettings.height}),n[0]&15|n[1]&524288&&(s.$$scope={dirty:n,ctx:i}),t.$set(s)},i(i){e||(O(t.$$.fragment,i),e=!0)},o(i){B(t.$$.fragment,i),e=!1},d(i){nt(t,i)}}}function a4(r){let t,e;return t=new F2({props:{title:"Top view of PCB image or a project file",description:"Click to upload or drag and drop a file. Image file (png, jpg) begins a new project, a .tht3d file restores a previously saved project.",onUpload:r[24]}}),{c(){tt(t.$$.fragment)},l(i){et(t.$$.fragment,i)},m(i,n){it(t,i,n),e=!0},p:Wt,i(i){e||(O(t.$$.fragment,i),e=!0)},o(i){B(t.$$.fragment,i),e=!1},d(i){nt(t,i)}}}function Nc(r){let t,e,i;function n(o){r[26](o,r[44],r[45],r[46])}function s(){return r[27](r[44])}function a(...o){return r[28](r[44],...o)}let l={};return r[44]!==void 0&&(l.config=r[44]),t=new f2({props:l}),mi.push(()=>is(t,"config",n)),t.$on("dblclick",s),t.$on("dragmove",a),t.$on("dragend",r[29]),{c(){tt(t.$$.fragment)},l(o){et(t.$$.fragment,o)},m(o,c){it(t,o,c),i=!0},p(o,c){r=o;const h={};!e&&c[0]&8&&(e=!0,h.config=r[44],es(()=>e=!1)),t.$set(h)},i(o){i||(O(t.$$.fragment,o),i=!0)},o(o){B(t.$$.fragment,o),i=!1},d(o){nt(t,o)}}}function Lc(r){let t,e,i;function n(o){r[30](o,r[41],r[42],r[43])}function s(){return r[31](r[41])}function a(...o){return r[32](r[41],...o)}let l={};return r[41]!==void 0&&(l.config=r[41]),t=new zh({props:l}),mi.push(()=>is(t,"config",n)),t.$on("dblclick",s),t.$on("dragmove",a),t.$on("dragend",r[33]),{c(){tt(t.$$.fragment)},l(o){et(t.$$.fragment,o)},m(o,c){it(t,o,c),i=!0},p(o,c){r=o;const h={};!e&&c[0]&8&&(e=!0,h.config=r[41],es(()=>e=!1)),t.$set(h)},i(o){i||(O(t.$$.fragment,o),i=!0)},o(o){B(t.$$.fragment,o),i=!1},d(o){nt(t,o)}}}function Oc(r){let t,e,i;function n(o){r[34](o,r[38],r[39],r[40])}function s(){return r[35](r[38])}function a(...o){return r[36](r[38],...o)}let l={};return r[38]!==void 0&&(l.config=r[38]),t=new zh({props:l}),mi.push(()=>is(t,"config",n)),t.$on("dblclick",s),t.$on("dragmove",a),t.$on("dragend",r[37]),{c(){tt(t.$$.fragment)},l(o){et(t.$$.fragment,o)},m(o,c){it(t,o,c),i=!0},p(o,c){r=o;const h={};!e&&c[0]&8&&(e=!0,h.config=r[38],es(()=>e=!1)),t.$set(h)},i(o){i||(O(t.$$.fragment,o),i=!0)},o(o){B(t.$$.fragment,o),i=!1},d(o){nt(t,o)}}}function o4(r){let t,e,i,n,s,a,l,o;t=new d2({props:{config:{image:r[0],scaleX:r[3].panelSettings.width/r[1].width,scaleY:-1*r[3].panelSettings.height/r[1].height,offsetY:r[1].height,opacity:.25}}});let c={};i=new P2({props:c}),r[25](i);let h=ke(r[3].circles),f=[];for(let u=0;u<h.length;u+=1)f[u]=Nc(kc(r,h,u));const g=u=>B(f[u],1,1,()=>{f[u]=null});let d=ke(r[3].rectangles),p=[];for(let u=0;u<d.length;u+=1)p[u]=Lc(Pc(r,d,u));const v=u=>B(p[u],1,1,()=>{p[u]=null});let b=ke(r[3].legs),_=[];for(let u=0;u<b.length;u+=1)_[u]=Oc(Tc(r,b,u));const w=u=>B(_[u],1,1,()=>{_[u]=null});return{c(){tt(t.$$.fragment),e=pt(),tt(i.$$.fragment),n=pt();for(let u=0;u<f.length;u+=1)f[u].c();s=pt();for(let u=0;u<p.length;u+=1)p[u].c();a=pt();for(let u=0;u<_.length;u+=1)_[u].c();l=It()},l(u){et(t.$$.fragment,u),e=mt(u),et(i.$$.fragment,u),n=mt(u);for(let m=0;m<f.length;m+=1)f[m].l(u);s=mt(u);for(let m=0;m<p.length;m+=1)p[m].l(u);a=mt(u);for(let m=0;m<_.length;m+=1)_[m].l(u);l=It()},m(u,m){it(t,u,m),G(u,e,m),it(i,u,m),G(u,n,m);for(let y=0;y<f.length;y+=1)f[y]&&f[y].m(u,m);G(u,s,m);for(let y=0;y<p.length;y+=1)p[y]&&p[y].m(u,m);G(u,a,m);for(let y=0;y<_.length;y+=1)_[y]&&_[y].m(u,m);G(u,l,m),o=!0},p(u,m){const y={};m[0]&11&&(y.config={image:u[0],scaleX:u[3].panelSettings.width/u[1].width,scaleY:-1*u[3].panelSettings.height/u[1].height,offsetY:u[1].height,opacity:.25}),t.$set(y);const S={};if(i.$set(S),m[0]&8200){h=ke(u[3].circles);let T;for(T=0;T<h.length;T+=1){const C=kc(u,h,T);f[T]?(f[T].p(C,m),O(f[T],1)):(f[T]=Nc(C),f[T].c(),O(f[T],1),f[T].m(s.parentNode,s))}for(ae(),T=h.length;T<f.length;T+=1)g(T);oe()}if(m[0]&4104){d=ke(u[3].rectangles);let T;for(T=0;T<d.length;T+=1){const C=Pc(u,d,T);p[T]?(p[T].p(C,m),O(p[T],1)):(p[T]=Lc(C),p[T].c(),O(p[T],1),p[T].m(a.parentNode,a))}for(ae(),T=d.length;T<p.length;T+=1)v(T);oe()}if(m[0]&4104){b=ke(u[3].legs);let T;for(T=0;T<b.length;T+=1){const C=Tc(u,b,T);_[T]?(_[T].p(C,m),O(_[T],1)):(_[T]=Oc(C),_[T].c(),O(_[T],1),_[T].m(l.parentNode,l))}for(ae(),T=b.length;T<_.length;T+=1)w(T);oe()}},i(u){if(!o){O(t.$$.fragment,u),O(i.$$.fragment,u);for(let m=0;m<h.length;m+=1)O(f[m]);for(let m=0;m<d.length;m+=1)O(p[m]);for(let m=0;m<b.length;m+=1)O(_[m]);o=!0}},o(u){B(t.$$.fragment,u),B(i.$$.fragment,u),f=f.filter(Boolean);for(let m=0;m<f.length;m+=1)B(f[m]);p=p.filter(Boolean);for(let m=0;m<p.length;m+=1)B(p[m]);_=_.filter(Boolean);for(let m=0;m<_.length;m+=1)B(_[m]);o=!1},d(u){u&&(R(e),R(n),R(s),R(a),R(l)),nt(t,u),r[25](null),nt(i,u),zn(f,u),zn(p,u),zn(_,u)}}}function l4(r){let t,e;return t=new m2({props:{$$slots:{default:[o4]},$$scope:{ctx:r}}}),{c(){tt(t.$$.fragment)},l(i){et(t.$$.fragment,i)},m(i,n){it(t,i,n),e=!0},p(i,n){const s={};n[0]&15|n[1]&524288&&(s.$$scope={dirty:n,ctx:i}),t.$set(s)},i(i){e||(O(t.$$.fragment,i),e=!0)},o(i){B(t.$$.fragment,i),e=!1},d(i){nt(t,i)}}}function c4(r){let t,e,i,n,s=r[3].filename+"",a,l,o,c,h,f,g;t=new Lu({props:{$$slots:{default:[r4]},$$scope:{ctx:r}}});let d=r[1]&&Rc(r);const p=[a4,s4],v=[];function b(_,w){return _[0]?_[1]?1:-1:0}return~(h=b(r))&&(f=v[h]=p[h](r)),{c(){tt(t.$$.fragment),e=pt(),i=ft("div"),n=ft("p"),a=At(s),l=pt(),d&&d.c(),o=pt(),c=ft("div"),f&&f.c(),this.h()},l(_){et(t.$$.fragment,_),e=mt(_),i=ut(_,"DIV",{class:!0});var w=at(i);n=ut(w,"P",{class:!0});var u=at(n);a=Tt(u,s),u.forEach(R),l=mt(w),d&&d.l(w),w.forEach(R),o=mt(_),c=ut(_,"DIV",{class:!0});var m=at(c);f&&f.l(m),m.forEach(R),this.h()},h(){J(n,"class","text-sm"),J(i,"class","flex justify-center"),J(c,"class","flex justify-center")},m(_,w){it(t,_,w),G(_,e,w),G(_,i,w),kt(i,n),kt(n,a),kt(i,l),d&&d.m(i,null),G(_,o,w),G(_,c,w),~h&&v[h].m(c,null),g=!0},p(_,w){const u={};w[0]&17|w[1]&524288&&(u.$$scope={dirty:w,ctx:_}),t.$set(u),(!g||w[0]&8)&&s!==(s=_[3].filename+"")&&Xe(a,s),_[1]?d?d.p(_,w):(d=Rc(_),d.c(),d.m(i,null)):d&&(d.d(1),d=null);let m=h;h=b(_),h===m?~h&&v[h].p(_,w):(f&&(ae(),B(v[m],1,1,()=>{v[m]=null}),oe()),~h?(f=v[h],f?f.p(_,w):(f=v[h]=p[h](_),f.c()),O(f,1),f.m(c,null)):f=null)},i(_){g||(O(t.$$.fragment,_),O(f),g=!0)},o(_){B(t.$$.fragment,_),B(f),g=!1},d(_){_&&(R(e),R(i),R(o),R(c)),nt(t,_),d&&d.d(),~h&&v[h].d()}}}const Dc=(r,t)=>r.name.localeCompare(t.name);function h4(r,t,e){let i,n;hi(r,Vt,I=>e(3,i=I)),hi(r,Ef,I=>e(4,n=I)),Di(()=>{const I=Ic(Vt);I.image&&I.filename&&o(I.image,I.filename,!1,!1)});const s="1.2.0";let a,l;const o=(I,j,x,L)=>{if(x&&I.startsWith("data:application/octet-stream"))try{const z=atob(I.replace("data:application/octet-stream;base64,","")),bt=JSON.parse(z),rt=ef.safeParse(bt);if(rt.success){Oe(Vt,i.circles=rt.data.circles||[],i),Oe(Vt,i.rectangles=rt.data.rectangles||[],i),Oe(Vt,i.legs=rt.data.legs||[],i),o(rt.data.image,rt.data.filename,!1,!0),Oe(Vt,i.panelSettings=rt.data.panelSettings,i);return}}catch{}e(0,a=document.createElement("img")),a.addEventListener("load",()=>{Oe(Vt,i.filename=j,i),a&&(e(1,l={width:a.width,height:a.height}),x&&Oe(Vt,i.panelSettings.height=Math.round(i.panelSettings.width*(l.height/l.width)),i),Oe(Vt,i.image=I,i)),(x||L)&&Vt.update(z=>(z.image=I,z.filename=j,z)),x&&f()}),a.addEventListener("error",()=>{e(0,a=void 0),Oe(Vt,i.image="",i),Oe(Vt,i.filename="",i)}),e(0,a.src=I,a)},c=()=>{const I={image:i.image,filename:i.filename,panelSettings:i.panelSettings,circles:i.circles,rectangles:i.rectangles,legs:i.legs},j=rf.stringify(I);Af(i.filename.slice(0,Math.max(0,i.filename.lastIndexOf(".")))+".tht3d",j)},h=async()=>{const{confirmed:I}=await Tf("Are you sure to reset PCB panel?");I&&(e(0,a=void 0),e(1,l=void 0),Vt.update(j=>(j.image="",j.filename="",j.circles=[],j.rectangles=[],j.legs=[],j)))},f=async()=>{const{confirmed:I,settings:j}=await Pf(i.panelSettings);I&&Vt.update(x=>(x.panelSettings=j,x))},g=I=>{switch(I.type){case"circle":{ro({radius:I.radius,depth:I.depth});break}case"rectangle":{so({width:I.width,height:I.height,depth:I.depth});break}}},d=()=>{if(!l)return;const I=C5({panelSettings:i.panelSettings,rectangles:i.rectangles,circles:i.circles,legs:i.legs});kf(i.filename,I)},p=(I,j)=>{const x=I.detail.target,L=i.panelSettings.width-("sizeX"in j?j.width:ts),z=i.panelSettings.height-("sizeY"in j?j.height:ts);x.x()<0&&x.x(0),x.x()>L&&x.x(L),x.y()<0&&x.y(0),x.y()>z&&x.y(z)},v=(I,j)=>{const x=I.detail.target,L=j.radius,z=j.radius,bt=i.panelSettings.width-j.radius,rt=i.panelSettings.height-j.radius;x.x()<L&&x.x(L),x.x()>bt&&x.x(bt),x.y()<z&&x.y(z),x.y()>rt&&x.y(rt)};let b;const _=I=>{if(I.detail.evt.button===2){const j=I.detail.target.id();for(const x of[N5,U5,D5]){const L=x(j);if(L!==void 0){b.setItems(L),b.toggleAt(I.detail.evt.pageX,I.detail.evt.pageY);return}}}},w=()=>d(),u=()=>h(),m=()=>c(),y=()=>f(),S=()=>ro(),T=()=>so(),C=()=>L5(),A=I=>g(I),P=()=>xf(),k=(I,j)=>o(I,j,!0,!1);function E(I){mi[I?"unshift":"push"](()=>{b=I,e(2,b)})}function M(I,j,x,L){x[L]=I,Vt.set(i)}const F=I=>sf(I),N=(I,j)=>v(j,I),D=()=>qn();function V(I,j,x,L){x[L]=I,Vt.set(i)}const Z=I=>af(I),lt=(I,j)=>p(j,I),K=()=>vn();function q(I,j,x,L){x[L]=I,Vt.set(i)}return[a,l,b,i,n,s,o,c,h,f,g,d,p,v,_,w,u,m,y,S,T,C,A,P,k,E,M,F,N,D,V,Z,lt,K,q,I=>O5(I),(I,j)=>p(j,I),()=>ia()]}class b4 extends Nt{constructor(t){super(),Lt(this,t,h4,c4,Mt,{},null,[-1,-1])}}export{b4 as component};
