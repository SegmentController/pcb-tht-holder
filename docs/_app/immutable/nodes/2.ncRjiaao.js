import{s as Mt,b as mt,v as Gt,h as _t,j as O,g as R,X as Ct,aa as Sn,B as Vi,p as Q,q as pt,e as ft,c as ut,d as st,n as Yt,i as zn,D as wi,w as te,x as ee,y as ie,z as ne,o as K,_ as Uc,a9 as rs,a6 as uf,Y as Di,a0 as X,a2 as ye,a1 as ke,Z as Xr,$ as W,r as zi,k as Et,m as pi,a3 as Ke,aj as df,a4 as qe,ak as gf,ae as mi,H as pf,ai as Jn,ab as mf,C as Fn,ag as Hn,t as vt,f as yt,l as $e,af as Vc,ah as Ie,ad as _f,a5 as vf}from"../chunks/scheduler.G6Rd7LpB.js";import{S as Nt,i as Lt,t as L,g as ce,a as B,c as he,b as tt,d as et,m as it,e as nt,f as ss,h as Go}from"../chunks/index.R4NbS2Jr.js";import{t as yf,F as lo,g as Jt,a as as,b as bt,W as bf,T as wf,e as Ee,B as os,V as H,c as Ii,P as co,L as ve,d as oe,S as Sf,M as Re,f as Pe,h as Cf,D as ho,i as Uo,R as zc,j as Hi,k as Af,l as Tf,n as Hc,C as Wc,z as at,p as kf,s as jc,q as Xc,r as Yc,v as Kc,w as qc,x as Pf,y as xf,A as Ef,E as Mf,G as Ff,H as Rf,I as Nf}from"../chunks/modalStore.iD_KK75v.js";import{w as Cn}from"../chunks/index.ZVOtqix1.js";import{b as Lf}from"../chunks/paths.qf9my7QR.js";function Of(r,t){let{enabled:e=!0,trigger:i,type:n="keydown"}=t;function s(a){const o=Array.isArray(i)?i:[i],l={alt:a.altKey,ctrl:a.ctrlKey,shift:a.shiftKey,meta:a.metaKey};for(const c of o){const h={modifier:[],preventDefault:!1,enabled:!0,...c},{modifier:f,key:d,callback:g,preventDefault:p,enabled:v}=h;if(v){if(f.length&&!(Array.isArray(f)?f:[f]).map(w=>typeof w=="string"?[w]:w).some(w=>w.every(u=>l[u])))continue;if(a.key===d){p&&a.preventDefault();const b={node:r,trigger:h,originalEvent:a};r.dispatchEvent(new CustomEvent("shortcut",{detail:b})),g?.(b)}}}}return e&&r.addEventListener(n,s),{update:a=>{const{enabled:o=!0,type:l="keydown"}=a;e&&(!o||n!==l)?r.removeEventListener(n,s):!e&&o&&r.addEventListener(l,s),e=o,n=l,i=a.trigger},destroy:()=>{r.removeEventListener(n,s)}}}function Df(r){const t=r-1;return t*t*t+1}function If(r){return--r*r*r*r*r+1}function Vo(r,{delay:t=0,duration:e=400,easing:i=Df,axis:n="y"}={}){const s=getComputedStyle(r),a=+s.opacity,o=n==="y"?"height":"width",l=parseFloat(s[o]),c=n==="y"?["top","bottom"]:["left","right"],h=c.map(_=>`${_[0].toUpperCase()}${_.slice(1)}`),f=parseFloat(s[`padding${h[0]}`]),d=parseFloat(s[`padding${h[1]}`]),g=parseFloat(s[`margin${h[0]}`]),p=parseFloat(s[`margin${h[1]}`]),v=parseFloat(s[`border${h[0]}Width`]),b=parseFloat(s[`border${h[1]}Width`]);return{delay:t,duration:e,easing:i,css:_=>`overflow: hidden;opacity: ${Math.min(_*20,1)*a};${o}: ${_*l}px;padding-${c[0]}: ${_*f}px;padding-${c[1]}: ${_*d}px;margin-${c[0]}: ${_*g}px;margin-${c[1]}: ${_*p}px;border-${c[0]}-width: ${_*v}px;border-${c[1]}-width: ${_*b}px;`}}const mn=Math.min,Li=Math.max,Yr=Math.round,cr=Math.floor,_i=r=>({x:r,y:r}),Bf={left:"right",right:"left",bottom:"top",top:"bottom"},Gf={start:"end",end:"start"};function Va(r,t,e){return Li(r,mn(t,e))}function Qn(r,t){return typeof r=="function"?r(t):r}function Bi(r){return r.split("-")[0]}function Zn(r){return r.split("-")[1]}function $c(r){return r==="x"?"y":"x"}function fo(r){return r==="y"?"height":"width"}function ls(r){return["top","bottom"].includes(Bi(r))?"y":"x"}function uo(r){return $c(ls(r))}function Uf(r,t,e){e===void 0&&(e=!1);const i=Zn(r),n=uo(r),s=fo(n);let a=n==="x"?i===(e?"end":"start")?"right":"left":i==="start"?"bottom":"top";return t.reference[s]>t.floating[s]&&(a=Kr(a)),[a,Kr(a)]}function Vf(r){const t=Kr(r);return[za(r),t,za(t)]}function za(r){return r.replace(/start|end/g,t=>Gf[t])}function zf(r,t,e){const i=["left","right"],n=["right","left"],s=["top","bottom"],a=["bottom","top"];switch(r){case"top":case"bottom":return e?t?n:i:t?i:n;case"left":case"right":return t?s:a;default:return[]}}function Hf(r,t,e,i){const n=Zn(r);let s=zf(Bi(r),e==="start",i);return n&&(s=s.map(a=>a+"-"+n),t&&(s=s.concat(s.map(za)))),s}function Kr(r){return r.replace(/left|right|bottom|top/g,t=>Bf[t])}function Wf(r){return{top:0,right:0,bottom:0,left:0,...r}}function Jc(r){return typeof r!="number"?Wf(r):{top:r,right:r,bottom:r,left:r}}function qr(r){return{...r,top:r.y,left:r.x,right:r.x+r.width,bottom:r.y+r.height}}function zo(r,t,e){let{reference:i,floating:n}=r;const s=ls(t),a=uo(t),o=fo(a),l=Bi(t),c=s==="y",h=i.x+i.width/2-n.width/2,f=i.y+i.height/2-n.height/2,d=i[o]/2-n[o]/2;let g;switch(l){case"top":g={x:h,y:i.y-n.height};break;case"bottom":g={x:h,y:i.y+i.height};break;case"right":g={x:i.x+i.width,y:f};break;case"left":g={x:i.x-n.width,y:f};break;default:g={x:i.x,y:i.y}}switch(Zn(t)){case"start":g[a]-=d*(e&&c?-1:1);break;case"end":g[a]+=d*(e&&c?-1:1);break}return g}const jf=async(r,t,e)=>{const{placement:i="bottom",strategy:n="absolute",middleware:s=[],platform:a}=e,o=s.filter(Boolean),l=await(a.isRTL==null?void 0:a.isRTL(t));let c=await a.getElementRects({reference:r,floating:t,strategy:n}),{x:h,y:f}=zo(c,i,l),d=i,g={},p=0;for(let v=0;v<o.length;v++){const{name:b,fn:_}=o[v],{x:w,y:u,data:m,reset:y}=await _({x:h,y:f,initialPlacement:i,placement:d,strategy:n,middlewareData:g,rects:c,platform:a,elements:{reference:r,floating:t}});if(h=w??h,f=u??f,g={...g,[b]:{...g[b],...m}},y&&p<=50){p++,typeof y=="object"&&(y.placement&&(d=y.placement),y.rects&&(c=y.rects===!0?await a.getElementRects({reference:r,floating:t,strategy:n}):y.rects),{x:h,y:f}=zo(c,d,l)),v=-1;continue}}return{x:h,y:f,placement:d,strategy:n,middlewareData:g}};async function Qc(r,t){var e;t===void 0&&(t={});const{x:i,y:n,platform:s,rects:a,elements:o,strategy:l}=r,{boundary:c="clippingAncestors",rootBoundary:h="viewport",elementContext:f="floating",altBoundary:d=!1,padding:g=0}=Qn(t,r),p=Jc(g),b=o[d?f==="floating"?"reference":"floating":f],_=qr(await s.getClippingRect({element:(e=await(s.isElement==null?void 0:s.isElement(b)))==null||e?b:b.contextElement||await(s.getDocumentElement==null?void 0:s.getDocumentElement(o.floating)),boundary:c,rootBoundary:h,strategy:l})),w=f==="floating"?{...a.floating,x:i,y:n}:a.reference,u=await(s.getOffsetParent==null?void 0:s.getOffsetParent(o.floating)),m=await(s.isElement==null?void 0:s.isElement(u))?await(s.getScale==null?void 0:s.getScale(u))||{x:1,y:1}:{x:1,y:1},y=qr(s.convertOffsetParentRelativeRectToViewportRelativeRect?await s.convertOffsetParentRelativeRectToViewportRelativeRect({rect:w,offsetParent:u,strategy:l}):w);return{top:(_.top-y.top+p.top)/m.y,bottom:(y.bottom-_.bottom+p.bottom)/m.y,left:(_.left-y.left+p.left)/m.x,right:(y.right-_.right+p.right)/m.x}}const Xf=r=>({name:"arrow",options:r,async fn(t){const{x:e,y:i,placement:n,rects:s,platform:a,elements:o,middlewareData:l}=t,{element:c,padding:h=0}=Qn(r,t)||{};if(c==null)return{};const f=Jc(h),d={x:e,y:i},g=uo(n),p=fo(g),v=await a.getDimensions(c),b=g==="y",_=b?"top":"left",w=b?"bottom":"right",u=b?"clientHeight":"clientWidth",m=s.reference[p]+s.reference[g]-d[g]-s.floating[p],y=d[g]-s.reference[g],S=await(a.getOffsetParent==null?void 0:a.getOffsetParent(c));let T=S?S[u]:0;(!T||!await(a.isElement==null?void 0:a.isElement(S)))&&(T=o.floating[u]||s.floating[p]);const C=m/2-y/2,A=T/2-v[p]/2-1,k=mn(f[_],A),P=mn(f[w],A),x=k,M=T-v[p]-P,F=T/2-v[p]/2+C,N=Va(x,F,M),I=!l.arrow&&Zn(n)!=null&&F!=N&&s.reference[p]/2-(F<x?k:P)-v[p]/2<0,V=I?F<x?F-x:F-M:0;return{[g]:d[g]+V,data:{[g]:N,centerOffset:F-N-V,...I&&{alignmentOffset:V}},reset:I}}}),Yf=function(r){return r===void 0&&(r={}),{name:"flip",options:r,async fn(t){var e,i;const{placement:n,middlewareData:s,rects:a,initialPlacement:o,platform:l,elements:c}=t,{mainAxis:h=!0,crossAxis:f=!0,fallbackPlacements:d,fallbackStrategy:g="bestFit",fallbackAxisSideDirection:p="none",flipAlignment:v=!0,...b}=Qn(r,t);if((e=s.arrow)!=null&&e.alignmentOffset)return{};const _=Bi(n),w=Bi(o)===o,u=await(l.isRTL==null?void 0:l.isRTL(c.floating)),m=d||(w||!v?[Kr(o)]:Vf(o));!d&&p!=="none"&&m.push(...Hf(o,v,p,u));const y=[o,...m],S=await Qc(t,b),T=[];let C=((i=s.flip)==null?void 0:i.overflows)||[];if(h&&T.push(S[_]),f){const x=Uf(n,a,u);T.push(S[x[0]],S[x[1]])}if(C=[...C,{placement:n,overflows:T}],!T.every(x=>x<=0)){var A,k;const x=(((A=s.flip)==null?void 0:A.index)||0)+1,M=y[x];if(M)return{data:{index:x,overflows:C},reset:{placement:M}};let F=(k=C.filter(N=>N.overflows[0]<=0).sort((N,I)=>N.overflows[1]-I.overflows[1])[0])==null?void 0:k.placement;if(!F)switch(g){case"bestFit":{var P;const N=(P=C.map(I=>[I.placement,I.overflows.filter(V=>V>0).reduce((V,Z)=>V+Z,0)]).sort((I,V)=>I[1]-V[1])[0])==null?void 0:P[0];N&&(F=N);break}case"initialPlacement":F=o;break}if(n!==F)return{reset:{placement:F}}}return{}}}};async function Kf(r,t){const{placement:e,platform:i,elements:n}=r,s=await(i.isRTL==null?void 0:i.isRTL(n.floating)),a=Bi(e),o=Zn(e),l=ls(e)==="y",c=["left","top"].includes(a)?-1:1,h=s&&l?-1:1,f=Qn(t,r);let{mainAxis:d,crossAxis:g,alignmentAxis:p}=typeof f=="number"?{mainAxis:f,crossAxis:0,alignmentAxis:null}:{mainAxis:0,crossAxis:0,alignmentAxis:null,...f};return o&&typeof p=="number"&&(g=o==="end"?p*-1:p),l?{x:g*h,y:d*c}:{x:d*c,y:g*h}}const qf=function(r){return r===void 0&&(r=0),{name:"offset",options:r,async fn(t){var e,i;const{x:n,y:s,placement:a,middlewareData:o}=t,l=await Kf(t,r);return a===((e=o.offset)==null?void 0:e.placement)&&(i=o.arrow)!=null&&i.alignmentOffset?{}:{x:n+l.x,y:s+l.y,data:{...l,placement:a}}}}},$f=function(r){return r===void 0&&(r={}),{name:"shift",options:r,async fn(t){const{x:e,y:i,placement:n}=t,{mainAxis:s=!0,crossAxis:a=!1,limiter:o={fn:b=>{let{x:_,y:w}=b;return{x:_,y:w}}},...l}=Qn(r,t),c={x:e,y:i},h=await Qc(t,l),f=ls(Bi(n)),d=$c(f);let g=c[d],p=c[f];if(s){const b=d==="y"?"top":"left",_=d==="y"?"bottom":"right",w=g+h[b],u=g-h[_];g=Va(w,g,u)}if(a){const b=f==="y"?"top":"left",_=f==="y"?"bottom":"right",w=p+h[b],u=p-h[_];p=Va(w,p,u)}const v=o.fn({...t,[d]:g,[f]:p});return{...v,data:{x:v.x-e,y:v.y-i}}}}};function vi(r){return Zc(r)?(r.nodeName||"").toLowerCase():"#document"}function fe(r){var t;return(r==null||(t=r.ownerDocument)==null?void 0:t.defaultView)||window}function ti(r){var t;return(t=(Zc(r)?r.ownerDocument:r.document)||window.document)==null?void 0:t.documentElement}function Zc(r){return r instanceof Node||r instanceof fe(r).Node}function Je(r){return r instanceof Element||r instanceof fe(r).Element}function Ne(r){return r instanceof HTMLElement||r instanceof fe(r).HTMLElement}function Ho(r){return typeof ShadowRoot>"u"?!1:r instanceof ShadowRoot||r instanceof fe(r).ShadowRoot}function tr(r){const{overflow:t,overflowX:e,overflowY:i,display:n}=be(r);return/auto|scroll|overlay|hidden|clip/.test(t+i+e)&&!["inline","contents"].includes(n)}function Jf(r){return["table","td","th"].includes(vi(r))}function go(r){const t=po(),e=be(r);return e.transform!=="none"||e.perspective!=="none"||(e.containerType?e.containerType!=="normal":!1)||!t&&(e.backdropFilter?e.backdropFilter!=="none":!1)||!t&&(e.filter?e.filter!=="none":!1)||["transform","perspective","filter"].some(i=>(e.willChange||"").includes(i))||["paint","layout","strict","content"].some(i=>(e.contain||"").includes(i))}function Qf(r){let t=_n(r);for(;Ne(t)&&!cs(t);){if(go(t))return t;t=_n(t)}return null}function po(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function cs(r){return["html","body","#document"].includes(vi(r))}function be(r){return fe(r).getComputedStyle(r)}function hs(r){return Je(r)?{scrollLeft:r.scrollLeft,scrollTop:r.scrollTop}:{scrollLeft:r.pageXOffset,scrollTop:r.pageYOffset}}function _n(r){if(vi(r)==="html")return r;const t=r.assignedSlot||r.parentNode||Ho(r)&&r.host||ti(r);return Ho(t)?t.host:t}function th(r){const t=_n(r);return cs(t)?r.ownerDocument?r.ownerDocument.body:r.body:Ne(t)&&tr(t)?t:th(t)}function Xn(r,t,e){var i;t===void 0&&(t=[]),e===void 0&&(e=!0);const n=th(r),s=n===((i=r.ownerDocument)==null?void 0:i.body),a=fe(n);return s?t.concat(a,a.visualViewport||[],tr(n)?n:[],a.frameElement&&e?Xn(a.frameElement):[]):t.concat(n,Xn(n,[],e))}function eh(r){const t=be(r);let e=parseFloat(t.width)||0,i=parseFloat(t.height)||0;const n=Ne(r),s=n?r.offsetWidth:e,a=n?r.offsetHeight:i,o=Yr(e)!==s||Yr(i)!==a;return o&&(e=s,i=a),{width:e,height:i,$:o}}function mo(r){return Je(r)?r:r.contextElement}function pn(r){const t=mo(r);if(!Ne(t))return _i(1);const e=t.getBoundingClientRect(),{width:i,height:n,$:s}=eh(t);let a=(s?Yr(e.width):e.width)/i,o=(s?Yr(e.height):e.height)/n;return(!a||!Number.isFinite(a))&&(a=1),(!o||!Number.isFinite(o))&&(o=1),{x:a,y:o}}const Zf=_i(0);function ih(r){const t=fe(r);return!po()||!t.visualViewport?Zf:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function tu(r,t,e){return t===void 0&&(t=!1),!e||t&&e!==fe(r)?!1:t}function Gi(r,t,e,i){t===void 0&&(t=!1),e===void 0&&(e=!1);const n=r.getBoundingClientRect(),s=mo(r);let a=_i(1);t&&(i?Je(i)&&(a=pn(i)):a=pn(r));const o=tu(s,e,i)?ih(s):_i(0);let l=(n.left+o.x)/a.x,c=(n.top+o.y)/a.y,h=n.width/a.x,f=n.height/a.y;if(s){const d=fe(s),g=i&&Je(i)?fe(i):i;let p=d.frameElement;for(;p&&i&&g!==d;){const v=pn(p),b=p.getBoundingClientRect(),_=be(p),w=b.left+(p.clientLeft+parseFloat(_.paddingLeft))*v.x,u=b.top+(p.clientTop+parseFloat(_.paddingTop))*v.y;l*=v.x,c*=v.y,h*=v.x,f*=v.y,l+=w,c+=u,p=fe(p).frameElement}}return qr({width:h,height:f,x:l,y:c})}function eu(r){let{rect:t,offsetParent:e,strategy:i}=r;const n=Ne(e),s=ti(e);if(e===s)return t;let a={scrollLeft:0,scrollTop:0},o=_i(1);const l=_i(0);if((n||!n&&i!=="fixed")&&((vi(e)!=="body"||tr(s))&&(a=hs(e)),Ne(e))){const c=Gi(e);o=pn(e),l.x=c.x+e.clientLeft,l.y=c.y+e.clientTop}return{width:t.width*o.x,height:t.height*o.y,x:t.x*o.x-a.scrollLeft*o.x+l.x,y:t.y*o.y-a.scrollTop*o.y+l.y}}function iu(r){return Array.from(r.getClientRects())}function nh(r){return Gi(ti(r)).left+hs(r).scrollLeft}function nu(r){const t=ti(r),e=hs(r),i=r.ownerDocument.body,n=Li(t.scrollWidth,t.clientWidth,i.scrollWidth,i.clientWidth),s=Li(t.scrollHeight,t.clientHeight,i.scrollHeight,i.clientHeight);let a=-e.scrollLeft+nh(r);const o=-e.scrollTop;return be(i).direction==="rtl"&&(a+=Li(t.clientWidth,i.clientWidth)-n),{width:n,height:s,x:a,y:o}}function ru(r,t){const e=fe(r),i=ti(r),n=e.visualViewport;let s=i.clientWidth,a=i.clientHeight,o=0,l=0;if(n){s=n.width,a=n.height;const c=po();(!c||c&&t==="fixed")&&(o=n.offsetLeft,l=n.offsetTop)}return{width:s,height:a,x:o,y:l}}function su(r,t){const e=Gi(r,!0,t==="fixed"),i=e.top+r.clientTop,n=e.left+r.clientLeft,s=Ne(r)?pn(r):_i(1),a=r.clientWidth*s.x,o=r.clientHeight*s.y,l=n*s.x,c=i*s.y;return{width:a,height:o,x:l,y:c}}function Wo(r,t,e){let i;if(t==="viewport")i=ru(r,e);else if(t==="document")i=nu(ti(r));else if(Je(t))i=su(t,e);else{const n=ih(r);i={...t,x:t.x-n.x,y:t.y-n.y}}return qr(i)}function rh(r,t){const e=_n(r);return e===t||!Je(e)||cs(e)?!1:be(e).position==="fixed"||rh(e,t)}function au(r,t){const e=t.get(r);if(e)return e;let i=Xn(r,[],!1).filter(o=>Je(o)&&vi(o)!=="body"),n=null;const s=be(r).position==="fixed";let a=s?_n(r):r;for(;Je(a)&&!cs(a);){const o=be(a),l=go(a);!l&&o.position==="fixed"&&(n=null),(s?!l&&!n:!l&&o.position==="static"&&!!n&&["absolute","fixed"].includes(n.position)||tr(a)&&!l&&rh(r,a))?i=i.filter(h=>h!==a):n=o,a=_n(a)}return t.set(r,i),i}function ou(r){let{element:t,boundary:e,rootBoundary:i,strategy:n}=r;const a=[...e==="clippingAncestors"?au(t,this._c):[].concat(e),i],o=a[0],l=a.reduce((c,h)=>{const f=Wo(t,h,n);return c.top=Li(f.top,c.top),c.right=mn(f.right,c.right),c.bottom=mn(f.bottom,c.bottom),c.left=Li(f.left,c.left),c},Wo(t,o,n));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}}function lu(r){return eh(r)}function cu(r,t,e){const i=Ne(t),n=ti(t),s=e==="fixed",a=Gi(r,!0,s,t);let o={scrollLeft:0,scrollTop:0};const l=_i(0);if(i||!i&&!s)if((vi(t)!=="body"||tr(n))&&(o=hs(t)),i){const c=Gi(t,!0,s,t);l.x=c.x+t.clientLeft,l.y=c.y+t.clientTop}else n&&(l.x=nh(n));return{x:a.left+o.scrollLeft-l.x,y:a.top+o.scrollTop-l.y,width:a.width,height:a.height}}function jo(r,t){return!Ne(r)||be(r).position==="fixed"?null:t?t(r):r.offsetParent}function sh(r,t){const e=fe(r);if(!Ne(r))return e;let i=jo(r,t);for(;i&&Jf(i)&&be(i).position==="static";)i=jo(i,t);return i&&(vi(i)==="html"||vi(i)==="body"&&be(i).position==="static"&&!go(i))?e:i||Qf(r)||e}const hu=async function(r){let{reference:t,floating:e,strategy:i}=r;const n=this.getOffsetParent||sh,s=this.getDimensions;return{reference:cu(t,await n(e),i),floating:{x:0,y:0,...await s(e)}}};function fu(r){return be(r).direction==="rtl"}const uu={convertOffsetParentRelativeRectToViewportRelativeRect:eu,getDocumentElement:ti,getClippingRect:ou,getOffsetParent:sh,getElementRects:hu,getClientRects:iu,getDimensions:lu,getScale:pn,isElement:Je,isRTL:fu};function du(r,t){let e=null,i;const n=ti(r);function s(){clearTimeout(i),e&&e.disconnect(),e=null}function a(o,l){o===void 0&&(o=!1),l===void 0&&(l=1),s();const{left:c,top:h,width:f,height:d}=r.getBoundingClientRect();if(o||t(),!f||!d)return;const g=cr(h),p=cr(n.clientWidth-(c+f)),v=cr(n.clientHeight-(h+d)),b=cr(c),w={rootMargin:-g+"px "+-p+"px "+-v+"px "+-b+"px",threshold:Li(0,mn(1,l))||1};let u=!0;function m(y){const S=y[0].intersectionRatio;if(S!==l){if(!u)return a();S?a(!1,S):i=setTimeout(()=>{a(!1,1e-7)},100)}u=!1}try{e=new IntersectionObserver(m,{...w,root:n.ownerDocument})}catch{e=new IntersectionObserver(m,w)}e.observe(r)}return a(!0),s}function Xo(r,t,e,i){i===void 0&&(i={});const{ancestorScroll:n=!0,ancestorResize:s=!0,elementResize:a=typeof ResizeObserver=="function",layoutShift:o=typeof IntersectionObserver=="function",animationFrame:l=!1}=i,c=mo(r),h=n||s?[...c?Xn(c):[],...Xn(t)]:[];h.forEach(_=>{n&&_.addEventListener("scroll",e,{passive:!0}),s&&_.addEventListener("resize",e)});const f=c&&o?du(c,e):null;let d=-1,g=null;a&&(g=new ResizeObserver(_=>{let[w]=_;w&&w.target===c&&g&&(g.unobserve(t),cancelAnimationFrame(d),d=requestAnimationFrame(()=>{g&&g.observe(t)})),e()}),c&&!l&&g.observe(c),g.observe(t));let p,v=l?Gi(r):null;l&&b();function b(){const _=Gi(r);v&&(_.x!==v.x||_.y!==v.y||_.width!==v.width||_.height!==v.height)&&e(),v=_,p=requestAnimationFrame(b)}return e(),()=>{h.forEach(_=>{n&&_.removeEventListener("scroll",e),s&&_.removeEventListener("resize",e)}),f&&f(),g&&g.disconnect(),g=null,l&&cancelAnimationFrame(p)}}const gu=(r,t,e)=>{const i=new Map,n={platform:uu,...e},s={...n.platform,_c:i};return jf(r,t,{...n,platform:s})};function Yo(r){let t;return{c(){t=ft("div")},l(e){t=ut(e,"DIV",{}),st(t).forEach(R)},m(e,i){O(e,t,i),r[23](t)},p:Yt,d(e){e&&R(t),r[23](null)}}}function Ko(r){let t,e;const i=[{use:r[9]},{options:r[3]},{role:"tooltip"},{tabindex:r[1]?-1:void 0},r[11]];let n={$$slots:{default:[pu]},$$scope:{ctx:r}};for(let s=0;s<i.length;s+=1)n=Q(n,i[s]);return t=new lo({props:n}),t.$on("focusin",function(){zn(ai(r[1],r[7]))&&ai(r[1],r[7]).apply(this,arguments)}),t.$on("focusout",function(){zn(ai(r[1],r[8]))&&ai(r[1],r[8]).apply(this,arguments)}),t.$on("mouseenter",function(){zn(ai(r[1]&&!r[4],r[7]))&&ai(r[1]&&!r[4],r[7]).apply(this,arguments)}),t.$on("mouseleave",function(){zn(ai(r[1]&&!r[4],r[8]))&&ai(r[1]&&!r[4],r[8]).apply(this,arguments)}),{c(){tt(t.$$.fragment)},l(s){et(t.$$.fragment,s)},m(s,a){it(t,s,a),e=!0},p(s,a){r=s;const o=a[0]&2570?Jt(i,[a[0]&512&&{use:r[9]},a[0]&8&&{options:r[3]},i[2],a[0]&2&&{tabindex:r[1]?-1:void 0},a[0]&2048&&as(r[11])]):{};a[0]&16777284&&(o.$$scope={dirty:a,ctx:r}),t.$set(o)},i(s){e||(L(t.$$.fragment,s),e=!0)},o(s){B(t.$$.fragment,s),e=!1},d(s){nt(t,s)}}}function qo(r){let t,e,i;return{c(){t=ft("div"),this.h()},l(n){t=ut(n,"DIV",{class:!0}),st(t).forEach(R),this.h()},h(){K(t,"class",r[6])},m(n,s){O(n,t,s),e||(i=Uc(r[10].call(null,t)),e=!0)},p(n,s){s[0]&64&&K(t,"class",n[6])},d(n){n&&R(t),e=!1,i()}}}function pu(r){let t,e,i;const n=r[22].default,s=te(n,r,r[24],null);let a=r[2]&&qo(r);return{c(){s&&s.c(),t=mt(),a&&a.c(),e=Gt()},l(o){s&&s.l(o),t=_t(o),a&&a.l(o),e=Gt()},m(o,l){s&&s.m(o,l),O(o,t,l),a&&a.m(o,l),O(o,e,l),i=!0},p(o,l){s&&s.p&&(!i||l[0]&16777216)&&ee(s,n,o,o[24],i?ne(n,o[24],l,null):ie(o[24]),null),o[2]?a?a.p(o,l):(a=qo(o),a.c(),a.m(e.parentNode,e)):a&&(a.d(1),a=null)},i(o){i||(L(s,o),i=!0)},o(o){B(s,o),i=!1},d(o){o&&(R(t),R(e)),s&&s.d(o),a&&a.d(o)}}}function mu(r){let t,e,i,n=!r[3]&&Yo(r),s=r[0]&&r[3]&&Ko(r);return{c(){n&&n.c(),t=mt(),s&&s.c(),e=Gt()},l(a){n&&n.l(a),t=_t(a),s&&s.l(a),e=Gt()},m(a,o){n&&n.m(a,o),O(a,t,o),s&&s.m(a,o),O(a,e,o),i=!0},p(a,o){a[3]?n&&(n.d(1),n=null):n?n.p(a,o):(n=Yo(a),n.c(),n.m(t.parentNode,t)),a[0]&&a[3]?s?(s.p(a,o),o[0]&9&&L(s,1)):(s=Ko(a),s.c(),L(s,1),s.m(e.parentNode,e)):s&&(ce(),B(s,1,1,()=>{s=null}),he())},i(a){i||(L(s),i=!0)},o(a){B(s),i=!1},d(a){a&&(R(t),R(e)),n&&n.d(a),s&&s.d(a)}}}function ai(r,t){return r?t:()=>{}}function _u(r,t,e){let i;const n=["activeContent","arrow","offset","placement","trigger","triggeredBy","reference","strategy","open","yOnly","middlewares"];let s=Ct(t,n),{$$slots:a={},$$scope:o}=t,{activeContent:l=!1}=t,{arrow:c=!0}=t,{offset:h=8}=t,{placement:f="top"}=t,{trigger:d="hover"}=t,{triggeredBy:g=void 0}=t,{reference:p=void 0}=t,{strategy:v="absolute"}=t,{open:b=!1}=t,{yOnly:_=!1}=t,{middlewares:w=[Yf(),$f()]}=t;const u=Sn();let m,y,S,T,C,A=[],k=!1;const P=()=>(k=!0,setTimeout(()=>k=!1,250)),x=U=>{y===void 0&&console.error("trigger undefined"),!p&&A.includes(U.target)&&y!==U.target&&(e(3,y=U.target),P()),m&&U.type==="focusin"&&!b&&P(),e(0,b=m&&U.type==="click"&&!k?!b:!0)},M=U=>U.matches(":hover"),F=U=>U.contains(document.activeElement),N=U=>U!=null?`${U}px`:"",I=U=>{l?setTimeout(()=>{const Ft=[y,S,...A].filter(Boolean);U.type==="mouseleave"&&Ft.some(M)||U.type==="focusout"&&Ft.some(F)||e(0,b=!1)},100):e(0,b=!1)};let V;const Z={left:"right",right:"left",bottom:"top",top:"bottom"};function lt(){gu(y,S,{placement:f,strategy:v,middleware:i}).then(({x:U,y:Ft,middlewareData:Pt,placement:E,strategy:D})=>{S.style.position=D,S.style.left=_?"0":N(U),S.style.top=N(Ft),Pt.arrow&&T instanceof HTMLDivElement&&(e(20,T.style.left=N(Pt.arrow.x),T),e(20,T.style.top=N(Pt.arrow.y),T),e(21,V=Z[E.split("-")[0]]),e(20,T.style[V]=N(-T.offsetWidth/2-(t.border?1:0)),T))})}function q(U,Ft){S=U;let Pt=Xo(Ft,S,lt);return{update(E){Pt(),Pt=Xo(E,S,lt)},destroy(){Pt()}}}Vi(()=>{const U=[["focusin",x,!0],["focusout",I,!0],["click",x,m],["mouseenter",x,!m],["mouseleave",I,!m]];return g?A=[...document.querySelectorAll(g)]:A=C.previousElementSibling?[C.previousElementSibling]:[],A.length||console.error("No triggers found."),A.forEach(Ft=>{Ft.tabIndex<0&&(Ft.tabIndex=0);for(const[Pt,E,D]of U)D&&Ft.addEventListener(Pt,E)}),p?(e(3,y=document.querySelector(p)??document.body),y===document.body?console.error(`Popup reference not found: '${p}'`):(y.addEventListener("focusout",I),m||y.addEventListener("mouseleave",I))):e(3,y=A[0]),()=>{A.forEach(Ft=>{if(Ft)for(const[Pt,E]of U)Ft.removeEventListener(Pt,E)}),y&&(y.removeEventListener("focusout",I),y.removeEventListener("mouseleave",I))}});let J;function gt(U){return e(20,T=U),{destroy(){e(20,T=null)}}}function At(U){wi[U?"unshift":"push"](()=>{C=U,e(5,C)})}return r.$$set=U=>{e(36,t=Q(Q({},t),pt(U))),e(11,s=Ct(t,n)),"activeContent"in U&&e(1,l=U.activeContent),"arrow"in U&&e(2,c=U.arrow),"offset"in U&&e(12,h=U.offset),"placement"in U&&e(13,f=U.placement),"trigger"in U&&e(14,d=U.trigger),"triggeredBy"in U&&e(15,g=U.triggeredBy),"reference"in U&&e(16,p=U.reference),"strategy"in U&&e(17,v=U.strategy),"open"in U&&e(0,b=U.open),"yOnly"in U&&e(18,_=U.yOnly),"middlewares"in U&&e(19,w=U.middlewares),"$$scope"in U&&e(24,o=U.$$scope)},r.$$.update=()=>{r.$$.dirty[0]&16384&&e(4,m=d==="click"),r.$$.dirty[0]&1&&u("show",b),r.$$.dirty[0]&8200&&f&&(e(3,y),e(13,f)),r.$$.dirty[0]&1576960&&(i=[...w,qf(+h),T&&Xf({element:T,padding:10})]),e(6,J=yf("absolute pointer-events-none block w-[10px] h-[10px] rotate-45 bg-inherit border-inherit",t.border&&V==="bottom"&&"border-b border-e",t.border&&V==="top"&&"border-t border-s ",t.border&&V==="right"&&"border-t border-e ",t.border&&V==="left"&&"border-b border-s "))},t=pt(t),[b,l,c,y,m,C,J,x,I,q,gt,s,h,f,d,g,p,v,_,w,T,V,a,At,o]}class vu extends Nt{constructor(t){super(),Lt(this,t,_u,mu,Mt,{activeContent:1,arrow:2,offset:12,placement:13,trigger:14,triggeredBy:15,reference:16,strategy:17,open:0,yOnly:18,middlewares:19},null,[-1,-1])}}const yu=r=>({}),$o=r=>({}),bu=r=>({}),Jo=r=>({});function Qo(r){let t,e;const i=r[12].header,n=te(i,r,r[15],Jo);return{c(){t=ft("div"),n&&n.c(),this.h()},l(s){t=ut(s,"DIV",{class:!0});var a=st(t);n&&n.l(a),a.forEach(R),this.h()},h(){K(t,"class",r[2])},m(s,a){O(s,t,a),n&&n.m(t,null),e=!0},p(s,a){n&&n.p&&(!e||a&32768)&&ee(n,i,s,s[15],e?ne(i,s[15],a,bu):ie(s[15]),Jo)},i(s){e||(L(n,s),e=!0)},o(s){B(n,s),e=!1},d(s){s&&R(t),n&&n.d(s)}}}function Zo(r){let t,e;const i=r[12].footer,n=te(i,r,r[15],$o);return{c(){t=ft("div"),n&&n.c(),this.h()},l(s){t=ut(s,"DIV",{class:!0});var a=st(t);n&&n.l(a),a.forEach(R),this.h()},h(){K(t,"class",r[4])},m(s,a){O(s,t,a),n&&n.m(t,null),e=!0},p(s,a){n&&n.p&&(!e||a&32768)&&ee(n,i,s,s[15],e?ne(i,s[15],a,yu):ie(s[15]),$o)},i(s){e||(L(n,s),e=!0)},o(s){B(n,s),e=!1},d(s){s&&R(t),n&&n.d(s)}}}function wu(r){let t,e,i,n,s,a=r[6].header&&Qo(r);const o=r[12].default,l=te(o,r,r[15],null);let c=r[6].footer&&Zo(r);return{c(){a&&a.c(),t=mt(),e=ft("ul"),l&&l.c(),i=mt(),c&&c.c(),n=Gt(),this.h()},l(h){a&&a.l(h),t=_t(h),e=ut(h,"UL",{class:!0});var f=st(e);l&&l.l(f),f.forEach(R),i=_t(h),c&&c.l(h),n=Gt(),this.h()},h(){K(e,"class",r[3])},m(h,f){a&&a.m(h,f),O(h,t,f),O(h,e,f),l&&l.m(e,null),O(h,i,f),c&&c.m(h,f),O(h,n,f),s=!0},p(h,f){h[6].header?a?(a.p(h,f),f&64&&L(a,1)):(a=Qo(h),a.c(),L(a,1),a.m(t.parentNode,t)):a&&(ce(),B(a,1,1,()=>{a=null}),he()),l&&l.p&&(!s||f&32768)&&ee(l,o,h,h[15],s?ne(o,h[15],f,null):ie(h[15]),null),h[6].footer?c?(c.p(h,f),f&64&&L(c,1)):(c=Zo(h),c.c(),L(c,1),c.m(n.parentNode,n)):c&&(ce(),B(c,1,1,()=>{c=null}),he())},i(h){s||(L(a),L(l,h),L(c),s=!0)},o(h){B(a),B(l,h),B(c),s=!1},d(h){h&&(R(t),R(e),R(i),R(n)),a&&a.d(h),l&&l.d(h),c&&c.d(h)}}}function Su(r){let t,e,i;const n=[{activeContent:!0},r[5],{class:r[1]}];function s(o){r[13](o)}let a={$$slots:{default:[wu]},$$scope:{ctx:r}};for(let o=0;o<n.length;o+=1)a=Q(a,n[o]);return r[0]!==void 0&&(a.open=r[0]),t=new vu({props:a}),wi.push(()=>ss(t,"open",s)),t.$on("show",r[14]),{c(){tt(t.$$.fragment)},l(o){et(t.$$.fragment,o)},m(o,l){it(t,o,l),i=!0},p(o,[l]){const c=l&34?Jt(n,[n[0],l&32&&as(o[5]),l&2&&{class:o[1]}]):{};l&32832&&(c.$$scope={dirty:l,ctx:o}),!e&&l&1&&(e=!0,c.open=o[0],rs(()=>e=!1)),t.$set(c)},i(o){i||(L(t.$$.fragment,o),i=!0)},o(o){B(t.$$.fragment,o),i=!1},d(o){nt(t,o)}}}function Cu(r,t,e){const i=["activeUrl","open","containerClass","headerClass","footerClass","activeClass"];let n=Ct(t,i),{$$slots:s={},$$scope:a}=t;const o=uf(s),l=Cn("");let{activeUrl:c=""}=t,{open:h=!1}=t,{containerClass:f="divide-y z-50"}=t,{headerClass:d="py-1 overflow-hidden rounded-t-lg"}=t,{footerClass:g="py-1 overflow-hidden rounded-b-lg"}=t,{activeClass:p="text-primary-700 dark:text-primary-700 hover:text-primary-900 dark:hover:text-primary-900"}=t,v=bt(p,t.classActive);Di("DropdownType",{activeClass:v}),Di("activeUrl",l);let b=bt(f,t.classContainer),_=bt(d,t.classHeader),w=bt("py-1",t.class),u=bt(g,t.classFooter);function m(S){h=S,e(0,h)}function y(S){X.call(this,r,S)}return r.$$set=S=>{e(18,t=Q(Q({},t),pt(S))),e(5,n=Ct(t,i)),"activeUrl"in S&&e(7,c=S.activeUrl),"open"in S&&e(0,h=S.open),"containerClass"in S&&e(8,f=S.containerClass),"headerClass"in S&&e(9,d=S.headerClass),"footerClass"in S&&e(10,g=S.footerClass),"activeClass"in S&&e(11,p=S.activeClass),"$$scope"in S&&e(15,a=S.$$scope)},r.$$.update=()=>{r.$$.dirty&128&&l.set(c),e(5,n.arrow=n.arrow??!1,n),e(5,n.trigger=n.trigger??"click",n),e(5,n.placement=n.placement??"bottom",n),e(5,n.color=n.color??"dropdown",n),e(5,n.shadow=n.shadow??!0,n),e(5,n.rounded=n.rounded??!0,n)},t=pt(t),[h,b,_,w,u,n,o,c,f,d,g,p,s,m,y,a]}class Ha extends Nt{constructor(t){super(),Lt(this,t,Cu,Su,Mt,{activeUrl:7,open:0,containerClass:8,headerClass:9,footerClass:10,activeClass:11})}}function Au(r){let t,e,i=[r[1],{class:e=bt(r[0],r[2].class)}],n={};for(let s=0;s<i.length;s+=1)n=Q(n,i[s]);return{c(){t=ft("div"),this.h()},l(s){t=ut(s,"DIV",{class:!0}),st(t).forEach(R),this.h()},h(){ye(t,n)},m(s,a){O(s,t,a)},p(s,[a]){ye(t,n=Jt(i,[a&2&&s[1],a&5&&e!==(e=bt(s[0],s[2].class))&&{class:e}]))},i:Yt,o:Yt,d(s){s&&R(t)}}}function Tu(r,t,e){const i=["divClass"];let n=Ct(t,i),{divClass:s="my-1 h-px bg-gray-100 dark:bg-gray-600"}=t;return r.$$set=a=>{e(2,t=Q(Q({},t),pt(a))),e(1,n=Ct(t,i)),"divClass"in a&&e(0,s=a.divClass)},t=pt(t),[s,n,t]}class ah extends Nt{constructor(t){super(),Lt(this,t,Tu,Au,Mt,{divClass:0})}}function aa(r){let t,e,i,n,s,a;const o=r[9].default,l=te(o,r,r[18],null);let c=[{href:r[0]},{type:e=r[0]?void 0:"button"},{role:i=r[0]?"link":"button"},r[4],{class:r[2]}],h={};for(let f=0;f<c.length;f+=1)h=Q(h,c[f]);return{c(){t=ft(r[0]?"a":"button"),l&&l.c(),this.h()},l(f){t=ut(f,((r[0]?"a":"button")||"null").toUpperCase(),{href:!0,type:!0,role:!0,class:!0});var d=st(t);l&&l.l(d),d.forEach(R),this.h()},h(){Xr(r[0]?"a":"button")(t,h)},m(f,d){O(f,t,d),l&&l.m(t,null),n=!0,s||(a=[W(t,"click",r[10]),W(t,"change",r[11]),W(t,"keydown",r[12]),W(t,"keyup",r[13]),W(t,"focus",r[14]),W(t,"blur",r[15]),W(t,"mouseenter",r[16]),W(t,"mouseleave",r[17])],s=!0)},p(f,d){l&&l.p&&(!n||d&262144)&&ee(l,o,f,f[18],n?ne(o,f[18],d,null):ie(f[18]),null),Xr(f[0]?"a":"button")(t,h=Jt(c,[(!n||d&1)&&{href:f[0]},(!n||d&1&&e!==(e=f[0]?void 0:"button"))&&{type:e},(!n||d&1&&i!==(i=f[0]?"link":"button"))&&{role:i},d&16&&f[4],(!n||d&4)&&{class:f[2]}]))},i(f){n||(L(l,f),n=!0)},o(f){B(l,f),n=!1},d(f){f&&R(t),l&&l.d(f),s=!1,zi(a)}}}function ku(r){let t=r[0]?"a":"button",e,i,n=(r[0]?"a":"button")&&aa(r);return{c(){n&&n.c(),e=Gt()},l(s){n&&n.l(s),e=Gt()},m(s,a){n&&n.m(s,a),O(s,e,a),i=!0},p(s,a){s[0],t?Mt(t,s[0]?"a":"button")?(n.d(1),n=aa(s),t=s[0]?"a":"button",n.c(),n.m(e.parentNode,e)):n.p(s,a):(n=aa(s),t=s[0]?"a":"button",n.c(),n.m(e.parentNode,e))},i(s){i||(L(n,s),i=!0)},o(s){B(n,s),i=!1},d(s){s&&R(e),n&&n.d(s)}}}function Pu(r){let t,e;return t=new bf({props:{tag:"li",show:r[1],use:r[3],$$slots:{default:[ku]},$$scope:{ctx:r}}}),{c(){tt(t.$$.fragment)},l(i){et(t.$$.fragment,i)},m(i,n){it(t,i,n),e=!0},p(i,[n]){const s={};n&2&&(s.show=i[1]),n&262165&&(s.$$scope={dirty:n,ctx:i}),t.$set(s)},i(i){e||(L(t.$$.fragment,i),e=!0)},o(i){B(t.$$.fragment,i),e=!1},d(i){nt(t,i)}}}function xu(r,t,e){let i,n;const s=["defaultClass","href","activeClass"];let a=Ct(t,s),{$$slots:o={},$$scope:l}=t,{defaultClass:c="font-medium py-2 px-4 text-sm hover:bg-gray-100 dark:hover:bg-gray-600"}=t,{href:h=void 0}=t,{activeClass:f=void 0}=t;const d=ke("DropdownType")??{},g=ke("activeUrl");let p="";g.subscribe(A=>{e(7,p=A)});let v=!0;function b(A){e(1,v=A.parentElement?.tagName==="UL")}function _(A){X.call(this,r,A)}function w(A){X.call(this,r,A)}function u(A){X.call(this,r,A)}function m(A){X.call(this,r,A)}function y(A){X.call(this,r,A)}function S(A){X.call(this,r,A)}function T(A){X.call(this,r,A)}function C(A){X.call(this,r,A)}return r.$$set=A=>{e(21,t=Q(Q({},t),pt(A))),e(4,a=Ct(t,s)),"defaultClass"in A&&e(5,c=A.defaultClass),"href"in A&&e(0,h=A.href),"activeClass"in A&&e(6,f=A.activeClass),"$$scope"in A&&e(18,l=A.$$scope)},r.$$.update=()=>{r.$$.dirty&129&&e(8,i=p?h===p:!1),e(2,n=bt(c,h?"block":"w-full text-left",i&&(f??d.activeClass),t.class))},t=pt(t),[h,v,n,b,a,c,f,p,i,o,_,w,u,m,y,S,T,C,l]}class Xe extends Nt{constructor(t){super(),Lt(this,t,xu,Pu,Mt,{defaultClass:5,href:0,activeClass:6})}}function Eu(r){let t,e,i,n,s,a,o,l;const c=r[8].default,h=te(c,r,r[7],null);let f=[r[6],{type:"file"},{class:"hidden"}],d={};for(let g=0;g<f.length;g+=1)d=Q(d,f[g]);return{c(){t=ft("button"),e=ft("label"),h&&h.c(),i=mt(),n=ft("input"),this.h()},l(g){t=ut(g,"BUTTON",{class:!0,type:!0});var p=st(t);e=ut(p,"LABEL",{class:!0,tabindex:!0});var v=st(e);h&&h.l(v),i=_t(v),n=ut(v,"INPUT",{type:!0,class:!0}),v.forEach(R),p.forEach(R),this.h()},h(){ye(n,d),K(e,"class","flex flex-col items-center"),K(e,"tabindex","0"),K(t,"class",s=bt(r[2],r[5].class)),K(t,"type","button")},m(g,p){O(g,t,p),Et(t,e),h&&h.m(e,null),Et(e,i),Et(e,n),n.autofocus&&n.focus(),r[21](n),a=!0,o||(l=[W(n,"change",r[20]),W(n,"change",r[18]),W(n,"click",r[19]),W(t,"keydown",r[4]),W(t,"focus",r[9]),W(t,"blur",r[10]),W(t,"mouseenter",r[11]),W(t,"mouseleave",r[12]),W(t,"mouseover",r[13]),W(t,"dragenter",r[14]),W(t,"dragleave",r[15]),W(t,"dragover",r[16]),W(t,"drop",r[17])],o=!0)},p(g,[p]){h&&h.p&&(!a||p&128)&&ee(h,c,g,g[7],a?ne(c,g[7],p,null):ie(g[7]),null),ye(n,d=Jt(f,[p&64&&g[6],{type:"file"},{class:"hidden"}])),(!a||p&36&&s!==(s=bt(g[2],g[5].class)))&&K(t,"class",s)},i(g){a||(L(h,g),a=!0)},o(g){B(h,g),a=!1},d(g){g&&R(t),h&&h.d(g),r[21](null),o=!1,zi(l)}}}function Mu(r,t,e){const i=["value","files","defaultClass"];let n=Ct(t,i),{$$slots:s={},$$scope:a}=t,{value:o=""}=t,{files:l=void 0}=t,{defaultClass:c="flex flex-col justify-center items-center w-full h-64 bg-gray-50 rounded-lg border-2 border-gray-300 border-dashed cursor-pointer dark:hover:bg-bray-800 dark:bg-gray-700 hover:bg-gray-100 dark:border-gray-600 dark:hover:border-gray-500 dark:hover:bg-gray-600"}=t,h;function f(A){[" ","Enter"].includes(A.key)&&(A.preventDefault(),h.click())}function d(A){X.call(this,r,A)}function g(A){X.call(this,r,A)}function p(A){X.call(this,r,A)}function v(A){X.call(this,r,A)}function b(A){X.call(this,r,A)}function _(A){X.call(this,r,A)}function w(A){X.call(this,r,A)}function u(A){X.call(this,r,A)}function m(A){X.call(this,r,A)}function y(A){X.call(this,r,A)}function S(A){X.call(this,r,A)}function T(){o=this.value,l=this.files,e(0,o),e(1,l)}function C(A){wi[A?"unshift":"push"](()=>{h=A,e(3,h)})}return r.$$set=A=>{e(5,t=Q(Q({},t),pt(A))),e(6,n=Ct(t,i)),"value"in A&&e(0,o=A.value),"files"in A&&e(1,l=A.files),"defaultClass"in A&&e(2,c=A.defaultClass),"$$scope"in A&&e(7,a=A.$$scope)},t=pt(t),[o,l,c,h,f,t,n,a,s,d,g,p,v,b,_,w,u,m,y,S,T,C]}class Fu extends Nt{constructor(t){super(),Lt(this,t,Mu,Eu,Mt,{value:0,files:1,defaultClass:2})}}function Ru(r){let t,e,i;const n=r[3].default,s=te(n,r,r[2],null);return{c(){t=ft("kbd"),s&&s.c(),this.h()},l(a){t=ut(a,"KBD",{class:!0});var o=st(t);s&&s.l(o),o.forEach(R),this.h()},h(){K(t,"class",e=bt(r[0],r[1].class))},m(a,o){O(a,t,o),s&&s.m(t,null),i=!0},p(a,[o]){s&&s.p&&(!i||o&4)&&ee(s,n,a,a[2],i?ne(n,a[2],o,null):ie(a[2]),null),(!i||o&3&&e!==(e=bt(a[0],a[1].class)))&&K(t,"class",e)},i(a){i||(L(s,a),i=!0)},o(a){B(s,a),i=!1},d(a){a&&R(t),s&&s.d(a)}}}function Nu(r,t,e){let{$$slots:i={},$$scope:n}=t,{kbdClass:s="text-xs font-semibold text-gray-800 bg-gray-100 border border-gray-200 rounded-lg dark:bg-gray-600 dark:text-gray-100 dark:border-gray-500"}=t;return r.$$set=a=>{e(1,t=Q(Q({},t),pt(a))),"kbdClass"in a&&e(0,s=a.kbdClass),"$$scope"in a&&e(2,n=a.$$scope)},t=pt(t),[s,t,n,i]}class er extends Nt{constructor(t){super(),Lt(this,t,Nu,Ru,Mt,{kbdClass:0})}}function Lu(r){let t,e,i;const n=r[3].default,s=te(n,r,r[2],null);return{c(){t=ft("div"),s&&s.c(),this.h()},l(a){t=ut(a,"DIV",{class:!0});var o=st(t);s&&s.l(o),o.forEach(R),this.h()},h(){K(t,"class",e=bt("mx-auto flex flex-wrap justify-between items-center ",r[0]?"w-full":"container",r[1].class))},m(a,o){O(a,t,o),s&&s.m(t,null),i=!0},p(a,[o]){s&&s.p&&(!i||o&4)&&ee(s,n,a,a[2],i?ne(n,a[2],o,null):ie(a[2]),null),(!i||o&3&&e!==(e=bt("mx-auto flex flex-wrap justify-between items-center ",a[0]?"w-full":"container",a[1].class)))&&K(t,"class",e)},i(a){i||(L(s,a),i=!0)},o(a){B(s,a),i=!1},d(a){a&&R(t),s&&s.d(a)}}}function Ou(r,t,e){let{$$slots:i={},$$scope:n}=t,{fluid:s=!1}=t;return r.$$set=a=>{e(1,t=Q(Q({},t),pt(a))),"fluid"in a&&e(0,s=a.fluid),"$$scope"in a&&e(2,n=a.$$scope)},t=pt(t),[s,t,n,i]}class oh extends Nt{constructor(t){super(),Lt(this,t,Ou,Lu,Mt,{fluid:0})}}const Du=r=>({hidden:r&2}),tl=r=>({hidden:r[1],toggle:r[3],NavContainer:oh});function Iu(r){let t;const e=r[6].default,i=te(e,r,r[7],tl);return{c(){i&&i.c()},l(n){i&&i.l(n)},m(n,s){i&&i.m(n,s),t=!0},p(n,s){i&&i.p&&(!t||s&130)&&ee(i,e,n,n[7],t?ne(e,n[7],s,Du):ie(n[7]),tl)},i(n){t||(L(i,n),t=!0)},o(n){B(i,n),t=!1},d(n){i&&i.d(n)}}}function Bu(r){let t,e;return t=new oh({props:{fluid:r[0],$$slots:{default:[Iu]},$$scope:{ctx:r}}}),{c(){tt(t.$$.fragment)},l(i){et(t.$$.fragment,i)},m(i,n){it(t,i,n),e=!0},p(i,n){const s={};n&1&&(s.fluid=i[0]),n&130&&(s.$$scope={dirty:n,ctx:i}),t.$set(s)},i(i){e||(L(t.$$.fragment,i),e=!0)},o(i){B(t.$$.fragment,i),e=!1},d(i){nt(t,i)}}}function Gu(r){let t,e;const i=[{tag:"nav"},r[4],{class:bt("px-2 sm:px-4 py-2.5 w-full",r[5].class)}];let n={$$slots:{default:[Bu]},$$scope:{ctx:r}};for(let s=0;s<i.length;s+=1)n=Q(n,i[s]);return t=new lo({props:n}),{c(){tt(t.$$.fragment)},l(s){et(t.$$.fragment,s)},m(s,a){it(t,s,a),e=!0},p(s,[a]){const o=a&48?Jt(i,[i[0],a&16&&as(s[4]),a&32&&{class:bt("px-2 sm:px-4 py-2.5 w-full",s[5].class)}]):{};a&131&&(o.$$scope={dirty:a,ctx:s}),t.$set(o)},i(s){e||(L(t.$$.fragment,s),e=!0)},o(s){B(t.$$.fragment,s),e=!1},d(s){nt(t,s)}}}function Uu(r,t,e){const i=["fluid"];let n=Ct(t,i),s,{$$slots:a={},$$scope:o}=t,{fluid:l=!1}=t,c=Cn(!0);pi(r,c,f=>e(1,s=f)),Di("navHidden",c);let h=()=>c.update(f=>!f);return r.$$set=f=>{e(5,t=Q(Q({},t),pt(f))),e(4,n=Ct(t,i)),"fluid"in f&&e(0,l=f.fluid),"$$scope"in f&&e(7,o=f.$$scope)},r.$$.update=()=>{e(4,n.color=n.color??"navbar",n)},t=pt(t),[l,s,c,h,n,t,a,o]}class Vu extends Nt{constructor(t){super(),Lt(this,t,Uu,Gu,Mt,{fluid:0})}}function zu(r){let t,e,i;const n=r[4].default,s=te(n,r,r[3],null);let a=[{href:r[0]},r[1],{class:e=bt("flex items-center",r[2].class)}],o={};for(let l=0;l<a.length;l+=1)o=Q(o,a[l]);return{c(){t=ft("a"),s&&s.c(),this.h()},l(l){t=ut(l,"A",{href:!0,class:!0});var c=st(t);s&&s.l(c),c.forEach(R),this.h()},h(){ye(t,o)},m(l,c){O(l,t,c),s&&s.m(t,null),i=!0},p(l,[c]){s&&s.p&&(!i||c&8)&&ee(s,n,l,l[3],i?ne(n,l[3],c,null):ie(l[3]),null),ye(t,o=Jt(a,[(!i||c&1)&&{href:l[0]},c&2&&l[1],(!i||c&4&&e!==(e=bt("flex items-center",l[2].class)))&&{class:e}]))},i(l){i||(L(s,l),i=!0)},o(l){B(s,l),i=!1},d(l){l&&R(t),s&&s.d(l)}}}function Hu(r,t,e){const i=["href"];let n=Ct(t,i),{$$slots:s={},$$scope:a}=t,{href:o=""}=t;return r.$$set=l=>{e(2,t=Q(Q({},t),pt(l))),e(1,n=Ct(t,i)),"href"in l&&e(0,o=l.href),"$$scope"in l&&e(3,a=l.$$scope)},t=pt(t),[o,n,t,a,s]}class Wu extends Nt{constructor(t){super(),Lt(this,t,Hu,zu,Mt,{href:0})}}function ju(r){let t,e,i,n,s,a=[{xmlns:"http://www.w3.org/2000/svg"},{role:"button"},{tabindex:"0"},{width:r[0]},{height:r[0]},{class:i=r[4].class},r[5],{"aria-label":r[1]},{fill:"none"},{viewBox:r[2]},{"stroke-width":"2"}],o={};for(let l=0;l<a.length;l+=1)o=Q(o,a[l]);return{c(){t=Ke("svg"),e=new df(!0),this.h()},l(l){t=qe(l,"svg",{xmlns:!0,role:!0,tabindex:!0,width:!0,height:!0,class:!0,"aria-label":!0,fill:!0,viewBox:!0,"stroke-width":!0});var c=st(t);e=gf(c,!0),c.forEach(R),this.h()},h(){e.a=null,mi(t,o)},m(l,c){O(l,t,c),e.m(r[3],t),n||(s=W(t,"click",r[8]),n=!0)},p(l,[c]){c&8&&e.p(l[3]),mi(t,o=Jt(a,[{xmlns:"http://www.w3.org/2000/svg"},{role:"button"},{tabindex:"0"},c&1&&{width:l[0]},c&1&&{height:l[0]},c&16&&i!==(i=l[4].class)&&{class:i},c&32&&l[5],c&2&&{"aria-label":l[1]},{fill:"none"},c&4&&{viewBox:l[2]},{"stroke-width":"2"}]))},i:Yt,o:Yt,d(l){l&&R(t),n=!1,s()}}}function Xu(r,t,e){const i=["size","color","variation","ariaLabel"];let n=Ct(t,i),{size:s="24"}=t,{color:a="currentColor"}=t,{variation:o="outline"}=t,{ariaLabel:l="bars 3"}=t,c,h,f=`<path stroke="${a}" stroke-linecap="round" stroke-linejoin="round" d="M4 6h16M4 12h16M4 18h16"></path> `,d=`<path fill="${a}" clip-rule="evenodd" fill-rule="evenodd" d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z"></path> `;function g(p){X.call(this,r,p)}return r.$$set=p=>{e(4,t=Q(Q({},t),pt(p))),e(5,n=Ct(t,i)),"size"in p&&e(0,s=p.size),"color"in p&&e(6,a=p.color),"variation"in p&&e(7,o=p.variation),"ariaLabel"in p&&e(1,l=p.ariaLabel)},r.$$.update=()=>{if(r.$$.dirty&128)switch(o){case"outline":e(3,h=f),e(2,c="0 0 24 24");break;case"solid":e(3,h=d),e(2,c="0 0 24 24");break;default:e(3,h=f),e(2,c="0 0 24 24")}},t=pt(t),[s,l,c,h,t,n,a,o,g]}class Yu extends Nt{constructor(t){super(),Lt(this,t,Xu,ju,Mt,{size:0,color:6,variation:7,ariaLabel:1})}}function Ku(r){let t,e;return t=new Yu({props:{class:bt(r[0],r[4].classMenu)}}),{c(){tt(t.$$.fragment)},l(i){et(t.$$.fragment,i)},m(i,n){it(t,i,n),e=!0},p(i,n){const s={};n&17&&(s.class=bt(i[0],i[4].classMenu)),t.$set(s)},i(i){e||(L(t.$$.fragment,i),e=!0)},o(i){B(t.$$.fragment,i),e=!1},d(i){nt(t,i)}}}function qu(r){let t,e;const i=[{name:"Open main menu"},r[3],{class:bt(el,r[4].class)}];let n={$$slots:{default:[Ku]},$$scope:{ctx:r}};for(let s=0;s<i.length;s+=1)n=Q(n,i[s]);return t=new wf({props:n}),t.$on("click",function(){zn(r[1]||r[2])&&(r[1]||r[2]).apply(this,arguments)}),{c(){tt(t.$$.fragment)},l(s){et(t.$$.fragment,s)},m(s,a){it(t,s,a),e=!0},p(s,[a]){r=s;const o=a&24?Jt(i,[i[0],a&8&&as(r[3]),a&16&&{class:bt(el,r[4].class)}]):{};a&81&&(o.$$scope={dirty:a,ctx:r}),t.$set(o)},i(s){e||(L(t.$$.fragment,s),e=!0)},o(s){B(t.$$.fragment,s),e=!1},d(s){nt(t,s)}}}let el="ms-3 md:hidden";function $u(r,t,e){const i=["menuClass","onClick"];let n=Ct(t,i),{menuClass:s="h-6 w-6 shrink-0"}=t,{onClick:a=void 0}=t,o=ke("navHidden")??Cn(!0);const l=c=>o.update(h=>!h);return r.$$set=c=>{e(4,t=Q(Q({},t),pt(c))),e(3,n=Ct(t,i)),"menuClass"in c&&e(0,s=c.menuClass),"onClick"in c&&e(1,a=c.onClick)},t=pt(t),[s,a,l,n,t]}class Ju extends Nt{constructor(t){super(),Lt(this,t,$u,qu,Mt,{menuClass:0,onClick:1})}}function oa(r){let t,e,i,n,s;const a=r[8].default,o=te(a,r,r[7],null);let l=[{role:e=r[0]?void 0:"link"},{href:r[0]},r[2],{class:r[1]}],c={};for(let h=0;h<l.length;h+=1)c=Q(c,l[h]);return{c(){t=ft(r[0]?"a":"div"),o&&o.c(),this.h()},l(h){t=ut(h,((r[0]?"a":"div")||"null").toUpperCase(),{role:!0,href:!0,class:!0});var f=st(t);o&&o.l(f),f.forEach(R),this.h()},h(){Xr(r[0]?"a":"div")(t,c)},m(h,f){O(h,t,f),o&&o.m(t,null),i=!0,n||(s=[W(t,"blur",r[9]),W(t,"change",r[10]),W(t,"click",r[11]),W(t,"focus",r[12]),W(t,"keydown",r[13]),W(t,"keypress",r[14]),W(t,"keyup",r[15]),W(t,"mouseenter",r[16]),W(t,"mouseleave",r[17]),W(t,"mouseover",r[18])],n=!0)},p(h,f){o&&o.p&&(!i||f&128)&&ee(o,a,h,h[7],i?ne(a,h[7],f,null):ie(h[7]),null),Xr(h[0]?"a":"div")(t,c=Jt(l,[(!i||f&1&&e!==(e=h[0]?void 0:"link"))&&{role:e},(!i||f&1)&&{href:h[0]},f&4&&h[2],(!i||f&2)&&{class:h[1]}]))},i(h){i||(L(o,h),i=!0)},o(h){B(o,h),i=!1},d(h){h&&R(t),o&&o.d(h),n=!1,zi(s)}}}function Qu(r){let t,e=r[0]?"a":"div",i,n=(r[0]?"a":"div")&&oa(r);return{c(){t=ft("li"),n&&n.c()},l(s){t=ut(s,"LI",{});var a=st(t);n&&n.l(a),a.forEach(R)},m(s,a){O(s,t,a),n&&n.m(t,null),i=!0},p(s,[a]){s[0],e?Mt(e,s[0]?"a":"div")?(n.d(1),n=oa(s),e=s[0]?"a":"div",n.c(),n.m(t,null)):n.p(s,a):(n=oa(s),e=s[0]?"a":"div",n.c(),n.m(t,null))},i(s){i||(L(n,s),i=!0)},o(s){B(n,s),i=!1},d(s){s&&R(t),n&&n.d(s)}}}function Zu(r,t,e){let i,n;const s=["href","activeClass","nonActiveClass"];let a=Ct(t,s),{$$slots:o={},$$scope:l}=t,{href:c=""}=t,{activeClass:h=void 0}=t,{nonActiveClass:f=void 0}=t;const d=ke("navbarContext")??{},g=ke("activeUrl");let p="";g.subscribe(A=>{e(5,p=A)});function v(A){X.call(this,r,A)}function b(A){X.call(this,r,A)}function _(A){X.call(this,r,A)}function w(A){X.call(this,r,A)}function u(A){X.call(this,r,A)}function m(A){X.call(this,r,A)}function y(A){X.call(this,r,A)}function S(A){X.call(this,r,A)}function T(A){X.call(this,r,A)}function C(A){X.call(this,r,A)}return r.$$set=A=>{e(21,t=Q(Q({},t),pt(A))),e(2,a=Ct(t,s)),"href"in A&&e(0,c=A.href),"activeClass"in A&&e(3,h=A.activeClass),"nonActiveClass"in A&&e(4,f=A.nonActiveClass),"$$scope"in A&&e(7,l=A.$$scope)},r.$$.update=()=>{r.$$.dirty&33&&e(6,i=p?c===p:!1),e(1,n=bt("block py-2 pe-4 ps-3 md:p-0 rounded md:border-0",i?h??d.activeClass:f??d.nonActiveClass,t.class))},t=pt(t),[c,n,a,h,f,p,i,l,o,v,b,_,w,u,m,y,S,T,C]}class il extends Nt{constructor(t){super(),Lt(this,t,Zu,Qu,Mt,{href:0,activeClass:3,nonActiveClass:4})}}function td(r){let t,e,i;const n=r[13].default,s=te(n,r,r[15],null);let a=[r[5],{class:r[2]},{hidden:r[1]}],o={};for(let l=0;l<a.length;l+=1)o=Q(o,a[l]);return{c(){t=ft("div"),e=ft("ul"),s&&s.c(),this.h()},l(l){t=ut(l,"DIV",{class:!0});var c=st(t);e=ut(c,"UL",{class:!0});var h=st(e);s&&s.l(h),h.forEach(R),c.forEach(R),this.h()},h(){K(e,"class",r[3]),ye(t,o)},m(l,c){O(l,t,c),Et(t,e),s&&s.m(e,null),i=!0},p(l,c){s&&s.p&&(!i||c&32768)&&ee(s,n,l,l[15],i?ne(n,l[15],c,null):ie(l[15]),null),(!i||c&8)&&K(e,"class",l[3]),ye(t,o=Jt(a,[c&32&&l[5],(!i||c&4)&&{class:l[2]},(!i||c&2)&&{hidden:l[1]}]))},i(l){i||(L(s,l),i=!0)},o(l){B(s,l),i=!1},d(l){l&&R(t),s&&s.d(l)}}}function ed(r){let t,e,i,n,s,a;e=new lo({props:{tag:"ul",border:!0,rounded:!0,color:"navbarUl",class:r[3],$$slots:{default:[id]},$$scope:{ctx:r}}});let o=[r[5],{class:r[2]},{role:"button"},{tabindex:"0"}],l={};for(let c=0;c<o.length;c+=1)l=Q(l,o[c]);return{c(){t=ft("div"),tt(e.$$.fragment),this.h()},l(c){t=ut(c,"DIV",{class:!0,role:!0,tabindex:!0});var h=st(t);et(e.$$.fragment,h),h.forEach(R),this.h()},h(){ye(t,l)},m(c,h){O(c,t,h),it(e,t,null),n=!0,s||(a=W(t,"click",r[14]),s=!0)},p(c,h){r=c;const f={};h&8&&(f.class=r[3]),h&32768&&(f.$$scope={dirty:h,ctx:r}),e.$set(f),ye(t,l=Jt(o,[h&32&&r[5],(!n||h&4)&&{class:r[2]},{role:"button"},{tabindex:"0"}]))},i(c){n||(L(e.$$.fragment,c),c&&pf(()=>{n&&(i||(i=Go(t,Vo,r[0],!0)),i.run(1))}),n=!0)},o(c){B(e.$$.fragment,c),c&&(i||(i=Go(t,Vo,r[0],!1)),i.run(0)),n=!1},d(c){c&&R(t),nt(e),c&&i&&i.end(),s=!1,a()}}}function id(r){let t;const e=r[13].default,i=te(e,r,r[15],null);return{c(){i&&i.c()},l(n){i&&i.l(n)},m(n,s){i&&i.m(n,s),t=!0},p(n,s){i&&i.p&&(!t||s&32768)&&ee(i,e,n,n[15],t?ne(e,n[15],s,null):ie(n[15]),null)},i(n){t||(L(i,n),t=!0)},o(n){B(i,n),t=!1},d(n){i&&i.d(n)}}}function nd(r){let t,e,i,n;const s=[ed,td],a=[];function o(l,c){return l[1]?1:0}return t=o(r),e=a[t]=s[t](r),{c(){e.c(),i=Gt()},l(l){e.l(l),i=Gt()},m(l,c){a[t].m(l,c),O(l,i,c),n=!0},p(l,[c]){let h=t;t=o(l),t===h?a[t].p(l,c):(ce(),B(a[h],1,1,()=>{a[h]=null}),he(),e=a[t],e?e.p(l,c):(e=a[t]=s[t](l),e.c()),L(e,1),e.m(i.parentNode,i))},i(l){n||(L(e),n=!0)},o(l){B(e),n=!1},d(l){l&&R(i),a[t].d(l)}}}function rd(r,t,e){const i=["activeUrl","divClass","ulClass","hidden","slideParams","activeClass","nonActiveClass"];let n=Ct(t,i),s,{$$slots:a={},$$scope:o}=t;const l=Cn("");let{activeUrl:c=""}=t,{divClass:h="w-full md:block md:w-auto"}=t,{ulClass:f="flex flex-col p-4 mt-4 md:flex-row md:space-x-8 rtl:space-x-reverse md:mt-0 md:text-sm md:font-medium"}=t,{hidden:d=void 0}=t,{slideParams:g={delay:250,duration:500,easing:If}}=t,{activeClass:p="text-white bg-primary-700 md:bg-transparent md:text-primary-700 md:dark:text-white dark:bg-primary-600 md:dark:bg-transparent"}=t,{nonActiveClass:v="text-gray-700 hover:bg-gray-100 md:hover:bg-transparent md:border-0 md:hover:text-primary-700 dark:text-gray-400 md:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white md:dark:hover:bg-transparent"}=t;Di("navbarContext",{activeClass:p,nonActiveClass:v}),Di("activeUrl",l);let b=ke("navHidden");pi(r,b,y=>e(12,s=y));let _,w,u;function m(y){X.call(this,r,y)}return r.$$set=y=>{e(17,t=Q(Q({},t),pt(y))),e(5,n=Ct(t,i)),"activeUrl"in y&&e(6,c=y.activeUrl),"divClass"in y&&e(7,h=y.divClass),"ulClass"in y&&e(8,f=y.ulClass),"hidden"in y&&e(9,d=y.hidden),"slideParams"in y&&e(0,g=y.slideParams),"activeClass"in y&&e(10,p=y.activeClass),"nonActiveClass"in y&&e(11,v=y.nonActiveClass),"$$scope"in y&&e(15,o=y.$$scope)},r.$$.update=()=>{r.$$.dirty&64&&l.set(c),r.$$.dirty&4608&&e(1,_=d??s??!0),e(2,w=bt(h,t.class)),e(3,u=bt(f,t.classUl))},t=pt(t),[g,_,w,u,b,n,c,h,f,d,p,v,s,a,m,o]}class sd extends Nt{constructor(t){super(),Lt(this,t,rd,nd,Mt,{activeUrl:6,divClass:7,ulClass:8,hidden:9,slideParams:0,activeClass:10,nonActiveClass:11})}}function ad(r){let t,e,i,n,s,a=[{xmlns:"http://www.w3.org/2000/svg"},{fill:"none"},r[7],{class:i=bt("shrink-0",r[6][r[0]],r[8].class)},{role:r[1]},{"aria-label":r[5]},{viewBox:"0 0 10 7"}],o={};for(let l=0;l<a.length;l+=1)o=Q(o,a[l]);return{c(){t=Ke("svg"),e=Ke("path"),this.h()},l(l){t=qe(l,"svg",{xmlns:!0,fill:!0,class:!0,role:!0,"aria-label":!0,viewBox:!0});var c=st(t);e=qe(c,"path",{stroke:!0,"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),st(e).forEach(R),c.forEach(R),this.h()},h(){K(e,"stroke","currentColor"),K(e,"stroke-linecap",r[2]),K(e,"stroke-linejoin",r[3]),K(e,"stroke-width",r[4]),K(e,"d","m1 1.444 4 3.791 4-3.79"),mi(t,o)},m(l,c){O(l,t,c),Et(t,e),n||(s=[W(t,"click",r[9]),W(t,"keydown",r[10]),W(t,"keyup",r[11]),W(t,"focus",r[12]),W(t,"blur",r[13]),W(t,"mouseenter",r[14]),W(t,"mouseleave",r[15]),W(t,"mouseover",r[16]),W(t,"mouseout",r[17])],n=!0)},p(l,[c]){c&4&&K(e,"stroke-linecap",l[2]),c&8&&K(e,"stroke-linejoin",l[3]),c&16&&K(e,"stroke-width",l[4]),mi(t,o=Jt(a,[{xmlns:"http://www.w3.org/2000/svg"},{fill:"none"},c&128&&l[7],c&257&&i!==(i=bt("shrink-0",l[6][l[0]],l[8].class))&&{class:i},c&2&&{role:l[1]},c&32&&{"aria-label":l[5]},{viewBox:"0 0 10 7"}]))},i:Yt,o:Yt,d(l){l&&R(t),n=!1,zi(s)}}}function od(r,t,e){const i=["size","role","strokeLinecap","strokeLinejoin","strokeWidth","ariaLabel"];let n=Ct(t,i);const s=ke("iconCtx")??{},a={xs:"w-3 h-3",sm:"w-4 h-4",md:"w-5 h-5",lg:"w-6 h-6",xl:"w-8 h-8"};let{size:o=s.size||"md"}=t,{role:l=s.role||"img"}=t,{strokeLinecap:c=s.strokeLinecap||"round"}=t,{strokeLinejoin:h=s.strokeLinejoin||"round"}=t,{strokeWidth:f=s.strokeWidth||"2"}=t,{ariaLabel:d="chevron down outline"}=t;function g(S){X.call(this,r,S)}function p(S){X.call(this,r,S)}function v(S){X.call(this,r,S)}function b(S){X.call(this,r,S)}function _(S){X.call(this,r,S)}function w(S){X.call(this,r,S)}function u(S){X.call(this,r,S)}function m(S){X.call(this,r,S)}function y(S){X.call(this,r,S)}return r.$$set=S=>{e(8,t=Q(Q({},t),pt(S))),e(7,n=Ct(t,i)),"size"in S&&e(0,o=S.size),"role"in S&&e(1,l=S.role),"strokeLinecap"in S&&e(2,c=S.strokeLinecap),"strokeLinejoin"in S&&e(3,h=S.strokeLinejoin),"strokeWidth"in S&&e(4,f=S.strokeWidth),"ariaLabel"in S&&e(5,d=S.ariaLabel)},t=pt(t),[o,l,c,h,f,d,a,n,t,g,p,v,b,_,w,u,m,y]}class lh extends Nt{constructor(t){super(),Lt(this,t,od,ad,Mt,{size:0,role:1,strokeLinecap:2,strokeLinejoin:3,strokeWidth:4,ariaLabel:5})}}function ld(r){let t,e,i,n,s,a=[{xmlns:"http://www.w3.org/2000/svg"},{fill:"currentColor"},r[4],{class:i=bt("shrink-0",r[3][r[0]],r[5].class)},{role:r[1]},{"aria-label":r[2]},{viewBox:"0 0 6 10"}],o={};for(let l=0;l<a.length;l+=1)o=Q(o,a[l]);return{c(){t=Ke("svg"),e=Ke("path"),this.h()},l(l){t=qe(l,"svg",{xmlns:!0,fill:!0,class:!0,role:!0,"aria-label":!0,viewBox:!0});var c=st(t);e=qe(c,"path",{fill:!0,d:!0}),st(e).forEach(R),c.forEach(R),this.h()},h(){K(e,"fill","currentColor"),K(e,"d","M1.01 10a.997.997 0 0 1-.705-1.705L3.59 5.006.305 1.717A.999.999 0 1 1 1.715.305L5.709 4.3a1 1 0 0 1 0 1.412L1.716 9.707A.998.998 0 0 1 1.01 10Z"),mi(t,o)},m(l,c){O(l,t,c),Et(t,e),n||(s=[W(t,"click",r[6]),W(t,"keydown",r[7]),W(t,"keyup",r[8]),W(t,"focus",r[9]),W(t,"blur",r[10]),W(t,"mouseenter",r[11]),W(t,"mouseleave",r[12]),W(t,"mouseover",r[13]),W(t,"mouseout",r[14])],n=!0)},p(l,[c]){mi(t,o=Jt(a,[{xmlns:"http://www.w3.org/2000/svg"},{fill:"currentColor"},c&16&&l[4],c&33&&i!==(i=bt("shrink-0",l[3][l[0]],l[5].class))&&{class:i},c&2&&{role:l[1]},c&4&&{"aria-label":l[2]},{viewBox:"0 0 6 10"}]))},i:Yt,o:Yt,d(l){l&&R(t),n=!1,zi(s)}}}function cd(r,t,e){const i=["size","role","ariaLabel"];let n=Ct(t,i);const s=ke("iconCtx")??{},a={xs:"w-3 h-3",sm:"w-4 h-4",md:"w-5 h-5",lg:"w-6 h-6",xl:"w-8 h-8"};let{size:o=s.size||"md"}=t,{role:l=s.role||"img"}=t,{ariaLabel:c="chevron right solid"}=t;function h(u){X.call(this,r,u)}function f(u){X.call(this,r,u)}function d(u){X.call(this,r,u)}function g(u){X.call(this,r,u)}function p(u){X.call(this,r,u)}function v(u){X.call(this,r,u)}function b(u){X.call(this,r,u)}function _(u){X.call(this,r,u)}function w(u){X.call(this,r,u)}return r.$$set=u=>{e(5,t=Q(Q({},t),pt(u))),e(4,n=Ct(t,i)),"size"in u&&e(0,o=u.size),"role"in u&&e(1,l=u.role),"ariaLabel"in u&&e(2,c=u.ariaLabel)},t=pt(t),[o,l,c,a,n,t,h,f,d,g,p,v,b,_,w]}class hd extends Nt{constructor(t){super(),Lt(this,t,cd,ld,Mt,{size:0,role:1,ariaLabel:2})}}function fd(r){let t,e,i,n,s,a=[{xmlns:"http://www.w3.org/2000/svg"},{fill:"currentColor"},r[4],{class:i=bt("shrink-0",r[3][r[0]],r[5].class)},{role:r[1]},{"aria-label":r[2]},{viewBox:"0 0 20 14"}],o={};for(let l=0;l<a.length;l+=1)o=Q(o,a[l]);return{c(){t=Ke("svg"),e=Ke("path"),this.h()},l(l){t=qe(l,"svg",{xmlns:!0,fill:!0,class:!0,role:!0,"aria-label":!0,viewBox:!0});var c=st(t);e=qe(c,"path",{fill:!0,d:!0}),st(e).forEach(R),c.forEach(R),this.h()},h(){K(e,"fill","currentColor"),K(e,"d","M11 0H2a2 2 0 0 0-2 2v10a2 2 0 0 0 2 2h9a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2Zm8.585 1.189a.994.994 0 0 0-.9-.138l-2.965.983a1 1 0 0 0-.685.949v8a1 1 0 0 0 .675.946l2.965 1.02a1.013 1.013 0 0 0 1.032-.242A1 1 0 0 0 20 12V2a1 1 0 0 0-.415-.811Z"),mi(t,o)},m(l,c){O(l,t,c),Et(t,e),n||(s=[W(t,"click",r[6]),W(t,"keydown",r[7]),W(t,"keyup",r[8]),W(t,"focus",r[9]),W(t,"blur",r[10]),W(t,"mouseenter",r[11]),W(t,"mouseleave",r[12]),W(t,"mouseover",r[13]),W(t,"mouseout",r[14])],n=!0)},p(l,[c]){mi(t,o=Jt(a,[{xmlns:"http://www.w3.org/2000/svg"},{fill:"currentColor"},c&16&&l[4],c&33&&i!==(i=bt("shrink-0",l[3][l[0]],l[5].class))&&{class:i},c&2&&{role:l[1]},c&4&&{"aria-label":l[2]},{viewBox:"0 0 20 14"}]))},i:Yt,o:Yt,d(l){l&&R(t),n=!1,zi(s)}}}function ud(r,t,e){const i=["size","role","ariaLabel"];let n=Ct(t,i);const s=ke("iconCtx")??{},a={xs:"w-3 h-3",sm:"w-4 h-4",md:"w-5 h-5",lg:"w-6 h-6",xl:"w-8 h-8"};let{size:o=s.size||"md"}=t,{role:l=s.role||"img"}=t,{ariaLabel:c="video solid"}=t;function h(u){X.call(this,r,u)}function f(u){X.call(this,r,u)}function d(u){X.call(this,r,u)}function g(u){X.call(this,r,u)}function p(u){X.call(this,r,u)}function v(u){X.call(this,r,u)}function b(u){X.call(this,r,u)}function _(u){X.call(this,r,u)}function w(u){X.call(this,r,u)}return r.$$set=u=>{e(5,t=Q(Q({},t),pt(u))),e(4,n=Ct(t,i)),"size"in u&&e(0,o=u.size),"role"in u&&e(1,l=u.role),"ariaLabel"in u&&e(2,c=u.ariaLabel)},t=pt(t),[o,l,c,a,n,t,h,f,d,g,p,v,b,_,w]}class dd extends Nt{constructor(t){super(),Lt(this,t,ud,fd,Mt,{size:0,role:1,ariaLabel:2})}}var nl=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function gd(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var _o={exports:{}},fs={},ch={},ct={};(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r._registerNode=r.Konva=r.glob=void 0;const t=Math.PI/180;function e(){return typeof window<"u"&&({}.toString.call(window)==="[object Window]"||{}.toString.call(window)==="[object global]")}r.glob=typeof nl<"u"?nl:typeof window<"u"?window:typeof WorkerGlobalScope<"u"?self:{},r.Konva={_global:r.glob,version:"9.3.0",isBrowser:e(),isUnminified:/param/.test(function(n){}.toString()),dblClickWindow:400,getAngle(n){return r.Konva.angleDeg?n*t:n},enableTrace:!1,pointerEventsEnabled:!0,autoDrawEnabled:!0,hitOnDragEnabled:!1,capturePointerEventsEnabled:!1,_mouseListenClick:!1,_touchListenClick:!1,_pointerListenClick:!1,_mouseInDblClickWindow:!1,_touchInDblClickWindow:!1,_pointerInDblClickWindow:!1,_mouseDblClickPointerId:null,_touchDblClickPointerId:null,_pointerDblClickPointerId:null,pixelRatio:typeof window<"u"&&window.devicePixelRatio||1,dragDistance:3,angleDeg:!0,showWarnings:!0,dragButtons:[0,1],isDragging(){return r.Konva.DD.isDragging},isDragReady(){return!!r.Konva.DD.node},releaseCanvasOnDestroy:!0,document:r.glob.document,_injectGlobal(n){r.glob.Konva=n}};const i=n=>{r.Konva[n.prototype.getClassName()]=n};r._registerNode=i,r.Konva._injectGlobal(r.Konva)})(ct);var It={};(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.Util=r.Transform=void 0;const t=ct;class e{constructor(m=[1,0,0,1,0,0]){this.dirty=!1,this.m=m&&m.slice()||[1,0,0,1,0,0]}reset(){this.m[0]=1,this.m[1]=0,this.m[2]=0,this.m[3]=1,this.m[4]=0,this.m[5]=0}copy(){return new e(this.m)}copyInto(m){m.m[0]=this.m[0],m.m[1]=this.m[1],m.m[2]=this.m[2],m.m[3]=this.m[3],m.m[4]=this.m[4],m.m[5]=this.m[5]}point(m){var y=this.m;return{x:y[0]*m.x+y[2]*m.y+y[4],y:y[1]*m.x+y[3]*m.y+y[5]}}translate(m,y){return this.m[4]+=this.m[0]*m+this.m[2]*y,this.m[5]+=this.m[1]*m+this.m[3]*y,this}scale(m,y){return this.m[0]*=m,this.m[1]*=m,this.m[2]*=y,this.m[3]*=y,this}rotate(m){var y=Math.cos(m),S=Math.sin(m),T=this.m[0]*y+this.m[2]*S,C=this.m[1]*y+this.m[3]*S,A=this.m[0]*-S+this.m[2]*y,k=this.m[1]*-S+this.m[3]*y;return this.m[0]=T,this.m[1]=C,this.m[2]=A,this.m[3]=k,this}getTranslation(){return{x:this.m[4],y:this.m[5]}}skew(m,y){var S=this.m[0]+this.m[2]*y,T=this.m[1]+this.m[3]*y,C=this.m[2]+this.m[0]*m,A=this.m[3]+this.m[1]*m;return this.m[0]=S,this.m[1]=T,this.m[2]=C,this.m[3]=A,this}multiply(m){var y=this.m[0]*m.m[0]+this.m[2]*m.m[1],S=this.m[1]*m.m[0]+this.m[3]*m.m[1],T=this.m[0]*m.m[2]+this.m[2]*m.m[3],C=this.m[1]*m.m[2]+this.m[3]*m.m[3],A=this.m[0]*m.m[4]+this.m[2]*m.m[5]+this.m[4],k=this.m[1]*m.m[4]+this.m[3]*m.m[5]+this.m[5];return this.m[0]=y,this.m[1]=S,this.m[2]=T,this.m[3]=C,this.m[4]=A,this.m[5]=k,this}invert(){var m=1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]),y=this.m[3]*m,S=-this.m[1]*m,T=-this.m[2]*m,C=this.m[0]*m,A=m*(this.m[2]*this.m[5]-this.m[3]*this.m[4]),k=m*(this.m[1]*this.m[4]-this.m[0]*this.m[5]);return this.m[0]=y,this.m[1]=S,this.m[2]=T,this.m[3]=C,this.m[4]=A,this.m[5]=k,this}getMatrix(){return this.m}decompose(){var m=this.m[0],y=this.m[1],S=this.m[2],T=this.m[3],C=this.m[4],A=this.m[5],k=m*T-y*S;let P={x:C,y:A,rotation:0,scaleX:0,scaleY:0,skewX:0,skewY:0};if(m!=0||y!=0){var x=Math.sqrt(m*m+y*y);P.rotation=y>0?Math.acos(m/x):-Math.acos(m/x),P.scaleX=x,P.scaleY=k/x,P.skewX=(m*S+y*T)/k,P.skewY=0}else if(S!=0||T!=0){var M=Math.sqrt(S*S+T*T);P.rotation=Math.PI/2-(T>0?Math.acos(-S/M):-Math.acos(S/M)),P.scaleX=k/M,P.scaleY=M,P.skewX=0,P.skewY=(m*S+y*T)/k}return P.rotation=r.Util._getRotation(P.rotation),P}}r.Transform=e;var i="[object Array]",n="[object Number]",s="[object String]",a="[object Boolean]",o=Math.PI/180,l=180/Math.PI,c="#",h="",f="0",d="Konva warning: ",g="Konva error: ",p="rgb(",v={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,132,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,255,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,203],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[119,128,144],slategrey:[119,128,144],snow:[255,255,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],transparent:[255,255,255,0],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,5]},b=/rgb\((\d{1,3}),(\d{1,3}),(\d{1,3})\)/,_=[];const w=typeof requestAnimationFrame<"u"&&requestAnimationFrame||function(u){setTimeout(u,60)};r.Util={_isElement(u){return!!(u&&u.nodeType==1)},_isFunction(u){return!!(u&&u.constructor&&u.call&&u.apply)},_isPlainObject(u){return!!u&&u.constructor===Object},_isArray(u){return Object.prototype.toString.call(u)===i},_isNumber(u){return Object.prototype.toString.call(u)===n&&!isNaN(u)&&isFinite(u)},_isString(u){return Object.prototype.toString.call(u)===s},_isBoolean(u){return Object.prototype.toString.call(u)===a},isObject(u){return u instanceof Object},isValidSelector(u){if(typeof u!="string")return!1;var m=u[0];return m==="#"||m==="."||m===m.toUpperCase()},_sign(u){return u===0||u>0?1:-1},requestAnimFrame(u){_.push(u),_.length===1&&w(function(){const m=_;_=[],m.forEach(function(y){y()})})},createCanvasElement(){var u=document.createElement("canvas");try{u.style=u.style||{}}catch{}return u},createImageElement(){return document.createElement("img")},_isInDocument(u){for(;u=u.parentNode;)if(u==document)return!0;return!1},_urlToImage(u,m){var y=r.Util.createImageElement();y.onload=function(){m(y)},y.src=u},_rgbToHex(u,m,y){return((1<<24)+(u<<16)+(m<<8)+y).toString(16).slice(1)},_hexToRgb(u){u=u.replace(c,h);var m=parseInt(u,16);return{r:m>>16&255,g:m>>8&255,b:m&255}},getRandomColor(){for(var u=(Math.random()*16777215<<0).toString(16);u.length<6;)u=f+u;return c+u},getRGB(u){var m;return u in v?(m=v[u],{r:m[0],g:m[1],b:m[2]}):u[0]===c?this._hexToRgb(u.substring(1)):u.substr(0,4)===p?(m=b.exec(u.replace(/ /g,"")),{r:parseInt(m[1],10),g:parseInt(m[2],10),b:parseInt(m[3],10)}):{r:0,g:0,b:0}},colorToRGBA(u){return u=u||"black",r.Util._namedColorToRBA(u)||r.Util._hex3ColorToRGBA(u)||r.Util._hex4ColorToRGBA(u)||r.Util._hex6ColorToRGBA(u)||r.Util._hex8ColorToRGBA(u)||r.Util._rgbColorToRGBA(u)||r.Util._rgbaColorToRGBA(u)||r.Util._hslColorToRGBA(u)},_namedColorToRBA(u){var m=v[u.toLowerCase()];return m?{r:m[0],g:m[1],b:m[2],a:1}:null},_rgbColorToRGBA(u){if(u.indexOf("rgb(")===0){u=u.match(/rgb\(([^)]+)\)/)[1];var m=u.split(/ *, */).map(Number);return{r:m[0],g:m[1],b:m[2],a:1}}},_rgbaColorToRGBA(u){if(u.indexOf("rgba(")===0){u=u.match(/rgba\(([^)]+)\)/)[1];var m=u.split(/ *, */).map((y,S)=>y.slice(-1)==="%"?S===3?parseInt(y)/100:parseInt(y)/100*255:Number(y));return{r:m[0],g:m[1],b:m[2],a:m[3]}}},_hex8ColorToRGBA(u){if(u[0]==="#"&&u.length===9)return{r:parseInt(u.slice(1,3),16),g:parseInt(u.slice(3,5),16),b:parseInt(u.slice(5,7),16),a:parseInt(u.slice(7,9),16)/255}},_hex6ColorToRGBA(u){if(u[0]==="#"&&u.length===7)return{r:parseInt(u.slice(1,3),16),g:parseInt(u.slice(3,5),16),b:parseInt(u.slice(5,7),16),a:1}},_hex4ColorToRGBA(u){if(u[0]==="#"&&u.length===5)return{r:parseInt(u[1]+u[1],16),g:parseInt(u[2]+u[2],16),b:parseInt(u[3]+u[3],16),a:parseInt(u[4]+u[4],16)/255}},_hex3ColorToRGBA(u){if(u[0]==="#"&&u.length===4)return{r:parseInt(u[1]+u[1],16),g:parseInt(u[2]+u[2],16),b:parseInt(u[3]+u[3],16),a:1}},_hslColorToRGBA(u){if(/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.test(u)){const[m,...y]=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(u),S=Number(y[0])/360,T=Number(y[1])/100,C=Number(y[2])/100;let A,k,P;if(T===0)return P=C*255,{r:Math.round(P),g:Math.round(P),b:Math.round(P),a:1};C<.5?A=C*(1+T):A=C+T-C*T;const x=2*C-A,M=[0,0,0];for(let F=0;F<3;F++)k=S+1/3*-(F-1),k<0&&k++,k>1&&k--,6*k<1?P=x+(A-x)*6*k:2*k<1?P=A:3*k<2?P=x+(A-x)*(2/3-k)*6:P=x,M[F]=P*255;return{r:Math.round(M[0]),g:Math.round(M[1]),b:Math.round(M[2]),a:1}}},haveIntersection(u,m){return!(m.x>u.x+u.width||m.x+m.width<u.x||m.y>u.y+u.height||m.y+m.height<u.y)},cloneObject(u){var m={};for(var y in u)this._isPlainObject(u[y])?m[y]=this.cloneObject(u[y]):this._isArray(u[y])?m[y]=this.cloneArray(u[y]):m[y]=u[y];return m},cloneArray(u){return u.slice(0)},degToRad(u){return u*o},radToDeg(u){return u*l},_degToRad(u){return r.Util.warn("Util._degToRad is removed. Please use public Util.degToRad instead."),r.Util.degToRad(u)},_radToDeg(u){return r.Util.warn("Util._radToDeg is removed. Please use public Util.radToDeg instead."),r.Util.radToDeg(u)},_getRotation(u){return t.Konva.angleDeg?r.Util.radToDeg(u):u},_capitalize(u){return u.charAt(0).toUpperCase()+u.slice(1)},throw(u){throw new Error(g+u)},error(u){console.error(g+u)},warn(u){t.Konva.showWarnings&&console.warn(d+u)},each(u,m){for(var y in u)m(y,u[y])},_inRange(u,m,y){return m<=u&&u<y},_getProjectionToSegment(u,m,y,S,T,C){var A,k,P,x=(u-y)*(u-y)+(m-S)*(m-S);if(x==0)A=u,k=m,P=(T-y)*(T-y)+(C-S)*(C-S);else{var M=((T-u)*(y-u)+(C-m)*(S-m))/x;M<0?(A=u,k=m,P=(u-T)*(u-T)+(m-C)*(m-C)):M>1?(A=y,k=S,P=(y-T)*(y-T)+(S-C)*(S-C)):(A=u+M*(y-u),k=m+M*(S-m),P=(A-T)*(A-T)+(k-C)*(k-C))}return[A,k,P]},_getProjectionToLine(u,m,y){var S=r.Util.cloneObject(u),T=Number.MAX_VALUE;return m.forEach(function(C,A){if(!(!y&&A===m.length-1)){var k=m[(A+1)%m.length],P=r.Util._getProjectionToSegment(C.x,C.y,k.x,k.y,u.x,u.y),x=P[0],M=P[1],F=P[2];F<T&&(S.x=x,S.y=M,T=F)}}),S},_prepareArrayForTween(u,m,y){var S,T=[],C=[];if(u.length>m.length){var A=m;m=u,u=A}for(S=0;S<u.length;S+=2)T.push({x:u[S],y:u[S+1]});for(S=0;S<m.length;S+=2)C.push({x:m[S],y:m[S+1]});var k=[];return C.forEach(function(P){var x=r.Util._getProjectionToLine(P,T,y);k.push(x.x),k.push(x.y)}),k},_prepareToStringify(u){var m;u.visitedByCircularReferenceRemoval=!0;for(var y in u)if(u.hasOwnProperty(y)&&u[y]&&typeof u[y]=="object"){if(m=Object.getOwnPropertyDescriptor(u,y),u[y].visitedByCircularReferenceRemoval||r.Util._isElement(u[y]))if(m.configurable)delete u[y];else return null;else if(r.Util._prepareToStringify(u[y])===null)if(m.configurable)delete u[y];else return null}return delete u.visitedByCircularReferenceRemoval,u},_assign(u,m){for(var y in m)u[y]=m[y];return u},_getFirstPointerId(u){return u.touches?u.changedTouches[0].identifier:u.pointerId||999},releaseCanvas(...u){t.Konva.releaseCanvasOnDestroy&&u.forEach(m=>{m.width=0,m.height=0})},drawRoundedRectPath(u,m,y,S){let T=0,C=0,A=0,k=0;typeof S=="number"?T=C=A=k=Math.min(S,m/2,y/2):(T=Math.min(S[0]||0,m/2,y/2),C=Math.min(S[1]||0,m/2,y/2),k=Math.min(S[2]||0,m/2,y/2),A=Math.min(S[3]||0,m/2,y/2)),u.moveTo(T,0),u.lineTo(m-C,0),u.arc(m-C,C,C,Math.PI*3/2,0,!1),u.lineTo(m,y-k),u.arc(m-k,y-k,k,0,Math.PI/2,!1),u.lineTo(A,y),u.arc(A,y-A,A,Math.PI/2,Math.PI,!1),u.lineTo(0,T),u.arc(T,T,T,Math.PI,Math.PI*3/2,!1)}}})(It);var Ot={},ot={},j={};Object.defineProperty(j,"__esModule",{value:!0});j.getComponentValidator=j.getBooleanValidator=j.getNumberArrayValidator=j.getFunctionValidator=j.getStringOrGradientValidator=j.getStringValidator=j.getNumberOrAutoValidator=j.getNumberOrArrayOfNumbersValidator=j.getNumberValidator=j.alphaComponent=j.RGBComponent=void 0;const ei=ct,Bt=It;function ii(r){return Bt.Util._isString(r)?'"'+r+'"':Object.prototype.toString.call(r)==="[object Number]"||Bt.Util._isBoolean(r)?r:Object.prototype.toString.call(r)}function pd(r){return r>255?255:r<0?0:Math.round(r)}j.RGBComponent=pd;function md(r){return r>1?1:r<1e-4?1e-4:r}j.alphaComponent=md;function _d(){if(ei.Konva.isUnminified)return function(r,t){return Bt.Util._isNumber(r)||Bt.Util.warn(ii(r)+' is a not valid value for "'+t+'" attribute. The value should be a number.'),r}}j.getNumberValidator=_d;function vd(r){if(ei.Konva.isUnminified)return function(t,e){let i=Bt.Util._isNumber(t),n=Bt.Util._isArray(t)&&t.length==r;return!i&&!n&&Bt.Util.warn(ii(t)+' is a not valid value for "'+e+'" attribute. The value should be a number or Array<number>('+r+")"),t}}j.getNumberOrArrayOfNumbersValidator=vd;function yd(){if(ei.Konva.isUnminified)return function(r,t){var e=Bt.Util._isNumber(r),i=r==="auto";return e||i||Bt.Util.warn(ii(r)+' is a not valid value for "'+t+'" attribute. The value should be a number or "auto".'),r}}j.getNumberOrAutoValidator=yd;function bd(){if(ei.Konva.isUnminified)return function(r,t){return Bt.Util._isString(r)||Bt.Util.warn(ii(r)+' is a not valid value for "'+t+'" attribute. The value should be a string.'),r}}j.getStringValidator=bd;function wd(){if(ei.Konva.isUnminified)return function(r,t){const e=Bt.Util._isString(r),i=Object.prototype.toString.call(r)==="[object CanvasGradient]"||r&&r.addColorStop;return e||i||Bt.Util.warn(ii(r)+' is a not valid value for "'+t+'" attribute. The value should be a string or a native gradient.'),r}}j.getStringOrGradientValidator=wd;function Sd(){if(ei.Konva.isUnminified)return function(r,t){return Bt.Util._isFunction(r)||Bt.Util.warn(ii(r)+' is a not valid value for "'+t+'" attribute. The value should be a function.'),r}}j.getFunctionValidator=Sd;function Cd(){if(ei.Konva.isUnminified)return function(r,t){const e=Int8Array?Object.getPrototypeOf(Int8Array):null;return e&&r instanceof e||(Bt.Util._isArray(r)?r.forEach(function(i){Bt.Util._isNumber(i)||Bt.Util.warn('"'+t+'" attribute has non numeric element '+i+". Make sure that all elements are numbers.")}):Bt.Util.warn(ii(r)+' is a not valid value for "'+t+'" attribute. The value should be a array of numbers.')),r}}j.getNumberArrayValidator=Cd;function Ad(){if(ei.Konva.isUnminified)return function(r,t){var e=r===!0||r===!1;return e||Bt.Util.warn(ii(r)+' is a not valid value for "'+t+'" attribute. The value should be a boolean.'),r}}j.getBooleanValidator=Ad;function Td(r){if(ei.Konva.isUnminified)return function(t,e){return t==null||Bt.Util.isObject(t)||Bt.Util.warn(ii(t)+' is a not valid value for "'+e+'" attribute. The value should be an object with properties '+r),t}}j.getComponentValidator=Td;(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.Factory=void 0;const t=It,e=j;var i="get",n="set";r.Factory={addGetterSetter(s,a,o,l,c){r.Factory.addGetter(s,a,o),r.Factory.addSetter(s,a,l,c),r.Factory.addOverloadedGetterSetter(s,a)},addGetter(s,a,o){var l=i+t.Util._capitalize(a);s.prototype[l]=s.prototype[l]||function(){var c=this.attrs[a];return c===void 0?o:c}},addSetter(s,a,o,l){var c=n+t.Util._capitalize(a);s.prototype[c]||r.Factory.overWriteSetter(s,a,o,l)},overWriteSetter(s,a,o,l){var c=n+t.Util._capitalize(a);s.prototype[c]=function(h){return o&&h!==void 0&&h!==null&&(h=o.call(this,h,a)),this._setAttr(a,h),l&&l.call(this),this}},addComponentsGetterSetter(s,a,o,l,c){var h=o.length,f=t.Util._capitalize,d=i+f(a),g=n+f(a),p,v;s.prototype[d]=function(){var _={};for(p=0;p<h;p++)v=o[p],_[v]=this.getAttr(a+f(v));return _};var b=(0,e.getComponentValidator)(o);s.prototype[g]=function(_){var w=this.attrs[a],u;l&&(_=l.call(this,_)),b&&b.call(this,_,a);for(u in _)_.hasOwnProperty(u)&&this._setAttr(a+f(u),_[u]);return _||o.forEach(m=>{this._setAttr(a+f(m),void 0)}),this._fireChangeEvent(a,w,_),c&&c.call(this),this},r.Factory.addOverloadedGetterSetter(s,a)},addOverloadedGetterSetter(s,a){var o=t.Util._capitalize(a),l=n+o,c=i+o;s.prototype[a]=function(){return arguments.length?(this[l](arguments[0]),this):this[c]()}},addDeprecatedGetterSetter(s,a,o,l){t.Util.error("Adding deprecated "+a);var c=i+t.Util._capitalize(a),h=a+" property is deprecated and will be removed soon. Look at Konva change log for more information.";s.prototype[c]=function(){t.Util.error(h);var f=this.attrs[a];return f===void 0?o:f},r.Factory.addSetter(s,a,l,function(){t.Util.error(h)}),r.Factory.addOverloadedGetterSetter(s,a)},backCompat(s,a){t.Util.each(a,function(o,l){var c=s.prototype[l],h=i+t.Util._capitalize(o),f=n+t.Util._capitalize(o);function d(){c.apply(this,arguments),t.Util.error('"'+o+'" method is deprecated and will be removed soon. Use ""'+l+'" instead.')}s.prototype[o]=d,s.prototype[h]=d,s.prototype[f]=d})},afterSetFilter(){this._filterUpToDate=!1}}})(ot);var Te={},Ye={};Object.defineProperty(Ye,"__esModule",{value:!0});Ye.HitContext=Ye.SceneContext=Ye.Context=void 0;const hh=It,kd=ct;function Pd(r){var t=[],e=r.length,i=hh.Util,n,s;for(n=0;n<e;n++)s=r[n],i._isNumber(s)?s=Math.round(s*1e3)/1e3:i._isString(s)||(s=s+""),t.push(s);return t}var rl=",",xd="(",Ed=")",Md="([",Fd="])",Rd=";",Nd="()",Ld="=",sl=["arc","arcTo","beginPath","bezierCurveTo","clearRect","clip","closePath","createLinearGradient","createPattern","createRadialGradient","drawImage","ellipse","fill","fillText","getImageData","createImageData","lineTo","moveTo","putImageData","quadraticCurveTo","rect","restore","rotate","save","scale","setLineDash","setTransform","stroke","strokeText","transform","translate"],Od=["fillStyle","strokeStyle","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","letterSpacing","lineCap","lineDashOffset","lineJoin","lineWidth","miterLimit","direction","font","textAlign","textBaseline","globalAlpha","globalCompositeOperation","imageSmoothingEnabled"];const Dd=100;class us{constructor(t){this.canvas=t,kd.Konva.enableTrace&&(this.traceArr=[],this._enableTrace())}fillShape(t){t.fillEnabled()&&this._fill(t)}_fill(t){}strokeShape(t){t.hasStroke()&&this._stroke(t)}_stroke(t){}fillStrokeShape(t){t.attrs.fillAfterStrokeEnabled?(this.strokeShape(t),this.fillShape(t)):(this.fillShape(t),this.strokeShape(t))}getTrace(t,e){var i=this.traceArr,n=i.length,s="",a,o,l,c;for(a=0;a<n;a++)o=i[a],l=o.method,l?(c=o.args,s+=l,t?s+=Nd:hh.Util._isArray(c[0])?s+=Md+c.join(rl)+Fd:(e&&(c=c.map(h=>typeof h=="number"?Math.floor(h):h)),s+=xd+c.join(rl)+Ed)):(s+=o.property,t||(s+=Ld+o.val)),s+=Rd;return s}clearTrace(){this.traceArr=[]}_trace(t){var e=this.traceArr,i;e.push(t),i=e.length,i>=Dd&&e.shift()}reset(){var t=this.getCanvas().getPixelRatio();this.setTransform(1*t,0,0,1*t,0,0)}getCanvas(){return this.canvas}clear(t){var e=this.getCanvas();t?this.clearRect(t.x||0,t.y||0,t.width||0,t.height||0):this.clearRect(0,0,e.getWidth()/e.pixelRatio,e.getHeight()/e.pixelRatio)}_applyLineCap(t){const e=t.attrs.lineCap;e&&this.setAttr("lineCap",e)}_applyOpacity(t){var e=t.getAbsoluteOpacity();e!==1&&this.setAttr("globalAlpha",e)}_applyLineJoin(t){const e=t.attrs.lineJoin;e&&this.setAttr("lineJoin",e)}setAttr(t,e){this._context[t]=e}arc(t,e,i,n,s,a){this._context.arc(t,e,i,n,s,a)}arcTo(t,e,i,n,s){this._context.arcTo(t,e,i,n,s)}beginPath(){this._context.beginPath()}bezierCurveTo(t,e,i,n,s,a){this._context.bezierCurveTo(t,e,i,n,s,a)}clearRect(t,e,i,n){this._context.clearRect(t,e,i,n)}clip(...t){this._context.clip.apply(this._context,t)}closePath(){this._context.closePath()}createImageData(t,e){var i=arguments;if(i.length===2)return this._context.createImageData(t,e);if(i.length===1)return this._context.createImageData(t)}createLinearGradient(t,e,i,n){return this._context.createLinearGradient(t,e,i,n)}createPattern(t,e){return this._context.createPattern(t,e)}createRadialGradient(t,e,i,n,s,a){return this._context.createRadialGradient(t,e,i,n,s,a)}drawImage(t,e,i,n,s,a,o,l,c){var h=arguments,f=this._context;h.length===3?f.drawImage(t,e,i):h.length===5?f.drawImage(t,e,i,n,s):h.length===9&&f.drawImage(t,e,i,n,s,a,o,l,c)}ellipse(t,e,i,n,s,a,o,l){this._context.ellipse(t,e,i,n,s,a,o,l)}isPointInPath(t,e,i,n){return i?this._context.isPointInPath(i,t,e,n):this._context.isPointInPath(t,e,n)}fill(...t){this._context.fill.apply(this._context,t)}fillRect(t,e,i,n){this._context.fillRect(t,e,i,n)}strokeRect(t,e,i,n){this._context.strokeRect(t,e,i,n)}fillText(t,e,i,n){n?this._context.fillText(t,e,i,n):this._context.fillText(t,e,i)}measureText(t){return this._context.measureText(t)}getImageData(t,e,i,n){return this._context.getImageData(t,e,i,n)}lineTo(t,e){this._context.lineTo(t,e)}moveTo(t,e){this._context.moveTo(t,e)}rect(t,e,i,n){this._context.rect(t,e,i,n)}putImageData(t,e,i){this._context.putImageData(t,e,i)}quadraticCurveTo(t,e,i,n){this._context.quadraticCurveTo(t,e,i,n)}restore(){this._context.restore()}rotate(t){this._context.rotate(t)}save(){this._context.save()}scale(t,e){this._context.scale(t,e)}setLineDash(t){this._context.setLineDash?this._context.setLineDash(t):"mozDash"in this._context?this._context.mozDash=t:"webkitLineDash"in this._context&&(this._context.webkitLineDash=t)}getLineDash(){return this._context.getLineDash()}setTransform(t,e,i,n,s,a){this._context.setTransform(t,e,i,n,s,a)}stroke(t){t?this._context.stroke(t):this._context.stroke()}strokeText(t,e,i,n){this._context.strokeText(t,e,i,n)}transform(t,e,i,n,s,a){this._context.transform(t,e,i,n,s,a)}translate(t,e){this._context.translate(t,e)}_enableTrace(){var t=this,e=sl.length,i=this.setAttr,n,s,a=function(o){var l=t[o],c;t[o]=function(){return s=Pd(Array.prototype.slice.call(arguments,0)),c=l.apply(t,arguments),t._trace({method:o,args:s}),c}};for(n=0;n<e;n++)a(sl[n]);t.setAttr=function(){i.apply(t,arguments);var o=arguments[0],l=arguments[1];(o==="shadowOffsetX"||o==="shadowOffsetY"||o==="shadowBlur")&&(l=l/this.canvas.getPixelRatio()),t._trace({property:o,val:l})}}_applyGlobalCompositeOperation(t){const e=t.attrs.globalCompositeOperation;var i=!e||e==="source-over";i||this.setAttr("globalCompositeOperation",e)}}Ye.Context=us;Od.forEach(function(r){Object.defineProperty(us.prototype,r,{get(){return this._context[r]},set(t){this._context[r]=t}})});class Id extends us{constructor(t,{willReadFrequently:e=!1}={}){super(t),this._context=t._canvas.getContext("2d",{willReadFrequently:e})}_fillColor(t){var e=t.fill();this.setAttr("fillStyle",e),t._fillFunc(this)}_fillPattern(t){this.setAttr("fillStyle",t._getFillPattern()),t._fillFunc(this)}_fillLinearGradient(t){var e=t._getLinearGradient();e&&(this.setAttr("fillStyle",e),t._fillFunc(this))}_fillRadialGradient(t){const e=t._getRadialGradient();e&&(this.setAttr("fillStyle",e),t._fillFunc(this))}_fill(t){const e=t.fill(),i=t.getFillPriority();if(e&&i==="color"){this._fillColor(t);return}const n=t.getFillPatternImage();if(n&&i==="pattern"){this._fillPattern(t);return}const s=t.getFillLinearGradientColorStops();if(s&&i==="linear-gradient"){this._fillLinearGradient(t);return}const a=t.getFillRadialGradientColorStops();if(a&&i==="radial-gradient"){this._fillRadialGradient(t);return}e?this._fillColor(t):n?this._fillPattern(t):s?this._fillLinearGradient(t):a&&this._fillRadialGradient(t)}_strokeLinearGradient(t){const e=t.getStrokeLinearGradientStartPoint(),i=t.getStrokeLinearGradientEndPoint(),n=t.getStrokeLinearGradientColorStops(),s=this.createLinearGradient(e.x,e.y,i.x,i.y);if(n){for(var a=0;a<n.length;a+=2)s.addColorStop(n[a],n[a+1]);this.setAttr("strokeStyle",s)}}_stroke(t){var e=t.dash(),i=t.getStrokeScaleEnabled();if(t.hasStroke()){if(!i){this.save();var n=this.getCanvas().getPixelRatio();this.setTransform(n,0,0,n,0,0)}this._applyLineCap(t),e&&t.dashEnabled()&&(this.setLineDash(e),this.setAttr("lineDashOffset",t.dashOffset())),this.setAttr("lineWidth",t.strokeWidth()),t.getShadowForStrokeEnabled()||this.setAttr("shadowColor","rgba(0,0,0,0)");var s=t.getStrokeLinearGradientColorStops();s?this._strokeLinearGradient(t):this.setAttr("strokeStyle",t.stroke()),t._strokeFunc(this),i||this.restore()}}_applyShadow(t){var e,i,n,s=(e=t.getShadowRGBA())!==null&&e!==void 0?e:"black",a=(i=t.getShadowBlur())!==null&&i!==void 0?i:5,o=(n=t.getShadowOffset())!==null&&n!==void 0?n:{x:0,y:0},l=t.getAbsoluteScale(),c=this.canvas.getPixelRatio(),h=l.x*c,f=l.y*c;this.setAttr("shadowColor",s),this.setAttr("shadowBlur",a*Math.min(Math.abs(h),Math.abs(f))),this.setAttr("shadowOffsetX",o.x*h),this.setAttr("shadowOffsetY",o.y*f)}}Ye.SceneContext=Id;class Bd extends us{constructor(t){super(t),this._context=t._canvas.getContext("2d",{willReadFrequently:!0})}_fill(t){this.save(),this.setAttr("fillStyle",t.colorKey),t._fillFuncHit(this),this.restore()}strokeShape(t){t.hasHitStroke()&&this._stroke(t)}_stroke(t){if(t.hasHitStroke()){const s=t.getStrokeScaleEnabled();if(!s){this.save();var e=this.getCanvas().getPixelRatio();this.setTransform(e,0,0,e,0,0)}this._applyLineCap(t);var i=t.hitStrokeWidth(),n=i==="auto"?t.strokeWidth():i;this.setAttr("lineWidth",n),this.setAttr("strokeStyle",t.colorKey),t._strokeFuncHit(this),s||this.restore()}}}Ye.HitContext=Bd;Object.defineProperty(Te,"__esModule",{value:!0});Te.HitCanvas=Te.SceneCanvas=Te.Canvas=void 0;const $r=It,fh=Ye,uh=ct,Gd=ot,Ud=j;var hr;function Vd(){if(hr)return hr;var r=$r.Util.createCanvasElement(),t=r.getContext("2d");return hr=function(){var e=uh.Konva._global.devicePixelRatio||1,i=t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1;return e/i}(),$r.Util.releaseCanvas(r),hr}class ds{constructor(t){this.pixelRatio=1,this.width=0,this.height=0,this.isCache=!1;var e=t||{},i=e.pixelRatio||uh.Konva.pixelRatio||Vd();this.pixelRatio=i,this._canvas=$r.Util.createCanvasElement(),this._canvas.style.padding="0",this._canvas.style.margin="0",this._canvas.style.border="0",this._canvas.style.background="transparent",this._canvas.style.position="absolute",this._canvas.style.top="0",this._canvas.style.left="0"}getContext(){return this.context}getPixelRatio(){return this.pixelRatio}setPixelRatio(t){var e=this.pixelRatio;this.pixelRatio=t,this.setSize(this.getWidth()/e,this.getHeight()/e)}setWidth(t){this.width=this._canvas.width=t*this.pixelRatio,this._canvas.style.width=t+"px";var e=this.pixelRatio,i=this.getContext()._context;i.scale(e,e)}setHeight(t){this.height=this._canvas.height=t*this.pixelRatio,this._canvas.style.height=t+"px";var e=this.pixelRatio,i=this.getContext()._context;i.scale(e,e)}getWidth(){return this.width}getHeight(){return this.height}setSize(t,e){this.setWidth(t||0),this.setHeight(e||0)}toDataURL(t,e){try{return this._canvas.toDataURL(t,e)}catch{try{return this._canvas.toDataURL()}catch(n){return $r.Util.error("Unable to get data URL. "+n.message+" For more info read https://konvajs.org/docs/posts/Tainted_Canvas.html."),""}}}}Te.Canvas=ds;Gd.Factory.addGetterSetter(ds,"pixelRatio",void 0,(0,Ud.getNumberValidator)());class zd extends ds{constructor(t={width:0,height:0,willReadFrequently:!1}){super(t),this.context=new fh.SceneContext(this,{willReadFrequently:t.willReadFrequently}),this.setSize(t.width,t.height)}}Te.SceneCanvas=zd;class Hd extends ds{constructor(t={width:0,height:0}){super(t),this.hitCanvas=!0,this.context=new fh.HitContext(this),this.setSize(t.width,t.height)}}Te.HitCanvas=Hd;var gs={};(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.DD=void 0;const t=ct,e=It;r.DD={get isDragging(){var i=!1;return r.DD._dragElements.forEach(n=>{n.dragStatus==="dragging"&&(i=!0)}),i},justDragged:!1,get node(){var i;return r.DD._dragElements.forEach(n=>{i=n.node}),i},_dragElements:new Map,_drag(i){const n=[];r.DD._dragElements.forEach((s,a)=>{const{node:o}=s,l=o.getStage();l.setPointersPositions(i),s.pointerId===void 0&&(s.pointerId=e.Util._getFirstPointerId(i));const c=l._changedPointerPositions.find(d=>d.id===s.pointerId);if(c){if(s.dragStatus!=="dragging"){var h=o.dragDistance(),f=Math.max(Math.abs(c.x-s.startPointerPos.x),Math.abs(c.y-s.startPointerPos.y));if(f<h||(o.startDrag({evt:i}),!o.isDragging()))return}o._setDragPosition(i,s),n.push(o)}}),n.forEach(s=>{s.fire("dragmove",{type:"dragmove",target:s,evt:i},!0)})},_endDragBefore(i){const n=[];r.DD._dragElements.forEach(s=>{const{node:a}=s,o=a.getStage();if(i&&o.setPointersPositions(i),!o._changedPointerPositions.find(h=>h.id===s.pointerId))return;(s.dragStatus==="dragging"||s.dragStatus==="stopped")&&(r.DD.justDragged=!0,t.Konva._mouseListenClick=!1,t.Konva._touchListenClick=!1,t.Konva._pointerListenClick=!1,s.dragStatus="stopped");const c=s.node.getLayer()||s.node instanceof t.Konva.Stage&&s.node;c&&n.indexOf(c)===-1&&n.push(c)}),n.forEach(s=>{s.draw()})},_endDragAfter(i){r.DD._dragElements.forEach((n,s)=>{n.dragStatus==="stopped"&&n.node.fire("dragend",{type:"dragend",target:n.node,evt:i},!0),n.dragStatus!=="dragging"&&r.DD._dragElements.delete(s)})}},t.Konva.isBrowser&&(window.addEventListener("mouseup",r.DD._endDragBefore,!0),window.addEventListener("touchend",r.DD._endDragBefore,!0),window.addEventListener("mousemove",r.DD._drag),window.addEventListener("touchmove",r.DD._drag),window.addEventListener("mouseup",r.DD._endDragAfter,!1),window.addEventListener("touchend",r.DD._endDragAfter,!1))})(gs);Object.defineProperty(Ot,"__esModule",{value:!0});Ot.Node=void 0;const ht=It,ir=ot,fr=Te,Pi=ct,ue=gs,Ht=j;var Br="absoluteOpacity",ur="allEventListeners",He="absoluteTransform",al="absoluteScale",xi="canvas",Wd="Change",jd="children",Xd="konva",Wa="listening",ol="mouseenter",ll="mouseleave",cl="set",hl="Shape",Gr=" ",fl="stage",hi="transform",Yd="Stage",ja="visible",Kd=["xChange.konva","yChange.konva","scaleXChange.konva","scaleYChange.konva","skewXChange.konva","skewYChange.konva","rotationChange.konva","offsetXChange.konva","offsetYChange.konva","transformsEnabledChange.konva"].join(Gr);let qd=1,rt=class Xa{constructor(t){this._id=qd++,this.eventListeners={},this.attrs={},this.index=0,this._allEventListeners=null,this.parent=null,this._cache=new Map,this._attachedDepsListeners=new Map,this._lastPos=null,this._batchingTransformChange=!1,this._needClearTransformCache=!1,this._filterUpToDate=!1,this._isUnderCache=!1,this._dragEventId=null,this._shouldFireChangeEvents=!1,this.setAttrs(t),this._shouldFireChangeEvents=!0}hasChildren(){return!1}_clearCache(t){(t===hi||t===He)&&this._cache.get(t)?this._cache.get(t).dirty=!0:t?this._cache.delete(t):this._cache.clear()}_getCache(t,e){var i=this._cache.get(t),n=t===hi||t===He,s=i===void 0||n&&i.dirty===!0;return s&&(i=e.call(this),this._cache.set(t,i)),i}_calculate(t,e,i){if(!this._attachedDepsListeners.get(t)){const n=e.map(s=>s+"Change.konva").join(Gr);this.on(n,()=>{this._clearCache(t)}),this._attachedDepsListeners.set(t,!0)}return this._getCache(t,i)}_getCanvasCache(){return this._cache.get(xi)}_clearSelfAndDescendantCache(t){this._clearCache(t),t===He&&this.fire("absoluteTransformChange")}clearCache(){if(this._cache.has(xi)){const{scene:t,filter:e,hit:i}=this._cache.get(xi);ht.Util.releaseCanvas(t,e,i),this._cache.delete(xi)}return this._clearSelfAndDescendantCache(),this._requestDraw(),this}cache(t){var e=t||{},i={};(e.x===void 0||e.y===void 0||e.width===void 0||e.height===void 0)&&(i=this.getClientRect({skipTransform:!0,relativeTo:this.getParent()||void 0}));var n=Math.ceil(e.width||i.width),s=Math.ceil(e.height||i.height),a=e.pixelRatio,o=e.x===void 0?Math.floor(i.x):e.x,l=e.y===void 0?Math.floor(i.y):e.y,c=e.offset||0,h=e.drawBorder||!1,f=e.hitCanvasPixelRatio||1;if(!n||!s){ht.Util.error("Can not cache the node. Width or height of the node equals 0. Caching is skipped.");return}n+=c*2+1,s+=c*2+1,o-=c,l-=c;var d=new fr.SceneCanvas({pixelRatio:a,width:n,height:s}),g=new fr.SceneCanvas({pixelRatio:a,width:0,height:0,willReadFrequently:!0}),p=new fr.HitCanvas({pixelRatio:f,width:n,height:s}),v=d.getContext(),b=p.getContext();return p.isCache=!0,d.isCache=!0,this._cache.delete(xi),this._filterUpToDate=!1,e.imageSmoothingEnabled===!1&&(d.getContext()._context.imageSmoothingEnabled=!1,g.getContext()._context.imageSmoothingEnabled=!1),v.save(),b.save(),v.translate(-o,-l),b.translate(-o,-l),this._isUnderCache=!0,this._clearSelfAndDescendantCache(Br),this._clearSelfAndDescendantCache(al),this.drawScene(d,this),this.drawHit(p,this),this._isUnderCache=!1,v.restore(),b.restore(),h&&(v.save(),v.beginPath(),v.rect(0,0,n,s),v.closePath(),v.setAttr("strokeStyle","red"),v.setAttr("lineWidth",5),v.stroke(),v.restore()),this._cache.set(xi,{scene:d,filter:g,hit:p,x:o,y:l}),this._requestDraw(),this}isCached(){return this._cache.has(xi)}getClientRect(t){throw new Error('abstract "getClientRect" method call')}_transformedRect(t,e){var i=[{x:t.x,y:t.y},{x:t.x+t.width,y:t.y},{x:t.x+t.width,y:t.y+t.height},{x:t.x,y:t.y+t.height}],n=1/0,s=1/0,a=-1/0,o=-1/0,l=this.getAbsoluteTransform(e);return i.forEach(function(c){var h=l.point(c);n===void 0&&(n=a=h.x,s=o=h.y),n=Math.min(n,h.x),s=Math.min(s,h.y),a=Math.max(a,h.x),o=Math.max(o,h.y)}),{x:n,y:s,width:a-n,height:o-s}}_drawCachedSceneCanvas(t){t.save(),t._applyOpacity(this),t._applyGlobalCompositeOperation(this);const e=this._getCanvasCache();t.translate(e.x,e.y);var i=this._getCachedSceneCanvas(),n=i.pixelRatio;t.drawImage(i._canvas,0,0,i.width/n,i.height/n),t.restore()}_drawCachedHitCanvas(t){var e=this._getCanvasCache(),i=e.hit;t.save(),t.translate(e.x,e.y),t.drawImage(i._canvas,0,0,i.width/i.pixelRatio,i.height/i.pixelRatio),t.restore()}_getCachedSceneCanvas(){var t=this.filters(),e=this._getCanvasCache(),i=e.scene,n=e.filter,s=n.getContext(),a,o,l,c;if(t){if(!this._filterUpToDate){var h=i.pixelRatio;n.setSize(i.width/i.pixelRatio,i.height/i.pixelRatio);try{for(a=t.length,s.clear(),s.drawImage(i._canvas,0,0,i.getWidth()/h,i.getHeight()/h),o=s.getImageData(0,0,n.getWidth(),n.getHeight()),l=0;l<a;l++){if(c=t[l],typeof c!="function"){ht.Util.error("Filter should be type of function, but got "+typeof c+" instead. Please check correct filters");continue}c.call(this,o),s.putImageData(o,0,0)}}catch(f){ht.Util.error("Unable to apply filter. "+f.message+" This post my help you https://konvajs.org/docs/posts/Tainted_Canvas.html.")}this._filterUpToDate=!0}return n}return i}on(t,e){if(this._cache&&this._cache.delete(ur),arguments.length===3)return this._delegate.apply(this,arguments);var i=t.split(Gr),n=i.length,s,a,o,l,c;for(s=0;s<n;s++)a=i[s],o=a.split("."),l=o[0],c=o[1]||"",this.eventListeners[l]||(this.eventListeners[l]=[]),this.eventListeners[l].push({name:c,handler:e});return this}off(t,e){var i=(t||"").split(Gr),n=i.length,s,a,o,l,c,h;if(this._cache&&this._cache.delete(ur),!t)for(a in this.eventListeners)this._off(a);for(s=0;s<n;s++)if(o=i[s],l=o.split("."),c=l[0],h=l[1],c)this.eventListeners[c]&&this._off(c,h,e);else for(a in this.eventListeners)this._off(a,h,e);return this}dispatchEvent(t){var e={target:this,type:t.type,evt:t};return this.fire(t.type,e),this}addEventListener(t,e){return this.on(t,function(i){e.call(this,i.evt)}),this}removeEventListener(t){return this.off(t),this}_delegate(t,e,i){var n=this;this.on(t,function(s){for(var a=s.target.findAncestors(e,!0,n),o=0;o<a.length;o++)s=ht.Util.cloneObject(s),s.currentTarget=a[o],i.call(a[o],s)})}remove(){return this.isDragging()&&this.stopDrag(),ue.DD._dragElements.delete(this._id),this._remove(),this}_clearCaches(){this._clearSelfAndDescendantCache(He),this._clearSelfAndDescendantCache(Br),this._clearSelfAndDescendantCache(al),this._clearSelfAndDescendantCache(fl),this._clearSelfAndDescendantCache(ja),this._clearSelfAndDescendantCache(Wa)}_remove(){this._clearCaches();var t=this.getParent();t&&t.children&&(t.children.splice(this.index,1),t._setChildrenIndices(),this.parent=null)}destroy(){return this.remove(),this.clearCache(),this}getAttr(t){var e="get"+ht.Util._capitalize(t);return ht.Util._isFunction(this[e])?this[e]():this.attrs[t]}getAncestors(){for(var t=this.getParent(),e=[];t;)e.push(t),t=t.getParent();return e}getAttrs(){return this.attrs||{}}setAttrs(t){return this._batchTransformChanges(()=>{var e,i;if(!t)return this;for(e in t)e!==jd&&(i=cl+ht.Util._capitalize(e),ht.Util._isFunction(this[i])?this[i](t[e]):this._setAttr(e,t[e]))}),this}isListening(){return this._getCache(Wa,this._isListening)}_isListening(t){if(!this.listening())return!1;const i=this.getParent();return i&&i!==t&&this!==t?i._isListening(t):!0}isVisible(){return this._getCache(ja,this._isVisible)}_isVisible(t){if(!this.visible())return!1;const i=this.getParent();return i&&i!==t&&this!==t?i._isVisible(t):!0}shouldDrawHit(t,e=!1){if(t)return this._isVisible(t)&&this._isListening(t);var i=this.getLayer(),n=!1;ue.DD._dragElements.forEach(a=>{a.dragStatus==="dragging"&&(a.node.nodeType==="Stage"||a.node.getLayer()===i)&&(n=!0)});var s=!e&&!Pi.Konva.hitOnDragEnabled&&n;return this.isListening()&&this.isVisible()&&!s}show(){return this.visible(!0),this}hide(){return this.visible(!1),this}getZIndex(){return this.index||0}getAbsoluteZIndex(){var t=this.getDepth(),e=this,i=0,n,s,a,o;function l(h){for(n=[],s=h.length,a=0;a<s;a++)o=h[a],i++,o.nodeType!==hl&&(n=n.concat(o.getChildren().slice())),o._id===e._id&&(a=s);n.length>0&&n[0].getDepth()<=t&&l(n)}const c=this.getStage();return e.nodeType!==Yd&&c&&l(c.getChildren()),i}getDepth(){for(var t=0,e=this.parent;e;)t++,e=e.parent;return t}_batchTransformChanges(t){this._batchingTransformChange=!0,t(),this._batchingTransformChange=!1,this._needClearTransformCache&&(this._clearCache(hi),this._clearSelfAndDescendantCache(He)),this._needClearTransformCache=!1}setPosition(t){return this._batchTransformChanges(()=>{this.x(t.x),this.y(t.y)}),this}getPosition(){return{x:this.x(),y:this.y()}}getRelativePointerPosition(){const t=this.getStage();if(!t)return null;var e=t.getPointerPosition();if(!e)return null;var i=this.getAbsoluteTransform().copy();return i.invert(),i.point(e)}getAbsolutePosition(t){let e=!1,i=this.parent;for(;i;){if(i.isCached()){e=!0;break}i=i.parent}e&&!t&&(t=!0);var n=this.getAbsoluteTransform(t).getMatrix(),s=new ht.Transform,a=this.offset();return s.m=n.slice(),s.translate(a.x,a.y),s.getTranslation()}setAbsolutePosition(t){const{x:e,y:i,...n}=this._clearTransform();this.attrs.x=e,this.attrs.y=i,this._clearCache(hi);var s=this._getAbsoluteTransform().copy();return s.invert(),s.translate(t.x,t.y),t={x:this.attrs.x+s.getTranslation().x,y:this.attrs.y+s.getTranslation().y},this._setTransform(n),this.setPosition({x:t.x,y:t.y}),this._clearCache(hi),this._clearSelfAndDescendantCache(He),this}_setTransform(t){var e;for(e in t)this.attrs[e]=t[e]}_clearTransform(){var t={x:this.x(),y:this.y(),rotation:this.rotation(),scaleX:this.scaleX(),scaleY:this.scaleY(),offsetX:this.offsetX(),offsetY:this.offsetY(),skewX:this.skewX(),skewY:this.skewY()};return this.attrs.x=0,this.attrs.y=0,this.attrs.rotation=0,this.attrs.scaleX=1,this.attrs.scaleY=1,this.attrs.offsetX=0,this.attrs.offsetY=0,this.attrs.skewX=0,this.attrs.skewY=0,t}move(t){var e=t.x,i=t.y,n=this.x(),s=this.y();return e!==void 0&&(n+=e),i!==void 0&&(s+=i),this.setPosition({x:n,y:s}),this}_eachAncestorReverse(t,e){var i=[],n=this.getParent(),s,a;if(!(e&&e._id===this._id)){for(i.unshift(this);n&&(!e||n._id!==e._id);)i.unshift(n),n=n.parent;for(s=i.length,a=0;a<s;a++)t(i[a])}}rotate(t){return this.rotation(this.rotation()+t),this}moveToTop(){if(!this.parent)return ht.Util.warn("Node has no parent. moveToTop function is ignored."),!1;var t=this.index,e=this.parent.getChildren().length;return t<e-1?(this.parent.children.splice(t,1),this.parent.children.push(this),this.parent._setChildrenIndices(),!0):!1}moveUp(){if(!this.parent)return ht.Util.warn("Node has no parent. moveUp function is ignored."),!1;var t=this.index,e=this.parent.getChildren().length;return t<e-1?(this.parent.children.splice(t,1),this.parent.children.splice(t+1,0,this),this.parent._setChildrenIndices(),!0):!1}moveDown(){if(!this.parent)return ht.Util.warn("Node has no parent. moveDown function is ignored."),!1;var t=this.index;return t>0?(this.parent.children.splice(t,1),this.parent.children.splice(t-1,0,this),this.parent._setChildrenIndices(),!0):!1}moveToBottom(){if(!this.parent)return ht.Util.warn("Node has no parent. moveToBottom function is ignored."),!1;var t=this.index;return t>0?(this.parent.children.splice(t,1),this.parent.children.unshift(this),this.parent._setChildrenIndices(),!0):!1}setZIndex(t){if(!this.parent)return ht.Util.warn("Node has no parent. zIndex parameter is ignored."),this;(t<0||t>=this.parent.children.length)&&ht.Util.warn("Unexpected value "+t+" for zIndex property. zIndex is just index of a node in children of its parent. Expected value is from 0 to "+(this.parent.children.length-1)+".");var e=this.index;return this.parent.children.splice(e,1),this.parent.children.splice(t,0,this),this.parent._setChildrenIndices(),this}getAbsoluteOpacity(){return this._getCache(Br,this._getAbsoluteOpacity)}_getAbsoluteOpacity(){var t=this.opacity(),e=this.getParent();return e&&!e._isUnderCache&&(t*=e.getAbsoluteOpacity()),t}moveTo(t){return this.getParent()!==t&&(this._remove(),t.add(this)),this}toObject(){var t={},e=this.getAttrs(),i,n,s,a,o;t.attrs={};for(i in e)n=e[i],o=ht.Util.isObject(n)&&!ht.Util._isPlainObject(n)&&!ht.Util._isArray(n),!o&&(s=typeof this[i]=="function"&&this[i],delete e[i],a=s?s.call(this):null,e[i]=n,a!==n&&(t.attrs[i]=n));return t.className=this.getClassName(),ht.Util._prepareToStringify(t)}toJSON(){return JSON.stringify(this.toObject())}getParent(){return this.parent}findAncestors(t,e,i){var n=[];e&&this._isMatch(t)&&n.push(this);for(var s=this.parent;s;){if(s===i)return n;s._isMatch(t)&&n.push(s),s=s.parent}return n}isAncestorOf(t){return!1}findAncestor(t,e,i){return this.findAncestors(t,e,i)[0]}_isMatch(t){if(!t)return!1;if(typeof t=="function")return t(this);var e=t.replace(/ /g,"").split(","),i=e.length,n,s;for(n=0;n<i;n++)if(s=e[n],ht.Util.isValidSelector(s)||(ht.Util.warn('Selector "'+s+'" is invalid. Allowed selectors examples are "#foo", ".bar" or "Group".'),ht.Util.warn('If you have a custom shape with such className, please change it to start with upper letter like "Triangle".'),ht.Util.warn("Konva is awesome, right?")),s.charAt(0)==="#"){if(this.id()===s.slice(1))return!0}else if(s.charAt(0)==="."){if(this.hasName(s.slice(1)))return!0}else if(this.className===s||this.nodeType===s)return!0;return!1}getLayer(){var t=this.getParent();return t?t.getLayer():null}getStage(){return this._getCache(fl,this._getStage)}_getStage(){var t=this.getParent();return t?t.getStage():null}fire(t,e={},i){return e.target=e.target||this,i?this._fireAndBubble(t,e):this._fire(t,e),this}getAbsoluteTransform(t){return t?this._getAbsoluteTransform(t):this._getCache(He,this._getAbsoluteTransform)}_getAbsoluteTransform(t){var e;if(t)return e=new ht.Transform,this._eachAncestorReverse(function(n){var s=n.transformsEnabled();s==="all"?e.multiply(n.getTransform()):s==="position"&&e.translate(n.x()-n.offsetX(),n.y()-n.offsetY())},t),e;e=this._cache.get(He)||new ht.Transform,this.parent?this.parent.getAbsoluteTransform().copyInto(e):e.reset();var i=this.transformsEnabled();if(i==="all")e.multiply(this.getTransform());else if(i==="position"){const n=this.attrs.x||0,s=this.attrs.y||0,a=this.attrs.offsetX||0,o=this.attrs.offsetY||0;e.translate(n-a,s-o)}return e.dirty=!1,e}getAbsoluteScale(t){for(var e=this;e;)e._isUnderCache&&(t=e),e=e.getParent();const n=this.getAbsoluteTransform(t).decompose();return{x:n.scaleX,y:n.scaleY}}getAbsoluteRotation(){return this.getAbsoluteTransform().decompose().rotation}getTransform(){return this._getCache(hi,this._getTransform)}_getTransform(){var t,e,i=this._cache.get(hi)||new ht.Transform;i.reset();var n=this.x(),s=this.y(),a=Pi.Konva.getAngle(this.rotation()),o=(t=this.attrs.scaleX)!==null&&t!==void 0?t:1,l=(e=this.attrs.scaleY)!==null&&e!==void 0?e:1,c=this.attrs.skewX||0,h=this.attrs.skewY||0,f=this.attrs.offsetX||0,d=this.attrs.offsetY||0;return(n!==0||s!==0)&&i.translate(n,s),a!==0&&i.rotate(a),(c!==0||h!==0)&&i.skew(c,h),(o!==1||l!==1)&&i.scale(o,l),(f!==0||d!==0)&&i.translate(-1*f,-1*d),i.dirty=!1,i}clone(t){var e=ht.Util.cloneObject(this.attrs),i,n,s,a,o;for(i in t)e[i]=t[i];var l=new this.constructor(e);for(i in this.eventListeners)for(n=this.eventListeners[i],s=n.length,a=0;a<s;a++)o=n[a],o.name.indexOf(Xd)<0&&(l.eventListeners[i]||(l.eventListeners[i]=[]),l.eventListeners[i].push(o));return l}_toKonvaCanvas(t){t=t||{};var e=this.getClientRect(),i=this.getStage(),n=t.x!==void 0?t.x:Math.floor(e.x),s=t.y!==void 0?t.y:Math.floor(e.y),a=t.pixelRatio||1,o=new fr.SceneCanvas({width:t.width||Math.ceil(e.width)||(i?i.width():0),height:t.height||Math.ceil(e.height)||(i?i.height():0),pixelRatio:a}),l=o.getContext();return t.imageSmoothingEnabled===!1&&(l._context.imageSmoothingEnabled=!1),l.save(),(n||s)&&l.translate(-1*n,-1*s),this.drawScene(o),l.restore(),o}toCanvas(t){return this._toKonvaCanvas(t)._canvas}toDataURL(t){t=t||{};var e=t.mimeType||null,i=t.quality||null,n=this._toKonvaCanvas(t).toDataURL(e,i);return t.callback&&t.callback(n),n}toImage(t){return new Promise((e,i)=>{try{const n=t?.callback;n&&delete t.callback,ht.Util._urlToImage(this.toDataURL(t),function(s){e(s),n?.(s)})}catch(n){i(n)}})}toBlob(t){return new Promise((e,i)=>{try{const n=t?.callback;n&&delete t.callback,this.toCanvas(t).toBlob(s=>{e(s),n?.(s)},t?.mimeType,t?.quality)}catch(n){i(n)}})}setSize(t){return this.width(t.width),this.height(t.height),this}getSize(){return{width:this.width(),height:this.height()}}getClassName(){return this.className||this.nodeType}getType(){return this.nodeType}getDragDistance(){return this.attrs.dragDistance!==void 0?this.attrs.dragDistance:this.parent?this.parent.getDragDistance():Pi.Konva.dragDistance}_off(t,e,i){var n=this.eventListeners[t],s,a,o;for(s=0;s<n.length;s++)if(a=n[s].name,o=n[s].handler,(a!=="konva"||e==="konva")&&(!e||a===e)&&(!i||i===o)){if(n.splice(s,1),n.length===0){delete this.eventListeners[t];break}s--}}_fireChangeEvent(t,e,i){this._fire(t+Wd,{oldVal:e,newVal:i})}addName(t){if(!this.hasName(t)){var e=this.name(),i=e?e+" "+t:t;this.name(i)}return this}hasName(t){if(!t)return!1;const e=this.name();if(!e)return!1;var i=(e||"").split(/\s/g);return i.indexOf(t)!==-1}removeName(t){var e=(this.name()||"").split(/\s/g),i=e.indexOf(t);return i!==-1&&(e.splice(i,1),this.name(e.join(" "))),this}setAttr(t,e){var i=this[cl+ht.Util._capitalize(t)];return ht.Util._isFunction(i)?i.call(this,e):this._setAttr(t,e),this}_requestDraw(){if(Pi.Konva.autoDrawEnabled){const t=this.getLayer()||this.getStage();t?.batchDraw()}}_setAttr(t,e){var i=this.attrs[t];i===e&&!ht.Util.isObject(e)||(e==null?delete this.attrs[t]:this.attrs[t]=e,this._shouldFireChangeEvents&&this._fireChangeEvent(t,i,e),this._requestDraw())}_setComponentAttr(t,e,i){var n;i!==void 0&&(n=this.attrs[t],n||(this.attrs[t]=this.getAttr(t)),this.attrs[t][e]=i,this._fireChangeEvent(t,n,i))}_fireAndBubble(t,e,i){e&&this.nodeType===hl&&(e.target=this);var n=(t===ol||t===ll)&&(i&&(this===i||this.isAncestorOf&&this.isAncestorOf(i))||this.nodeType==="Stage"&&!i);if(!n){this._fire(t,e);var s=(t===ol||t===ll)&&i&&i.isAncestorOf&&i.isAncestorOf(this)&&!i.isAncestorOf(this.parent);(e&&!e.cancelBubble||!e)&&this.parent&&this.parent.isListening()&&!s&&(i&&i.parent?this._fireAndBubble.call(this.parent,t,e,i):this._fireAndBubble.call(this.parent,t,e))}}_getProtoListeners(t){var e,i,n;const s=(e=this._cache.get(ur))!==null&&e!==void 0?e:{};let a=s?.[t];if(a===void 0){a=[];let o=Object.getPrototypeOf(this);for(;o;){const l=(n=(i=o.eventListeners)===null||i===void 0?void 0:i[t])!==null&&n!==void 0?n:[];a.push(...l),o=Object.getPrototypeOf(o)}s[t]=a,this._cache.set(ur,s)}return a}_fire(t,e){e=e||{},e.currentTarget=this,e.type=t;const i=this._getProtoListeners(t);if(i)for(var n=0;n<i.length;n++)i[n].handler.call(this,e);const s=this.eventListeners[t];if(s)for(var n=0;n<s.length;n++)s[n].handler.call(this,e)}draw(){return this.drawScene(),this.drawHit(),this}_createDragElement(t){var e=t?t.pointerId:void 0,i=this.getStage(),n=this.getAbsolutePosition();if(i){var s=i._getPointerById(e)||i._changedPointerPositions[0]||n;ue.DD._dragElements.set(this._id,{node:this,startPointerPos:s,offset:{x:s.x-n.x,y:s.y-n.y},dragStatus:"ready",pointerId:e})}}startDrag(t,e=!0){ue.DD._dragElements.has(this._id)||this._createDragElement(t);const i=ue.DD._dragElements.get(this._id);i.dragStatus="dragging",this.fire("dragstart",{type:"dragstart",target:this,evt:t&&t.evt},e)}_setDragPosition(t,e){const i=this.getStage()._getPointerById(e.pointerId);if(i){var n={x:i.x-e.offset.x,y:i.y-e.offset.y},s=this.dragBoundFunc();if(s!==void 0){const a=s.call(this,n,t);a?n=a:ht.Util.warn("dragBoundFunc did not return any value. That is unexpected behavior. You must return new absolute position from dragBoundFunc.")}(!this._lastPos||this._lastPos.x!==n.x||this._lastPos.y!==n.y)&&(this.setAbsolutePosition(n),this._requestDraw()),this._lastPos=n}}stopDrag(t){const e=ue.DD._dragElements.get(this._id);e&&(e.dragStatus="stopped"),ue.DD._endDragBefore(t),ue.DD._endDragAfter(t)}setDraggable(t){this._setAttr("draggable",t),this._dragChange()}isDragging(){const t=ue.DD._dragElements.get(this._id);return t?t.dragStatus==="dragging":!1}_listenDrag(){this._dragCleanup(),this.on("mousedown.konva touchstart.konva",function(t){var e=t.evt.button!==void 0,i=!e||Pi.Konva.dragButtons.indexOf(t.evt.button)>=0;if(i&&!this.isDragging()){var n=!1;ue.DD._dragElements.forEach(s=>{this.isAncestorOf(s.node)&&(n=!0)}),n||this._createDragElement(t)}})}_dragChange(){if(this.attrs.draggable)this._listenDrag();else{this._dragCleanup();var t=this.getStage();if(!t)return;const e=ue.DD._dragElements.get(this._id),i=e&&e.dragStatus==="dragging",n=e&&e.dragStatus==="ready";i?this.stopDrag():n&&ue.DD._dragElements.delete(this._id)}}_dragCleanup(){this.off("mousedown.konva"),this.off("touchstart.konva")}isClientRectOnScreen(t={x:0,y:0}){const e=this.getStage();if(!e)return!1;const i={x:-t.x,y:-t.y,width:e.width()+2*t.x,height:e.height()+2*t.y};return ht.Util.haveIntersection(i,this.getClientRect())}static create(t,e){return ht.Util._isString(t)&&(t=JSON.parse(t)),this._createNode(t,e)}static _createNode(t,e){var i=Xa.prototype.getClassName.call(t),n=t.children,s,a,o;e&&(t.attrs.container=e),Pi.Konva[i]||(ht.Util.warn('Can not find a node with class name "'+i+'". Fallback to "Shape".'),i="Shape");const l=Pi.Konva[i];if(s=new l(t.attrs),n)for(a=n.length,o=0;o<a;o++)s.add(Xa._createNode(n[o]));return s}};Ot.Node=rt;rt.prototype.nodeType="Node";rt.prototype._attrsAffectingSize=[];rt.prototype.eventListeners={};rt.prototype.on.call(rt.prototype,Kd,function(){if(this._batchingTransformChange){this._needClearTransformCache=!0;return}this._clearCache(hi),this._clearSelfAndDescendantCache(He)});rt.prototype.on.call(rt.prototype,"visibleChange.konva",function(){this._clearSelfAndDescendantCache(ja)});rt.prototype.on.call(rt.prototype,"listeningChange.konva",function(){this._clearSelfAndDescendantCache(Wa)});rt.prototype.on.call(rt.prototype,"opacityChange.konva",function(){this._clearSelfAndDescendantCache(Br)});const xt=ir.Factory.addGetterSetter;xt(rt,"zIndex");xt(rt,"absolutePosition");xt(rt,"position");xt(rt,"x",0,(0,Ht.getNumberValidator)());xt(rt,"y",0,(0,Ht.getNumberValidator)());xt(rt,"globalCompositeOperation","source-over",(0,Ht.getStringValidator)());xt(rt,"opacity",1,(0,Ht.getNumberValidator)());xt(rt,"name","",(0,Ht.getStringValidator)());xt(rt,"id","",(0,Ht.getStringValidator)());xt(rt,"rotation",0,(0,Ht.getNumberValidator)());ir.Factory.addComponentsGetterSetter(rt,"scale",["x","y"]);xt(rt,"scaleX",1,(0,Ht.getNumberValidator)());xt(rt,"scaleY",1,(0,Ht.getNumberValidator)());ir.Factory.addComponentsGetterSetter(rt,"skew",["x","y"]);xt(rt,"skewX",0,(0,Ht.getNumberValidator)());xt(rt,"skewY",0,(0,Ht.getNumberValidator)());ir.Factory.addComponentsGetterSetter(rt,"offset",["x","y"]);xt(rt,"offsetX",0,(0,Ht.getNumberValidator)());xt(rt,"offsetY",0,(0,Ht.getNumberValidator)());xt(rt,"dragDistance",null,(0,Ht.getNumberValidator)());xt(rt,"width",0,(0,Ht.getNumberValidator)());xt(rt,"height",0,(0,Ht.getNumberValidator)());xt(rt,"listening",!0,(0,Ht.getBooleanValidator)());xt(rt,"preventDefault",!0,(0,Ht.getBooleanValidator)());xt(rt,"filters",null,function(r){return this._filterUpToDate=!1,r});xt(rt,"visible",!0,(0,Ht.getBooleanValidator)());xt(rt,"transformsEnabled","all",(0,Ht.getStringValidator)());xt(rt,"size");xt(rt,"dragBoundFunc");xt(rt,"draggable",!1,(0,Ht.getBooleanValidator)());ir.Factory.backCompat(rt,{rotateDeg:"rotate",setRotationDeg:"setRotation",getRotationDeg:"getRotation"});var Wi={};Object.defineProperty(Wi,"__esModule",{value:!0});Wi.Container=void 0;const An=ot,la=Ot,ps=j;let ji=class extends la.Node{constructor(){super(...arguments),this.children=[]}getChildren(t){if(!t)return this.children||[];const e=this.children||[];var i=[];return e.forEach(function(n){t(n)&&i.push(n)}),i}hasChildren(){return this.getChildren().length>0}removeChildren(){return this.getChildren().forEach(t=>{t.parent=null,t.index=0,t.remove()}),this.children=[],this._requestDraw(),this}destroyChildren(){return this.getChildren().forEach(t=>{t.parent=null,t.index=0,t.destroy()}),this.children=[],this._requestDraw(),this}add(...t){if(t.length===0)return this;if(t.length>1){for(var e=0;e<t.length;e++)this.add(t[e]);return this}const i=t[0];return i.getParent()?(i.moveTo(this),this):(this._validateAdd(i),i.index=this.getChildren().length,i.parent=this,i._clearCaches(),this.getChildren().push(i),this._fire("add",{child:i}),this._requestDraw(),this)}destroy(){return this.hasChildren()&&this.destroyChildren(),super.destroy(),this}find(t){return this._generalFind(t,!1)}findOne(t){var e=this._generalFind(t,!0);return e.length>0?e[0]:void 0}_generalFind(t,e){var i=[];return this._descendants(n=>{const s=n._isMatch(t);return s&&i.push(n),!!(s&&e)}),i}_descendants(t){let e=!1;const i=this.getChildren();for(const n of i){if(e=t(n),e)return!0;if(n.hasChildren()&&(e=n._descendants(t),e))return!0}return!1}toObject(){var t=la.Node.prototype.toObject.call(this);return t.children=[],this.getChildren().forEach(e=>{t.children.push(e.toObject())}),t}isAncestorOf(t){for(var e=t.getParent();e;){if(e._id===this._id)return!0;e=e.getParent()}return!1}clone(t){var e=la.Node.prototype.clone.call(this,t);return this.getChildren().forEach(function(i){e.add(i.clone())}),e}getAllIntersections(t){var e=[];return this.find("Shape").forEach(i=>{i.isVisible()&&i.intersects(t)&&e.push(i)}),e}_clearSelfAndDescendantCache(t){var e;super._clearSelfAndDescendantCache(t),!this.isCached()&&((e=this.children)===null||e===void 0||e.forEach(function(i){i._clearSelfAndDescendantCache(t)}))}_setChildrenIndices(){var t;(t=this.children)===null||t===void 0||t.forEach(function(e,i){e.index=i}),this._requestDraw()}drawScene(t,e){var i=this.getLayer(),n=t||i&&i.getCanvas(),s=n&&n.getContext(),a=this._getCanvasCache(),o=a&&a.scene,l=n&&n.isCache;if(!this.isVisible()&&!l)return this;if(o){s.save();var c=this.getAbsoluteTransform(e).getMatrix();s.transform(c[0],c[1],c[2],c[3],c[4],c[5]),this._drawCachedSceneCanvas(s),s.restore()}else this._drawChildren("drawScene",n,e);return this}drawHit(t,e){if(!this.shouldDrawHit(e))return this;var i=this.getLayer(),n=t||i&&i.hitCanvas,s=n&&n.getContext(),a=this._getCanvasCache(),o=a&&a.hit;if(o){s.save();var l=this.getAbsoluteTransform(e).getMatrix();s.transform(l[0],l[1],l[2],l[3],l[4],l[5]),this._drawCachedHitCanvas(s),s.restore()}else this._drawChildren("drawHit",n,e);return this}_drawChildren(t,e,i){var n,s=e&&e.getContext(),a=this.clipWidth(),o=this.clipHeight(),l=this.clipFunc(),c=a&&o||l;const h=i===this;if(c){s.save();var f=this.getAbsoluteTransform(i),d=f.getMatrix();s.transform(d[0],d[1],d[2],d[3],d[4],d[5]),s.beginPath();let b;if(l)b=l.call(this,s,this);else{var g=this.clipX(),p=this.clipY();s.rect(g,p,a,o)}s.clip.apply(s,b),d=f.copy().invert().getMatrix(),s.transform(d[0],d[1],d[2],d[3],d[4],d[5])}var v=!h&&this.globalCompositeOperation()!=="source-over"&&t==="drawScene";v&&(s.save(),s._applyGlobalCompositeOperation(this)),(n=this.children)===null||n===void 0||n.forEach(function(b){b[t](e,i)}),v&&s.restore(),c&&s.restore()}getClientRect(t={}){var e,i=t.skipTransform,n=t.relativeTo,s,a,o,l,c={x:1/0,y:1/0,width:0,height:0},h=this;(e=this.children)===null||e===void 0||e.forEach(function(v){if(v.visible()){var b=v.getClientRect({relativeTo:h,skipShadow:t.skipShadow,skipStroke:t.skipStroke});b.width===0&&b.height===0||(s===void 0?(s=b.x,a=b.y,o=b.x+b.width,l=b.y+b.height):(s=Math.min(s,b.x),a=Math.min(a,b.y),o=Math.max(o,b.x+b.width),l=Math.max(l,b.y+b.height)))}});for(var f=this.find("Shape"),d=!1,g=0;g<f.length;g++){var p=f[g];if(p._isVisible(this)){d=!0;break}}return d&&s!==void 0?c={x:s,y:a,width:o-s,height:l-a}:c={x:0,y:0,width:0,height:0},i?c:this._transformedRect(c,n)}};Wi.Container=ji;An.Factory.addComponentsGetterSetter(ji,"clip",["x","y","width","height"]);An.Factory.addGetterSetter(ji,"clipX",void 0,(0,ps.getNumberValidator)());An.Factory.addGetterSetter(ji,"clipY",void 0,(0,ps.getNumberValidator)());An.Factory.addGetterSetter(ji,"clipWidth",void 0,(0,ps.getNumberValidator)());An.Factory.addGetterSetter(ji,"clipHeight",void 0,(0,ps.getNumberValidator)());An.Factory.addGetterSetter(ji,"clipFunc");var dh={},se={};Object.defineProperty(se,"__esModule",{value:!0});se.releaseCapture=se.setPointerCapture=se.hasPointerCapture=se.createEvent=se.getCapturedShape=void 0;const $d=ct,Yn=new Map,gh=$d.Konva._global.PointerEvent!==void 0;function Jd(r){return Yn.get(r)}se.getCapturedShape=Jd;function vo(r){return{evt:r,pointerId:r.pointerId}}se.createEvent=vo;function Qd(r,t){return Yn.get(r)===t}se.hasPointerCapture=Qd;function Zd(r,t){ph(r),t.getStage()&&(Yn.set(r,t),gh&&t._fire("gotpointercapture",vo(new PointerEvent("gotpointercapture"))))}se.setPointerCapture=Zd;function ph(r,t){const e=Yn.get(r);if(!e)return;const i=e.getStage();i&&i.content,Yn.delete(r),gh&&e._fire("lostpointercapture",vo(new PointerEvent("lostpointercapture")))}se.releaseCapture=ph;(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.Stage=r.stages=void 0;const t=It,e=ot,i=Wi,n=ct,s=Te,a=gs,o=ct,l=se;var c="Stage",h="string",f="px",d="mouseout",g="mouseleave",p="mouseover",v="mouseenter",b="mousemove",_="mousedown",w="mouseup",u="pointermove",m="pointerdown",y="pointerup",S="pointercancel",T="lostpointercapture",C="pointerout",A="pointerleave",k="pointerover",P="pointerenter",x="contextmenu",M="touchstart",F="touchend",N="touchmove",I="touchcancel",V="wheel",Z=5,lt=[[v,"_pointerenter"],[_,"_pointerdown"],[b,"_pointermove"],[w,"_pointerup"],[g,"_pointerleave"],[M,"_pointerdown"],[N,"_pointermove"],[F,"_pointerup"],[I,"_pointercancel"],[p,"_pointerover"],[V,"_wheel"],[x,"_contextmenu"],[m,"_pointerdown"],[u,"_pointermove"],[y,"_pointerup"],[S,"_pointercancel"],[T,"_lostpointercapture"]];const q={mouse:{[C]:d,[A]:g,[k]:p,[P]:v,[u]:b,[m]:_,[y]:w,[S]:"mousecancel",pointerclick:"click",pointerdblclick:"dblclick"},touch:{[C]:"touchout",[A]:"touchleave",[k]:"touchover",[P]:"touchenter",[u]:N,[m]:M,[y]:F,[S]:I,pointerclick:"tap",pointerdblclick:"dbltap"},pointer:{[C]:C,[A]:A,[k]:k,[P]:P,[u]:u,[m]:m,[y]:y,[S]:S,pointerclick:"pointerclick",pointerdblclick:"pointerdblclick"}},J=Pt=>Pt.indexOf("pointer")>=0?"pointer":Pt.indexOf("touch")>=0?"touch":"mouse",gt=Pt=>{const E=J(Pt);if(E==="pointer")return n.Konva.pointerEventsEnabled&&q.pointer;if(E==="touch")return q.touch;if(E==="mouse")return q.mouse};function At(Pt={}){return(Pt.clipFunc||Pt.clipWidth||Pt.clipHeight)&&t.Util.warn("Stage does not support clipping. Please use clip for Layers or Groups."),Pt}const U="Pointer position is missing and not registered by the stage. Looks like it is outside of the stage container. You can set it manually from event: stage.setPointersPositions(event);";r.stages=[];class Ft extends i.Container{constructor(E){super(At(E)),this._pointerPositions=[],this._changedPointerPositions=[],this._buildDOM(),this._bindContentEvents(),r.stages.push(this),this.on("widthChange.konva heightChange.konva",this._resizeDOM),this.on("visibleChange.konva",this._checkVisibility),this.on("clipWidthChange.konva clipHeightChange.konva clipFuncChange.konva",()=>{At(this.attrs)}),this._checkVisibility()}_validateAdd(E){const D=E.getType()==="Layer",Y=E.getType()==="FastLayer";D||Y||t.Util.throw("You may only add layers to the stage.")}_checkVisibility(){if(!this.content)return;const E=this.visible()?"":"none";this.content.style.display=E}setContainer(E){if(typeof E===h){if(E.charAt(0)==="."){var D=E.slice(1);E=document.getElementsByClassName(D)[0]}else{var Y;E.charAt(0)!=="#"?Y=E:Y=E.slice(1),E=document.getElementById(Y)}if(!E)throw"Can not find container in document with id "+Y}return this._setAttr("container",E),this.content&&(this.content.parentElement&&this.content.parentElement.removeChild(this.content),E.appendChild(this.content)),this}shouldDrawHit(){return!0}clear(){var E=this.children,D=E.length,Y;for(Y=0;Y<D;Y++)E[Y].clear();return this}clone(E){return E||(E={}),E.container=typeof document<"u"&&document.createElement("div"),i.Container.prototype.clone.call(this,E)}destroy(){super.destroy();var E=this.content;E&&t.Util._isInDocument(E)&&this.container().removeChild(E);var D=r.stages.indexOf(this);return D>-1&&r.stages.splice(D,1),t.Util.releaseCanvas(this.bufferCanvas._canvas,this.bufferHitCanvas._canvas),this}getPointerPosition(){const E=this._pointerPositions[0]||this._changedPointerPositions[0];return E?{x:E.x,y:E.y}:(t.Util.warn(U),null)}_getPointerById(E){return this._pointerPositions.find(D=>D.id===E)}getPointersPositions(){return this._pointerPositions}getStage(){return this}getContent(){return this.content}_toKonvaCanvas(E){E=E||{},E.x=E.x||0,E.y=E.y||0,E.width=E.width||this.width(),E.height=E.height||this.height();var D=new s.SceneCanvas({width:E.width,height:E.height,pixelRatio:E.pixelRatio||1}),Y=D.getContext()._context,G=this.children;return(E.x||E.y)&&Y.translate(-1*E.x,-1*E.y),G.forEach(function(z){if(z.isVisible()){var $=z._toKonvaCanvas(E);Y.drawImage($._canvas,E.x,E.y,$.getWidth()/$.getPixelRatio(),$.getHeight()/$.getPixelRatio())}}),D}getIntersection(E){if(!E)return null;var D=this.children,Y=D.length,G=Y-1,z;for(z=G;z>=0;z--){const $=D[z].getIntersection(E);if($)return $}return null}_resizeDOM(){var E=this.width(),D=this.height();this.content&&(this.content.style.width=E+f,this.content.style.height=D+f),this.bufferCanvas.setSize(E,D),this.bufferHitCanvas.setSize(E,D),this.children.forEach(Y=>{Y.setSize({width:E,height:D}),Y.draw()})}add(E,...D){if(arguments.length>1){for(var Y=0;Y<arguments.length;Y++)this.add(arguments[Y]);return this}super.add(E);var G=this.children.length;return G>Z&&t.Util.warn("The stage has "+G+" layers. Recommended maximum number of layers is 3-5. Adding more layers into the stage may drop the performance. Rethink your tree structure, you can use Konva.Group."),E.setSize({width:this.width(),height:this.height()}),E.draw(),n.Konva.isBrowser&&this.content.appendChild(E.canvas._canvas),this}getParent(){return null}getLayer(){return null}hasPointerCapture(E){return l.hasPointerCapture(E,this)}setPointerCapture(E){l.setPointerCapture(E,this)}releaseCapture(E){l.releaseCapture(E,this)}getLayers(){return this.children}_bindContentEvents(){n.Konva.isBrowser&&lt.forEach(([E,D])=>{this.content.addEventListener(E,Y=>{this[D](Y)},{passive:!1})})}_pointerenter(E){this.setPointersPositions(E);const D=gt(E.type);D&&this._fire(D.pointerenter,{evt:E,target:this,currentTarget:this})}_pointerover(E){this.setPointersPositions(E);const D=gt(E.type);D&&this._fire(D.pointerover,{evt:E,target:this,currentTarget:this})}_getTargetShape(E){let D=this[E+"targetShape"];return D&&!D.getStage()&&(D=null),D}_pointerleave(E){const D=gt(E.type),Y=J(E.type);if(D){this.setPointersPositions(E);var G=this._getTargetShape(Y),z=!a.DD.isDragging||n.Konva.hitOnDragEnabled;G&&z?(G._fireAndBubble(D.pointerout,{evt:E}),G._fireAndBubble(D.pointerleave,{evt:E}),this._fire(D.pointerleave,{evt:E,target:this,currentTarget:this}),this[Y+"targetShape"]=null):z&&(this._fire(D.pointerleave,{evt:E,target:this,currentTarget:this}),this._fire(D.pointerout,{evt:E,target:this,currentTarget:this})),this.pointerPos=null,this._pointerPositions=[]}}_pointerdown(E){const D=gt(E.type),Y=J(E.type);if(D){this.setPointersPositions(E);var G=!1;this._changedPointerPositions.forEach(z=>{var $=this.getIntersection(z);if(a.DD.justDragged=!1,n.Konva["_"+Y+"ListenClick"]=!0,!$||!$.isListening())return;n.Konva.capturePointerEventsEnabled&&$.setPointerCapture(z.id),this[Y+"ClickStartShape"]=$,$._fireAndBubble(D.pointerdown,{evt:E,pointerId:z.id}),G=!0;const Tt=E.type.indexOf("touch")>=0;$.preventDefault()&&E.cancelable&&Tt&&E.preventDefault()}),G||this._fire(D.pointerdown,{evt:E,target:this,currentTarget:this,pointerId:this._pointerPositions[0].id})}}_pointermove(E){const D=gt(E.type),Y=J(E.type);if(!D)return;a.DD.isDragging&&a.DD.node.preventDefault()&&E.cancelable&&E.preventDefault(),this.setPointersPositions(E);var G=!a.DD.isDragging||n.Konva.hitOnDragEnabled;if(!G)return;var z={};let $=!1;var Tt=this._getTargetShape(Y);this._changedPointerPositions.forEach(Wt=>{const St=l.getCapturedShape(Wt.id)||this.getIntersection(Wt),$t=Wt.id,De={evt:E,pointerId:$t};var Qi=Tt!==St;if(Qi&&Tt&&(Tt._fireAndBubble(D.pointerout,{...De},St),Tt._fireAndBubble(D.pointerleave,{...De},St)),St){if(z[St._id])return;z[St._id]=!0}St&&St.isListening()?($=!0,Qi&&(St._fireAndBubble(D.pointerover,{...De},Tt),St._fireAndBubble(D.pointerenter,{...De},Tt),this[Y+"targetShape"]=St),St._fireAndBubble(D.pointermove,{...De})):Tt&&(this._fire(D.pointerover,{evt:E,target:this,currentTarget:this,pointerId:$t}),this[Y+"targetShape"]=null)}),$||this._fire(D.pointermove,{evt:E,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id})}_pointerup(E){const D=gt(E.type),Y=J(E.type);if(!D)return;this.setPointersPositions(E);const G=this[Y+"ClickStartShape"],z=this[Y+"ClickEndShape"];var $={};let Tt=!1;this._changedPointerPositions.forEach(Wt=>{const St=l.getCapturedShape(Wt.id)||this.getIntersection(Wt);if(St){if(St.releaseCapture(Wt.id),$[St._id])return;$[St._id]=!0}const $t=Wt.id,De={evt:E,pointerId:$t};let Qi=!1;n.Konva["_"+Y+"InDblClickWindow"]?(Qi=!0,clearTimeout(this[Y+"DblTimeout"])):a.DD.justDragged||(n.Konva["_"+Y+"InDblClickWindow"]=!0,clearTimeout(this[Y+"DblTimeout"])),this[Y+"DblTimeout"]=setTimeout(function(){n.Konva["_"+Y+"InDblClickWindow"]=!1},n.Konva.dblClickWindow),St&&St.isListening()?(Tt=!0,this[Y+"ClickEndShape"]=St,St._fireAndBubble(D.pointerup,{...De}),n.Konva["_"+Y+"ListenClick"]&&G&&G===St&&(St._fireAndBubble(D.pointerclick,{...De}),Qi&&z&&z===St&&St._fireAndBubble(D.pointerdblclick,{...De}))):(this[Y+"ClickEndShape"]=null,n.Konva["_"+Y+"ListenClick"]&&this._fire(D.pointerclick,{evt:E,target:this,currentTarget:this,pointerId:$t}),Qi&&this._fire(D.pointerdblclick,{evt:E,target:this,currentTarget:this,pointerId:$t}))}),Tt||this._fire(D.pointerup,{evt:E,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id}),n.Konva["_"+Y+"ListenClick"]=!1,E.cancelable&&Y!=="touch"&&E.preventDefault()}_contextmenu(E){this.setPointersPositions(E);var D=this.getIntersection(this.getPointerPosition());D&&D.isListening()?D._fireAndBubble(x,{evt:E}):this._fire(x,{evt:E,target:this,currentTarget:this})}_wheel(E){this.setPointersPositions(E);var D=this.getIntersection(this.getPointerPosition());D&&D.isListening()?D._fireAndBubble(V,{evt:E}):this._fire(V,{evt:E,target:this,currentTarget:this})}_pointercancel(E){this.setPointersPositions(E);const D=l.getCapturedShape(E.pointerId)||this.getIntersection(this.getPointerPosition());D&&D._fireAndBubble(y,l.createEvent(E)),l.releaseCapture(E.pointerId)}_lostpointercapture(E){l.releaseCapture(E.pointerId)}setPointersPositions(E){var D=this._getContentPosition(),Y=null,G=null;E=E||window.event,E.touches!==void 0?(this._pointerPositions=[],this._changedPointerPositions=[],Array.prototype.forEach.call(E.touches,z=>{this._pointerPositions.push({id:z.identifier,x:(z.clientX-D.left)/D.scaleX,y:(z.clientY-D.top)/D.scaleY})}),Array.prototype.forEach.call(E.changedTouches||E.touches,z=>{this._changedPointerPositions.push({id:z.identifier,x:(z.clientX-D.left)/D.scaleX,y:(z.clientY-D.top)/D.scaleY})})):(Y=(E.clientX-D.left)/D.scaleX,G=(E.clientY-D.top)/D.scaleY,this.pointerPos={x:Y,y:G},this._pointerPositions=[{x:Y,y:G,id:t.Util._getFirstPointerId(E)}],this._changedPointerPositions=[{x:Y,y:G,id:t.Util._getFirstPointerId(E)}])}_setPointerPosition(E){t.Util.warn('Method _setPointerPosition is deprecated. Use "stage.setPointersPositions(event)" instead.'),this.setPointersPositions(E)}_getContentPosition(){if(!this.content||!this.content.getBoundingClientRect)return{top:0,left:0,scaleX:1,scaleY:1};var E=this.content.getBoundingClientRect();return{top:E.top,left:E.left,scaleX:E.width/this.content.clientWidth||1,scaleY:E.height/this.content.clientHeight||1}}_buildDOM(){if(this.bufferCanvas=new s.SceneCanvas({width:this.width(),height:this.height()}),this.bufferHitCanvas=new s.HitCanvas({pixelRatio:1,width:this.width(),height:this.height()}),!!n.Konva.isBrowser){var E=this.container();if(!E)throw"Stage has no container. A container is required.";E.innerHTML="",this.content=document.createElement("div"),this.content.style.position="relative",this.content.style.userSelect="none",this.content.className="konvajs-content",this.content.setAttribute("role","presentation"),E.appendChild(this.content),this._resizeDOM()}}cache(){return t.Util.warn("Cache function is not allowed for stage. You may use cache only for layers, groups and shapes."),this}clearCache(){return this}batchDraw(){return this.getChildren().forEach(function(E){E.batchDraw()}),this}}r.Stage=Ft,Ft.prototype.nodeType=c,(0,o._registerNode)(Ft),e.Factory.addGetterSetter(Ft,"container")})(dh);var nr={},Kt={};(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.Shape=r.shapes=void 0;const t=ct,e=It,i=ot,n=Ot,s=j,a=ct,o=se;var l="hasShadow",c="shadowRGBA",h="patternImage",f="linearGradient",d="radialGradient";let g;function p(){return g||(g=e.Util.createCanvasElement().getContext("2d"),g)}r.shapes={};function v(A){const k=this.attrs.fillRule;k?A.fill(k):A.fill()}function b(A){A.stroke()}function _(A){A.fill()}function w(A){A.stroke()}function u(){this._clearCache(l)}function m(){this._clearCache(c)}function y(){this._clearCache(h)}function S(){this._clearCache(f)}function T(){this._clearCache(d)}class C extends n.Node{constructor(k){super(k);let P;for(;P=e.Util.getRandomColor(),!(P&&!(P in r.shapes)););this.colorKey=P,r.shapes[P]=this}getContext(){return e.Util.warn("shape.getContext() method is deprecated. Please do not use it."),this.getLayer().getContext()}getCanvas(){return e.Util.warn("shape.getCanvas() method is deprecated. Please do not use it."),this.getLayer().getCanvas()}getSceneFunc(){return this.attrs.sceneFunc||this._sceneFunc}getHitFunc(){return this.attrs.hitFunc||this._hitFunc}hasShadow(){return this._getCache(l,this._hasShadow)}_hasShadow(){return this.shadowEnabled()&&this.shadowOpacity()!==0&&!!(this.shadowColor()||this.shadowBlur()||this.shadowOffsetX()||this.shadowOffsetY())}_getFillPattern(){return this._getCache(h,this.__getFillPattern)}__getFillPattern(){if(this.fillPatternImage()){var k=p();const P=k.createPattern(this.fillPatternImage(),this.fillPatternRepeat()||"repeat");if(P&&P.setTransform){const x=new e.Transform;x.translate(this.fillPatternX(),this.fillPatternY()),x.rotate(t.Konva.getAngle(this.fillPatternRotation())),x.scale(this.fillPatternScaleX(),this.fillPatternScaleY()),x.translate(-1*this.fillPatternOffsetX(),-1*this.fillPatternOffsetY());const M=x.getMatrix(),F=typeof DOMMatrix>"u"?{a:M[0],b:M[1],c:M[2],d:M[3],e:M[4],f:M[5]}:new DOMMatrix(M);P.setTransform(F)}return P}}_getLinearGradient(){return this._getCache(f,this.__getLinearGradient)}__getLinearGradient(){var k=this.fillLinearGradientColorStops();if(k){for(var P=p(),x=this.fillLinearGradientStartPoint(),M=this.fillLinearGradientEndPoint(),F=P.createLinearGradient(x.x,x.y,M.x,M.y),N=0;N<k.length;N+=2)F.addColorStop(k[N],k[N+1]);return F}}_getRadialGradient(){return this._getCache(d,this.__getRadialGradient)}__getRadialGradient(){var k=this.fillRadialGradientColorStops();if(k){for(var P=p(),x=this.fillRadialGradientStartPoint(),M=this.fillRadialGradientEndPoint(),F=P.createRadialGradient(x.x,x.y,this.fillRadialGradientStartRadius(),M.x,M.y,this.fillRadialGradientEndRadius()),N=0;N<k.length;N+=2)F.addColorStop(k[N],k[N+1]);return F}}getShadowRGBA(){return this._getCache(c,this._getShadowRGBA)}_getShadowRGBA(){if(this.hasShadow()){var k=e.Util.colorToRGBA(this.shadowColor());if(k)return"rgba("+k.r+","+k.g+","+k.b+","+k.a*(this.shadowOpacity()||1)+")"}}hasFill(){return this._calculate("hasFill",["fillEnabled","fill","fillPatternImage","fillLinearGradientColorStops","fillRadialGradientColorStops"],()=>this.fillEnabled()&&!!(this.fill()||this.fillPatternImage()||this.fillLinearGradientColorStops()||this.fillRadialGradientColorStops()))}hasStroke(){return this._calculate("hasStroke",["strokeEnabled","strokeWidth","stroke","strokeLinearGradientColorStops"],()=>this.strokeEnabled()&&this.strokeWidth()&&!!(this.stroke()||this.strokeLinearGradientColorStops()))}hasHitStroke(){const k=this.hitStrokeWidth();return k==="auto"?this.hasStroke():this.strokeEnabled()&&!!k}intersects(k){var P=this.getStage();if(!P)return!1;const x=P.bufferHitCanvas;return x.getContext().clear(),this.drawHit(x,void 0,!0),x.context.getImageData(Math.round(k.x),Math.round(k.y),1,1).data[3]>0}destroy(){return n.Node.prototype.destroy.call(this),delete r.shapes[this.colorKey],delete this.colorKey,this}_useBufferCanvas(k){var P;if(!this.getStage()||!((P=this.attrs.perfectDrawEnabled)!==null&&P!==void 0?P:!0))return!1;const M=k||this.hasFill(),F=this.hasStroke(),N=this.getAbsoluteOpacity()!==1;if(M&&F&&N)return!0;const I=this.hasShadow(),V=this.shadowForStrokeEnabled();return!!(M&&F&&I&&V)}setStrokeHitEnabled(k){e.Util.warn("strokeHitEnabled property is deprecated. Please use hitStrokeWidth instead."),k?this.hitStrokeWidth("auto"):this.hitStrokeWidth(0)}getStrokeHitEnabled(){return this.hitStrokeWidth()!==0}getSelfRect(){var k=this.size();return{x:this._centroid?-k.width/2:0,y:this._centroid?-k.height/2:0,width:k.width,height:k.height}}getClientRect(k={}){const P=k.skipTransform,x=k.relativeTo,M=this.getSelfRect(),N=!k.skipStroke&&this.hasStroke()&&this.strokeWidth()||0,I=M.width+N,V=M.height+N,Z=!k.skipShadow&&this.hasShadow(),lt=Z?this.shadowOffsetX():0,q=Z?this.shadowOffsetY():0,J=I+Math.abs(lt),gt=V+Math.abs(q),At=Z&&this.shadowBlur()||0,U=J+At*2,Ft=gt+At*2,Pt={width:U,height:Ft,x:-(N/2+At)+Math.min(lt,0)+M.x,y:-(N/2+At)+Math.min(q,0)+M.y};return P?Pt:this._transformedRect(Pt,x)}drawScene(k,P){var x=this.getLayer(),M=k||x.getCanvas(),F=M.getContext(),N=this._getCanvasCache(),I=this.getSceneFunc(),V=this.hasShadow(),Z,lt,q,J=M.isCache,gt=P===this;if(!this.isVisible()&&!gt)return this;if(N){F.save();var At=this.getAbsoluteTransform(P).getMatrix();return F.transform(At[0],At[1],At[2],At[3],At[4],At[5]),this._drawCachedSceneCanvas(F),F.restore(),this}if(!I)return this;if(F.save(),this._useBufferCanvas()&&!J){Z=this.getStage(),lt=Z.bufferCanvas,q=lt.getContext(),q.clear(),q.save(),q._applyLineJoin(this);var U=this.getAbsoluteTransform(P).getMatrix();q.transform(U[0],U[1],U[2],U[3],U[4],U[5]),I.call(this,q,this),q.restore();var Ft=lt.pixelRatio;V&&F._applyShadow(this),F._applyOpacity(this),F._applyGlobalCompositeOperation(this),F.drawImage(lt._canvas,0,0,lt.width/Ft,lt.height/Ft)}else{if(F._applyLineJoin(this),!gt){var U=this.getAbsoluteTransform(P).getMatrix();F.transform(U[0],U[1],U[2],U[3],U[4],U[5]),F._applyOpacity(this),F._applyGlobalCompositeOperation(this)}V&&F._applyShadow(this),I.call(this,F,this)}return F.restore(),this}drawHit(k,P,x=!1){if(!this.shouldDrawHit(P,x))return this;var M=this.getLayer(),F=k||M.hitCanvas,N=F&&F.getContext(),I=this.hitFunc()||this.sceneFunc(),V=this._getCanvasCache(),Z=V&&V.hit;if(this.colorKey||e.Util.warn("Looks like your canvas has a destroyed shape in it. Do not reuse shape after you destroyed it. If you want to reuse shape you should call remove() instead of destroy()"),Z){N.save();var lt=this.getAbsoluteTransform(P).getMatrix();return N.transform(lt[0],lt[1],lt[2],lt[3],lt[4],lt[5]),this._drawCachedHitCanvas(N),N.restore(),this}if(!I)return this;if(N.save(),N._applyLineJoin(this),!(this===P)){var J=this.getAbsoluteTransform(P).getMatrix();N.transform(J[0],J[1],J[2],J[3],J[4],J[5])}return I.call(this,N,this),N.restore(),this}drawHitFromCache(k=0){var P=this._getCanvasCache(),x=this._getCachedSceneCanvas(),M=P.hit,F=M.getContext(),N=M.getWidth(),I=M.getHeight(),V,Z,lt,q,J,gt;F.clear(),F.drawImage(x._canvas,0,0,N,I);try{for(V=F.getImageData(0,0,N,I),Z=V.data,lt=Z.length,q=e.Util._hexToRgb(this.colorKey),J=0;J<lt;J+=4)gt=Z[J+3],gt>k?(Z[J]=q.r,Z[J+1]=q.g,Z[J+2]=q.b,Z[J+3]=255):Z[J+3]=0;F.putImageData(V,0,0)}catch(At){e.Util.error("Unable to draw hit graph from cached scene canvas. "+At.message)}return this}hasPointerCapture(k){return o.hasPointerCapture(k,this)}setPointerCapture(k){o.setPointerCapture(k,this)}releaseCapture(k){o.releaseCapture(k,this)}}r.Shape=C,C.prototype._fillFunc=v,C.prototype._strokeFunc=b,C.prototype._fillFuncHit=_,C.prototype._strokeFuncHit=w,C.prototype._centroid=!1,C.prototype.nodeType="Shape",(0,a._registerNode)(C),C.prototype.eventListeners={},C.prototype.on.call(C.prototype,"shadowColorChange.konva shadowBlurChange.konva shadowOffsetChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",u),C.prototype.on.call(C.prototype,"shadowColorChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",m),C.prototype.on.call(C.prototype,"fillPriorityChange.konva fillPatternImageChange.konva fillPatternRepeatChange.konva fillPatternScaleXChange.konva fillPatternScaleYChange.konva fillPatternOffsetXChange.konva fillPatternOffsetYChange.konva fillPatternXChange.konva fillPatternYChange.konva fillPatternRotationChange.konva",y),C.prototype.on.call(C.prototype,"fillPriorityChange.konva fillLinearGradientColorStopsChange.konva fillLinearGradientStartPointXChange.konva fillLinearGradientStartPointYChange.konva fillLinearGradientEndPointXChange.konva fillLinearGradientEndPointYChange.konva",S),C.prototype.on.call(C.prototype,"fillPriorityChange.konva fillRadialGradientColorStopsChange.konva fillRadialGradientStartPointXChange.konva fillRadialGradientStartPointYChange.konva fillRadialGradientEndPointXChange.konva fillRadialGradientEndPointYChange.konva fillRadialGradientStartRadiusChange.konva fillRadialGradientEndRadiusChange.konva",T),i.Factory.addGetterSetter(C,"stroke",void 0,(0,s.getStringOrGradientValidator)()),i.Factory.addGetterSetter(C,"strokeWidth",2,(0,s.getNumberValidator)()),i.Factory.addGetterSetter(C,"fillAfterStrokeEnabled",!1),i.Factory.addGetterSetter(C,"hitStrokeWidth","auto",(0,s.getNumberOrAutoValidator)()),i.Factory.addGetterSetter(C,"strokeHitEnabled",!0,(0,s.getBooleanValidator)()),i.Factory.addGetterSetter(C,"perfectDrawEnabled",!0,(0,s.getBooleanValidator)()),i.Factory.addGetterSetter(C,"shadowForStrokeEnabled",!0,(0,s.getBooleanValidator)()),i.Factory.addGetterSetter(C,"lineJoin"),i.Factory.addGetterSetter(C,"lineCap"),i.Factory.addGetterSetter(C,"sceneFunc"),i.Factory.addGetterSetter(C,"hitFunc"),i.Factory.addGetterSetter(C,"dash"),i.Factory.addGetterSetter(C,"dashOffset",0,(0,s.getNumberValidator)()),i.Factory.addGetterSetter(C,"shadowColor",void 0,(0,s.getStringValidator)()),i.Factory.addGetterSetter(C,"shadowBlur",0,(0,s.getNumberValidator)()),i.Factory.addGetterSetter(C,"shadowOpacity",1,(0,s.getNumberValidator)()),i.Factory.addComponentsGetterSetter(C,"shadowOffset",["x","y"]),i.Factory.addGetterSetter(C,"shadowOffsetX",0,(0,s.getNumberValidator)()),i.Factory.addGetterSetter(C,"shadowOffsetY",0,(0,s.getNumberValidator)()),i.Factory.addGetterSetter(C,"fillPatternImage"),i.Factory.addGetterSetter(C,"fill",void 0,(0,s.getStringOrGradientValidator)()),i.Factory.addGetterSetter(C,"fillPatternX",0,(0,s.getNumberValidator)()),i.Factory.addGetterSetter(C,"fillPatternY",0,(0,s.getNumberValidator)()),i.Factory.addGetterSetter(C,"fillLinearGradientColorStops"),i.Factory.addGetterSetter(C,"strokeLinearGradientColorStops"),i.Factory.addGetterSetter(C,"fillRadialGradientStartRadius",0),i.Factory.addGetterSetter(C,"fillRadialGradientEndRadius",0),i.Factory.addGetterSetter(C,"fillRadialGradientColorStops"),i.Factory.addGetterSetter(C,"fillPatternRepeat","repeat"),i.Factory.addGetterSetter(C,"fillEnabled",!0),i.Factory.addGetterSetter(C,"strokeEnabled",!0),i.Factory.addGetterSetter(C,"shadowEnabled",!0),i.Factory.addGetterSetter(C,"dashEnabled",!0),i.Factory.addGetterSetter(C,"strokeScaleEnabled",!0),i.Factory.addGetterSetter(C,"fillPriority","color"),i.Factory.addComponentsGetterSetter(C,"fillPatternOffset",["x","y"]),i.Factory.addGetterSetter(C,"fillPatternOffsetX",0,(0,s.getNumberValidator)()),i.Factory.addGetterSetter(C,"fillPatternOffsetY",0,(0,s.getNumberValidator)()),i.Factory.addComponentsGetterSetter(C,"fillPatternScale",["x","y"]),i.Factory.addGetterSetter(C,"fillPatternScaleX",1,(0,s.getNumberValidator)()),i.Factory.addGetterSetter(C,"fillPatternScaleY",1,(0,s.getNumberValidator)()),i.Factory.addComponentsGetterSetter(C,"fillLinearGradientStartPoint",["x","y"]),i.Factory.addComponentsGetterSetter(C,"strokeLinearGradientStartPoint",["x","y"]),i.Factory.addGetterSetter(C,"fillLinearGradientStartPointX",0),i.Factory.addGetterSetter(C,"strokeLinearGradientStartPointX",0),i.Factory.addGetterSetter(C,"fillLinearGradientStartPointY",0),i.Factory.addGetterSetter(C,"strokeLinearGradientStartPointY",0),i.Factory.addComponentsGetterSetter(C,"fillLinearGradientEndPoint",["x","y"]),i.Factory.addComponentsGetterSetter(C,"strokeLinearGradientEndPoint",["x","y"]),i.Factory.addGetterSetter(C,"fillLinearGradientEndPointX",0),i.Factory.addGetterSetter(C,"strokeLinearGradientEndPointX",0),i.Factory.addGetterSetter(C,"fillLinearGradientEndPointY",0),i.Factory.addGetterSetter(C,"strokeLinearGradientEndPointY",0),i.Factory.addComponentsGetterSetter(C,"fillRadialGradientStartPoint",["x","y"]),i.Factory.addGetterSetter(C,"fillRadialGradientStartPointX",0),i.Factory.addGetterSetter(C,"fillRadialGradientStartPointY",0),i.Factory.addComponentsGetterSetter(C,"fillRadialGradientEndPoint",["x","y"]),i.Factory.addGetterSetter(C,"fillRadialGradientEndPointX",0),i.Factory.addGetterSetter(C,"fillRadialGradientEndPointY",0),i.Factory.addGetterSetter(C,"fillPatternRotation",0),i.Factory.addGetterSetter(C,"fillRule",void 0,(0,s.getStringValidator)()),i.Factory.backCompat(C,{dashArray:"dash",getDashArray:"getDash",setDashArray:"getDash",drawFunc:"sceneFunc",getDrawFunc:"getSceneFunc",setDrawFunc:"setSceneFunc",drawHitFunc:"hitFunc",getDrawHitFunc:"getHitFunc",setDrawHitFunc:"setHitFunc"})})(Kt);Object.defineProperty(nr,"__esModule",{value:!0});nr.Layer=void 0;const Be=It,ca=Wi,Zi=Ot,yo=ot,ul=Te,t0=j,e0=Kt,i0=ct;var n0="#",r0="beforeDraw",s0="draw",mh=[{x:0,y:0},{x:-1,y:-1},{x:1,y:-1},{x:1,y:1},{x:-1,y:1}],a0=mh.length;let Tn=class extends ca.Container{constructor(t){super(t),this.canvas=new ul.SceneCanvas,this.hitCanvas=new ul.HitCanvas({pixelRatio:1}),this._waitingForDraw=!1,this.on("visibleChange.konva",this._checkVisibility),this._checkVisibility(),this.on("imageSmoothingEnabledChange.konva",this._setSmoothEnabled),this._setSmoothEnabled()}createPNGStream(){return this.canvas._canvas.createPNGStream()}getCanvas(){return this.canvas}getNativeCanvasElement(){return this.canvas._canvas}getHitCanvas(){return this.hitCanvas}getContext(){return this.getCanvas().getContext()}clear(t){return this.getContext().clear(t),this.getHitCanvas().getContext().clear(t),this}setZIndex(t){super.setZIndex(t);var e=this.getStage();return e&&e.content&&(e.content.removeChild(this.getNativeCanvasElement()),t<e.children.length-1?e.content.insertBefore(this.getNativeCanvasElement(),e.children[t+1].getCanvas()._canvas):e.content.appendChild(this.getNativeCanvasElement())),this}moveToTop(){Zi.Node.prototype.moveToTop.call(this);var t=this.getStage();return t&&t.content&&(t.content.removeChild(this.getNativeCanvasElement()),t.content.appendChild(this.getNativeCanvasElement())),!0}moveUp(){var t=Zi.Node.prototype.moveUp.call(this);if(!t)return!1;var e=this.getStage();return!e||!e.content?!1:(e.content.removeChild(this.getNativeCanvasElement()),this.index<e.children.length-1?e.content.insertBefore(this.getNativeCanvasElement(),e.children[this.index+1].getCanvas()._canvas):e.content.appendChild(this.getNativeCanvasElement()),!0)}moveDown(){if(Zi.Node.prototype.moveDown.call(this)){var t=this.getStage();if(t){var e=t.children;t.content&&(t.content.removeChild(this.getNativeCanvasElement()),t.content.insertBefore(this.getNativeCanvasElement(),e[this.index+1].getCanvas()._canvas))}return!0}return!1}moveToBottom(){if(Zi.Node.prototype.moveToBottom.call(this)){var t=this.getStage();if(t){var e=t.children;t.content&&(t.content.removeChild(this.getNativeCanvasElement()),t.content.insertBefore(this.getNativeCanvasElement(),e[1].getCanvas()._canvas))}return!0}return!1}getLayer(){return this}remove(){var t=this.getNativeCanvasElement();return Zi.Node.prototype.remove.call(this),t&&t.parentNode&&Be.Util._isInDocument(t)&&t.parentNode.removeChild(t),this}getStage(){return this.parent}setSize({width:t,height:e}){return this.canvas.setSize(t,e),this.hitCanvas.setSize(t,e),this._setSmoothEnabled(),this}_validateAdd(t){var e=t.getType();e!=="Group"&&e!=="Shape"&&Be.Util.throw("You may only add groups and shapes to a layer.")}_toKonvaCanvas(t){return t=t||{},t.width=t.width||this.getWidth(),t.height=t.height||this.getHeight(),t.x=t.x!==void 0?t.x:this.x(),t.y=t.y!==void 0?t.y:this.y(),Zi.Node.prototype._toKonvaCanvas.call(this,t)}_checkVisibility(){this.visible()?this.canvas._canvas.style.display="block":this.canvas._canvas.style.display="none"}_setSmoothEnabled(){this.getContext()._context.imageSmoothingEnabled=this.imageSmoothingEnabled()}getWidth(){if(this.parent)return this.parent.width()}setWidth(){Be.Util.warn('Can not change width of layer. Use "stage.width(value)" function instead.')}getHeight(){if(this.parent)return this.parent.height()}setHeight(){Be.Util.warn('Can not change height of layer. Use "stage.height(value)" function instead.')}batchDraw(){return this._waitingForDraw||(this._waitingForDraw=!0,Be.Util.requestAnimFrame(()=>{this.draw(),this._waitingForDraw=!1})),this}getIntersection(t){if(!this.isListening()||!this.isVisible())return null;for(var e=1,i=!1;;){for(let n=0;n<a0;n++){const s=mh[n],a=this._getIntersection({x:t.x+s.x*e,y:t.y+s.y*e}),o=a.shape;if(o)return o;if(i=!!a.antialiased,!a.antialiased)break}if(i)e+=1;else return null}}_getIntersection(t){const e=this.hitCanvas.pixelRatio,i=this.hitCanvas.context.getImageData(Math.round(t.x*e),Math.round(t.y*e),1,1).data,n=i[3];if(n===255){const s=Be.Util._rgbToHex(i[0],i[1],i[2]),a=e0.shapes[n0+s];return a?{shape:a}:{antialiased:!0}}else if(n>0)return{antialiased:!0};return{}}drawScene(t,e){var i=this.getLayer(),n=t||i&&i.getCanvas();return this._fire(r0,{node:this}),this.clearBeforeDraw()&&n.getContext().clear(),ca.Container.prototype.drawScene.call(this,n,e),this._fire(s0,{node:this}),this}drawHit(t,e){var i=this.getLayer(),n=t||i&&i.hitCanvas;return i&&i.clearBeforeDraw()&&i.getHitCanvas().getContext().clear(),ca.Container.prototype.drawHit.call(this,n,e),this}enableHitGraph(){return this.hitGraphEnabled(!0),this}disableHitGraph(){return this.hitGraphEnabled(!1),this}setHitGraphEnabled(t){Be.Util.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening(t)}getHitGraphEnabled(t){return Be.Util.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening()}toggleHitCanvas(){if(!(!this.parent||!this.parent.content)){var t=this.parent,e=!!this.hitCanvas._canvas.parentNode;e?t.content.removeChild(this.hitCanvas._canvas):t.content.appendChild(this.hitCanvas._canvas)}}destroy(){return Be.Util.releaseCanvas(this.getNativeCanvasElement(),this.getHitCanvas()._canvas),super.destroy()}};nr.Layer=Tn;Tn.prototype.nodeType="Layer";(0,i0._registerNode)(Tn);yo.Factory.addGetterSetter(Tn,"imageSmoothingEnabled",!0);yo.Factory.addGetterSetter(Tn,"clearBeforeDraw",!0);yo.Factory.addGetterSetter(Tn,"hitGraphEnabled",!0,(0,t0.getBooleanValidator)());var ms={};Object.defineProperty(ms,"__esModule",{value:!0});ms.FastLayer=void 0;const o0=It,l0=nr,c0=ct;class bo extends l0.Layer{constructor(t){super(t),this.listening(!1),o0.Util.warn('Konva.Fast layer is deprecated. Please use "new Konva.Layer({ listening: false })" instead.')}}ms.FastLayer=bo;bo.prototype.nodeType="FastLayer";(0,c0._registerNode)(bo);var kn={};Object.defineProperty(kn,"__esModule",{value:!0});kn.Group=void 0;const h0=It,f0=Wi,u0=ct;class wo extends f0.Container{_validateAdd(t){var e=t.getType();e!=="Group"&&e!=="Shape"&&h0.Util.throw("You may only add groups and shapes to groups.")}}kn.Group=wo;wo.prototype.nodeType="Group";(0,u0._registerNode)(wo);var Pn={};Object.defineProperty(Pn,"__esModule",{value:!0});Pn.Animation=void 0;const ha=ct,dl=It,fa=function(){return ha.glob.performance&&ha.glob.performance.now?function(){return ha.glob.performance.now()}:function(){return new Date().getTime()}}();class Me{constructor(t,e){this.id=Me.animIdCounter++,this.frame={time:0,timeDiff:0,lastTime:fa(),frameRate:0},this.func=t,this.setLayers(e)}setLayers(t){let e=[];return t&&(e=Array.isArray(t)?t:[t]),this.layers=e,this}getLayers(){return this.layers}addLayer(t){const e=this.layers,i=e.length;for(let n=0;n<i;n++)if(e[n]._id===t._id)return!1;return this.layers.push(t),!0}isRunning(){const e=Me.animations,i=e.length;for(let n=0;n<i;n++)if(e[n].id===this.id)return!0;return!1}start(){return this.stop(),this.frame.timeDiff=0,this.frame.lastTime=fa(),Me._addAnimation(this),this}stop(){return Me._removeAnimation(this),this}_updateFrameObject(t){this.frame.timeDiff=t-this.frame.lastTime,this.frame.lastTime=t,this.frame.time+=this.frame.timeDiff,this.frame.frameRate=1e3/this.frame.timeDiff}static _addAnimation(t){this.animations.push(t),this._handleAnimation()}static _removeAnimation(t){const e=t.id,i=this.animations,n=i.length;for(let s=0;s<n;s++)if(i[s].id===e){this.animations.splice(s,1);break}}static _runFrames(){const t={},e=this.animations;for(let i=0;i<e.length;i++){const n=e[i],s=n.layers,a=n.func;n._updateFrameObject(fa());const o=s.length;let l;if(a?l=a.call(n,n.frame)!==!1:l=!0,!!l)for(let c=0;c<o;c++){const h=s[c];h._id!==void 0&&(t[h._id]=h)}}for(let i in t)t.hasOwnProperty(i)&&t[i].batchDraw()}static _animationLoop(){const t=Me;t.animations.length?(t._runFrames(),dl.Util.requestAnimFrame(t._animationLoop)):t.animRunning=!1}static _handleAnimation(){this.animRunning||(this.animRunning=!0,dl.Util.requestAnimFrame(this._animationLoop))}}Pn.Animation=Me;Me.animations=[];Me.animIdCounter=0;Me.animRunning=!1;var _h={};(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.Easings=r.Tween=void 0;const t=It,e=Pn,i=Ot,n=ct;var s={node:1,duration:1,easing:1,onFinish:1,yoyo:1},a=1,o=2,l=3,c=0,h=["fill","stroke","shadowColor"];class f{constructor(p,v,b,_,w,u,m){this.prop=p,this.propFunc=v,this.begin=_,this._pos=_,this.duration=u,this._change=0,this.prevPos=0,this.yoyo=m,this._time=0,this._position=0,this._startTime=0,this._finish=0,this.func=b,this._change=w-this.begin,this.pause()}fire(p){var v=this[p];v&&v()}setTime(p){p>this.duration?this.yoyo?(this._time=this.duration,this.reverse()):this.finish():p<0?this.yoyo?(this._time=0,this.play()):this.reset():(this._time=p,this.update())}getTime(){return this._time}setPosition(p){this.prevPos=this._pos,this.propFunc(p),this._pos=p}getPosition(p){return p===void 0&&(p=this._time),this.func(p,this.begin,this._change,this.duration)}play(){this.state=o,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onPlay")}reverse(){this.state=l,this._time=this.duration-this._time,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onReverse")}seek(p){this.pause(),this._time=p,this.update(),this.fire("onSeek")}reset(){this.pause(),this._time=0,this.update(),this.fire("onReset")}finish(){this.pause(),this._time=this.duration,this.update(),this.fire("onFinish")}update(){this.setPosition(this.getPosition(this._time)),this.fire("onUpdate")}onEnterFrame(){var p=this.getTimer()-this._startTime;this.state===o?this.setTime(p):this.state===l&&this.setTime(this.duration-p)}pause(){this.state=a,this.fire("onPause")}getTimer(){return new Date().getTime()}}class d{constructor(p){var v=this,b=p.node,_=b._id,w,u=p.easing||r.Easings.Linear,m=!!p.yoyo,y;typeof p.duration>"u"?w=.3:p.duration===0?w=.001:w=p.duration,this.node=b,this._id=c++;var S=b.getLayer()||(b instanceof n.Konva.Stage?b.getLayers():null);S||t.Util.error("Tween constructor have `node` that is not in a layer. Please add node into layer first."),this.anim=new e.Animation(function(){v.tween.onEnterFrame()},S),this.tween=new f(y,function(T){v._tweenFunc(T)},u,0,1,w*1e3,m),this._addListeners(),d.attrs[_]||(d.attrs[_]={}),d.attrs[_][this._id]||(d.attrs[_][this._id]={}),d.tweens[_]||(d.tweens[_]={});for(y in p)s[y]===void 0&&this._addAttr(y,p[y]);this.reset(),this.onFinish=p.onFinish,this.onReset=p.onReset,this.onUpdate=p.onUpdate}_addAttr(p,v){var b=this.node,_=b._id,w,u,m,y,S,T,C,A;if(m=d.tweens[_][p],m&&delete d.attrs[_][m][p],w=b.getAttr(p),t.Util._isArray(v))if(u=[],S=Math.max(v.length,w.length),p==="points"&&v.length!==w.length&&(v.length>w.length?(C=w,w=t.Util._prepareArrayForTween(w,v,b.closed())):(T=v,v=t.Util._prepareArrayForTween(v,w,b.closed()))),p.indexOf("fill")===0)for(y=0;y<S;y++)if(y%2===0)u.push(v[y]-w[y]);else{var k=t.Util.colorToRGBA(w[y]);A=t.Util.colorToRGBA(v[y]),w[y]=k,u.push({r:A.r-k.r,g:A.g-k.g,b:A.b-k.b,a:A.a-k.a})}else for(y=0;y<S;y++)u.push(v[y]-w[y]);else h.indexOf(p)!==-1?(w=t.Util.colorToRGBA(w),A=t.Util.colorToRGBA(v),u={r:A.r-w.r,g:A.g-w.g,b:A.b-w.b,a:A.a-w.a}):u=v-w;d.attrs[_][this._id][p]={start:w,diff:u,end:v,trueEnd:T,trueStart:C},d.tweens[_][p]=this._id}_tweenFunc(p){var v=this.node,b=d.attrs[v._id][this._id],_,w,u,m,y,S,T,C;for(_ in b){if(w=b[_],u=w.start,m=w.diff,C=w.end,t.Util._isArray(u))if(y=[],T=Math.max(u.length,C.length),_.indexOf("fill")===0)for(S=0;S<T;S++)S%2===0?y.push((u[S]||0)+m[S]*p):y.push("rgba("+Math.round(u[S].r+m[S].r*p)+","+Math.round(u[S].g+m[S].g*p)+","+Math.round(u[S].b+m[S].b*p)+","+(u[S].a+m[S].a*p)+")");else for(S=0;S<T;S++)y.push((u[S]||0)+m[S]*p);else h.indexOf(_)!==-1?y="rgba("+Math.round(u.r+m.r*p)+","+Math.round(u.g+m.g*p)+","+Math.round(u.b+m.b*p)+","+(u.a+m.a*p)+")":y=u+m*p;v.setAttr(_,y)}}_addListeners(){this.tween.onPlay=()=>{this.anim.start()},this.tween.onReverse=()=>{this.anim.start()},this.tween.onPause=()=>{this.anim.stop()},this.tween.onFinish=()=>{var p=this.node,v=d.attrs[p._id][this._id];v.points&&v.points.trueEnd&&p.setAttr("points",v.points.trueEnd),this.onFinish&&this.onFinish.call(this)},this.tween.onReset=()=>{var p=this.node,v=d.attrs[p._id][this._id];v.points&&v.points.trueStart&&p.points(v.points.trueStart),this.onReset&&this.onReset()},this.tween.onUpdate=()=>{this.onUpdate&&this.onUpdate.call(this)}}play(){return this.tween.play(),this}reverse(){return this.tween.reverse(),this}reset(){return this.tween.reset(),this}seek(p){return this.tween.seek(p*1e3),this}pause(){return this.tween.pause(),this}finish(){return this.tween.finish(),this}destroy(){var p=this.node._id,v=this._id,b=d.tweens[p],_;this.pause();for(_ in b)delete d.tweens[p][_];delete d.attrs[p][v]}}r.Tween=d,d.attrs={},d.tweens={},i.Node.prototype.to=function(g){var p=g.onFinish;g.node=this,g.onFinish=function(){this.destroy(),p&&p()};var v=new d(g);v.play()},r.Easings={BackEaseIn(g,p,v,b){var _=1.70158;return v*(g/=b)*g*((_+1)*g-_)+p},BackEaseOut(g,p,v,b){var _=1.70158;return v*((g=g/b-1)*g*((_+1)*g+_)+1)+p},BackEaseInOut(g,p,v,b){var _=1.70158;return(g/=b/2)<1?v/2*(g*g*(((_*=1.525)+1)*g-_))+p:v/2*((g-=2)*g*(((_*=1.525)+1)*g+_)+2)+p},ElasticEaseIn(g,p,v,b,_,w){var u=0;return g===0?p:(g/=b)===1?p+v:(w||(w=b*.3),!_||_<Math.abs(v)?(_=v,u=w/4):u=w/(2*Math.PI)*Math.asin(v/_),-(_*Math.pow(2,10*(g-=1))*Math.sin((g*b-u)*(2*Math.PI)/w))+p)},ElasticEaseOut(g,p,v,b,_,w){var u=0;return g===0?p:(g/=b)===1?p+v:(w||(w=b*.3),!_||_<Math.abs(v)?(_=v,u=w/4):u=w/(2*Math.PI)*Math.asin(v/_),_*Math.pow(2,-10*g)*Math.sin((g*b-u)*(2*Math.PI)/w)+v+p)},ElasticEaseInOut(g,p,v,b,_,w){var u=0;return g===0?p:(g/=b/2)===2?p+v:(w||(w=b*(.3*1.5)),!_||_<Math.abs(v)?(_=v,u=w/4):u=w/(2*Math.PI)*Math.asin(v/_),g<1?-.5*(_*Math.pow(2,10*(g-=1))*Math.sin((g*b-u)*(2*Math.PI)/w))+p:_*Math.pow(2,-10*(g-=1))*Math.sin((g*b-u)*(2*Math.PI)/w)*.5+v+p)},BounceEaseOut(g,p,v,b){return(g/=b)<1/2.75?v*(7.5625*g*g)+p:g<2/2.75?v*(7.5625*(g-=1.5/2.75)*g+.75)+p:g<2.5/2.75?v*(7.5625*(g-=2.25/2.75)*g+.9375)+p:v*(7.5625*(g-=2.625/2.75)*g+.984375)+p},BounceEaseIn(g,p,v,b){return v-r.Easings.BounceEaseOut(b-g,0,v,b)+p},BounceEaseInOut(g,p,v,b){return g<b/2?r.Easings.BounceEaseIn(g*2,0,v,b)*.5+p:r.Easings.BounceEaseOut(g*2-b,0,v,b)*.5+v*.5+p},EaseIn(g,p,v,b){return v*(g/=b)*g+p},EaseOut(g,p,v,b){return-v*(g/=b)*(g-2)+p},EaseInOut(g,p,v,b){return(g/=b/2)<1?v/2*g*g+p:-v/2*(--g*(g-2)-1)+p},StrongEaseIn(g,p,v,b){return v*(g/=b)*g*g*g*g+p},StrongEaseOut(g,p,v,b){return v*((g=g/b-1)*g*g*g*g+1)+p},StrongEaseInOut(g,p,v,b){return(g/=b/2)<1?v/2*g*g*g*g*g+p:v/2*((g-=2)*g*g*g*g+2)+p},Linear(g,p,v,b){return v*g/b+p}}})(_h);(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.Konva=void 0;const t=ct,e=It,i=Ot,n=Wi,s=dh,a=nr,o=ms,l=kn,c=gs,h=Kt,f=Pn,d=_h,g=Ye,p=Te;r.Konva=e.Util._assign(t.Konva,{Util:e.Util,Transform:e.Transform,Node:i.Node,Container:n.Container,Stage:s.Stage,stages:s.stages,Layer:a.Layer,FastLayer:o.FastLayer,Group:l.Group,DD:c.DD,Shape:h.Shape,shapes:h.shapes,Animation:f.Animation,Tween:d.Tween,Easings:d.Easings,Context:g.Context,Canvas:p.Canvas}),r.default=r.Konva})(ch);var _s={};Object.defineProperty(_s,"__esModule",{value:!0});_s.Arc=void 0;const vs=ot,d0=Kt,gl=ct,ys=j,g0=ct;class ni extends d0.Shape{_sceneFunc(t){var e=gl.Konva.getAngle(this.angle()),i=this.clockwise();t.beginPath(),t.arc(0,0,this.outerRadius(),0,e,i),t.arc(0,0,this.innerRadius(),e,0,!i),t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(t){this.outerRadius(t/2)}setHeight(t){this.outerRadius(t/2)}getSelfRect(){const t=this.innerRadius(),e=this.outerRadius(),i=this.clockwise(),n=gl.Konva.getAngle(i?360-this.angle():this.angle()),s=Math.cos(Math.min(n,Math.PI)),a=1,o=Math.sin(Math.min(Math.max(Math.PI,n),3*Math.PI/2)),l=Math.sin(Math.min(n,Math.PI/2)),c=s*(s>0?t:e),h=a*e,f=o*(o>0?t:e),d=l*(l>0?e:t);return{x:c,y:i?-1*d:f,width:h-c,height:d-f}}}_s.Arc=ni;ni.prototype._centroid=!0;ni.prototype.className="Arc";ni.prototype._attrsAffectingSize=["innerRadius","outerRadius"];(0,g0._registerNode)(ni);vs.Factory.addGetterSetter(ni,"innerRadius",0,(0,ys.getNumberValidator)());vs.Factory.addGetterSetter(ni,"outerRadius",0,(0,ys.getNumberValidator)());vs.Factory.addGetterSetter(ni,"angle",0,(0,ys.getNumberValidator)());vs.Factory.addGetterSetter(ni,"clockwise",!1,(0,ys.getBooleanValidator)());var bs={},rr={};Object.defineProperty(rr,"__esModule",{value:!0});rr.Line=void 0;const ws=ot,p0=Kt,vh=j,m0=ct;function Ya(r,t,e,i,n,s,a){var o=Math.sqrt(Math.pow(e-r,2)+Math.pow(i-t,2)),l=Math.sqrt(Math.pow(n-e,2)+Math.pow(s-i,2)),c=a*o/(o+l),h=a*l/(o+l),f=e-c*(n-r),d=i-c*(s-t),g=e+h*(n-r),p=i+h*(s-t);return[f,d,g,p]}function pl(r,t){var e=r.length,i=[],n,s;for(n=2;n<e-2;n+=2)s=Ya(r[n-2],r[n-1],r[n],r[n+1],r[n+2],r[n+3],t),!isNaN(s[0])&&(i.push(s[0]),i.push(s[1]),i.push(r[n]),i.push(r[n+1]),i.push(s[2]),i.push(s[3]));return i}class Si extends p0.Shape{constructor(t){super(t),this.on("pointsChange.konva tensionChange.konva closedChange.konva bezierChange.konva",function(){this._clearCache("tensionPoints")})}_sceneFunc(t){var e=this.points(),i=e.length,n=this.tension(),s=this.closed(),a=this.bezier(),o,l,c;if(i){if(t.beginPath(),t.moveTo(e[0],e[1]),n!==0&&i>4){for(o=this.getTensionPoints(),l=o.length,c=s?0:4,s||t.quadraticCurveTo(o[0],o[1],o[2],o[3]);c<l-2;)t.bezierCurveTo(o[c++],o[c++],o[c++],o[c++],o[c++],o[c++]);s||t.quadraticCurveTo(o[l-2],o[l-1],e[i-2],e[i-1])}else if(a)for(c=2;c<i;)t.bezierCurveTo(e[c++],e[c++],e[c++],e[c++],e[c++],e[c++]);else for(c=2;c<i;c+=2)t.lineTo(e[c],e[c+1]);s?(t.closePath(),t.fillStrokeShape(this)):t.strokeShape(this)}}getTensionPoints(){return this._getCache("tensionPoints",this._getTensionPoints)}_getTensionPoints(){return this.closed()?this._getTensionPointsClosed():pl(this.points(),this.tension())}_getTensionPointsClosed(){var t=this.points(),e=t.length,i=this.tension(),n=Ya(t[e-2],t[e-1],t[0],t[1],t[2],t[3],i),s=Ya(t[e-4],t[e-3],t[e-2],t[e-1],t[0],t[1],i),a=pl(t,i),o=[n[2],n[3]].concat(a).concat([s[0],s[1],t[e-2],t[e-1],s[2],s[3],n[0],n[1],t[0],t[1]]);return o}getWidth(){return this.getSelfRect().width}getHeight(){return this.getSelfRect().height}getSelfRect(){var t=this.points();if(t.length<4)return{x:t[0]||0,y:t[1]||0,width:0,height:0};this.tension()!==0?t=[t[0],t[1],...this._getTensionPoints(),t[t.length-2],t[t.length-1]]:t=this.points();for(var e=t[0],i=t[0],n=t[1],s=t[1],a,o,l=0;l<t.length/2;l++)a=t[l*2],o=t[l*2+1],e=Math.min(e,a),i=Math.max(i,a),n=Math.min(n,o),s=Math.max(s,o);return{x:e,y:n,width:i-e,height:s-n}}}rr.Line=Si;Si.prototype.className="Line";Si.prototype._attrsAffectingSize=["points","bezier","tension"];(0,m0._registerNode)(Si);ws.Factory.addGetterSetter(Si,"closed",!1);ws.Factory.addGetterSetter(Si,"bezier",!1);ws.Factory.addGetterSetter(Si,"tension",0,(0,vh.getNumberValidator)());ws.Factory.addGetterSetter(Si,"points",[],(0,vh.getNumberArrayValidator)());var xn={},yh={};(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.t2length=r.getQuadraticArcLength=r.getCubicArcLength=r.binomialCoefficients=r.cValues=r.tValues=void 0,r.tValues=[[],[],[-.5773502691896257,.5773502691896257],[0,-.7745966692414834,.7745966692414834],[-.33998104358485626,.33998104358485626,-.8611363115940526,.8611363115940526],[0,-.5384693101056831,.5384693101056831,-.906179845938664,.906179845938664],[.6612093864662645,-.6612093864662645,-.2386191860831969,.2386191860831969,-.932469514203152,.932469514203152],[0,.4058451513773972,-.4058451513773972,-.7415311855993945,.7415311855993945,-.9491079123427585,.9491079123427585],[-.1834346424956498,.1834346424956498,-.525532409916329,.525532409916329,-.7966664774136267,.7966664774136267,-.9602898564975363,.9602898564975363],[0,-.8360311073266358,.8360311073266358,-.9681602395076261,.9681602395076261,-.3242534234038089,.3242534234038089,-.6133714327005904,.6133714327005904],[-.14887433898163122,.14887433898163122,-.4333953941292472,.4333953941292472,-.6794095682990244,.6794095682990244,-.8650633666889845,.8650633666889845,-.9739065285171717,.9739065285171717],[0,-.26954315595234496,.26954315595234496,-.5190961292068118,.5190961292068118,-.7301520055740494,.7301520055740494,-.8870625997680953,.8870625997680953,-.978228658146057,.978228658146057],[-.1252334085114689,.1252334085114689,-.3678314989981802,.3678314989981802,-.5873179542866175,.5873179542866175,-.7699026741943047,.7699026741943047,-.9041172563704749,.9041172563704749,-.9815606342467192,.9815606342467192],[0,-.2304583159551348,.2304583159551348,-.44849275103644687,.44849275103644687,-.6423493394403402,.6423493394403402,-.8015780907333099,.8015780907333099,-.9175983992229779,.9175983992229779,-.9841830547185881,.9841830547185881],[-.10805494870734367,.10805494870734367,-.31911236892788974,.31911236892788974,-.5152486363581541,.5152486363581541,-.6872929048116855,.6872929048116855,-.827201315069765,.827201315069765,-.9284348836635735,.9284348836635735,-.9862838086968123,.9862838086968123],[0,-.20119409399743451,.20119409399743451,-.3941513470775634,.3941513470775634,-.5709721726085388,.5709721726085388,-.7244177313601701,.7244177313601701,-.8482065834104272,.8482065834104272,-.937273392400706,.937273392400706,-.9879925180204854,.9879925180204854],[-.09501250983763744,.09501250983763744,-.2816035507792589,.2816035507792589,-.45801677765722737,.45801677765722737,-.6178762444026438,.6178762444026438,-.755404408355003,.755404408355003,-.8656312023878318,.8656312023878318,-.9445750230732326,.9445750230732326,-.9894009349916499,.9894009349916499],[0,-.17848418149584785,.17848418149584785,-.3512317634538763,.3512317634538763,-.5126905370864769,.5126905370864769,-.6576711592166907,.6576711592166907,-.7815140038968014,.7815140038968014,-.8802391537269859,.8802391537269859,-.9506755217687678,.9506755217687678,-.9905754753144174,.9905754753144174],[-.0847750130417353,.0847750130417353,-.2518862256915055,.2518862256915055,-.41175116146284263,.41175116146284263,-.5597708310739475,.5597708310739475,-.6916870430603532,.6916870430603532,-.8037049589725231,.8037049589725231,-.8926024664975557,.8926024664975557,-.9558239495713977,.9558239495713977,-.9915651684209309,.9915651684209309],[0,-.16035864564022537,.16035864564022537,-.31656409996362983,.31656409996362983,-.46457074137596094,.46457074137596094,-.600545304661681,.600545304661681,-.7209661773352294,.7209661773352294,-.8227146565371428,.8227146565371428,-.9031559036148179,.9031559036148179,-.96020815213483,.96020815213483,-.9924068438435844,.9924068438435844],[-.07652652113349734,.07652652113349734,-.22778585114164507,.22778585114164507,-.37370608871541955,.37370608871541955,-.5108670019508271,.5108670019508271,-.636053680726515,.636053680726515,-.7463319064601508,.7463319064601508,-.8391169718222188,.8391169718222188,-.912234428251326,.912234428251326,-.9639719272779138,.9639719272779138,-.9931285991850949,.9931285991850949],[0,-.1455618541608951,.1455618541608951,-.2880213168024011,.2880213168024011,-.4243421202074388,.4243421202074388,-.5516188358872198,.5516188358872198,-.6671388041974123,.6671388041974123,-.7684399634756779,.7684399634756779,-.8533633645833173,.8533633645833173,-.9200993341504008,.9200993341504008,-.9672268385663063,.9672268385663063,-.9937521706203895,.9937521706203895],[-.06973927331972223,.06973927331972223,-.20786042668822127,.20786042668822127,-.34193582089208424,.34193582089208424,-.469355837986757,.469355837986757,-.5876404035069116,.5876404035069116,-.6944872631866827,.6944872631866827,-.7878168059792081,.7878168059792081,-.8658125777203002,.8658125777203002,-.926956772187174,.926956772187174,-.9700604978354287,.9700604978354287,-.9942945854823992,.9942945854823992],[0,-.1332568242984661,.1332568242984661,-.26413568097034495,.26413568097034495,-.3903010380302908,.3903010380302908,-.5095014778460075,.5095014778460075,-.6196098757636461,.6196098757636461,-.7186613631319502,.7186613631319502,-.8048884016188399,.8048884016188399,-.8767523582704416,.8767523582704416,-.9329710868260161,.9329710868260161,-.9725424712181152,.9725424712181152,-.9947693349975522,.9947693349975522],[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213]],r.cValues=[[],[],[1,1],[.8888888888888888,.5555555555555556,.5555555555555556],[.6521451548625461,.6521451548625461,.34785484513745385,.34785484513745385],[.5688888888888889,.47862867049936647,.47862867049936647,.23692688505618908,.23692688505618908],[.3607615730481386,.3607615730481386,.46791393457269104,.46791393457269104,.17132449237917036,.17132449237917036],[.4179591836734694,.3818300505051189,.3818300505051189,.27970539148927664,.27970539148927664,.1294849661688697,.1294849661688697],[.362683783378362,.362683783378362,.31370664587788727,.31370664587788727,.22238103445337448,.22238103445337448,.10122853629037626,.10122853629037626],[.3302393550012598,.1806481606948574,.1806481606948574,.08127438836157441,.08127438836157441,.31234707704000286,.31234707704000286,.26061069640293544,.26061069640293544],[.29552422471475287,.29552422471475287,.26926671930999635,.26926671930999635,.21908636251598204,.21908636251598204,.1494513491505806,.1494513491505806,.06667134430868814,.06667134430868814],[.2729250867779006,.26280454451024665,.26280454451024665,.23319376459199048,.23319376459199048,.18629021092773426,.18629021092773426,.1255803694649046,.1255803694649046,.05566856711617366,.05566856711617366],[.24914704581340277,.24914704581340277,.2334925365383548,.2334925365383548,.20316742672306592,.20316742672306592,.16007832854334622,.16007832854334622,.10693932599531843,.10693932599531843,.04717533638651183,.04717533638651183],[.2325515532308739,.22628318026289723,.22628318026289723,.2078160475368885,.2078160475368885,.17814598076194574,.17814598076194574,.13887351021978725,.13887351021978725,.09212149983772845,.09212149983772845,.04048400476531588,.04048400476531588],[.2152638534631578,.2152638534631578,.2051984637212956,.2051984637212956,.18553839747793782,.18553839747793782,.15720316715819355,.15720316715819355,.12151857068790319,.12151857068790319,.08015808715976021,.08015808715976021,.03511946033175186,.03511946033175186],[.2025782419255613,.19843148532711158,.19843148532711158,.1861610000155622,.1861610000155622,.16626920581699392,.16626920581699392,.13957067792615432,.13957067792615432,.10715922046717194,.10715922046717194,.07036604748810812,.07036604748810812,.03075324199611727,.03075324199611727],[.1894506104550685,.1894506104550685,.18260341504492358,.18260341504492358,.16915651939500254,.16915651939500254,.14959598881657674,.14959598881657674,.12462897125553388,.12462897125553388,.09515851168249279,.09515851168249279,.062253523938647894,.062253523938647894,.027152459411754096,.027152459411754096],[.17944647035620653,.17656270536699264,.17656270536699264,.16800410215645004,.16800410215645004,.15404576107681028,.15404576107681028,.13513636846852548,.13513636846852548,.11188384719340397,.11188384719340397,.08503614831717918,.08503614831717918,.0554595293739872,.0554595293739872,.02414830286854793,.02414830286854793],[.1691423829631436,.1691423829631436,.16427648374583273,.16427648374583273,.15468467512626524,.15468467512626524,.14064291467065065,.14064291467065065,.12255520671147846,.12255520671147846,.10094204410628717,.10094204410628717,.07642573025488905,.07642573025488905,.0497145488949698,.0497145488949698,.02161601352648331,.02161601352648331],[.1610544498487837,.15896884339395434,.15896884339395434,.15276604206585967,.15276604206585967,.1426067021736066,.1426067021736066,.12875396253933621,.12875396253933621,.11156664554733399,.11156664554733399,.09149002162245,.09149002162245,.06904454273764123,.06904454273764123,.0448142267656996,.0448142267656996,.019461788229726478,.019461788229726478],[.15275338713072584,.15275338713072584,.14917298647260374,.14917298647260374,.14209610931838204,.14209610931838204,.13168863844917664,.13168863844917664,.11819453196151841,.11819453196151841,.10193011981724044,.10193011981724044,.08327674157670475,.08327674157670475,.06267204833410907,.06267204833410907,.04060142980038694,.04060142980038694,.017614007139152118,.017614007139152118],[.14608113364969041,.14452440398997005,.14452440398997005,.13988739479107315,.13988739479107315,.13226893863333747,.13226893863333747,.12183141605372853,.12183141605372853,.10879729916714838,.10879729916714838,.09344442345603386,.09344442345603386,.0761001136283793,.0761001136283793,.057134425426857205,.057134425426857205,.036953789770852494,.036953789770852494,.016017228257774335,.016017228257774335],[.13925187285563198,.13925187285563198,.13654149834601517,.13654149834601517,.13117350478706238,.13117350478706238,.12325237681051242,.12325237681051242,.11293229608053922,.11293229608053922,.10041414444288096,.10041414444288096,.08594160621706773,.08594160621706773,.06979646842452049,.06979646842452049,.052293335152683286,.052293335152683286,.03377490158481415,.03377490158481415,.0146279952982722,.0146279952982722],[.13365457218610619,.1324620394046966,.1324620394046966,.12890572218808216,.12890572218808216,.12304908430672953,.12304908430672953,.11499664022241136,.11499664022241136,.10489209146454141,.10489209146454141,.09291576606003515,.09291576606003515,.07928141177671895,.07928141177671895,.06423242140852585,.06423242140852585,.04803767173108467,.04803767173108467,.030988005856979445,.030988005856979445,.013411859487141771,.013411859487141771],[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872]],r.binomialCoefficients=[[1],[1,1],[1,2,1],[1,3,3,1]];const t=(a,o,l)=>{let c,h,f;c=l/2,h=0;for(let g=0;g<20;g++)f=c*r.tValues[20][g]+c,h+=r.cValues[20][g]*i(a,o,f);return c*h};r.getCubicArcLength=t;const e=(a,o,l)=>{l===void 0&&(l=1);const c=a[0]-2*a[1]+a[2],h=o[0]-2*o[1]+o[2],f=2*a[1]-2*a[0],d=2*o[1]-2*o[0],g=4*(c*c+h*h),p=4*(c*f+h*d),v=f*f+d*d;if(g===0)return l*Math.sqrt(Math.pow(a[2]-a[0],2)+Math.pow(o[2]-o[0],2));const b=p/(2*g),_=v/g,w=l+b,u=_-b*b,m=w*w+u>0?Math.sqrt(w*w+u):0,y=b*b+u>0?Math.sqrt(b*b+u):0,S=b+Math.sqrt(b*b+u)!==0?u*Math.log(Math.abs((w+m)/(b+y))):0;return Math.sqrt(g)/2*(w*m-b*y+S)};r.getQuadraticArcLength=e;function i(a,o,l){const c=n(1,l,a),h=n(1,l,o),f=c*c+h*h;return Math.sqrt(f)}const n=(a,o,l)=>{const c=l.length-1;let h,f;if(c===0)return 0;if(a===0){f=0;for(let d=0;d<=c;d++)f+=r.binomialCoefficients[c][d]*Math.pow(1-o,c-d)*Math.pow(o,d)*l[d];return f}else{h=new Array(c);for(let d=0;d<c;d++)h[d]=c*(l[d+1]-l[d]);return n(a-1,o,h)}},s=(a,o,l)=>{let c=1,h=a/o,f=(a-l(h))/o,d=0;for(;c>.001;){const g=l(h+f),p=Math.abs(a-g)/o;if(p<c)c=p,h+=f;else{const v=l(h-f),b=Math.abs(a-v)/o;b<c?(c=b,h-=f):f/=2}if(d++,d>500)break}return h};r.t2length=s})(yh);Object.defineProperty(xn,"__esModule",{value:!0});xn.Path=void 0;const _0=ot,v0=Kt,y0=ct,tn=yh;class Xt extends v0.Shape{constructor(t){super(t),this.dataArray=[],this.pathLength=0,this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute()})}_readDataAttribute(){this.dataArray=Xt.parsePathData(this.data()),this.pathLength=Xt.getPathLength(this.dataArray)}_sceneFunc(t){var e=this.dataArray;t.beginPath();for(var i=!1,n=0;n<e.length;n++){var s=e[n].command,a=e[n].points;switch(s){case"L":t.lineTo(a[0],a[1]);break;case"M":t.moveTo(a[0],a[1]);break;case"C":t.bezierCurveTo(a[0],a[1],a[2],a[3],a[4],a[5]);break;case"Q":t.quadraticCurveTo(a[0],a[1],a[2],a[3]);break;case"A":var o=a[0],l=a[1],c=a[2],h=a[3],f=a[4],d=a[5],g=a[6],p=a[7],v=c>h?c:h,b=c>h?1:c/h,_=c>h?h/c:1;t.translate(o,l),t.rotate(g),t.scale(b,_),t.arc(0,0,v,f,f+d,1-p),t.scale(1/b,1/_),t.rotate(-g),t.translate(-o,-l);break;case"z":i=!0,t.closePath();break}}!i&&!this.hasFill()?t.strokeShape(this):t.fillStrokeShape(this)}getSelfRect(){var t=[];this.dataArray.forEach(function(c){if(c.command==="A"){var h=c.points[4],f=c.points[5],d=c.points[4]+f,g=Math.PI/180;if(Math.abs(h-d)<g&&(g=Math.abs(h-d)),f<0)for(let p=h-g;p>d;p-=g){const v=Xt.getPointOnEllipticalArc(c.points[0],c.points[1],c.points[2],c.points[3],p,0);t.push(v.x,v.y)}else for(let p=h+g;p<d;p+=g){const v=Xt.getPointOnEllipticalArc(c.points[0],c.points[1],c.points[2],c.points[3],p,0);t.push(v.x,v.y)}}else if(c.command==="C")for(let p=0;p<=1;p+=.01){const v=Xt.getPointOnCubicBezier(p,c.start.x,c.start.y,c.points[0],c.points[1],c.points[2],c.points[3],c.points[4],c.points[5]);t.push(v.x,v.y)}else t=t.concat(c.points)});for(var e=t[0],i=t[0],n=t[1],s=t[1],a,o,l=0;l<t.length/2;l++)a=t[l*2],o=t[l*2+1],isNaN(a)||(e=Math.min(e,a),i=Math.max(i,a)),isNaN(o)||(n=Math.min(n,o),s=Math.max(s,o));return{x:e,y:n,width:i-e,height:s-n}}getLength(){return this.pathLength}getPointAtLength(t){return Xt.getPointAtLengthOfDataArray(t,this.dataArray)}static getLineLength(t,e,i,n){return Math.sqrt((i-t)*(i-t)+(n-e)*(n-e))}static getPathLength(t){let e=0;for(var i=0;i<t.length;++i)e+=t[i].pathLength;return e}static getPointAtLengthOfDataArray(t,e){var i,n=0,s=e.length;if(!s)return null;for(;n<s&&t>e[n].pathLength;)t-=e[n].pathLength,++n;if(n===s)return i=e[n-1].points.slice(-2),{x:i[0],y:i[1]};if(t<.01)return i=e[n].points.slice(0,2),{x:i[0],y:i[1]};var a=e[n],o=a.points;switch(a.command){case"L":return Xt.getPointOnLine(t,a.start.x,a.start.y,o[0],o[1]);case"C":return Xt.getPointOnCubicBezier((0,tn.t2length)(t,Xt.getPathLength(e),v=>(0,tn.getCubicArcLength)([a.start.x,o[0],o[2],o[4]],[a.start.y,o[1],o[3],o[5]],v)),a.start.x,a.start.y,o[0],o[1],o[2],o[3],o[4],o[5]);case"Q":return Xt.getPointOnQuadraticBezier((0,tn.t2length)(t,Xt.getPathLength(e),v=>(0,tn.getQuadraticArcLength)([a.start.x,o[0],o[2]],[a.start.y,o[1],o[3]],v)),a.start.x,a.start.y,o[0],o[1],o[2],o[3]);case"A":var l=o[0],c=o[1],h=o[2],f=o[3],d=o[4],g=o[5],p=o[6];return d+=g*t/a.pathLength,Xt.getPointOnEllipticalArc(l,c,h,f,d,p)}return null}static getPointOnLine(t,e,i,n,s,a,o){a===void 0&&(a=e),o===void 0&&(o=i);var l=(s-i)/(n-e+1e-8),c=Math.sqrt(t*t/(1+l*l));n<e&&(c*=-1);var h=l*c,f;if(n===e)f={x:a,y:o+h};else if((o-i)/(a-e+1e-8)===l)f={x:a+c,y:o+h};else{var d,g,p=this.getLineLength(e,i,n,s),v=(a-e)*(n-e)+(o-i)*(s-i);v=v/(p*p),d=e+v*(n-e),g=i+v*(s-i);var b=this.getLineLength(a,o,d,g),_=Math.sqrt(t*t-b*b);c=Math.sqrt(_*_/(1+l*l)),n<e&&(c*=-1),h=l*c,f={x:d+c,y:g+h}}return f}static getPointOnCubicBezier(t,e,i,n,s,a,o,l,c){function h(b){return b*b*b}function f(b){return 3*b*b*(1-b)}function d(b){return 3*b*(1-b)*(1-b)}function g(b){return(1-b)*(1-b)*(1-b)}var p=l*h(t)+a*f(t)+n*d(t)+e*g(t),v=c*h(t)+o*f(t)+s*d(t)+i*g(t);return{x:p,y:v}}static getPointOnQuadraticBezier(t,e,i,n,s,a,o){function l(g){return g*g}function c(g){return 2*g*(1-g)}function h(g){return(1-g)*(1-g)}var f=a*l(t)+n*c(t)+e*h(t),d=o*l(t)+s*c(t)+i*h(t);return{x:f,y:d}}static getPointOnEllipticalArc(t,e,i,n,s,a){var o=Math.cos(a),l=Math.sin(a),c={x:i*Math.cos(s),y:n*Math.sin(s)};return{x:t+(c.x*o-c.y*l),y:e+(c.x*l+c.y*o)}}static parsePathData(t){if(!t)return[];var e=t,i=["m","M","l","L","v","V","h","H","z","Z","c","C","q","Q","t","T","s","S","a","A"];e=e.replace(new RegExp(" ","g"),",");for(var n=0;n<i.length;n++)e=e.replace(new RegExp(i[n],"g"),"|"+i[n]);var s=e.split("|"),a=[],o=[],l=0,c=0,h=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:e[-+]?\d+)?)/gi,f;for(n=1;n<s.length;n++){var d=s[n],g=d.charAt(0);for(d=d.slice(1),o.length=0;f=h.exec(d);)o.push(f[0]);for(var p=[],v=0,b=o.length;v<b;v++){if(o[v]==="00"){p.push(0,0);continue}var _=parseFloat(o[v]);isNaN(_)?p.push(0):p.push(_)}for(;p.length>0&&!isNaN(p[0]);){var w="",u=[],m=l,y=c,S,T,C,A,k,P,x,M,F,N;switch(g){case"l":l+=p.shift(),c+=p.shift(),w="L",u.push(l,c);break;case"L":l=p.shift(),c=p.shift(),u.push(l,c);break;case"m":var I=p.shift(),V=p.shift();if(l+=I,c+=V,w="M",a.length>2&&a[a.length-1].command==="z"){for(var Z=a.length-2;Z>=0;Z--)if(a[Z].command==="M"){l=a[Z].points[0]+I,c=a[Z].points[1]+V;break}}u.push(l,c),g="l";break;case"M":l=p.shift(),c=p.shift(),w="M",u.push(l,c),g="L";break;case"h":l+=p.shift(),w="L",u.push(l,c);break;case"H":l=p.shift(),w="L",u.push(l,c);break;case"v":c+=p.shift(),w="L",u.push(l,c);break;case"V":c=p.shift(),w="L",u.push(l,c);break;case"C":u.push(p.shift(),p.shift(),p.shift(),p.shift()),l=p.shift(),c=p.shift(),u.push(l,c);break;case"c":u.push(l+p.shift(),c+p.shift(),l+p.shift(),c+p.shift()),l+=p.shift(),c+=p.shift(),w="C",u.push(l,c);break;case"S":T=l,C=c,S=a[a.length-1],S.command==="C"&&(T=l+(l-S.points[2]),C=c+(c-S.points[3])),u.push(T,C,p.shift(),p.shift()),l=p.shift(),c=p.shift(),w="C",u.push(l,c);break;case"s":T=l,C=c,S=a[a.length-1],S.command==="C"&&(T=l+(l-S.points[2]),C=c+(c-S.points[3])),u.push(T,C,l+p.shift(),c+p.shift()),l+=p.shift(),c+=p.shift(),w="C",u.push(l,c);break;case"Q":u.push(p.shift(),p.shift()),l=p.shift(),c=p.shift(),u.push(l,c);break;case"q":u.push(l+p.shift(),c+p.shift()),l+=p.shift(),c+=p.shift(),w="Q",u.push(l,c);break;case"T":T=l,C=c,S=a[a.length-1],S.command==="Q"&&(T=l+(l-S.points[0]),C=c+(c-S.points[1])),l=p.shift(),c=p.shift(),w="Q",u.push(T,C,l,c);break;case"t":T=l,C=c,S=a[a.length-1],S.command==="Q"&&(T=l+(l-S.points[0]),C=c+(c-S.points[1])),l+=p.shift(),c+=p.shift(),w="Q",u.push(T,C,l,c);break;case"A":A=p.shift(),k=p.shift(),P=p.shift(),x=p.shift(),M=p.shift(),F=l,N=c,l=p.shift(),c=p.shift(),w="A",u=this.convertEndpointToCenterParameterization(F,N,l,c,x,M,A,k,P);break;case"a":A=p.shift(),k=p.shift(),P=p.shift(),x=p.shift(),M=p.shift(),F=l,N=c,l+=p.shift(),c+=p.shift(),w="A",u=this.convertEndpointToCenterParameterization(F,N,l,c,x,M,A,k,P);break}a.push({command:w||g,points:u,start:{x:m,y},pathLength:this.calcLength(m,y,w||g,u)})}(g==="z"||g==="Z")&&a.push({command:"z",points:[],start:void 0,pathLength:0})}return a}static calcLength(t,e,i,n){var s,a,o,l,c=Xt;switch(i){case"L":return c.getLineLength(t,e,n[0],n[1]);case"C":return(0,tn.getCubicArcLength)([t,n[0],n[2],n[4]],[e,n[1],n[3],n[5]],1);case"Q":return(0,tn.getQuadraticArcLength)([t,n[0],n[2]],[e,n[1],n[3]],1);case"A":s=0;var h=n[4],f=n[5],d=n[4]+f,g=Math.PI/180;if(Math.abs(h-d)<g&&(g=Math.abs(h-d)),a=c.getPointOnEllipticalArc(n[0],n[1],n[2],n[3],h,0),f<0)for(l=h-g;l>d;l-=g)o=c.getPointOnEllipticalArc(n[0],n[1],n[2],n[3],l,0),s+=c.getLineLength(a.x,a.y,o.x,o.y),a=o;else for(l=h+g;l<d;l+=g)o=c.getPointOnEllipticalArc(n[0],n[1],n[2],n[3],l,0),s+=c.getLineLength(a.x,a.y,o.x,o.y),a=o;return o=c.getPointOnEllipticalArc(n[0],n[1],n[2],n[3],d,0),s+=c.getLineLength(a.x,a.y,o.x,o.y),s}return 0}static convertEndpointToCenterParameterization(t,e,i,n,s,a,o,l,c){var h=c*(Math.PI/180),f=Math.cos(h)*(t-i)/2+Math.sin(h)*(e-n)/2,d=-1*Math.sin(h)*(t-i)/2+Math.cos(h)*(e-n)/2,g=f*f/(o*o)+d*d/(l*l);g>1&&(o*=Math.sqrt(g),l*=Math.sqrt(g));var p=Math.sqrt((o*o*(l*l)-o*o*(d*d)-l*l*(f*f))/(o*o*(d*d)+l*l*(f*f)));s===a&&(p*=-1),isNaN(p)&&(p=0);var v=p*o*d/l,b=p*-l*f/o,_=(t+i)/2+Math.cos(h)*v-Math.sin(h)*b,w=(e+n)/2+Math.sin(h)*v+Math.cos(h)*b,u=function(k){return Math.sqrt(k[0]*k[0]+k[1]*k[1])},m=function(k,P){return(k[0]*P[0]+k[1]*P[1])/(u(k)*u(P))},y=function(k,P){return(k[0]*P[1]<k[1]*P[0]?-1:1)*Math.acos(m(k,P))},S=y([1,0],[(f-v)/o,(d-b)/l]),T=[(f-v)/o,(d-b)/l],C=[(-1*f-v)/o,(-1*d-b)/l],A=y(T,C);return m(T,C)<=-1&&(A=Math.PI),m(T,C)>=1&&(A=0),a===0&&A>0&&(A=A-2*Math.PI),a===1&&A<0&&(A=A+2*Math.PI),[_,w,o,l,S,A,h,a]}}xn.Path=Xt;Xt.prototype.className="Path";Xt.prototype._attrsAffectingSize=["data"];(0,y0._registerNode)(Xt);_0.Factory.addGetterSetter(Xt,"data");Object.defineProperty(bs,"__esModule",{value:!0});bs.Arrow=void 0;const Ss=ot,b0=rr,bh=j,w0=ct,ml=xn;class Xi extends b0.Line{_sceneFunc(t){super._sceneFunc(t);var e=Math.PI*2,i=this.points(),n=i,s=this.tension()!==0&&i.length>4;s&&(n=this.getTensionPoints());var a=this.pointerLength(),o=i.length,l,c;if(s){const d=[n[n.length-4],n[n.length-3],n[n.length-2],n[n.length-1],i[o-2],i[o-1]],g=ml.Path.calcLength(n[n.length-4],n[n.length-3],"C",d),p=ml.Path.getPointOnQuadraticBezier(Math.min(1,1-a/g),d[0],d[1],d[2],d[3],d[4],d[5]);l=i[o-2]-p.x,c=i[o-1]-p.y}else l=i[o-2]-i[o-4],c=i[o-1]-i[o-3];var h=(Math.atan2(c,l)+e)%e,f=this.pointerWidth();this.pointerAtEnding()&&(t.save(),t.beginPath(),t.translate(i[o-2],i[o-1]),t.rotate(h),t.moveTo(0,0),t.lineTo(-a,f/2),t.lineTo(-a,-f/2),t.closePath(),t.restore(),this.__fillStroke(t)),this.pointerAtBeginning()&&(t.save(),t.beginPath(),t.translate(i[0],i[1]),s?(l=(n[0]+n[2])/2-i[0],c=(n[1]+n[3])/2-i[1]):(l=i[2]-i[0],c=i[3]-i[1]),t.rotate((Math.atan2(-c,-l)+e)%e),t.moveTo(0,0),t.lineTo(-a,f/2),t.lineTo(-a,-f/2),t.closePath(),t.restore(),this.__fillStroke(t))}__fillStroke(t){var e=this.dashEnabled();e&&(this.attrs.dashEnabled=!1,t.setLineDash([])),t.fillStrokeShape(this),e&&(this.attrs.dashEnabled=!0)}getSelfRect(){const t=super.getSelfRect(),e=this.pointerWidth()/2;return{x:t.x-e,y:t.y-e,width:t.width+e*2,height:t.height+e*2}}}bs.Arrow=Xi;Xi.prototype.className="Arrow";(0,w0._registerNode)(Xi);Ss.Factory.addGetterSetter(Xi,"pointerLength",10,(0,bh.getNumberValidator)());Ss.Factory.addGetterSetter(Xi,"pointerWidth",10,(0,bh.getNumberValidator)());Ss.Factory.addGetterSetter(Xi,"pointerAtBeginning",!1);Ss.Factory.addGetterSetter(Xi,"pointerAtEnding",!0);var Cs={};Object.defineProperty(Cs,"__esModule",{value:!0});Cs.Circle=void 0;const S0=ot,C0=Kt,A0=j,T0=ct;let En=class extends C0.Shape{_sceneFunc(t){t.beginPath(),t.arc(0,0,this.attrs.radius||0,0,Math.PI*2,!1),t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(t){this.radius()!==t/2&&this.radius(t/2)}setHeight(t){this.radius()!==t/2&&this.radius(t/2)}};Cs.Circle=En;En.prototype._centroid=!0;En.prototype.className="Circle";En.prototype._attrsAffectingSize=["radius"];(0,T0._registerNode)(En);S0.Factory.addGetterSetter(En,"radius",0,(0,A0.getNumberValidator)());var As={};Object.defineProperty(As,"__esModule",{value:!0});As.Ellipse=void 0;const So=ot,k0=Kt,wh=j,P0=ct;class Ci extends k0.Shape{_sceneFunc(t){var e=this.radiusX(),i=this.radiusY();t.beginPath(),t.save(),e!==i&&t.scale(1,i/e),t.arc(0,0,e,0,Math.PI*2,!1),t.restore(),t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.radiusX()*2}getHeight(){return this.radiusY()*2}setWidth(t){this.radiusX(t/2)}setHeight(t){this.radiusY(t/2)}}As.Ellipse=Ci;Ci.prototype.className="Ellipse";Ci.prototype._centroid=!0;Ci.prototype._attrsAffectingSize=["radiusX","radiusY"];(0,P0._registerNode)(Ci);So.Factory.addComponentsGetterSetter(Ci,"radius",["x","y"]);So.Factory.addGetterSetter(Ci,"radiusX",0,(0,wh.getNumberValidator)());So.Factory.addGetterSetter(Ci,"radiusY",0,(0,wh.getNumberValidator)());var Ts={};Object.defineProperty(Ts,"__esModule",{value:!0});Ts.Image=void 0;const ua=It,Yi=ot,x0=Kt,E0=ct,sr=j;let Le=class Sh extends x0.Shape{constructor(t){super(t),this.on("imageChange.konva",()=>{this._setImageLoad()}),this._setImageLoad()}_setImageLoad(){const t=this.image();t&&t.complete||t&&t.readyState===4||t&&t.addEventListener&&t.addEventListener("load",()=>{this._requestDraw()})}_useBufferCanvas(){return super._useBufferCanvas(!0)}_sceneFunc(t){const e=this.getWidth(),i=this.getHeight(),n=this.cornerRadius(),s=this.attrs.image;let a;if(s){const o=this.attrs.cropWidth,l=this.attrs.cropHeight;o&&l?a=[s,this.cropX(),this.cropY(),o,l,0,0,e,i]:a=[s,0,0,e,i]}(this.hasFill()||this.hasStroke()||n)&&(t.beginPath(),n?ua.Util.drawRoundedRectPath(t,e,i,n):t.rect(0,0,e,i),t.closePath(),t.fillStrokeShape(this)),s&&(n&&t.clip(),t.drawImage.apply(t,a))}_hitFunc(t){var e=this.width(),i=this.height(),n=this.cornerRadius();t.beginPath(),n?ua.Util.drawRoundedRectPath(t,e,i,n):t.rect(0,0,e,i),t.closePath(),t.fillStrokeShape(this)}getWidth(){var t,e;return(t=this.attrs.width)!==null&&t!==void 0?t:(e=this.image())===null||e===void 0?void 0:e.width}getHeight(){var t,e;return(t=this.attrs.height)!==null&&t!==void 0?t:(e=this.image())===null||e===void 0?void 0:e.height}static fromURL(t,e,i=null){var n=ua.Util.createImageElement();n.onload=function(){var s=new Sh({image:n});e(s)},n.onerror=i,n.crossOrigin="Anonymous",n.src=t}};Ts.Image=Le;Le.prototype.className="Image";(0,E0._registerNode)(Le);Yi.Factory.addGetterSetter(Le,"cornerRadius",0,(0,sr.getNumberOrArrayOfNumbersValidator)(4));Yi.Factory.addGetterSetter(Le,"image");Yi.Factory.addComponentsGetterSetter(Le,"crop",["x","y","width","height"]);Yi.Factory.addGetterSetter(Le,"cropX",0,(0,sr.getNumberValidator)());Yi.Factory.addGetterSetter(Le,"cropY",0,(0,sr.getNumberValidator)());Yi.Factory.addGetterSetter(Le,"cropWidth",0,(0,sr.getNumberValidator)());Yi.Factory.addGetterSetter(Le,"cropHeight",0,(0,sr.getNumberValidator)());var vn={};Object.defineProperty(vn,"__esModule",{value:!0});vn.Tag=vn.Label=void 0;const ks=ot,M0=Kt,F0=kn,Co=j,Ch=ct;var Ah=["fontFamily","fontSize","fontStyle","padding","lineHeight","text","width","height","pointerDirection","pointerWidth","pointerHeight"],R0="Change.konva",N0="none",Ka="up",qa="right",$a="down",Ja="left",L0=Ah.length;class Ao extends F0.Group{constructor(t){super(t),this.on("add.konva",function(e){this._addListeners(e.child),this._sync()})}getText(){return this.find("Text")[0]}getTag(){return this.find("Tag")[0]}_addListeners(t){var e=this,i,n=function(){e._sync()};for(i=0;i<L0;i++)t.on(Ah[i]+R0,n)}getWidth(){return this.getText().width()}getHeight(){return this.getText().height()}_sync(){var t=this.getText(),e=this.getTag(),i,n,s,a,o,l,c;if(t&&e){switch(i=t.width(),n=t.height(),s=e.pointerDirection(),a=e.pointerWidth(),c=e.pointerHeight(),o=0,l=0,s){case Ka:o=i/2,l=-1*c;break;case qa:o=i+a,l=n/2;break;case $a:o=i/2,l=n+c;break;case Ja:o=-1*a,l=n/2;break}e.setAttrs({x:-1*o,y:-1*l,width:i,height:n}),t.setAttrs({x:-1*o,y:-1*l})}}}vn.Label=Ao;Ao.prototype.className="Label";(0,Ch._registerNode)(Ao);class Ki extends M0.Shape{_sceneFunc(t){var e=this.width(),i=this.height(),n=this.pointerDirection(),s=this.pointerWidth(),a=this.pointerHeight(),o=this.cornerRadius();let l=0,c=0,h=0,f=0;typeof o=="number"?l=c=h=f=Math.min(o,e/2,i/2):(l=Math.min(o[0]||0,e/2,i/2),c=Math.min(o[1]||0,e/2,i/2),f=Math.min(o[2]||0,e/2,i/2),h=Math.min(o[3]||0,e/2,i/2)),t.beginPath(),t.moveTo(l,0),n===Ka&&(t.lineTo((e-s)/2,0),t.lineTo(e/2,-1*a),t.lineTo((e+s)/2,0)),t.lineTo(e-c,0),t.arc(e-c,c,c,Math.PI*3/2,0,!1),n===qa&&(t.lineTo(e,(i-a)/2),t.lineTo(e+s,i/2),t.lineTo(e,(i+a)/2)),t.lineTo(e,i-f),t.arc(e-f,i-f,f,0,Math.PI/2,!1),n===$a&&(t.lineTo((e+s)/2,i),t.lineTo(e/2,i+a),t.lineTo((e-s)/2,i)),t.lineTo(h,i),t.arc(h,i-h,h,Math.PI/2,Math.PI,!1),n===Ja&&(t.lineTo(0,(i+a)/2),t.lineTo(-1*s,i/2),t.lineTo(0,(i-a)/2)),t.lineTo(0,l),t.arc(l,l,l,Math.PI,Math.PI*3/2,!1),t.closePath(),t.fillStrokeShape(this)}getSelfRect(){var t=0,e=0,i=this.pointerWidth(),n=this.pointerHeight(),s=this.pointerDirection(),a=this.width(),o=this.height();return s===Ka?(e-=n,o+=n):s===$a?o+=n:s===Ja?(t-=i*1.5,a+=i):s===qa&&(a+=i*1.5),{x:t,y:e,width:a,height:o}}}vn.Tag=Ki;Ki.prototype.className="Tag";(0,Ch._registerNode)(Ki);ks.Factory.addGetterSetter(Ki,"pointerDirection",N0);ks.Factory.addGetterSetter(Ki,"pointerWidth",0,(0,Co.getNumberValidator)());ks.Factory.addGetterSetter(Ki,"pointerHeight",0,(0,Co.getNumberValidator)());ks.Factory.addGetterSetter(Ki,"cornerRadius",0,(0,Co.getNumberOrArrayOfNumbersValidator)(4));var ar={};Object.defineProperty(ar,"__esModule",{value:!0});ar.Rect=void 0;const O0=ot,D0=Kt,I0=ct,B0=It,G0=j;let Ps=class extends D0.Shape{_sceneFunc(t){var e=this.cornerRadius(),i=this.width(),n=this.height();t.beginPath(),e?B0.Util.drawRoundedRectPath(t,i,n,e):t.rect(0,0,i,n),t.closePath(),t.fillStrokeShape(this)}};ar.Rect=Ps;Ps.prototype.className="Rect";(0,I0._registerNode)(Ps);O0.Factory.addGetterSetter(Ps,"cornerRadius",0,(0,G0.getNumberOrArrayOfNumbersValidator)(4));var xs={};Object.defineProperty(xs,"__esModule",{value:!0});xs.RegularPolygon=void 0;const Th=ot,U0=Kt,kh=j,V0=ct;class qi extends U0.Shape{_sceneFunc(t){const e=this._getPoints();t.beginPath(),t.moveTo(e[0].x,e[0].y);for(var i=1;i<e.length;i++)t.lineTo(e[i].x,e[i].y);t.closePath(),t.fillStrokeShape(this)}_getPoints(){const t=this.attrs.sides,e=this.attrs.radius||0,i=[];for(var n=0;n<t;n++)i.push({x:e*Math.sin(n*2*Math.PI/t),y:-1*e*Math.cos(n*2*Math.PI/t)});return i}getSelfRect(){const t=this._getPoints();var e=t[0].x,i=t[0].y,n=t[0].x,s=t[0].y;return t.forEach(a=>{e=Math.min(e,a.x),i=Math.max(i,a.x),n=Math.min(n,a.y),s=Math.max(s,a.y)}),{x:e,y:n,width:i-e,height:s-n}}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(t){this.radius(t/2)}setHeight(t){this.radius(t/2)}}xs.RegularPolygon=qi;qi.prototype.className="RegularPolygon";qi.prototype._centroid=!0;qi.prototype._attrsAffectingSize=["radius"];(0,V0._registerNode)(qi);Th.Factory.addGetterSetter(qi,"radius",0,(0,kh.getNumberValidator)());Th.Factory.addGetterSetter(qi,"sides",0,(0,kh.getNumberValidator)());var Es={};Object.defineProperty(Es,"__esModule",{value:!0});Es.Ring=void 0;const Ph=ot,z0=Kt,xh=j,H0=ct;var _l=Math.PI*2;class $i extends z0.Shape{_sceneFunc(t){t.beginPath(),t.arc(0,0,this.innerRadius(),0,_l,!1),t.moveTo(this.outerRadius(),0),t.arc(0,0,this.outerRadius(),_l,0,!0),t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(t){this.outerRadius(t/2)}setHeight(t){this.outerRadius(t/2)}}Es.Ring=$i;$i.prototype.className="Ring";$i.prototype._centroid=!0;$i.prototype._attrsAffectingSize=["innerRadius","outerRadius"];(0,H0._registerNode)($i);Ph.Factory.addGetterSetter($i,"innerRadius",0,(0,xh.getNumberValidator)());Ph.Factory.addGetterSetter($i,"outerRadius",0,(0,xh.getNumberValidator)());var Ms={};Object.defineProperty(Ms,"__esModule",{value:!0});Ms.Sprite=void 0;const Ji=ot,W0=Kt,j0=Pn,Eh=j,X0=ct;class Oe extends W0.Shape{constructor(t){super(t),this._updated=!0,this.anim=new j0.Animation(()=>{var e=this._updated;return this._updated=!1,e}),this.on("animationChange.konva",function(){this.frameIndex(0)}),this.on("frameIndexChange.konva",function(){this._updated=!0}),this.on("frameRateChange.konva",function(){this.anim.isRunning()&&(clearInterval(this.interval),this._setInterval())})}_sceneFunc(t){var e=this.animation(),i=this.frameIndex(),n=i*4,s=this.animations()[e],a=this.frameOffsets(),o=s[n+0],l=s[n+1],c=s[n+2],h=s[n+3],f=this.image();if((this.hasFill()||this.hasStroke())&&(t.beginPath(),t.rect(0,0,c,h),t.closePath(),t.fillStrokeShape(this)),f)if(a){var d=a[e],g=i*2;t.drawImage(f,o,l,c,h,d[g+0],d[g+1],c,h)}else t.drawImage(f,o,l,c,h,0,0,c,h)}_hitFunc(t){var e=this.animation(),i=this.frameIndex(),n=i*4,s=this.animations()[e],a=this.frameOffsets(),o=s[n+2],l=s[n+3];if(t.beginPath(),a){var c=a[e],h=i*2;t.rect(c[h+0],c[h+1],o,l)}else t.rect(0,0,o,l);t.closePath(),t.fillShape(this)}_useBufferCanvas(){return super._useBufferCanvas(!0)}_setInterval(){var t=this;this.interval=setInterval(function(){t._updateIndex()},1e3/this.frameRate())}start(){if(!this.isRunning()){var t=this.getLayer();this.anim.setLayers(t),this._setInterval(),this.anim.start()}}stop(){this.anim.stop(),clearInterval(this.interval)}isRunning(){return this.anim.isRunning()}_updateIndex(){var t=this.frameIndex(),e=this.animation(),i=this.animations(),n=i[e],s=n.length/4;t<s-1?this.frameIndex(t+1):this.frameIndex(0)}}Ms.Sprite=Oe;Oe.prototype.className="Sprite";(0,X0._registerNode)(Oe);Ji.Factory.addGetterSetter(Oe,"animation");Ji.Factory.addGetterSetter(Oe,"animations");Ji.Factory.addGetterSetter(Oe,"frameOffsets");Ji.Factory.addGetterSetter(Oe,"image");Ji.Factory.addGetterSetter(Oe,"frameIndex",0,(0,Eh.getNumberValidator)());Ji.Factory.addGetterSetter(Oe,"frameRate",17,(0,Eh.getNumberValidator)());Ji.Factory.backCompat(Oe,{index:"frameIndex",getIndex:"getFrameIndex",setIndex:"setFrameIndex"});var Fs={};Object.defineProperty(Fs,"__esModule",{value:!0});Fs.Star=void 0;const To=ot,Y0=Kt,ko=j,K0=ct;class Ai extends Y0.Shape{_sceneFunc(t){var e=this.innerRadius(),i=this.outerRadius(),n=this.numPoints();t.beginPath(),t.moveTo(0,0-i);for(var s=1;s<n*2;s++){var a=s%2===0?i:e,o=a*Math.sin(s*Math.PI/n),l=-1*a*Math.cos(s*Math.PI/n);t.lineTo(o,l)}t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(t){this.outerRadius(t/2)}setHeight(t){this.outerRadius(t/2)}}Fs.Star=Ai;Ai.prototype.className="Star";Ai.prototype._centroid=!0;Ai.prototype._attrsAffectingSize=["innerRadius","outerRadius"];(0,K0._registerNode)(Ai);To.Factory.addGetterSetter(Ai,"numPoints",5,(0,ko.getNumberValidator)());To.Factory.addGetterSetter(Ai,"innerRadius",0,(0,ko.getNumberValidator)());To.Factory.addGetterSetter(Ai,"outerRadius",0,(0,ko.getNumberValidator)());var Ui={};Object.defineProperty(Ui,"__esModule",{value:!0});Ui.Text=Ui.stringToArray=void 0;const Qa=It,Qt=ot,q0=Kt,Ti=j,$0=ct;function Mh(r){return Array.from(r)}Ui.stringToArray=Mh;var en="auto",J0="center",Fh="inherit",Rn="justify",Q0="Change.konva",Z0="2d",vl="-",Rh="left",t1="text",e1="Text",i1="top",n1="bottom",yl="middle",Nh="normal",r1="px ",dr=" ",s1="right",bl="rtl",a1="word",o1="char",wl="none",da="…",Lh=["direction","fontFamily","fontSize","fontStyle","fontVariant","padding","align","verticalAlign","lineHeight","text","width","height","wrap","ellipsis","letterSpacing"],l1=Lh.length;function c1(r){return r.split(",").map(t=>{t=t.trim();const e=t.indexOf(" ")>=0,i=t.indexOf('"')>=0||t.indexOf("'")>=0;return e&&!i&&(t=`"${t}"`),t}).join(", ")}var gr;function ga(){return gr||(gr=Qa.Util.createCanvasElement().getContext(Z0),gr)}function h1(r){r.fillText(this._partialText,this._partialTextX,this._partialTextY)}function f1(r){r.setAttr("miterLimit",2),r.strokeText(this._partialText,this._partialTextX,this._partialTextY)}function u1(r){return r=r||{},!r.fillLinearGradientColorStops&&!r.fillRadialGradientColorStops&&!r.fillPatternImage&&(r.fill=r.fill||"black"),r}class Ut extends q0.Shape{constructor(t){super(u1(t)),this._partialTextX=0,this._partialTextY=0;for(var e=0;e<l1;e++)this.on(Lh[e]+Q0,this._setTextData);this._setTextData()}_sceneFunc(t){var e=this.textArr,i=e.length;if(this.text()){var n=this.padding(),s=this.fontSize(),a=this.lineHeight()*s,o=this.verticalAlign(),l=this.direction(),c=0,h=this.align(),f=this.getWidth(),d=this.letterSpacing(),g=this.fill(),p=this.textDecoration(),v=p.indexOf("underline")!==-1,b=p.indexOf("line-through")!==-1,_;l=l===Fh?t.direction:l;var w=0,w=a/2,u=0,m=0;for(l===bl&&t.setAttr("direction",l),t.setAttr("font",this._getContextFont()),t.setAttr("textBaseline",yl),t.setAttr("textAlign",Rh),o===yl?c=(this.getHeight()-i*a-n*2)/2:o===n1&&(c=this.getHeight()-i*a-n*2),t.translate(n,c+n),_=0;_<i;_++){var u=0,m=0,y=e[_],S=y.text,T=y.width,C=y.lastInParagraph,A,k,P;if(t.save(),h===s1?u+=f-T-n*2:h===J0&&(u+=(f-T-n*2)/2),v){t.save(),t.beginPath(),t.moveTo(u,w+m+Math.round(s/2)),A=S.split(" ").length-1,k=A===0,P=h===Rn&&!C?f-n*2:T,t.lineTo(u+Math.round(P),w+m+Math.round(s/2)),t.lineWidth=s/15;const V=this._getLinearGradient();t.strokeStyle=V||g,t.stroke(),t.restore()}if(b){t.save(),t.beginPath(),t.moveTo(u,w+m),A=S.split(" ").length-1,k=A===0,P=h===Rn&&C&&!k?f-n*2:T,t.lineTo(u+Math.round(P),w+m),t.lineWidth=s/15;const V=this._getLinearGradient();t.strokeStyle=V||g,t.stroke(),t.restore()}if(l!==bl&&(d!==0||h===Rn)){A=S.split(" ").length-1;for(var x=Mh(S),M=0;M<x.length;M++){var F=x[M];F===" "&&!C&&h===Rn&&(u+=(f-n*2-T)/A),this._partialTextX=u,this._partialTextY=w+m,this._partialText=F,t.fillStrokeShape(this),u+=this.measureSize(F).width+d}}else d!==0&&t.setAttr("letterSpacing",`${d}px`),this._partialTextX=u,this._partialTextY=w+m,this._partialText=S,t.fillStrokeShape(this);t.restore(),i>1&&(w+=a)}}}_hitFunc(t){var e=this.getWidth(),i=this.getHeight();t.beginPath(),t.rect(0,0,e,i),t.closePath(),t.fillStrokeShape(this)}setText(t){var e=Qa.Util._isString(t)?t:t==null?"":t+"";return this._setAttr(t1,e),this}getWidth(){var t=this.attrs.width===en||this.attrs.width===void 0;return t?this.getTextWidth()+this.padding()*2:this.attrs.width}getHeight(){var t=this.attrs.height===en||this.attrs.height===void 0;return t?this.fontSize()*this.textArr.length*this.lineHeight()+this.padding()*2:this.attrs.height}getTextWidth(){return this.textWidth}getTextHeight(){return Qa.Util.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}measureSize(t){var e=ga(),i=this.fontSize(),n;return e.save(),e.font=this._getContextFont(),n=e.measureText(t),e.restore(),{width:n.width,height:i}}_getContextFont(){return this.fontStyle()+dr+this.fontVariant()+dr+(this.fontSize()+r1)+c1(this.fontFamily())}_addTextLine(t){this.align()===Rn&&(t=t.trim());var i=this._getTextWidth(t);return this.textArr.push({text:t,width:i,lastInParagraph:!1})}_getTextWidth(t){var e=this.letterSpacing(),i=t.length;return ga().measureText(t).width+(i?e*(i-1):0)}_setTextData(){var t=this.text().split(`
`),e=+this.fontSize(),i=0,n=this.lineHeight()*e,s=this.attrs.width,a=this.attrs.height,o=s!==en&&s!==void 0,l=a!==en&&a!==void 0,c=this.padding(),h=s-c*2,f=a-c*2,d=0,g=this.wrap(),p=g!==wl,v=g!==o1&&p,b=this.ellipsis();this.textArr=[],ga().font=this._getContextFont();for(var _=b?this._getTextWidth(da):0,w=0,u=t.length;w<u;++w){var m=t[w],y=this._getTextWidth(m);if(o&&y>h)for(;m.length>0;){for(var S=0,T=m.length,C="",A=0;S<T;){var k=S+T>>>1,P=m.slice(0,k+1),x=this._getTextWidth(P)+_;x<=h?(S=k+1,C=P,A=x):T=k}if(C){if(v){var M,F=m[C.length],N=F===dr||F===vl;N&&A<=h?M=C.length:M=Math.max(C.lastIndexOf(dr),C.lastIndexOf(vl))+1,M>0&&(S=M,C=C.slice(0,S),A=this._getTextWidth(C))}C=C.trimRight(),this._addTextLine(C),i=Math.max(i,A),d+=n;var I=this._shouldHandleEllipsis(d);if(I){this._tryToAddEllipsisToLastLine();break}if(m=m.slice(S),m=m.trimLeft(),m.length>0&&(y=this._getTextWidth(m),y<=h)){this._addTextLine(m),d+=n,i=Math.max(i,y);break}}else break}else this._addTextLine(m),d+=n,i=Math.max(i,y),this._shouldHandleEllipsis(d)&&w<u-1&&this._tryToAddEllipsisToLastLine();if(this.textArr[this.textArr.length-1]&&(this.textArr[this.textArr.length-1].lastInParagraph=!0),l&&d+n>f)break}this.textHeight=e,this.textWidth=i}_shouldHandleEllipsis(t){var e=+this.fontSize(),i=this.lineHeight()*e,n=this.attrs.height,s=n!==en&&n!==void 0,a=this.padding(),o=n-a*2,l=this.wrap(),c=l!==wl;return!c||s&&t+i>o}_tryToAddEllipsisToLastLine(){var t=this.attrs.width,e=t!==en&&t!==void 0,i=this.padding(),n=t-i*2,s=this.ellipsis(),a=this.textArr[this.textArr.length-1];if(!(!a||!s)){if(e){var o=this._getTextWidth(a.text+da)<n;o||(a.text=a.text.slice(0,a.text.length-3))}this.textArr.splice(this.textArr.length-1,1),this._addTextLine(a.text+da)}}getStrokeScaleEnabled(){return!0}_useBufferCanvas(){const t=this.textDecoration().indexOf("underline")!==-1||this.textDecoration().indexOf("line-through")!==-1,e=this.hasShadow();return t&&e?!0:super._useBufferCanvas()}}Ui.Text=Ut;Ut.prototype._fillFunc=h1;Ut.prototype._strokeFunc=f1;Ut.prototype.className=e1;Ut.prototype._attrsAffectingSize=["text","fontSize","padding","wrap","lineHeight","letterSpacing"];(0,$0._registerNode)(Ut);Qt.Factory.overWriteSetter(Ut,"width",(0,Ti.getNumberOrAutoValidator)());Qt.Factory.overWriteSetter(Ut,"height",(0,Ti.getNumberOrAutoValidator)());Qt.Factory.addGetterSetter(Ut,"direction",Fh);Qt.Factory.addGetterSetter(Ut,"fontFamily","Arial");Qt.Factory.addGetterSetter(Ut,"fontSize",12,(0,Ti.getNumberValidator)());Qt.Factory.addGetterSetter(Ut,"fontStyle",Nh);Qt.Factory.addGetterSetter(Ut,"fontVariant",Nh);Qt.Factory.addGetterSetter(Ut,"padding",0,(0,Ti.getNumberValidator)());Qt.Factory.addGetterSetter(Ut,"align",Rh);Qt.Factory.addGetterSetter(Ut,"verticalAlign",i1);Qt.Factory.addGetterSetter(Ut,"lineHeight",1,(0,Ti.getNumberValidator)());Qt.Factory.addGetterSetter(Ut,"wrap",a1);Qt.Factory.addGetterSetter(Ut,"ellipsis",!1,(0,Ti.getBooleanValidator)());Qt.Factory.addGetterSetter(Ut,"letterSpacing",0,(0,Ti.getNumberValidator)());Qt.Factory.addGetterSetter(Ut,"text","",(0,Ti.getStringValidator)());Qt.Factory.addGetterSetter(Ut,"textDecoration","");var Rs={};Object.defineProperty(Rs,"__esModule",{value:!0});Rs.TextPath=void 0;const pa=It,xe=ot,d1=Kt,Nn=xn,ma=Ui,Oh=j,g1=ct;var p1="",Dh="normal";function Ih(r){r.fillText(this.partialText,0,0)}function Bh(r){r.strokeText(this.partialText,0,0)}class qt extends d1.Shape{constructor(t){super(t),this.dummyCanvas=pa.Util.createCanvasElement(),this.dataArray=[],this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute(),this._setTextData()}),this.on("textChange.konva alignChange.konva letterSpacingChange.konva kerningFuncChange.konva fontSizeChange.konva fontFamilyChange.konva",this._setTextData),this._setTextData()}_getTextPathLength(){return Nn.Path.getPathLength(this.dataArray)}_getPointAtLength(t){if(!this.attrs.data)return null;const e=this.pathLength;return t-1>e?null:Nn.Path.getPointAtLengthOfDataArray(t,this.dataArray)}_readDataAttribute(){this.dataArray=Nn.Path.parsePathData(this.attrs.data),this.pathLength=this._getTextPathLength()}_sceneFunc(t){t.setAttr("font",this._getContextFont()),t.setAttr("textBaseline",this.textBaseline()),t.setAttr("textAlign","left"),t.save();var e=this.textDecoration(),i=this.fill(),n=this.fontSize(),s=this.glyphInfo;e==="underline"&&t.beginPath();for(var a=0;a<s.length;a++){t.save();var o=s[a].p0;t.translate(o.x,o.y),t.rotate(s[a].rotation),this.partialText=s[a].text,t.fillStrokeShape(this),e==="underline"&&(a===0&&t.moveTo(0,n/2+1),t.lineTo(n,n/2+1)),t.restore()}e==="underline"&&(t.strokeStyle=i,t.lineWidth=n/20,t.stroke()),t.restore()}_hitFunc(t){t.beginPath();var e=this.glyphInfo;if(e.length>=1){var i=e[0].p0;t.moveTo(i.x,i.y)}for(var n=0;n<e.length;n++){var s=e[n].p1;t.lineTo(s.x,s.y)}t.setAttr("lineWidth",this.fontSize()),t.setAttr("strokeStyle",this.colorKey),t.stroke()}getTextWidth(){return this.textWidth}getTextHeight(){return pa.Util.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}setText(t){return ma.Text.prototype.setText.call(this,t)}_getContextFont(){return ma.Text.prototype._getContextFont.call(this)}_getTextSize(t){var e=this.dummyCanvas,i=e.getContext("2d");i.save(),i.font=this._getContextFont();var n=i.measureText(t);return i.restore(),{width:n.width,height:parseInt(`${this.fontSize()}`,10)}}_setTextData(){const{width:t,height:e}=this._getTextSize(this.attrs.text);if(this.textWidth=t,this.textHeight=e,this.glyphInfo=[],!this.attrs.data)return null;const i=this.letterSpacing(),n=this.align(),s=this.kerningFunc(),a=Math.max(this.textWidth+((this.attrs.text||"").length-1)*i,0);let o=0;n==="center"&&(o=Math.max(0,this.pathLength/2-a/2)),n==="right"&&(o=Math.max(0,this.pathLength-a));const l=(0,ma.stringToArray)(this.text());let c=o;for(var h=0;h<l.length;h++){const f=this._getPointAtLength(c);if(!f)return;let d=this._getTextSize(l[h]).width+i;if(l[h]===" "&&n==="justify"){const w=this.text().split(" ").length-1;d+=(this.pathLength-a)/w}const g=this._getPointAtLength(c+d);if(!g)return;const p=Nn.Path.getLineLength(f.x,f.y,g.x,g.y);let v=0;if(s)try{v=s(l[h-1],l[h])*this.fontSize()}catch{v=0}f.x+=v,g.x+=v,this.textWidth+=v;const b=Nn.Path.getPointOnLine(v+p/2,f.x,f.y,g.x,g.y),_=Math.atan2(g.y-f.y,g.x-f.x);this.glyphInfo.push({transposeX:b.x,transposeY:b.y,text:l[h],rotation:_,p0:f,p1:g}),c+=d}}getSelfRect(){if(!this.glyphInfo.length)return{x:0,y:0,width:0,height:0};var t=[];this.glyphInfo.forEach(function(h){t.push(h.p0.x),t.push(h.p0.y),t.push(h.p1.x),t.push(h.p1.y)});for(var e=t[0]||0,i=t[0]||0,n=t[1]||0,s=t[1]||0,a,o,l=0;l<t.length/2;l++)a=t[l*2],o=t[l*2+1],e=Math.min(e,a),i=Math.max(i,a),n=Math.min(n,o),s=Math.max(s,o);var c=this.fontSize();return{x:e-c/2,y:n-c/2,width:i-e+c,height:s-n+c}}destroy(){return pa.Util.releaseCanvas(this.dummyCanvas),super.destroy()}}Rs.TextPath=qt;qt.prototype._fillFunc=Ih;qt.prototype._strokeFunc=Bh;qt.prototype._fillFuncHit=Ih;qt.prototype._strokeFuncHit=Bh;qt.prototype.className="TextPath";qt.prototype._attrsAffectingSize=["text","fontSize","data"];(0,g1._registerNode)(qt);xe.Factory.addGetterSetter(qt,"data");xe.Factory.addGetterSetter(qt,"fontFamily","Arial");xe.Factory.addGetterSetter(qt,"fontSize",12,(0,Oh.getNumberValidator)());xe.Factory.addGetterSetter(qt,"fontStyle",Dh);xe.Factory.addGetterSetter(qt,"align","left");xe.Factory.addGetterSetter(qt,"letterSpacing",0,(0,Oh.getNumberValidator)());xe.Factory.addGetterSetter(qt,"textBaseline","middle");xe.Factory.addGetterSetter(qt,"fontVariant",Dh);xe.Factory.addGetterSetter(qt,"text",p1);xe.Factory.addGetterSetter(qt,"textDecoration",null);xe.Factory.addGetterSetter(qt,"kerningFunc",null);var Ns={};Object.defineProperty(Ns,"__esModule",{value:!0});Ns.Transformer=void 0;const kt=It,wt=ot,Sl=Ot,m1=Kt,_1=ar,Cl=kn,Ce=ct,ki=j,v1=ct;var Gh="tr-konva",y1=["resizeEnabledChange","rotateAnchorOffsetChange","rotateEnabledChange","enabledAnchorsChange","anchorSizeChange","borderEnabledChange","borderStrokeChange","borderStrokeWidthChange","borderDashChange","anchorStrokeChange","anchorStrokeWidthChange","anchorFillChange","anchorCornerRadiusChange","ignoreStrokeChange","anchorStyleFuncChange"].map(r=>r+`.${Gh}`).join(" "),Al="nodesRect",b1=["widthChange","heightChange","scaleXChange","scaleYChange","skewXChange","skewYChange","rotationChange","offsetXChange","offsetYChange","transformsEnabledChange","strokeWidthChange"],w1={"top-left":-45,"top-center":0,"top-right":45,"middle-right":-90,"middle-left":90,"bottom-left":-135,"bottom-center":180,"bottom-right":135};const S1="ontouchstart"in Ce.Konva._global;function C1(r,t,e){if(r==="rotater")return e;t+=kt.Util.degToRad(w1[r]||0);var i=(kt.Util.radToDeg(t)%360+360)%360;return kt.Util._inRange(i,315+22.5,360)||kt.Util._inRange(i,0,22.5)?"ns-resize":kt.Util._inRange(i,45-22.5,45+22.5)?"nesw-resize":kt.Util._inRange(i,90-22.5,90+22.5)?"ew-resize":kt.Util._inRange(i,135-22.5,135+22.5)?"nwse-resize":kt.Util._inRange(i,180-22.5,180+22.5)?"ns-resize":kt.Util._inRange(i,225-22.5,225+22.5)?"nesw-resize":kt.Util._inRange(i,270-22.5,270+22.5)?"ew-resize":kt.Util._inRange(i,315-22.5,315+22.5)?"nwse-resize":(kt.Util.error("Transformer has unknown angle for cursor detection: "+i),"pointer")}var Jr=["top-left","top-center","top-right","middle-right","middle-left","bottom-left","bottom-center","bottom-right"],Tl=1e8;function A1(r){return{x:r.x+r.width/2*Math.cos(r.rotation)+r.height/2*Math.sin(-r.rotation),y:r.y+r.height/2*Math.cos(r.rotation)+r.width/2*Math.sin(r.rotation)}}function Uh(r,t,e){const i=e.x+(r.x-e.x)*Math.cos(t)-(r.y-e.y)*Math.sin(t),n=e.y+(r.x-e.x)*Math.sin(t)+(r.y-e.y)*Math.cos(t);return{...r,rotation:r.rotation+t,x:i,y:n}}function T1(r,t){const e=A1(r);return Uh(r,t,e)}function k1(r,t,e){let i=t;for(let n=0;n<r.length;n++){const s=Ce.Konva.getAngle(r[n]),a=Math.abs(s-t)%(Math.PI*2);Math.min(a,Math.PI*2-a)<e&&(i=s)}return i}class dt extends Cl.Group{constructor(t){super(t),this._movingAnchorName=null,this._transforming=!1,this._createElements(),this._handleMouseMove=this._handleMouseMove.bind(this),this._handleMouseUp=this._handleMouseUp.bind(this),this.update=this.update.bind(this),this.on(y1,this.update),this.getNode()&&this.update()}attachTo(t){return this.setNode(t),this}setNode(t){return kt.Util.warn("tr.setNode(shape), tr.node(shape) and tr.attachTo(shape) methods are deprecated. Please use tr.nodes(nodesArray) instead."),this.setNodes([t])}getNode(){return this._nodes&&this._nodes[0]}_getEventNamespace(){return Gh+this._id}setNodes(t=[]){this._nodes&&this._nodes.length&&this.detach();const e=t.filter(n=>n.isAncestorOf(this)?(kt.Util.error("Konva.Transformer cannot be an a child of the node you are trying to attach"),!1):!0);this._nodes=t=e,t.length===1&&this.useSingleNodeRotation()?this.rotation(t[0].getAbsoluteRotation()):this.rotation(0),this._nodes.forEach(n=>{const s=()=>{this.nodes().length===1&&this.useSingleNodeRotation()&&this.rotation(this.nodes()[0].getAbsoluteRotation()),this._resetTransformCache(),!this._transforming&&!this.isDragging()&&this.update()},a=n._attrsAffectingSize.map(o=>o+"Change."+this._getEventNamespace()).join(" ");n.on(a,s),n.on(b1.map(o=>o+`.${this._getEventNamespace()}`).join(" "),s),n.on(`absoluteTransformChange.${this._getEventNamespace()}`,s),this._proxyDrag(n)}),this._resetTransformCache();var i=!!this.findOne(".top-left");return i&&this.update(),this}_proxyDrag(t){let e;t.on(`dragstart.${this._getEventNamespace()}`,i=>{e=t.getAbsolutePosition(),!this.isDragging()&&t!==this.findOne(".back")&&this.startDrag(i,!1)}),t.on(`dragmove.${this._getEventNamespace()}`,i=>{if(!e)return;const n=t.getAbsolutePosition(),s=n.x-e.x,a=n.y-e.y;this.nodes().forEach(o=>{if(o===t||o.isDragging())return;const l=o.getAbsolutePosition();o.setAbsolutePosition({x:l.x+s,y:l.y+a}),o.startDrag(i)}),e=null})}getNodes(){return this._nodes||[]}getActiveAnchor(){return this._movingAnchorName}detach(){this._nodes&&this._nodes.forEach(t=>{t.off("."+this._getEventNamespace())}),this._nodes=[],this._resetTransformCache()}_resetTransformCache(){this._clearCache(Al),this._clearCache("transform"),this._clearSelfAndDescendantCache("absoluteTransform")}_getNodeRect(){return this._getCache(Al,this.__getNodeRect)}__getNodeShape(t,e=this.rotation(),i){var n=t.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),s=t.getAbsoluteScale(i),a=t.getAbsolutePosition(i),o=n.x*s.x-t.offsetX()*s.x,l=n.y*s.y-t.offsetY()*s.y;const c=(Ce.Konva.getAngle(t.getAbsoluteRotation())+Math.PI*2)%(Math.PI*2),h={x:a.x+o*Math.cos(c)+l*Math.sin(-c),y:a.y+l*Math.cos(c)+o*Math.sin(c),width:n.width*s.x,height:n.height*s.y,rotation:c};return Uh(h,-Ce.Konva.getAngle(e),{x:0,y:0})}__getNodeRect(){var t=this.getNode();if(!t)return{x:-Tl,y:-Tl,width:0,height:0,rotation:0};const e=[];this.nodes().map(c=>{const h=c.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()});var f=[{x:h.x,y:h.y},{x:h.x+h.width,y:h.y},{x:h.x+h.width,y:h.y+h.height},{x:h.x,y:h.y+h.height}],d=c.getAbsoluteTransform();f.forEach(function(g){var p=d.point(g);e.push(p)})});const i=new kt.Transform;i.rotate(-Ce.Konva.getAngle(this.rotation()));var n=1/0,s=1/0,a=-1/0,o=-1/0;e.forEach(function(c){var h=i.point(c);n===void 0&&(n=a=h.x,s=o=h.y),n=Math.min(n,h.x),s=Math.min(s,h.y),a=Math.max(a,h.x),o=Math.max(o,h.y)}),i.invert();const l=i.point({x:n,y:s});return{x:l.x,y:l.y,width:a-n,height:o-s,rotation:Ce.Konva.getAngle(this.rotation())}}getX(){return this._getNodeRect().x}getY(){return this._getNodeRect().y}getWidth(){return this._getNodeRect().width}getHeight(){return this._getNodeRect().height}_createElements(){this._createBack(),Jr.forEach(t=>{this._createAnchor(t)}),this._createAnchor("rotater")}_createAnchor(t){var e=new _1.Rect({stroke:"rgb(0, 161, 255)",fill:"white",strokeWidth:1,name:t+" _anchor",dragDistance:0,draggable:!0,hitStrokeWidth:S1?10:"auto"}),i=this;e.on("mousedown touchstart",function(n){i._handleMouseDown(n)}),e.on("dragstart",n=>{e.stopDrag(),n.cancelBubble=!0}),e.on("dragend",n=>{n.cancelBubble=!0}),e.on("mouseenter",()=>{var n=Ce.Konva.getAngle(this.rotation()),s=this.rotateAnchorCursor(),a=C1(t,n,s);e.getStage().content&&(e.getStage().content.style.cursor=a),this._cursorChange=!0}),e.on("mouseout",()=>{e.getStage().content&&(e.getStage().content.style.cursor=""),this._cursorChange=!1}),this.add(e)}_createBack(){var t=new m1.Shape({name:"back",width:0,height:0,draggable:!0,sceneFunc(e,i){var n=i.getParent(),s=n.padding();e.beginPath(),e.rect(-s,-s,i.width()+s*2,i.height()+s*2),e.moveTo(i.width()/2,-s),n.rotateEnabled()&&n.rotateLineVisible()&&e.lineTo(i.width()/2,-n.rotateAnchorOffset()*kt.Util._sign(i.height())-s),e.fillStrokeShape(i)},hitFunc:(e,i)=>{if(this.shouldOverdrawWholeArea()){var n=this.padding();e.beginPath(),e.rect(-n,-n,i.width()+n*2,i.height()+n*2),e.fillStrokeShape(i)}}});this.add(t),this._proxyDrag(t),t.on("dragstart",e=>{e.cancelBubble=!0}),t.on("dragmove",e=>{e.cancelBubble=!0}),t.on("dragend",e=>{e.cancelBubble=!0}),this.on("dragmove",e=>{this.update()})}_handleMouseDown(t){this._movingAnchorName=t.target.name().split(" ")[0];var e=this._getNodeRect(),i=e.width,n=e.height,s=Math.sqrt(Math.pow(i,2)+Math.pow(n,2));this.sin=Math.abs(n/s),this.cos=Math.abs(i/s),typeof window<"u"&&(window.addEventListener("mousemove",this._handleMouseMove),window.addEventListener("touchmove",this._handleMouseMove),window.addEventListener("mouseup",this._handleMouseUp,!0),window.addEventListener("touchend",this._handleMouseUp,!0)),this._transforming=!0;var a=t.target.getAbsolutePosition(),o=t.target.getStage().getPointerPosition();this._anchorDragOffset={x:o.x-a.x,y:o.y-a.y},this._fire("transformstart",{evt:t.evt,target:this.getNode()}),this._nodes.forEach(l=>{l._fire("transformstart",{evt:t.evt,target:l})})}_handleMouseMove(t){var e,i,n,s=this.findOne("."+this._movingAnchorName),a=s.getStage();a.setPointersPositions(t);const o=a.getPointerPosition();let l={x:o.x-this._anchorDragOffset.x,y:o.y-this._anchorDragOffset.y};const c=s.getAbsolutePosition();this.anchorDragBoundFunc()&&(l=this.anchorDragBoundFunc()(c,l,t)),s.setAbsolutePosition(l);const h=s.getAbsolutePosition();if(!(c.x===h.x&&c.y===h.y)){if(this._movingAnchorName==="rotater"){var f=this._getNodeRect();e=s.x()-f.width/2,i=-s.y()+f.height/2;let M=Math.atan2(-i,e)+Math.PI/2;f.height<0&&(M-=Math.PI);var d=Ce.Konva.getAngle(this.rotation());const F=d+M,N=Ce.Konva.getAngle(this.rotationSnapTolerance()),V=k1(this.rotationSnaps(),F,N)-f.rotation,Z=T1(f,V);this._fitNodesInto(Z,t);return}var g=this.shiftBehavior(),p;g==="inverted"?p=this.keepRatio()&&!t.shiftKey:g==="none"?p=this.keepRatio():p=this.keepRatio()||t.shiftKey;var u=this.centeredScaling()||t.altKey;if(this._movingAnchorName==="top-left"){if(p){var v=u?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-right").x(),y:this.findOne(".bottom-right").y()};n=Math.sqrt(Math.pow(v.x-s.x(),2)+Math.pow(v.y-s.y(),2));var b=this.findOne(".top-left").x()>v.x?-1:1,_=this.findOne(".top-left").y()>v.y?-1:1;e=n*this.cos*b,i=n*this.sin*_,this.findOne(".top-left").x(v.x-e),this.findOne(".top-left").y(v.y-i)}}else if(this._movingAnchorName==="top-center")this.findOne(".top-left").y(s.y());else if(this._movingAnchorName==="top-right"){if(p){var v=u?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-left").x(),y:this.findOne(".bottom-left").y()};n=Math.sqrt(Math.pow(s.x()-v.x,2)+Math.pow(v.y-s.y(),2));var b=this.findOne(".top-right").x()<v.x?-1:1,_=this.findOne(".top-right").y()>v.y?-1:1;e=n*this.cos*b,i=n*this.sin*_,this.findOne(".top-right").x(v.x+e),this.findOne(".top-right").y(v.y-i)}var w=s.position();this.findOne(".top-left").y(w.y),this.findOne(".bottom-right").x(w.x)}else if(this._movingAnchorName==="middle-left")this.findOne(".top-left").x(s.x());else if(this._movingAnchorName==="middle-right")this.findOne(".bottom-right").x(s.x());else if(this._movingAnchorName==="bottom-left"){if(p){var v=u?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-right").x(),y:this.findOne(".top-right").y()};n=Math.sqrt(Math.pow(v.x-s.x(),2)+Math.pow(s.y()-v.y,2));var b=v.x<s.x()?-1:1,_=s.y()<v.y?-1:1;e=n*this.cos*b,i=n*this.sin*_,s.x(v.x-e),s.y(v.y+i)}w=s.position(),this.findOne(".top-left").x(w.x),this.findOne(".bottom-right").y(w.y)}else if(this._movingAnchorName==="bottom-center")this.findOne(".bottom-right").y(s.y());else if(this._movingAnchorName==="bottom-right"){if(p){var v=u?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-left").x(),y:this.findOne(".top-left").y()};n=Math.sqrt(Math.pow(s.x()-v.x,2)+Math.pow(s.y()-v.y,2));var b=this.findOne(".bottom-right").x()<v.x?-1:1,_=this.findOne(".bottom-right").y()<v.y?-1:1;e=n*this.cos*b,i=n*this.sin*_,this.findOne(".bottom-right").x(v.x+e),this.findOne(".bottom-right").y(v.y+i)}}else console.error(new Error("Wrong position argument of selection resizer: "+this._movingAnchorName));var u=this.centeredScaling()||t.altKey;if(u){var m=this.findOne(".top-left"),y=this.findOne(".bottom-right"),S=m.x(),T=m.y(),C=this.getWidth()-y.x(),A=this.getHeight()-y.y();y.move({x:-S,y:-T}),m.move({x:C,y:A})}var k=this.findOne(".top-left").getAbsolutePosition();e=k.x,i=k.y;var P=this.findOne(".bottom-right").x()-this.findOne(".top-left").x(),x=this.findOne(".bottom-right").y()-this.findOne(".top-left").y();this._fitNodesInto({x:e,y:i,width:P,height:x,rotation:Ce.Konva.getAngle(this.rotation())},t)}}_handleMouseUp(t){this._removeEvents(t)}getAbsoluteTransform(){return this.getTransform()}_removeEvents(t){if(this._transforming){this._transforming=!1,typeof window<"u"&&(window.removeEventListener("mousemove",this._handleMouseMove),window.removeEventListener("touchmove",this._handleMouseMove),window.removeEventListener("mouseup",this._handleMouseUp,!0),window.removeEventListener("touchend",this._handleMouseUp,!0));var e=this.getNode();this._fire("transformend",{evt:t,target:e}),e&&this._nodes.forEach(i=>{i._fire("transformend",{evt:t,target:i})}),this._movingAnchorName=null}}_fitNodesInto(t,e){var i=this._getNodeRect();const n=1;if(kt.Util._inRange(t.width,-this.padding()*2-n,n)){this.update();return}if(kt.Util._inRange(t.height,-this.padding()*2-n,n)){this.update();return}var s=new kt.Transform;if(s.rotate(Ce.Konva.getAngle(this.rotation())),this._movingAnchorName&&t.width<0&&this._movingAnchorName.indexOf("left")>=0){const d=s.point({x:-this.padding()*2,y:0});t.x+=d.x,t.y+=d.y,t.width+=this.padding()*2,this._movingAnchorName=this._movingAnchorName.replace("left","right"),this._anchorDragOffset.x-=d.x,this._anchorDragOffset.y-=d.y}else if(this._movingAnchorName&&t.width<0&&this._movingAnchorName.indexOf("right")>=0){const d=s.point({x:this.padding()*2,y:0});this._movingAnchorName=this._movingAnchorName.replace("right","left"),this._anchorDragOffset.x-=d.x,this._anchorDragOffset.y-=d.y,t.width+=this.padding()*2}if(this._movingAnchorName&&t.height<0&&this._movingAnchorName.indexOf("top")>=0){const d=s.point({x:0,y:-this.padding()*2});t.x+=d.x,t.y+=d.y,this._movingAnchorName=this._movingAnchorName.replace("top","bottom"),this._anchorDragOffset.x-=d.x,this._anchorDragOffset.y-=d.y,t.height+=this.padding()*2}else if(this._movingAnchorName&&t.height<0&&this._movingAnchorName.indexOf("bottom")>=0){const d=s.point({x:0,y:this.padding()*2});this._movingAnchorName=this._movingAnchorName.replace("bottom","top"),this._anchorDragOffset.x-=d.x,this._anchorDragOffset.y-=d.y,t.height+=this.padding()*2}if(this.boundBoxFunc()){const d=this.boundBoxFunc()(i,t);d?t=d:kt.Util.warn("boundBoxFunc returned falsy. You should return new bound rect from it!")}const a=1e7,o=new kt.Transform;o.translate(i.x,i.y),o.rotate(i.rotation),o.scale(i.width/a,i.height/a);const l=new kt.Transform,c=t.width/a,h=t.height/a;this.flipEnabled()===!1?(l.translate(t.x,t.y),l.rotate(t.rotation),l.translate(t.width<0?t.width:0,t.height<0?t.height:0),l.scale(Math.abs(c),Math.abs(h))):(l.translate(t.x,t.y),l.rotate(t.rotation),l.scale(c,h));const f=l.multiply(o.invert());this._nodes.forEach(d=>{var g;const p=d.getParent().getAbsoluteTransform(),v=d.getTransform().copy();v.translate(d.offsetX(),d.offsetY());const b=new kt.Transform;b.multiply(p.copy().invert()).multiply(f).multiply(p).multiply(v);const _=b.decompose();d.setAttrs(_),this._fire("transform",{evt:e,target:d}),d._fire("transform",{evt:e,target:d}),(g=d.getLayer())===null||g===void 0||g.batchDraw()}),this.rotation(kt.Util._getRotation(t.rotation)),this._resetTransformCache(),this.update(),this.getLayer().batchDraw()}forceUpdate(){this._resetTransformCache(),this.update()}_batchChangeChild(t,e){this.findOne(t).setAttrs(e)}update(){var t,e=this._getNodeRect();this.rotation(kt.Util._getRotation(e.rotation));var i=e.width,n=e.height,s=this.enabledAnchors(),a=this.resizeEnabled(),o=this.padding(),l=this.anchorSize();const c=this.find("._anchor");c.forEach(f=>{f.setAttrs({width:l,height:l,offsetX:l/2,offsetY:l/2,stroke:this.anchorStroke(),strokeWidth:this.anchorStrokeWidth(),fill:this.anchorFill(),cornerRadius:this.anchorCornerRadius()})}),this._batchChangeChild(".top-left",{x:0,y:0,offsetX:l/2+o,offsetY:l/2+o,visible:a&&s.indexOf("top-left")>=0}),this._batchChangeChild(".top-center",{x:i/2,y:0,offsetY:l/2+o,visible:a&&s.indexOf("top-center")>=0}),this._batchChangeChild(".top-right",{x:i,y:0,offsetX:l/2-o,offsetY:l/2+o,visible:a&&s.indexOf("top-right")>=0}),this._batchChangeChild(".middle-left",{x:0,y:n/2,offsetX:l/2+o,visible:a&&s.indexOf("middle-left")>=0}),this._batchChangeChild(".middle-right",{x:i,y:n/2,offsetX:l/2-o,visible:a&&s.indexOf("middle-right")>=0}),this._batchChangeChild(".bottom-left",{x:0,y:n,offsetX:l/2+o,offsetY:l/2-o,visible:a&&s.indexOf("bottom-left")>=0}),this._batchChangeChild(".bottom-center",{x:i/2,y:n,offsetY:l/2-o,visible:a&&s.indexOf("bottom-center")>=0}),this._batchChangeChild(".bottom-right",{x:i,y:n,offsetX:l/2-o,offsetY:l/2-o,visible:a&&s.indexOf("bottom-right")>=0}),this._batchChangeChild(".rotater",{x:i/2,y:-this.rotateAnchorOffset()*kt.Util._sign(n)-o,visible:this.rotateEnabled()}),this._batchChangeChild(".back",{width:i,height:n,visible:this.borderEnabled(),stroke:this.borderStroke(),strokeWidth:this.borderStrokeWidth(),dash:this.borderDash(),x:0,y:0});const h=this.anchorStyleFunc();h&&c.forEach(f=>{h(f)}),(t=this.getLayer())===null||t===void 0||t.batchDraw()}isTransforming(){return this._transforming}stopTransform(){if(this._transforming){this._removeEvents();var t=this.findOne("."+this._movingAnchorName);t&&t.stopDrag()}}destroy(){return this.getStage()&&this._cursorChange&&this.getStage().content&&(this.getStage().content.style.cursor=""),Cl.Group.prototype.destroy.call(this),this.detach(),this._removeEvents(),this}toObject(){return Sl.Node.prototype.toObject.call(this)}clone(t){var e=Sl.Node.prototype.clone.call(this,t);return e}getClientRect(){return this.nodes().length>0?super.getClientRect():{x:0,y:0,width:0,height:0}}}Ns.Transformer=dt;function P1(r){return r instanceof Array||kt.Util.warn("enabledAnchors value should be an array"),r instanceof Array&&r.forEach(function(t){Jr.indexOf(t)===-1&&kt.Util.warn("Unknown anchor name: "+t+". Available names are: "+Jr.join(", "))}),r||[]}dt.prototype.className="Transformer";(0,v1._registerNode)(dt);wt.Factory.addGetterSetter(dt,"enabledAnchors",Jr,P1);wt.Factory.addGetterSetter(dt,"flipEnabled",!0,(0,ki.getBooleanValidator)());wt.Factory.addGetterSetter(dt,"resizeEnabled",!0);wt.Factory.addGetterSetter(dt,"anchorSize",10,(0,ki.getNumberValidator)());wt.Factory.addGetterSetter(dt,"rotateEnabled",!0);wt.Factory.addGetterSetter(dt,"rotateLineVisible",!0);wt.Factory.addGetterSetter(dt,"rotationSnaps",[]);wt.Factory.addGetterSetter(dt,"rotateAnchorOffset",50,(0,ki.getNumberValidator)());wt.Factory.addGetterSetter(dt,"rotateAnchorCursor","crosshair");wt.Factory.addGetterSetter(dt,"rotationSnapTolerance",5,(0,ki.getNumberValidator)());wt.Factory.addGetterSetter(dt,"borderEnabled",!0);wt.Factory.addGetterSetter(dt,"anchorStroke","rgb(0, 161, 255)");wt.Factory.addGetterSetter(dt,"anchorStrokeWidth",1,(0,ki.getNumberValidator)());wt.Factory.addGetterSetter(dt,"anchorFill","white");wt.Factory.addGetterSetter(dt,"anchorCornerRadius",0,(0,ki.getNumberValidator)());wt.Factory.addGetterSetter(dt,"borderStroke","rgb(0, 161, 255)");wt.Factory.addGetterSetter(dt,"borderStrokeWidth",1,(0,ki.getNumberValidator)());wt.Factory.addGetterSetter(dt,"borderDash");wt.Factory.addGetterSetter(dt,"keepRatio",!0);wt.Factory.addGetterSetter(dt,"shiftBehavior","default");wt.Factory.addGetterSetter(dt,"centeredScaling",!1);wt.Factory.addGetterSetter(dt,"ignoreStroke",!1);wt.Factory.addGetterSetter(dt,"padding",0,(0,ki.getNumberValidator)());wt.Factory.addGetterSetter(dt,"node");wt.Factory.addGetterSetter(dt,"nodes");wt.Factory.addGetterSetter(dt,"boundBoxFunc");wt.Factory.addGetterSetter(dt,"anchorDragBoundFunc");wt.Factory.addGetterSetter(dt,"anchorStyleFunc");wt.Factory.addGetterSetter(dt,"shouldOverdrawWholeArea",!1);wt.Factory.addGetterSetter(dt,"useSingleNodeRotation",!0);wt.Factory.backCompat(dt,{lineEnabled:"borderEnabled",rotateHandlerOffset:"rotateAnchorOffset",enabledHandlers:"enabledAnchors"});var Ls={};Object.defineProperty(Ls,"__esModule",{value:!0});Ls.Wedge=void 0;const Os=ot,x1=Kt,E1=ct,Vh=j,M1=ct;class ri extends x1.Shape{_sceneFunc(t){t.beginPath(),t.arc(0,0,this.radius(),0,E1.Konva.getAngle(this.angle()),this.clockwise()),t.lineTo(0,0),t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(t){this.radius(t/2)}setHeight(t){this.radius(t/2)}}Ls.Wedge=ri;ri.prototype.className="Wedge";ri.prototype._centroid=!0;ri.prototype._attrsAffectingSize=["radius"];(0,M1._registerNode)(ri);Os.Factory.addGetterSetter(ri,"radius",0,(0,Vh.getNumberValidator)());Os.Factory.addGetterSetter(ri,"angle",0,(0,Vh.getNumberValidator)());Os.Factory.addGetterSetter(ri,"clockwise",!1);Os.Factory.backCompat(ri,{angleDeg:"angle",getAngleDeg:"getAngle",setAngleDeg:"setAngle"});var Ds={};Object.defineProperty(Ds,"__esModule",{value:!0});Ds.Blur=void 0;const kl=ot,F1=Ot,R1=j;function Pl(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}var N1=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],L1=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];function O1(r,t){var e=r.data,i=r.width,n=r.height,s,a,o,l,c,h,f,d,g,p,v,b,_,w,u,m,y,S,T,C,A,k,P,x,M=t+t+1,F=i-1,N=n-1,I=t+1,V=I*(I+1)/2,Z=new Pl,lt=null,q=Z,J=null,gt=null,At=N1[t],U=L1[t];for(o=1;o<M;o++)q=q.next=new Pl,o===I&&(lt=q);for(q.next=Z,f=h=0,a=0;a<n;a++){for(m=y=S=T=d=g=p=v=0,b=I*(C=e[h]),_=I*(A=e[h+1]),w=I*(k=e[h+2]),u=I*(P=e[h+3]),d+=V*C,g+=V*A,p+=V*k,v+=V*P,q=Z,o=0;o<I;o++)q.r=C,q.g=A,q.b=k,q.a=P,q=q.next;for(o=1;o<I;o++)l=h+((F<o?F:o)<<2),d+=(q.r=C=e[l])*(x=I-o),g+=(q.g=A=e[l+1])*x,p+=(q.b=k=e[l+2])*x,v+=(q.a=P=e[l+3])*x,m+=C,y+=A,S+=k,T+=P,q=q.next;for(J=Z,gt=lt,s=0;s<i;s++)e[h+3]=P=v*At>>U,P!==0?(P=255/P,e[h]=(d*At>>U)*P,e[h+1]=(g*At>>U)*P,e[h+2]=(p*At>>U)*P):e[h]=e[h+1]=e[h+2]=0,d-=b,g-=_,p-=w,v-=u,b-=J.r,_-=J.g,w-=J.b,u-=J.a,l=f+((l=s+t+1)<F?l:F)<<2,m+=J.r=e[l],y+=J.g=e[l+1],S+=J.b=e[l+2],T+=J.a=e[l+3],d+=m,g+=y,p+=S,v+=T,J=J.next,b+=C=gt.r,_+=A=gt.g,w+=k=gt.b,u+=P=gt.a,m-=C,y-=A,S-=k,T-=P,gt=gt.next,h+=4;f+=i}for(s=0;s<i;s++){for(y=S=T=m=g=p=v=d=0,h=s<<2,b=I*(C=e[h]),_=I*(A=e[h+1]),w=I*(k=e[h+2]),u=I*(P=e[h+3]),d+=V*C,g+=V*A,p+=V*k,v+=V*P,q=Z,o=0;o<I;o++)q.r=C,q.g=A,q.b=k,q.a=P,q=q.next;for(c=i,o=1;o<=t;o++)h=c+s<<2,d+=(q.r=C=e[h])*(x=I-o),g+=(q.g=A=e[h+1])*x,p+=(q.b=k=e[h+2])*x,v+=(q.a=P=e[h+3])*x,m+=C,y+=A,S+=k,T+=P,q=q.next,o<N&&(c+=i);for(h=s,J=Z,gt=lt,a=0;a<n;a++)l=h<<2,e[l+3]=P=v*At>>U,P>0?(P=255/P,e[l]=(d*At>>U)*P,e[l+1]=(g*At>>U)*P,e[l+2]=(p*At>>U)*P):e[l]=e[l+1]=e[l+2]=0,d-=b,g-=_,p-=w,v-=u,b-=J.r,_-=J.g,w-=J.b,u-=J.a,l=s+((l=a+I)<N?l:N)*i<<2,d+=m+=J.r=e[l],g+=y+=J.g=e[l+1],p+=S+=J.b=e[l+2],v+=T+=J.a=e[l+3],J=J.next,b+=C=gt.r,_+=A=gt.g,w+=k=gt.b,u+=P=gt.a,m-=C,y-=A,S-=k,T-=P,gt=gt.next,h+=i}}const D1=function(t){var e=Math.round(this.blurRadius());e>0&&O1(t,e)};Ds.Blur=D1;kl.Factory.addGetterSetter(F1.Node,"blurRadius",0,(0,R1.getNumberValidator)(),kl.Factory.afterSetFilter);var Is={};Object.defineProperty(Is,"__esModule",{value:!0});Is.Brighten=void 0;const xl=ot,I1=Ot,B1=j,G1=function(r){var t=this.brightness()*255,e=r.data,i=e.length,n;for(n=0;n<i;n+=4)e[n]+=t,e[n+1]+=t,e[n+2]+=t};Is.Brighten=G1;xl.Factory.addGetterSetter(I1.Node,"brightness",0,(0,B1.getNumberValidator)(),xl.Factory.afterSetFilter);var Bs={};Object.defineProperty(Bs,"__esModule",{value:!0});Bs.Contrast=void 0;const El=ot,U1=Ot,V1=j,z1=function(r){var t=Math.pow((this.contrast()+100)/100,2),e=r.data,i=e.length,n=150,s=150,a=150,o;for(o=0;o<i;o+=4)n=e[o],s=e[o+1],a=e[o+2],n/=255,n-=.5,n*=t,n+=.5,n*=255,s/=255,s-=.5,s*=t,s+=.5,s*=255,a/=255,a-=.5,a*=t,a+=.5,a*=255,n=n<0?0:n>255?255:n,s=s<0?0:s>255?255:s,a=a<0?0:a>255?255:a,e[o]=n,e[o+1]=s,e[o+2]=a};Bs.Contrast=z1;El.Factory.addGetterSetter(U1.Node,"contrast",0,(0,V1.getNumberValidator)(),El.Factory.afterSetFilter);var Gs={};Object.defineProperty(Gs,"__esModule",{value:!0});Gs.Emboss=void 0;const yi=ot,Us=Ot,H1=It,zh=j,W1=function(r){var t=this.embossStrength()*10,e=this.embossWhiteLevel()*255,i=this.embossDirection(),n=this.embossBlend(),s=0,a=0,o=r.data,l=r.width,c=r.height,h=l*4,f=c;switch(i){case"top-left":s=-1,a=-1;break;case"top":s=-1,a=0;break;case"top-right":s=-1,a=1;break;case"right":s=0,a=1;break;case"bottom-right":s=1,a=1;break;case"bottom":s=1,a=0;break;case"bottom-left":s=1,a=-1;break;case"left":s=0,a=-1;break;default:H1.Util.error("Unknown emboss direction: "+i)}do{var d=(f-1)*h,g=s;f+g<1&&(g=0),f+g>c&&(g=0);var p=(f-1+g)*l*4,v=l;do{var b=d+(v-1)*4,_=a;v+_<1&&(_=0),v+_>l&&(_=0);var w=p+(v-1+_)*4,u=o[b]-o[w],m=o[b+1]-o[w+1],y=o[b+2]-o[w+2],S=u,T=S>0?S:-S,C=m>0?m:-m,A=y>0?y:-y;if(C>T&&(S=m),A>T&&(S=y),S*=t,n){var k=o[b]+S,P=o[b+1]+S,x=o[b+2]+S;o[b]=k>255?255:k<0?0:k,o[b+1]=P>255?255:P<0?0:P,o[b+2]=x>255?255:x<0?0:x}else{var M=e-S;M<0?M=0:M>255&&(M=255),o[b]=o[b+1]=o[b+2]=M}}while(--v)}while(--f)};Gs.Emboss=W1;yi.Factory.addGetterSetter(Us.Node,"embossStrength",.5,(0,zh.getNumberValidator)(),yi.Factory.afterSetFilter);yi.Factory.addGetterSetter(Us.Node,"embossWhiteLevel",.5,(0,zh.getNumberValidator)(),yi.Factory.afterSetFilter);yi.Factory.addGetterSetter(Us.Node,"embossDirection","top-left",null,yi.Factory.afterSetFilter);yi.Factory.addGetterSetter(Us.Node,"embossBlend",!1,null,yi.Factory.afterSetFilter);var Vs={};Object.defineProperty(Vs,"__esModule",{value:!0});Vs.Enhance=void 0;const Ml=ot,j1=Ot,X1=j;function _a(r,t,e,i,n){var s=e-t,a=n-i,o;return s===0?i+a/2:a===0?i:(o=(r-t)/s,o=a*o+i,o)}const Y1=function(r){var t=r.data,e=t.length,i=t[0],n=i,s,a=t[1],o=a,l,c=t[2],h=c,f,d,g=this.enhance();if(g!==0){for(d=0;d<e;d+=4)s=t[d+0],s<i?i=s:s>n&&(n=s),l=t[d+1],l<a?a=l:l>o&&(o=l),f=t[d+2],f<c?c=f:f>h&&(h=f);n===i&&(n=255,i=0),o===a&&(o=255,a=0),h===c&&(h=255,c=0);var p,v,b,_,w,u,m,y,S;for(g>0?(v=n+g*(255-n),b=i-g*(i-0),w=o+g*(255-o),u=a-g*(a-0),y=h+g*(255-h),S=c-g*(c-0)):(p=(n+i)*.5,v=n+g*(n-p),b=i+g*(i-p),_=(o+a)*.5,w=o+g*(o-_),u=a+g*(a-_),m=(h+c)*.5,y=h+g*(h-m),S=c+g*(c-m)),d=0;d<e;d+=4)t[d+0]=_a(t[d+0],i,n,b,v),t[d+1]=_a(t[d+1],a,o,u,w),t[d+2]=_a(t[d+2],c,h,S,y)}};Vs.Enhance=Y1;Ml.Factory.addGetterSetter(j1.Node,"enhance",0,(0,X1.getNumberValidator)(),Ml.Factory.afterSetFilter);var zs={};Object.defineProperty(zs,"__esModule",{value:!0});zs.Grayscale=void 0;const K1=function(r){var t=r.data,e=t.length,i,n;for(i=0;i<e;i+=4)n=.34*t[i]+.5*t[i+1]+.16*t[i+2],t[i]=n,t[i+1]=n,t[i+2]=n};zs.Grayscale=K1;var Hs={};Object.defineProperty(Hs,"__esModule",{value:!0});Hs.HSL=void 0;const yn=ot,Po=Ot,xo=j;yn.Factory.addGetterSetter(Po.Node,"hue",0,(0,xo.getNumberValidator)(),yn.Factory.afterSetFilter);yn.Factory.addGetterSetter(Po.Node,"saturation",0,(0,xo.getNumberValidator)(),yn.Factory.afterSetFilter);yn.Factory.addGetterSetter(Po.Node,"luminance",0,(0,xo.getNumberValidator)(),yn.Factory.afterSetFilter);const q1=function(r){var t=r.data,e=t.length,i=1,n=Math.pow(2,this.saturation()),s=Math.abs(this.hue()+360)%360,a=this.luminance()*127,o,l=i*n*Math.cos(s*Math.PI/180),c=i*n*Math.sin(s*Math.PI/180),h=.299*i+.701*l+.167*c,f=.587*i-.587*l+.33*c,d=.114*i-.114*l-.497*c,g=.299*i-.299*l-.328*c,p=.587*i+.413*l+.035*c,v=.114*i-.114*l+.293*c,b=.299*i-.3*l+1.25*c,_=.587*i-.586*l-1.05*c,w=.114*i+.886*l-.2*c,u,m,y,S;for(o=0;o<e;o+=4)u=t[o+0],m=t[o+1],y=t[o+2],S=t[o+3],t[o+0]=h*u+f*m+d*y+a,t[o+1]=g*u+p*m+v*y+a,t[o+2]=b*u+_*m+w*y+a,t[o+3]=S};Hs.HSL=q1;var Ws={};Object.defineProperty(Ws,"__esModule",{value:!0});Ws.HSV=void 0;const bn=ot,Eo=Ot,Mo=j,$1=function(r){var t=r.data,e=t.length,i=Math.pow(2,this.value()),n=Math.pow(2,this.saturation()),s=Math.abs(this.hue()+360)%360,a,o=i*n*Math.cos(s*Math.PI/180),l=i*n*Math.sin(s*Math.PI/180),c=.299*i+.701*o+.167*l,h=.587*i-.587*o+.33*l,f=.114*i-.114*o-.497*l,d=.299*i-.299*o-.328*l,g=.587*i+.413*o+.035*l,p=.114*i-.114*o+.293*l,v=.299*i-.3*o+1.25*l,b=.587*i-.586*o-1.05*l,_=.114*i+.886*o-.2*l,w,u,m,y;for(a=0;a<e;a+=4)w=t[a+0],u=t[a+1],m=t[a+2],y=t[a+3],t[a+0]=c*w+h*u+f*m,t[a+1]=d*w+g*u+p*m,t[a+2]=v*w+b*u+_*m,t[a+3]=y};Ws.HSV=$1;bn.Factory.addGetterSetter(Eo.Node,"hue",0,(0,Mo.getNumberValidator)(),bn.Factory.afterSetFilter);bn.Factory.addGetterSetter(Eo.Node,"saturation",0,(0,Mo.getNumberValidator)(),bn.Factory.afterSetFilter);bn.Factory.addGetterSetter(Eo.Node,"value",0,(0,Mo.getNumberValidator)(),bn.Factory.afterSetFilter);var js={};Object.defineProperty(js,"__esModule",{value:!0});js.Invert=void 0;const J1=function(r){var t=r.data,e=t.length,i;for(i=0;i<e;i+=4)t[i]=255-t[i],t[i+1]=255-t[i+1],t[i+2]=255-t[i+2]};js.Invert=J1;var Xs={};Object.defineProperty(Xs,"__esModule",{value:!0});Xs.Kaleidoscope=void 0;const Qr=ot,Hh=Ot,Fl=It,Wh=j;var Q1=function(r,t,e){var i=r.data,n=t.data,s=r.width,a=r.height,o=e.polarCenterX||s/2,l=e.polarCenterY||a/2,c,h,f,d=0,g=0,p=0,v=0,b,_=Math.sqrt(o*o+l*l);h=s-o,f=a-l,b=Math.sqrt(h*h+f*f),_=b>_?b:_;var w=a,u=s,m,y,S=360/u*Math.PI/180,T,C;for(y=0;y<u;y+=1)for(T=Math.sin(y*S),C=Math.cos(y*S),m=0;m<w;m+=1)h=Math.floor(o+_*m/w*C),f=Math.floor(l+_*m/w*T),c=(f*s+h)*4,d=i[c+0],g=i[c+1],p=i[c+2],v=i[c+3],c=(y+m*s)*4,n[c+0]=d,n[c+1]=g,n[c+2]=p,n[c+3]=v},Z1=function(r,t,e){var i=r.data,n=t.data,s=r.width,a=r.height,o=e.polarCenterX||s/2,l=e.polarCenterY||a/2,c,h,f,d,g,p=0,v=0,b=0,_=0,w,u=Math.sqrt(o*o+l*l);h=s-o,f=a-l,w=Math.sqrt(h*h+f*f),u=w>u?w:u;var m=a,y=s,S,T,C=e.polarRotation||0,A,k;for(h=0;h<s;h+=1)for(f=0;f<a;f+=1)d=h-o,g=f-l,S=Math.sqrt(d*d+g*g)*m/u,T=(Math.atan2(g,d)*180/Math.PI+360+C)%360,T=T*y/360,A=Math.floor(T),k=Math.floor(S),c=(k*s+A)*4,p=i[c+0],v=i[c+1],b=i[c+2],_=i[c+3],c=(f*s+h)*4,n[c+0]=p,n[c+1]=v,n[c+2]=b,n[c+3]=_};const tg=function(r){var t=r.width,e=r.height,i,n,s,a,o,l,c,h,f,d,g=Math.round(this.kaleidoscopePower()),p=Math.round(this.kaleidoscopeAngle()),v=Math.floor(t*(p%360)/360);if(!(g<1)){var b=Fl.Util.createCanvasElement();b.width=t,b.height=e;var _=b.getContext("2d").getImageData(0,0,t,e);Fl.Util.releaseCanvas(b),Q1(r,_,{polarCenterX:t/2,polarCenterY:e/2});for(var w=t/Math.pow(2,g);w<=8;)w=w*2,g-=1;w=Math.ceil(w);var u=w,m=0,y=u,S=1;for(v+w>t&&(m=u,y=0,S=-1),n=0;n<e;n+=1)for(i=m;i!==y;i+=S)s=Math.round(i+v)%t,f=(t*n+s)*4,o=_.data[f+0],l=_.data[f+1],c=_.data[f+2],h=_.data[f+3],d=(t*n+i)*4,_.data[d+0]=o,_.data[d+1]=l,_.data[d+2]=c,_.data[d+3]=h;for(n=0;n<e;n+=1)for(u=Math.floor(w),a=0;a<g;a+=1){for(i=0;i<u+1;i+=1)f=(t*n+i)*4,o=_.data[f+0],l=_.data[f+1],c=_.data[f+2],h=_.data[f+3],d=(t*n+u*2-i-1)*4,_.data[d+0]=o,_.data[d+1]=l,_.data[d+2]=c,_.data[d+3]=h;u*=2}Z1(_,r,{polarRotation:0})}};Xs.Kaleidoscope=tg;Qr.Factory.addGetterSetter(Hh.Node,"kaleidoscopePower",2,(0,Wh.getNumberValidator)(),Qr.Factory.afterSetFilter);Qr.Factory.addGetterSetter(Hh.Node,"kaleidoscopeAngle",0,(0,Wh.getNumberValidator)(),Qr.Factory.afterSetFilter);var Ys={};Object.defineProperty(Ys,"__esModule",{value:!0});Ys.Mask=void 0;const Rl=ot,eg=Ot,ig=j;function pr(r,t,e){var i=(e*r.width+t)*4,n=[];return n.push(r.data[i++],r.data[i++],r.data[i++],r.data[i++]),n}function Ln(r,t){return Math.sqrt(Math.pow(r[0]-t[0],2)+Math.pow(r[1]-t[1],2)+Math.pow(r[2]-t[2],2))}function ng(r){for(var t=[0,0,0],e=0;e<r.length;e++)t[0]+=r[e][0],t[1]+=r[e][1],t[2]+=r[e][2];return t[0]/=r.length,t[1]/=r.length,t[2]/=r.length,t}function rg(r,t){var e=pr(r,0,0),i=pr(r,r.width-1,0),n=pr(r,0,r.height-1),s=pr(r,r.width-1,r.height-1),a=t||10;if(Ln(e,i)<a&&Ln(i,s)<a&&Ln(s,n)<a&&Ln(n,e)<a){for(var o=ng([i,e,s,n]),l=[],c=0;c<r.width*r.height;c++){var h=Ln(o,[r.data[c*4],r.data[c*4+1],r.data[c*4+2]]);l[c]=h<a?0:255}return l}}function sg(r,t){for(var e=0;e<r.width*r.height;e++)r.data[4*e+3]=t[e]}function ag(r,t,e){for(var i=[1,1,1,1,0,1,1,1,1],n=Math.round(Math.sqrt(i.length)),s=Math.floor(n/2),a=[],o=0;o<e;o++)for(var l=0;l<t;l++){for(var c=o*t+l,h=0,f=0;f<n;f++)for(var d=0;d<n;d++){var g=o+f-s,p=l+d-s;if(g>=0&&g<e&&p>=0&&p<t){var v=g*t+p,b=i[f*n+d];h+=r[v]*b}}a[c]=h===255*8?255:0}return a}function og(r,t,e){for(var i=[1,1,1,1,1,1,1,1,1],n=Math.round(Math.sqrt(i.length)),s=Math.floor(n/2),a=[],o=0;o<e;o++)for(var l=0;l<t;l++){for(var c=o*t+l,h=0,f=0;f<n;f++)for(var d=0;d<n;d++){var g=o+f-s,p=l+d-s;if(g>=0&&g<e&&p>=0&&p<t){var v=g*t+p,b=i[f*n+d];h+=r[v]*b}}a[c]=h>=255*4?255:0}return a}function lg(r,t,e){for(var i=[.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111],n=Math.round(Math.sqrt(i.length)),s=Math.floor(n/2),a=[],o=0;o<e;o++)for(var l=0;l<t;l++){for(var c=o*t+l,h=0,f=0;f<n;f++)for(var d=0;d<n;d++){var g=o+f-s,p=l+d-s;if(g>=0&&g<e&&p>=0&&p<t){var v=g*t+p,b=i[f*n+d];h+=r[v]*b}}a[c]=h}return a}const cg=function(r){var t=this.threshold(),e=rg(r,t);return e&&(e=ag(e,r.width,r.height),e=og(e,r.width,r.height),e=lg(e,r.width,r.height),sg(r,e)),r};Ys.Mask=cg;Rl.Factory.addGetterSetter(eg.Node,"threshold",0,(0,ig.getNumberValidator)(),Rl.Factory.afterSetFilter);var Ks={};Object.defineProperty(Ks,"__esModule",{value:!0});Ks.Noise=void 0;const Nl=ot,hg=Ot,fg=j,ug=function(r){var t=this.noise()*255,e=r.data,i=e.length,n=t/2,s;for(s=0;s<i;s+=4)e[s+0]+=n-2*n*Math.random(),e[s+1]+=n-2*n*Math.random(),e[s+2]+=n-2*n*Math.random()};Ks.Noise=ug;Nl.Factory.addGetterSetter(hg.Node,"noise",.2,(0,fg.getNumberValidator)(),Nl.Factory.afterSetFilter);var qs={};Object.defineProperty(qs,"__esModule",{value:!0});qs.Pixelate=void 0;const Ll=ot,dg=It,gg=Ot,pg=j,mg=function(r){var t=Math.ceil(this.pixelSize()),e=r.width,i=r.height,n,s,a,o,l,c,h,f=Math.ceil(e/t),d=Math.ceil(i/t),g,p,v,b,_,w,u,m=r.data;if(t<=0){dg.Util.error("pixelSize value can not be <= 0");return}for(_=0;_<f;_+=1)for(w=0;w<d;w+=1){for(o=0,l=0,c=0,h=0,g=_*t,p=g+t,v=w*t,b=v+t,u=0,n=g;n<p;n+=1)if(!(n>=e))for(s=v;s<b;s+=1)s>=i||(a=(e*s+n)*4,o+=m[a+0],l+=m[a+1],c+=m[a+2],h+=m[a+3],u+=1);for(o=o/u,l=l/u,c=c/u,h=h/u,n=g;n<p;n+=1)if(!(n>=e))for(s=v;s<b;s+=1)s>=i||(a=(e*s+n)*4,m[a+0]=o,m[a+1]=l,m[a+2]=c,m[a+3]=h)}};qs.Pixelate=mg;Ll.Factory.addGetterSetter(gg.Node,"pixelSize",8,(0,pg.getNumberValidator)(),Ll.Factory.afterSetFilter);var $s={};Object.defineProperty($s,"__esModule",{value:!0});$s.Posterize=void 0;const Ol=ot,_g=Ot,vg=j,yg=function(r){var t=Math.round(this.levels()*254)+1,e=r.data,i=e.length,n=255/t,s;for(s=0;s<i;s+=1)e[s]=Math.floor(e[s]/n)*n};$s.Posterize=yg;Ol.Factory.addGetterSetter(_g.Node,"levels",.5,(0,vg.getNumberValidator)(),Ol.Factory.afterSetFilter);var Js={};Object.defineProperty(Js,"__esModule",{value:!0});Js.RGB=void 0;const Zr=ot,Fo=Ot,bg=j,wg=function(r){var t=r.data,e=t.length,i=this.red(),n=this.green(),s=this.blue(),a,o;for(a=0;a<e;a+=4)o=(.34*t[a]+.5*t[a+1]+.16*t[a+2])/255,t[a]=o*i,t[a+1]=o*n,t[a+2]=o*s,t[a+3]=t[a+3]};Js.RGB=wg;Zr.Factory.addGetterSetter(Fo.Node,"red",0,function(r){return this._filterUpToDate=!1,r>255?255:r<0?0:Math.round(r)});Zr.Factory.addGetterSetter(Fo.Node,"green",0,function(r){return this._filterUpToDate=!1,r>255?255:r<0?0:Math.round(r)});Zr.Factory.addGetterSetter(Fo.Node,"blue",0,bg.RGBComponent,Zr.Factory.afterSetFilter);var Qs={};Object.defineProperty(Qs,"__esModule",{value:!0});Qs.RGBA=void 0;const Kn=ot,Zs=Ot,Sg=j,Cg=function(r){var t=r.data,e=t.length,i=this.red(),n=this.green(),s=this.blue(),a=this.alpha(),o,l;for(o=0;o<e;o+=4)l=1-a,t[o]=i*a+t[o]*l,t[o+1]=n*a+t[o+1]*l,t[o+2]=s*a+t[o+2]*l};Qs.RGBA=Cg;Kn.Factory.addGetterSetter(Zs.Node,"red",0,function(r){return this._filterUpToDate=!1,r>255?255:r<0?0:Math.round(r)});Kn.Factory.addGetterSetter(Zs.Node,"green",0,function(r){return this._filterUpToDate=!1,r>255?255:r<0?0:Math.round(r)});Kn.Factory.addGetterSetter(Zs.Node,"blue",0,Sg.RGBComponent,Kn.Factory.afterSetFilter);Kn.Factory.addGetterSetter(Zs.Node,"alpha",1,function(r){return this._filterUpToDate=!1,r>1?1:r<0?0:r});var ta={};Object.defineProperty(ta,"__esModule",{value:!0});ta.Sepia=void 0;const Ag=function(r){var t=r.data,e=t.length,i,n,s,a;for(i=0;i<e;i+=4)n=t[i+0],s=t[i+1],a=t[i+2],t[i+0]=Math.min(255,n*.393+s*.769+a*.189),t[i+1]=Math.min(255,n*.349+s*.686+a*.168),t[i+2]=Math.min(255,n*.272+s*.534+a*.131)};ta.Sepia=Ag;var ea={};Object.defineProperty(ea,"__esModule",{value:!0});ea.Solarize=void 0;const Tg=function(r){var t=r.data,e=r.width,i=r.height,n=e*4,s=i;do{var a=(s-1)*n,o=e;do{var l=a+(o-1)*4,c=t[l],h=t[l+1],f=t[l+2];c>127&&(c=255-c),h>127&&(h=255-h),f>127&&(f=255-f),t[l]=c,t[l+1]=h,t[l+2]=f}while(--o)}while(--s)};ea.Solarize=Tg;var ia={};Object.defineProperty(ia,"__esModule",{value:!0});ia.Threshold=void 0;const Dl=ot,kg=Ot,Pg=j,xg=function(r){var t=this.threshold()*255,e=r.data,i=e.length,n;for(n=0;n<i;n+=1)e[n]=e[n]<t?0:255};ia.Threshold=xg;Dl.Factory.addGetterSetter(kg.Node,"threshold",.5,(0,Pg.getNumberValidator)(),Dl.Factory.afterSetFilter);Object.defineProperty(fs,"__esModule",{value:!0});fs.Konva=void 0;const Il=ch,Eg=_s,Mg=bs,Fg=Cs,Rg=As,Ng=Ts,Bl=vn,Lg=rr,Og=xn,Dg=ar,Ig=xs,Bg=Es,Gg=Ms,Ug=Fs,Vg=Ui,zg=Rs,Hg=Ns,Wg=Ls,jg=Ds,Xg=Is,Yg=Bs,Kg=Gs,qg=Vs,$g=zs,Jg=Hs,Qg=Ws,Zg=js,t2=Xs,e2=Ys,i2=Ks,n2=qs,r2=$s,s2=Js,a2=Qs,o2=ta,l2=ea,c2=ia;fs.Konva=Il.Konva.Util._assign(Il.Konva,{Arc:Eg.Arc,Arrow:Mg.Arrow,Circle:Fg.Circle,Ellipse:Rg.Ellipse,Image:Ng.Image,Label:Bl.Label,Tag:Bl.Tag,Line:Lg.Line,Path:Og.Path,Rect:Dg.Rect,RegularPolygon:Ig.RegularPolygon,Ring:Bg.Ring,Sprite:Gg.Sprite,Star:Ug.Star,Text:Vg.Text,TextPath:zg.TextPath,Transformer:Hg.Transformer,Wedge:Wg.Wedge,Filters:{Blur:jg.Blur,Brighten:Xg.Brighten,Contrast:Yg.Contrast,Emboss:Kg.Emboss,Enhance:qg.Enhance,Grayscale:$g.Grayscale,HSL:Jg.HSL,HSV:Qg.HSV,Invert:Zg.Invert,Kaleidoscope:t2.Kaleidoscope,Mask:e2.Mask,Noise:i2.Noise,Pixelate:n2.Pixelate,Posterize:r2.Posterize,RGB:s2.RGB,RGBA:a2.RGBA,Sepia:o2.Sepia,Solarize:l2.Solarize,Threshold:c2.Threshold}});var h2=_o.exports;Object.defineProperty(h2,"__esModule",{value:!0});const f2=fs;_o.exports=f2.Konva;var u2=_o.exports;const or=gd(u2),d2=["mouseover","mouseout","mouseenter","mouseleave","mousemove","mousedown","mouseup","wheel","click","dblclick","touchstart","touchmove","touchend","tap","dbltap","pointerdown","pointermove","pointerup","pointercancel","pointerover","pointerenter","pointerout","pointerleave","pointerclick","pointerdblclick","dragstart","dragmove","dragend","transformstart","transform","transformend"];function lr(r,t){d2.forEach(e=>{t.on(e,i=>{r(e,i,{cancelable:!0})||(i.cancelBubble=!0)})})}const ts=["svelte-konva-stage","svelte-konva-layer","svelte-konva-group","svelte-konva-label"];var qn;(function(r){r[r.Stage=0]="Stage",r[r.Layer=1]="Layer",r[r.Group=2]="Group",r[r.Label=3]="Label"})(qn||(qn={}));const g2="svelte-konva: Component does not have any parent container. Please make sure that the component is wrapped inside a Layer or Group.",p2="svelte-konva: A Layer needs to have a Stage as parent.";function jh(r,t){ts.forEach(e=>{Di(e,null)}),Di(ts[r],t)}function Ro(){for(let r=1;r<4;r++){const t=ke(ts[r]);if(t)return t}throw new Error(g2)}function m2(){const r=ke(ts[qn.Stage]);if(r)return r;throw new Error(p2)}function Qe(r,t){for(const e in r)Object.prototype.hasOwnProperty.call(t,e)&&(r[e]=t[e])}function _2(r,t,e){let i,{config:n}=t,{handle:s=new or.Circle(n)}=t,{staticConfig:a=!1}=t,o=Ro();pi(r,o,c=>e(4,i=c));let l=Sn();return Vi(()=>{i.add(s),a||(s.on("transformend",()=>{Qe(n,s.getAttrs()),e(1,n)}),s.on("dragend",()=>{Qe(n,s.getAttrs()),e(1,n)})),lr(l,s)}),Jn(()=>{s.destroy()}),r.$$set=c=>{"config"in c&&e(1,n=c.config),"handle"in c&&e(2,s=c.handle),"staticConfig"in c&&e(3,a=c.staticConfig)},r.$$.update=()=>{r.$$.dirty&6&&s.setAttrs(n)},[o,n,s,a]}class v2 extends Nt{constructor(t){super(),Lt(this,t,_2,null,Mt,{config:1,handle:2,staticConfig:3})}}function y2(r,t,e){let i,{config:n}=t,{handle:s=new or.Image(n)}=t,{staticConfig:a=!1}=t,o=Ro();pi(r,o,c=>e(4,i=c));let l=Sn();return Vi(()=>{i.add(s),a||(s.on("transformend",()=>{Qe(n,s.getAttrs()),e(1,n)}),s.on("dragend",()=>{Qe(n,s.getAttrs()),e(1,n)})),lr(l,s)}),Jn(()=>{s.destroy()}),r.$$set=c=>{"config"in c&&e(1,n=c.config),"handle"in c&&e(2,s=c.handle),"staticConfig"in c&&e(3,a=c.staticConfig)},r.$$.update=()=>{r.$$.dirty&6&&s.setAttrs(n)},[o,n,s,a]}class b2 extends Nt{constructor(t){super(),Lt(this,t,y2,null,Mt,{config:1,handle:2,staticConfig:3})}}function Gl(r){let t;const e=r[6].default,i=te(e,r,r[5],null);return{c(){i&&i.c()},l(n){i&&i.l(n)},m(n,s){i&&i.m(n,s),t=!0},p(n,s){i&&i.p&&(!t||s&32)&&ee(i,e,n,n[5],t?ne(e,n[5],s,null):ie(n[5]),null)},i(n){t||(L(i,n),t=!0)},o(n){B(i,n),t=!1},d(n){i&&i.d(n)}}}function w2(r){let t,e,i=r[0]&&Gl(r);return{c(){i&&i.c(),t=Gt()},l(n){i&&i.l(n),t=Gt()},m(n,s){i&&i.m(n,s),O(n,t,s),e=!0},p(n,[s]){n[0]?i?(i.p(n,s),s&1&&L(i,1)):(i=Gl(n),i.c(),L(i,1),i.m(t.parentNode,t)):i&&(ce(),B(i,1,1,()=>{i=null}),he())},i(n){e||(L(i),e=!0)},o(n){B(i),e=!1},d(n){n&&R(t),i&&i.d(n)}}}function S2(r,t,e){let i,{$$slots:n={},$$scope:s}=t,{config:a={}}=t,{handle:o=new or.Layer(a)}=t,{staticConfig:l=!1}=t,c=Cn(null),h=Sn(),f=!1,d=m2();return pi(r,d,g=>e(7,i=g)),Vi(()=>{i.add(o),l||(o.on("transformend",()=>{Qe(a,o.getAttrs()),e(2,a)}),o.on("dragend",()=>{Qe(a,o.getAttrs()),e(2,a)})),lr(h,o),c.set(o),e(0,f=!0)}),Jn(()=>{o&&o.destroy()}),jh(qn.Layer,c),r.$$set=g=>{"config"in g&&e(2,a=g.config),"handle"in g&&e(3,o=g.handle),"staticConfig"in g&&e(4,l=g.staticConfig),"$$scope"in g&&e(5,s=g.$$scope)},r.$$.update=()=>{r.$$.dirty&12&&o&&o.setAttrs(a)},[f,d,a,o,l,s,n]}class C2 extends Nt{constructor(t){super(),Lt(this,t,S2,w2,Mt,{config:2,handle:3,staticConfig:4})}}function A2(r,t,e){let i,{config:n}=t,{handle:s=new or.Rect(n)}=t,{staticConfig:a=!1}=t,o=Ro();pi(r,o,c=>e(4,i=c));let l=Sn();return Vi(()=>{i.add(s),a||(s.on("transformend",()=>{Qe(n,s.getAttrs()),e(1,n)}),s.on("dragend",()=>{Qe(n,s.getAttrs()),e(1,n)})),lr(l,s)}),Jn(()=>{s.destroy()}),r.$$set=c=>{"config"in c&&e(1,n=c.config),"handle"in c&&e(2,s=c.handle),"staticConfig"in c&&e(3,a=c.staticConfig)},r.$$.update=()=>{r.$$.dirty&6&&s.setAttrs(n)},[o,n,s,a]}class Xh extends Nt{constructor(t){super(),Lt(this,t,A2,null,Mt,{config:1,handle:2,staticConfig:3})}}function Ul(r){let t;const e=r[7].default,i=te(e,r,r[6],null);return{c(){i&&i.c()},l(n){i&&i.l(n)},m(n,s){i&&i.m(n,s),t=!0},p(n,s){i&&i.p&&(!t||s&64)&&ee(i,e,n,n[6],t?ne(e,n[6],s,null):ie(n[6]),null)},i(n){t||(L(i,n),t=!0)},o(n){B(i,n),t=!1},d(n){i&&i.d(n)}}}function T2(r){let t,e,i=r[1]&&Ul(r),n=[r[2]],s={};for(let a=0;a<n.length;a+=1)s=Q(s,n[a]);return{c(){t=ft("div"),i&&i.c(),this.h()},l(a){t=ut(a,"DIV",{});var o=st(t);i&&i.l(o),o.forEach(R),this.h()},h(){ye(t,s)},m(a,o){O(a,t,o),i&&i.m(t,null),r[8](t),e=!0},p(a,[o]){a[1]?i?(i.p(a,o),o&2&&L(i,1)):(i=Ul(a),i.c(),L(i,1),i.m(t,null)):i&&(ce(),B(i,1,1,()=>{i=null}),he()),ye(t,s=Jt(n,[o&4&&a[2]]))},i(a){e||(L(i),e=!0)},o(a){B(i),e=!1},d(a){a&&R(t),i&&i.d(),r[8](null)}}}function k2(r,t,e){const i=["config","handle","staticConfig"];let n=Ct(t,i),{$$slots:s={},$$scope:a}=t,{config:o}=t,{handle:l=null}=t,{staticConfig:c=!1}=t,h=Cn(null),f,d=Sn(),g=!1;Vi(()=>{e(4,l=new or.Stage({container:f,...o})),c||l.on("dragend",()=>{Qe(o,l.getAttrs()),e(3,o)}),lr(d,l),h.set(l),e(1,g=!0)}),Jn(()=>{l&&l.destroy()}),jh(qn.Stage,h);function p(v){wi[v?"unshift":"push"](()=>{f=v,e(0,f)})}return r.$$set=v=>{t=Q(Q({},t),pt(v)),e(2,n=Ct(t,i)),"config"in v&&e(3,o=v.config),"handle"in v&&e(4,l=v.handle),"staticConfig"in v&&e(5,c=v.staticConfig),"$$scope"in v&&e(6,a=v.$$scope)},r.$$.update=()=>{r.$$.dirty&24&&l&&l.setAttrs(o)},[f,g,n,o,l,c,a,s,p]}class P2 extends Nt{constructor(t){super(),Lt(this,t,k2,T2,Mt,{config:3,handle:4,staticConfig:5})}}function Vl(r,t,e){const i=r.slice();return i[9]=t[e],i}function zl(r){let t,e,i=Ee(r[0]),n=[];for(let s=0;s<i.length;s+=1)n[s]=Hl(Vl(r,i,s));return{c(){t=ft("nav"),e=ft("ul");for(let s=0;s<n.length;s+=1)n[s].c();this.h()},l(s){t=ut(s,"NAV",{class:!0,style:!0});var a=st(t);e=ut(a,"UL",{class:!0});var o=st(e);for(let l=0;l<n.length;l+=1)n[l].l(o);o.forEach(R),a.forEach(R),this.h()},h(){K(e,"class","svelte-clk954"),K(t,"class","navbar svelte-clk954"),Fn(t,"position","absolute"),Fn(t,"top",r[2]+"px"),Fn(t,"left",r[1]+"px")},m(s,a){O(s,t,a),Et(t,e);for(let o=0;o<n.length;o+=1)n[o]&&n[o].m(e,null)},p(s,a){if(a&9){i=Ee(s[0]);let o;for(o=0;o<i.length;o+=1){const l=Vl(s,i,o);n[o]?n[o].p(l,a):(n[o]=Hl(l),n[o].c(),n[o].m(e,null))}for(;o<n.length;o+=1)n[o].d(1);n.length=i.length}a&4&&Fn(t,"top",s[2]+"px"),a&2&&Fn(t,"left",s[1]+"px")},d(s){s&&R(t),Hn(n,s)}}}function x2(r){let t,e,i=r[9].name+"",n,s,a,o;function l(){return r[8](r[9])}return{c(){t=ft("li"),e=ft("button"),n=vt(i),s=mt(),this.h()},l(c){t=ut(c,"LI",{class:!0});var h=st(t);e=ut(h,"BUTTON",{class:!0});var f=st(e);n=yt(f,i),f.forEach(R),s=_t(h),h.forEach(R),this.h()},h(){K(e,"class","svelte-clk954"),K(t,"class","svelte-clk954")},m(c,h){O(c,t,h),Et(t,e),Et(e,n),Et(t,s),a||(o=W(e,"click",l),a=!0)},p(c,h){r=c,h&1&&i!==(i=r[9].name+"")&&$e(n,i)},d(c){c&&R(t),a=!1,o()}}}function E2(r){let t,e=r[9].name+"",i;return{c(){t=ft("li"),i=vt(e),this.h()},l(n){t=ut(n,"LI",{class:!0});var s=st(t);i=yt(s,e),s.forEach(R),this.h()},h(){K(t,"class","group svelte-clk954")},m(n,s){O(n,t,s),Et(t,i)},p(n,s){s&1&&e!==(e=n[9].name+"")&&$e(i,e)},d(n){n&&R(t)}}}function M2(r){let t;return{c(){t=ft("hr"),this.h()},l(e){t=ut(e,"HR",{class:!0}),this.h()},h(){K(t,"class","svelte-clk954")},m(e,i){O(e,t,i)},p:Yt,d(e){e&&R(t)}}}function Hl(r){let t;function e(s,a){return s[9].name===""?M2:s[9].onClick?x2:E2}let i=e(r),n=i(r);return{c(){n.c(),t=Gt()},l(s){n.l(s),t=Gt()},m(s,a){n.m(s,a),O(s,t,a)},p(s,a){i===(i=e(s))&&n?n.p(s,a):(n.d(1),n=i(s),n&&(n.c(),n.m(t.parentNode,t)))},d(s){s&&R(t),n.d(s)}}}function F2(r){let t,e,i,n=r[3]&&zl(r);return{c(){n&&n.c(),t=Gt()},l(s){n&&n.l(s),t=Gt()},m(s,a){n&&n.m(s,a),O(s,t,a),e||(i=[W(window,"contextmenu",mf(r[6])),W(window,"click",r[7])],e=!0)},p(s,[a]){s[3]?n?n.p(s,a):(n=zl(s),n.c(),n.m(t.parentNode,t)):n&&(n.d(1),n=null)},i:Yt,o:Yt,d(s){s&&R(t),n&&n.d(s),e=!1,zi(i)}}}const Wl=16;function R2(r,t,e){let i;const n=(d,g)=>{i.length!==0&&(e(1,a=d-Wl),e(2,o=g-Wl),e(3,l=!l))},s=d=>e(0,i=d);let a=0,o=0,l=!1;return[i,a,o,l,n,s,()=>e(3,l=!1),()=>e(3,l=!1),d=>{d.onClick&&(e(3,l=!1),d.onClick(d.extra))}]}class N2 extends Nt{constructor(t){super(),Lt(this,t,R2,F2,Mt,{toggleAt:4,setItems:5})}get toggleAt(){return this.$$.ctx[4]}get setItems(){return this.$$.ctx[5]}}function L2(r){let t,e,i,n,s,a,o,l;return{c(){t=ft("p"),e=vt(r[0]),i=mt(),n=Ke("svg"),s=Ke("path"),a=mt(),o=ft("p"),l=vt(r[1]),this.h()},l(c){t=ut(c,"P",{class:!0});var h=st(t);e=yt(h,r[0]),h.forEach(R),i=_t(c),n=qe(c,"svg",{"aria-hidden":!0,class:!0,fill:!0,stroke:!0,viewBox:!0,xmlns:!0});var f=st(n);s=qe(f,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),st(s).forEach(R),f.forEach(R),a=_t(c),o=ut(c,"P",{class:!0});var d=st(o);l=yt(d,r[1]),d.forEach(R),this.h()},h(){K(t,"class","mb-2 text-lg text-gray-500 dark:text-gray-400 font-semibold"),K(s,"stroke-linecap","round"),K(s,"stroke-linejoin","round"),K(s,"stroke-width","2"),K(s,"d","M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"),K(n,"aria-hidden","true"),K(n,"class","mb-3 w-10 h-10 text-gray-400"),K(n,"fill","none"),K(n,"stroke","currentColor"),K(n,"viewBox","0 0 24 24"),K(n,"xmlns","http://www.w3.org/2000/svg"),K(o,"class","mb-2 text-sm text-gray-500 dark:text-gray-400")},m(c,h){O(c,t,h),Et(t,e),O(c,i,h),O(c,n,h),Et(n,s),O(c,a,h),O(c,o,h),Et(o,l)},p(c,h){h&1&&$e(e,c[0]),h&2&&$e(l,c[1])},d(c){c&&(R(t),R(i),R(n),R(a),R(o))}}}function O2(r){let t,e;return t=new Fu({props:{class:"m-4",$$slots:{default:[L2]},$$scope:{ctx:r}}}),t.$on("dragover",D2),t.$on("drop",r[2]),t.$on("change",r[3]),{c(){tt(t.$$.fragment)},l(i){et(t.$$.fragment,i)},m(i,n){it(t,i,n),e=!0},p(i,[n]){const s={};n&67&&(s.$$scope={dirty:n,ctx:i}),t.$set(s)},i(i){e||(L(t.$$.fragment,i),e=!0)},o(i){B(t.$$.fragment,i),e=!1},d(i){nt(t,i)}}}const D2=r=>r.preventDefault();function I2(r,t,e){let{title:i}=t,{description:n}=t,{onUpload:s}=t;const a=c=>{const h=new FileReader;h.addEventListener("load",f=>{f.target&&f.target.result&&!(f.target.result instanceof ArrayBuffer)&&s(f.target.result,c.name)}),h.readAsDataURL(c)},o=c=>{if(c.preventDefault(),c.dataTransfer){if(c.dataTransfer.items&&c.dataTransfer.items.length>0){if(c.dataTransfer.items[0].kind==="file"){const h=c.dataTransfer.items[0].getAsFile();h&&a(h)}}else if(c.dataTransfer.files&&c.dataTransfer.files.length>0){const h=c.dataTransfer.files[0];h&&a(h)}}},l=c=>{const h=c.target.files;h&&h.length>0&&a(h[0])};return r.$$set=c=>{"title"in c&&e(0,i=c.title),"description"in c&&e(1,n=c.description),"onUpload"in c&&e(4,s=c.onUpload)},[i,n,o,l,s]}class B2 extends Nt{constructor(t){super(),Lt(this,t,I2,O2,Mt,{title:0,description:1,onUpload:4})}}const Yh=0,G2=1,U2=2,jl=2,va=1.25,Xl=1,Ur=6*4+4+4,na=65535,V2=Math.pow(2,-24),ya=Symbol("SKIP_GENERATION");function z2(r){return r.index?r.index.count:r.attributes.position.count}function Mn(r){return z2(r)/3}function H2(r,t=ArrayBuffer){return r>65535?new Uint32Array(new t(4*r)):new Uint16Array(new t(2*r))}function W2(r,t){if(!r.index){const e=r.attributes.position.count,i=t.useSharedArrayBuffer?SharedArrayBuffer:ArrayBuffer,n=H2(e,i);r.setIndex(new os(n,1));for(let s=0;s<e;s++)n[s]=s}}function Kh(r){const t=Mn(r),e=r.drawRange,i=e.start/3,n=(e.start+e.count)/3,s=Math.max(0,i),a=Math.min(t,n)-s;return[{offset:Math.floor(s),count:Math.floor(a)}]}function qh(r){if(!r.groups||!r.groups.length)return Kh(r);const t=[],e=new Set,i=r.drawRange,n=i.start/3,s=(i.start+i.count)/3;for(const o of r.groups){const l=o.start/3,c=(o.start+o.count)/3;e.add(Math.max(n,l)),e.add(Math.min(s,c))}const a=Array.from(e.values()).sort((o,l)=>o-l);for(let o=0;o<a.length-1;o++){const l=a[o],c=a[o+1];t.push({offset:Math.floor(l),count:Math.floor(c-l)})}return t}function j2(r){if(r.groups.length===0)return!1;const t=Mn(r),e=qh(r).sort((s,a)=>s.offset-a.offset),i=e[e.length-1];i.count=Math.min(t-i.offset,i.count);let n=0;return e.forEach(({count:s})=>n+=s),t!==n}function Dt(r,t,e){return e.min.x=t[r],e.min.y=t[r+1],e.min.z=t[r+2],e.max.x=t[r+3],e.max.y=t[r+4],e.max.z=t[r+5],e}function X2(r){r[0]=r[1]=r[2]=1/0,r[3]=r[4]=r[5]=-1/0}function Yl(r){let t=-1,e=-1/0;for(let i=0;i<3;i++){const n=r[i+3]-r[i];n>e&&(e=n,t=i)}return t}function Kl(r,t){t.set(r)}function ql(r,t,e){let i,n;for(let s=0;s<3;s++){const a=s+3;i=r[s],n=t[s],e[s]=i<n?i:n,i=r[a],n=t[a],e[a]=i>n?i:n}}function mr(r,t,e){for(let i=0;i<3;i++){const n=t[r+2*i],s=t[r+2*i+1],a=n-s,o=n+s;a<e[i]&&(e[i]=a),o>e[i+3]&&(e[i+3]=o)}}function On(r){const t=r[3]-r[0],e=r[4]-r[1],i=r[5]-r[2];return 2*(t*e+e*i+i*t)}function ba(r,t,e,i,n=null){let s=1/0,a=1/0,o=1/0,l=-1/0,c=-1/0,h=-1/0,f=1/0,d=1/0,g=1/0,p=-1/0,v=-1/0,b=-1/0;const _=n!==null;for(let w=t*6,u=(t+e)*6;w<u;w+=6){const m=r[w+0],y=r[w+1],S=m-y,T=m+y;S<s&&(s=S),T>l&&(l=T),_&&m<f&&(f=m),_&&m>p&&(p=m);const C=r[w+2],A=r[w+3],k=C-A,P=C+A;k<a&&(a=k),P>c&&(c=P),_&&C<d&&(d=C),_&&C>v&&(v=C);const x=r[w+4],M=r[w+5],F=x-M,N=x+M;F<o&&(o=F),N>h&&(h=N),_&&x<g&&(g=x),_&&x>b&&(b=x)}i[0]=s,i[1]=a,i[2]=o,i[3]=l,i[4]=c,i[5]=h,_&&(n[0]=f,n[1]=d,n[2]=g,n[3]=p,n[4]=v,n[5]=b)}function Y2(r,t,e,i){let n=1/0,s=1/0,a=1/0,o=-1/0,l=-1/0,c=-1/0;for(let h=t*6,f=(t+e)*6;h<f;h+=6){const d=r[h+0];d<n&&(n=d),d>o&&(o=d);const g=r[h+2];g<s&&(s=g),g>l&&(l=g);const p=r[h+4];p<a&&(a=p),p>c&&(c=p)}i[0]=n,i[1]=s,i[2]=a,i[3]=o,i[4]=l,i[5]=c}function K2(r,t){X2(t);const e=r.attributes.position,i=r.index?r.index.array:null,n=Mn(r),s=new Float32Array(n*6),a=e.normalized,o=e.array,l=e.offset||0;let c=3;e.isInterleavedBufferAttribute&&(c=e.data.stride);const h=["getX","getY","getZ"];for(let f=0;f<n;f++){const d=f*3,g=f*6;let p=d+0,v=d+1,b=d+2;i&&(p=i[p],v=i[v],b=i[b]),a||(p=p*c+l,v=v*c+l,b=b*c+l);for(let _=0;_<3;_++){let w,u,m;a?(w=e[h[_]](p),u=e[h[_]](v),m=e[h[_]](b)):(w=o[p+_],u=o[v+_],m=o[b+_]);let y=w;u<y&&(y=u),m<y&&(y=m);let S=w;u>S&&(S=u),m>S&&(S=m);const T=(S-y)/2,C=_*2;s[g+C+0]=y+T,s[g+C+1]=T+(Math.abs(y)+T)*V2,y<t[_]&&(t[_]=y),S>t[_+3]&&(t[_+3]=S)}}return s}const We=32,q2=(r,t)=>r.candidate-t.candidate,oi=new Array(We).fill().map(()=>({count:0,bounds:new Float32Array(6),rightCacheBounds:new Float32Array(6),leftCacheBounds:new Float32Array(6),candidate:0})),_r=new Float32Array(6);function $2(r,t,e,i,n,s){let a=-1,o=0;if(s===Yh)a=Yl(t),a!==-1&&(o=(t[a]+t[a+3])/2);else if(s===G2)a=Yl(r),a!==-1&&(o=J2(e,i,n,a));else if(s===U2){const l=On(r);let c=va*n;const h=i*6,f=(i+n)*6;for(let d=0;d<3;d++){const g=t[d],b=(t[d+3]-g)/We;if(n<We/4){const _=[...oi];_.length=n;let w=0;for(let m=h;m<f;m+=6,w++){const y=_[w];y.candidate=e[m+2*d],y.count=0;const{bounds:S,leftCacheBounds:T,rightCacheBounds:C}=y;for(let A=0;A<3;A++)C[A]=1/0,C[A+3]=-1/0,T[A]=1/0,T[A+3]=-1/0,S[A]=1/0,S[A+3]=-1/0;mr(m,e,S)}_.sort(q2);let u=n;for(let m=0;m<u;m++){const y=_[m];for(;m+1<u&&_[m+1].candidate===y.candidate;)_.splice(m+1,1),u--}for(let m=h;m<f;m+=6){const y=e[m+2*d];for(let S=0;S<u;S++){const T=_[S];y>=T.candidate?mr(m,e,T.rightCacheBounds):(mr(m,e,T.leftCacheBounds),T.count++)}}for(let m=0;m<u;m++){const y=_[m],S=y.count,T=n-y.count,C=y.leftCacheBounds,A=y.rightCacheBounds;let k=0;S!==0&&(k=On(C)/l);let P=0;T!==0&&(P=On(A)/l);const x=Xl+va*(k*S+P*T);x<c&&(a=d,c=x,o=y.candidate)}}else{for(let u=0;u<We;u++){const m=oi[u];m.count=0,m.candidate=g+b+u*b;const y=m.bounds;for(let S=0;S<3;S++)y[S]=1/0,y[S+3]=-1/0}for(let u=h;u<f;u+=6){let S=~~((e[u+2*d]-g)/b);S>=We&&(S=We-1);const T=oi[S];T.count++,mr(u,e,T.bounds)}const _=oi[We-1];Kl(_.bounds,_.rightCacheBounds);for(let u=We-2;u>=0;u--){const m=oi[u],y=oi[u+1];ql(m.bounds,y.rightCacheBounds,m.rightCacheBounds)}let w=0;for(let u=0;u<We-1;u++){const m=oi[u],y=m.count,S=m.bounds,C=oi[u+1].rightCacheBounds;y!==0&&(w===0?Kl(S,_r):ql(S,_r,_r)),w+=y;let A=0,k=0;w!==0&&(A=On(_r)/l);const P=n-w;P!==0&&(k=On(C)/l);const x=Xl+va*(A*w+k*P);x<c&&(a=d,c=x,o=m.candidate)}}}}else console.warn(`MeshBVH: Invalid build strategy value ${s} used.`);return{axis:a,pos:o}}function J2(r,t,e,i){let n=0;for(let s=t,a=t+e;s<a;s++)n+=r[s*6+i*2];return n/e}class vr{constructor(){}}function Q2(r,t,e,i,n,s){let a=i,o=i+n-1;const l=s.pos,c=s.axis*2;for(;;){for(;a<=o&&e[a*6+c]<l;)a++;for(;a<=o&&e[o*6+c]>=l;)o--;if(a<o){for(let h=0;h<3;h++){let f=t[a*3+h];t[a*3+h]=t[o*3+h],t[o*3+h]=f}for(let h=0;h<6;h++){let f=e[a*6+h];e[a*6+h]=e[o*6+h],e[o*6+h]=f}a++,o--}else return a}}function Z2(r,t,e,i,n,s){let a=i,o=i+n-1;const l=s.pos,c=s.axis*2;for(;;){for(;a<=o&&e[a*6+c]<l;)a++;for(;a<=o&&e[o*6+c]>=l;)o--;if(a<o){let h=r[a];r[a]=r[o],r[o]=h;for(let f=0;f<6;f++){let d=e[a*6+f];e[a*6+f]=e[o*6+f],e[o*6+f]=d}a++,o--}else return a}}function t3(r,t){const e=(r.index?r.index.count:r.attributes.position.count)/3,i=e>2**16,n=i?4:2,s=t?new SharedArrayBuffer(e*n):new ArrayBuffer(e*n),a=i?new Uint32Array(s):new Uint16Array(s);for(let o=0,l=a.length;o<l;o++)a[o]=o;return a}function e3(r,t){const e=r.geometry,i=e.index?e.index.array:null,n=t.maxDepth,s=t.verbose,a=t.maxLeafTris,o=t.strategy,l=t.onProgress,c=Mn(e),h=r._indirectBuffer;let f=!1;const d=new Float32Array(6),g=new Float32Array(6),p=K2(e,d),v=t.indirect?Z2:Q2,b=[],_=t.indirect?Kh(e):qh(e);if(_.length===1){const m=_[0],y=new vr;y.boundingData=d,Y2(p,m.offset,m.count,g),u(y,m.offset,m.count,g),b.push(y)}else for(let m of _){const y=new vr;y.boundingData=new Float32Array(6),ba(p,m.offset,m.count,y.boundingData,g),u(y,m.offset,m.count,g),b.push(y)}return b;function w(m){l&&l(m/c)}function u(m,y,S,T=null,C=0){if(!f&&C>=n&&(f=!0,s&&(console.warn(`MeshBVH: Max depth of ${n} reached when generating BVH. Consider increasing maxDepth.`),console.warn(e))),S<=a||C>=n)return w(y+S),m.offset=y,m.count=S,m;const A=$2(m.boundingData,T,p,y,S,o);if(A.axis===-1)return w(y+S),m.offset=y,m.count=S,m;const k=v(h,i,p,y,S,A);if(k===y||k===y+S)w(y+S),m.offset=y,m.count=S;else{m.splitAxis=A.axis;const P=new vr,x=y,M=k-y;m.left=P,P.boundingData=new Float32Array(6),ba(p,x,M,P.boundingData,g),u(P,x,M,g,C+1);const F=new vr,N=k,I=S-M;m.right=F,F.boundingData=new Float32Array(6),ba(p,N,I,F.boundingData,g),u(F,N,I,g,C+1)}return m}}function i3(r,t){const e=r.geometry;t.indirect&&(r._indirectBuffer=t3(e,t.useSharedArrayBuffer),j2(e)&&!t.verbose&&console.warn('MeshBVH: Provided geometry contains groups that do not fully span the vertex contents while using the "indirect" option. BVH may incorrectly report intersections on unrendered portions of the geometry.')),r._indirectBuffer||W2(e,t);const i=e3(r,t);let n,s,a;const o=[],l=t.useSharedArrayBuffer?SharedArrayBuffer:ArrayBuffer;for(let f=0;f<i.length;f++){const d=i[f];let g=c(d);const p=new l(Ur*g);n=new Float32Array(p),s=new Uint32Array(p),a=new Uint16Array(p),h(0,d),o.push(p)}r._roots=o;return;function c(f){return f.count?1:1+c(f.left)+c(f.right)}function h(f,d){const g=f/4,p=f/2,v=!!d.count,b=d.boundingData;for(let _=0;_<6;_++)n[g+_]=b[_];if(v){const _=d.offset,w=d.count;return s[g+6]=_,a[p+14]=w,a[p+15]=na,f+Ur}else{const _=d.left,w=d.right,u=d.splitAxis;let m;if(m=h(f+Ur,_),m/4>Math.pow(2,32))throw new Error("MeshBVH: Cannot store child pointer greater than 32 bits.");return s[g+6]=m/4,m=h(m,w),s[g+7]=u,m}}}class Ze{constructor(){this.min=1/0,this.max=-1/0}setFromPointsField(t,e){let i=1/0,n=-1/0;for(let s=0,a=t.length;s<a;s++){const l=t[s][e];i=l<i?l:i,n=l>n?l:n}this.min=i,this.max=n}setFromPoints(t,e){let i=1/0,n=-1/0;for(let s=0,a=e.length;s<a;s++){const o=e[s],l=t.dot(o);i=l<i?l:i,n=l>n?l:n}this.min=i,this.max=n}isSeparated(t){return this.min>t.max||t.min>this.max}}Ze.prototype.setFromBox=function(){const r=new H;return function(e,i){const n=i.min,s=i.max;let a=1/0,o=-1/0;for(let l=0;l<=1;l++)for(let c=0;c<=1;c++)for(let h=0;h<=1;h++){r.x=n.x*l+s.x*(1-l),r.y=n.y*c+s.y*(1-c),r.z=n.z*h+s.z*(1-h);const f=e.dot(r);a=Math.min(f,a),o=Math.max(f,o)}this.min=a,this.max=o}}();const n3=function(){const r=new H,t=new H,e=new H;return function(n,s,a){const o=n.start,l=r,c=s.start,h=t;e.subVectors(o,c),r.subVectors(n.end,n.start),t.subVectors(s.end,s.start);const f=e.dot(h),d=h.dot(l),g=h.dot(h),p=e.dot(l),b=l.dot(l)*g-d*d;let _,w;b!==0?_=(f*d-p*g)/b:_=0,w=(f+_*d)/g,a.x=_,a.y=w}}(),No=function(){const r=new Ii,t=new H,e=new H;return function(n,s,a,o){n3(n,s,r);let l=r.x,c=r.y;if(l>=0&&l<=1&&c>=0&&c<=1){n.at(l,a),s.at(c,o);return}else if(l>=0&&l<=1){c<0?s.at(0,o):s.at(1,o),n.closestPointToPoint(o,!0,a);return}else if(c>=0&&c<=1){l<0?n.at(0,a):n.at(1,a),s.closestPointToPoint(a,!0,o);return}else{let h;l<0?h=n.start:h=n.end;let f;c<0?f=s.start:f=s.end;const d=t,g=e;if(n.closestPointToPoint(f,!0,t),s.closestPointToPoint(h,!0,e),d.distanceToSquared(f)<=g.distanceToSquared(h)){a.copy(d),o.copy(f);return}else{a.copy(h),o.copy(g);return}}}}(),r3=function(){const r=new H,t=new H,e=new co,i=new ve;return function(s,a){const{radius:o,center:l}=s,{a:c,b:h,c:f}=a;if(i.start=c,i.end=h,i.closestPointToPoint(l,!0,r).distanceTo(l)<=o||(i.start=c,i.end=f,i.closestPointToPoint(l,!0,r).distanceTo(l)<=o)||(i.start=h,i.end=f,i.closestPointToPoint(l,!0,r).distanceTo(l)<=o))return!0;const v=a.getPlane(e);if(Math.abs(v.distanceToPoint(l))<=o){const _=v.projectPoint(l,t);if(a.containsPoint(_))return!0}return!1}}(),s3=1e-15;function wa(r){return Math.abs(r)<s3}class we extends oe{constructor(...t){super(...t),this.isExtendedTriangle=!0,this.satAxes=new Array(4).fill().map(()=>new H),this.satBounds=new Array(4).fill().map(()=>new Ze),this.points=[this.a,this.b,this.c],this.sphere=new Sf,this.plane=new co,this.needsUpdate=!0}intersectsSphere(t){return r3(t,this)}update(){const t=this.a,e=this.b,i=this.c,n=this.points,s=this.satAxes,a=this.satBounds,o=s[0],l=a[0];this.getNormal(o),l.setFromPoints(o,n);const c=s[1],h=a[1];c.subVectors(t,e),h.setFromPoints(c,n);const f=s[2],d=a[2];f.subVectors(e,i),d.setFromPoints(f,n);const g=s[3],p=a[3];g.subVectors(i,t),p.setFromPoints(g,n),this.sphere.setFromPoints(this.points),this.plane.setFromNormalAndCoplanarPoint(o,t),this.needsUpdate=!1}}we.prototype.closestPointToSegment=function(){const r=new H,t=new H,e=new ve;return function(n,s=null,a=null){const{start:o,end:l}=n,c=this.points;let h,f=1/0;for(let d=0;d<3;d++){const g=(d+1)%3;e.start.copy(c[d]),e.end.copy(c[g]),No(e,n,r,t),h=r.distanceToSquared(t),h<f&&(f=h,s&&s.copy(r),a&&a.copy(t))}return this.closestPointToPoint(o,r),h=o.distanceToSquared(r),h<f&&(f=h,s&&s.copy(r),a&&a.copy(o)),this.closestPointToPoint(l,r),h=l.distanceToSquared(r),h<f&&(f=h,s&&s.copy(r),a&&a.copy(l)),Math.sqrt(f)}}();we.prototype.intersectsTriangle=function(){const r=new we,t=new Array(3),e=new Array(3),i=new Ze,n=new Ze,s=new H,a=new H,o=new H,l=new H,c=new H,h=new ve,f=new ve,d=new ve,g=new H;function p(v,b,_){const w=v.points;let u=0,m=-1;for(let y=0;y<3;y++){const{start:S,end:T}=h;S.copy(w[y]),T.copy(w[(y+1)%3]),h.delta(a);const C=wa(b.distanceToPoint(S));if(wa(b.normal.dot(a))&&C){_.copy(h),u=2;break}const A=b.intersectLine(h,g);if(!A&&C&&g.copy(S),(A||C)&&!wa(g.distanceTo(T))){if(u<=1)(u===1?_.start:_.end).copy(g),C&&(m=u);else if(u>=2){(m===1?_.start:_.end).copy(g),u=2;break}if(u++,u===2&&m===-1)break}}return u}return function(b,_=null,w=!1){this.needsUpdate&&this.update(),b.isExtendedTriangle?b.needsUpdate&&b.update():(r.copy(b),r.update(),b=r);const u=this.plane,m=b.plane;if(Math.abs(u.normal.dot(m.normal))>1-1e-10){const y=this.satBounds,S=this.satAxes;e[0]=b.a,e[1]=b.b,e[2]=b.c;for(let A=0;A<4;A++){const k=y[A],P=S[A];if(i.setFromPoints(P,e),k.isSeparated(i))return!1}const T=b.satBounds,C=b.satAxes;t[0]=this.a,t[1]=this.b,t[2]=this.c;for(let A=0;A<4;A++){const k=T[A],P=C[A];if(i.setFromPoints(P,t),k.isSeparated(i))return!1}for(let A=0;A<4;A++){const k=S[A];for(let P=0;P<4;P++){const x=C[P];if(s.crossVectors(k,x),i.setFromPoints(s,t),n.setFromPoints(s,e),i.isSeparated(n))return!1}}return _&&(w||console.warn("ExtendedTriangle.intersectsTriangle: Triangles are coplanar which does not support an output edge. Setting edge to 0, 0, 0."),_.start.set(0,0,0),_.end.set(0,0,0)),!0}else{const y=p(this,m,f);if(y===1&&b.containsPoint(f.end))return _&&(_.start.copy(f.end),_.end.copy(f.end)),!0;if(y!==2)return!1;const S=p(b,u,d);if(S===1&&this.containsPoint(d.end))return _&&(_.start.copy(d.end),_.end.copy(d.end)),!0;if(S!==2)return!1;if(f.delta(o),d.delta(l),o.dot(l)<0){let M=d.start;d.start=d.end,d.end=M}const T=f.start.dot(o),C=f.end.dot(o),A=d.start.dot(o),k=d.end.dot(o),P=C<A,x=T<k;return T!==k&&A!==C&&P===x?!1:(_&&(c.subVectors(f.start,d.start),c.dot(o)>0?_.start.copy(f.start):_.start.copy(d.start),c.subVectors(f.end,d.end),c.dot(o)<0?_.end.copy(f.end):_.end.copy(d.end)),!0)}}}();we.prototype.distanceToPoint=function(){const r=new H;return function(e){return this.closestPointToPoint(e,r),e.distanceTo(r)}}();we.prototype.distanceToTriangle=function(){const r=new H,t=new H,e=["a","b","c"],i=new ve,n=new ve;return function(a,o=null,l=null){const c=o||l?i:null;if(this.intersectsTriangle(a,c))return(o||l)&&(o&&c.getCenter(o),l&&c.getCenter(l)),0;let h=1/0;for(let f=0;f<3;f++){let d;const g=e[f],p=a[g];this.closestPointToPoint(p,r),d=p.distanceToSquared(r),d<h&&(h=d,o&&o.copy(r),l&&l.copy(p));const v=this[g];a.closestPointToPoint(v,r),d=v.distanceToSquared(r),d<h&&(h=d,o&&o.copy(v),l&&l.copy(r))}for(let f=0;f<3;f++){const d=e[f],g=e[(f+1)%3];i.set(this[d],this[g]);for(let p=0;p<3;p++){const v=e[p],b=e[(p+1)%3];n.set(a[v],a[b]),No(i,n,r,t);const _=r.distanceToSquared(t);_<h&&(h=_,o&&o.copy(r),l&&l.copy(t))}}return Math.sqrt(h)}}();class re{constructor(t,e,i){this.isOrientedBox=!0,this.min=new H,this.max=new H,this.matrix=new Re,this.invMatrix=new Re,this.points=new Array(8).fill().map(()=>new H),this.satAxes=new Array(3).fill().map(()=>new H),this.satBounds=new Array(3).fill().map(()=>new Ze),this.alignedSatBounds=new Array(3).fill().map(()=>new Ze),this.needsUpdate=!1,t&&this.min.copy(t),e&&this.max.copy(e),i&&this.matrix.copy(i)}set(t,e,i){this.min.copy(t),this.max.copy(e),this.matrix.copy(i),this.needsUpdate=!0}copy(t){this.min.copy(t.min),this.max.copy(t.max),this.matrix.copy(t.matrix),this.needsUpdate=!0}}re.prototype.update=function(){return function(){const t=this.matrix,e=this.min,i=this.max,n=this.points;for(let c=0;c<=1;c++)for(let h=0;h<=1;h++)for(let f=0;f<=1;f++){const d=1*c|2*h|4*f,g=n[d];g.x=c?i.x:e.x,g.y=h?i.y:e.y,g.z=f?i.z:e.z,g.applyMatrix4(t)}const s=this.satBounds,a=this.satAxes,o=n[0];for(let c=0;c<3;c++){const h=a[c],f=s[c],d=1<<c,g=n[d];h.subVectors(o,g),f.setFromPoints(h,n)}const l=this.alignedSatBounds;l[0].setFromPointsField(n,"x"),l[1].setFromPointsField(n,"y"),l[2].setFromPointsField(n,"z"),this.invMatrix.copy(this.matrix).invert(),this.needsUpdate=!1}}();re.prototype.intersectsBox=function(){const r=new Ze;return function(e){this.needsUpdate&&this.update();const i=e.min,n=e.max,s=this.satBounds,a=this.satAxes,o=this.alignedSatBounds;if(r.min=i.x,r.max=n.x,o[0].isSeparated(r)||(r.min=i.y,r.max=n.y,o[1].isSeparated(r))||(r.min=i.z,r.max=n.z,o[2].isSeparated(r)))return!1;for(let l=0;l<3;l++){const c=a[l],h=s[l];if(r.setFromBox(c,e),h.isSeparated(r))return!1}return!0}}();re.prototype.intersectsTriangle=function(){const r=new we,t=new Array(3),e=new Ze,i=new Ze,n=new H;return function(a){this.needsUpdate&&this.update(),a.isExtendedTriangle?a.needsUpdate&&a.update():(r.copy(a),r.update(),a=r);const o=this.satBounds,l=this.satAxes;t[0]=a.a,t[1]=a.b,t[2]=a.c;for(let d=0;d<3;d++){const g=o[d],p=l[d];if(e.setFromPoints(p,t),g.isSeparated(e))return!1}const c=a.satBounds,h=a.satAxes,f=this.points;for(let d=0;d<3;d++){const g=c[d],p=h[d];if(e.setFromPoints(p,f),g.isSeparated(e))return!1}for(let d=0;d<3;d++){const g=l[d];for(let p=0;p<4;p++){const v=h[p];if(n.crossVectors(g,v),e.setFromPoints(n,t),i.setFromPoints(n,f),e.isSeparated(i))return!1}}return!0}}();re.prototype.closestPointToPoint=function(){return function(t,e){return this.needsUpdate&&this.update(),e.copy(t).applyMatrix4(this.invMatrix).clamp(this.min,this.max).applyMatrix4(this.matrix),e}}();re.prototype.distanceToPoint=function(){const r=new H;return function(e){return this.closestPointToPoint(e,r),e.distanceTo(r)}}();re.prototype.distanceToBox=function(){const r=["x","y","z"],t=new Array(12).fill().map(()=>new ve),e=new Array(12).fill().map(()=>new ve),i=new H,n=new H;return function(a,o=0,l=null,c=null){if(this.needsUpdate&&this.update(),this.intersectsBox(a))return(l||c)&&(a.getCenter(n),this.closestPointToPoint(n,i),a.closestPointToPoint(i,n),l&&l.copy(i),c&&c.copy(n)),0;const h=o*o,f=a.min,d=a.max,g=this.points;let p=1/0;for(let b=0;b<8;b++){const _=g[b];n.copy(_).clamp(f,d);const w=_.distanceToSquared(n);if(w<p&&(p=w,l&&l.copy(_),c&&c.copy(n),w<h))return Math.sqrt(w)}let v=0;for(let b=0;b<3;b++)for(let _=0;_<=1;_++)for(let w=0;w<=1;w++){const u=(b+1)%3,m=(b+2)%3,y=_<<u|w<<m,S=1<<b|_<<u|w<<m,T=g[y],C=g[S];t[v].set(T,C);const k=r[b],P=r[u],x=r[m],M=e[v],F=M.start,N=M.end;F[k]=f[k],F[P]=_?f[P]:d[P],F[x]=w?f[x]:d[P],N[k]=d[k],N[P]=_?f[P]:d[P],N[x]=w?f[x]:d[P],v++}for(let b=0;b<=1;b++)for(let _=0;_<=1;_++)for(let w=0;w<=1;w++){n.x=b?d.x:f.x,n.y=_?d.y:f.y,n.z=w?d.z:f.z,this.closestPointToPoint(n,i);const u=n.distanceToSquared(i);if(u<p&&(p=u,l&&l.copy(i),c&&c.copy(n),u<h))return Math.sqrt(u)}for(let b=0;b<12;b++){const _=t[b];for(let w=0;w<12;w++){const u=e[w];No(_,u,i,n);const m=i.distanceToSquared(n);if(m<p&&(p=m,l&&l.copy(i),c&&c.copy(n),m<h))return Math.sqrt(m)}}return Math.sqrt(p)}}();class Lo{constructor(t){this._getNewPrimitive=t,this._primitives=[]}getPrimitive(){const t=this._primitives;return t.length===0?this._getNewPrimitive():t.pop()}releasePrimitive(t){this._primitives.push(t)}}class a3 extends Lo{constructor(){super(()=>new we)}}const ge=new a3;function ae(r,t){return t[r+15]===65535}function le(r,t){return t[r+6]}function pe(r,t){return t[r+14]}function me(r){return r+8}function _e(r,t){return t[r+6]}function $h(r,t){return t[r+7]}class o3{constructor(){this.float32Array=null,this.uint16Array=null,this.uint32Array=null;const t=[];let e=null;this.setBuffer=i=>{e&&t.push(e),e=i,this.float32Array=new Float32Array(i),this.uint16Array=new Uint16Array(i),this.uint32Array=new Uint32Array(i)},this.clearBuffer=()=>{e=null,this.float32Array=null,this.uint16Array=null,this.uint32Array=null,t.length!==0&&this.setBuffer(t.pop())}}}const Rt=new o3;let di,gn;const nn=[],yr=new Lo(()=>new Pe);function l3(r,t,e,i,n,s){di=yr.getPrimitive(),gn=yr.getPrimitive(),nn.push(di,gn),Rt.setBuffer(r._roots[t]);const a=Za(0,r.geometry,e,i,n,s);Rt.clearBuffer(),yr.releasePrimitive(di),yr.releasePrimitive(gn),nn.pop(),nn.pop();const o=nn.length;return o>0&&(gn=nn[o-1],di=nn[o-2]),a}function Za(r,t,e,i,n=null,s=0,a=0){const{float32Array:o,uint16Array:l,uint32Array:c}=Rt;let h=r*2;if(ae(h,l)){const d=le(r,c),g=pe(h,l);return Dt(r,o,di),i(d,g,!1,a,s+r,di)}else{let k=function(x){const{uint16Array:M,uint32Array:F}=Rt;let N=x*2;for(;!ae(N,M);)x=me(x),N=x*2;return le(x,F)},P=function(x){const{uint16Array:M,uint32Array:F}=Rt;let N=x*2;for(;!ae(N,M);)x=_e(x,F),N=x*2;return le(x,F)+pe(N,M)};const d=me(r),g=_e(r,c);let p=d,v=g,b,_,w,u;if(n&&(w=di,u=gn,Dt(p,o,w),Dt(v,o,u),b=n(w),_=n(u),_<b)){p=g,v=d;const x=b;b=_,_=x,w=u}w||(w=di,Dt(p,o,w));const m=ae(p*2,l),y=e(w,m,b,a+1,s+p);let S;if(y===jl){const x=k(p),F=P(p)-x;S=i(x,F,!0,a+1,s+p,w)}else S=y&&Za(p,t,e,i,n,s,a+1);if(S)return!0;u=gn,Dt(v,o,u);const T=ae(v*2,l),C=e(u,T,_,a+1,s+v);let A;if(C===jl){const x=k(v),F=P(v)-x;A=i(x,F,!0,a+1,s+v,u)}else A=C&&Za(v,t,e,i,n,s,a+1);return!!A}}const Dn=new H,Sa=new H;function c3(r,t,e={},i=0,n=1/0){const s=i*i,a=n*n;let o=1/0,l=null;if(r.shapecast({boundsTraverseOrder:h=>(Dn.copy(t).clamp(h.min,h.max),Dn.distanceToSquared(t)),intersectsBounds:(h,f,d)=>d<o&&d<a,intersectsTriangle:(h,f)=>{h.closestPointToPoint(t,Dn);const d=t.distanceToSquared(Dn);return d<o&&(Sa.copy(Dn),o=d,l=f),d<s}}),o===1/0)return null;const c=Math.sqrt(o);return e.point?e.point.copy(Sa):e.point=Sa.clone(),e.distance=c,e.faceIndex=l,e}const rn=new H,sn=new H,an=new H,br=new Ii,wr=new Ii,Sr=new Ii,$l=new H,Jl=new H,Ql=new H,Cr=new H;function h3(r,t,e,i,n,s){let a;return s===Cf?a=r.intersectTriangle(i,e,t,!0,n):a=r.intersectTriangle(t,e,i,s!==ho,n),a===null?null:{distance:r.origin.distanceTo(n),point:n.clone()}}function f3(r,t,e,i,n,s,a,o,l){rn.fromBufferAttribute(t,s),sn.fromBufferAttribute(t,a),an.fromBufferAttribute(t,o);const c=h3(r,rn,sn,an,Cr,l);if(c){i&&(br.fromBufferAttribute(i,s),wr.fromBufferAttribute(i,a),Sr.fromBufferAttribute(i,o),c.uv=oe.getInterpolation(Cr,rn,sn,an,br,wr,Sr,new Ii)),n&&(br.fromBufferAttribute(n,s),wr.fromBufferAttribute(n,a),Sr.fromBufferAttribute(n,o),c.uv1=oe.getInterpolation(Cr,rn,sn,an,br,wr,Sr,new Ii)),e&&($l.fromBufferAttribute(e,s),Jl.fromBufferAttribute(e,a),Ql.fromBufferAttribute(e,o),c.normal=oe.getInterpolation(Cr,rn,sn,an,$l,Jl,Ql,new H),c.normal.dot(r.direction)>0&&c.normal.multiplyScalar(-1));const h={a:s,b:a,c:o,normal:new H,materialIndex:0};oe.getNormal(rn,sn,an,h.normal),c.face=h,c.faceIndex=s}return c}function ra(r,t,e,i,n){const s=i*3;let a=s+0,o=s+1,l=s+2;const c=r.index;r.index&&(a=c.getX(a),o=c.getX(o),l=c.getX(l));const{position:h,normal:f,uv:d,uv1:g}=r.attributes,p=f3(e,h,f,d,g,a,o,l,t);return p?(p.faceIndex=i,n&&n.push(p),p):null}function jt(r,t,e,i){const n=r.a,s=r.b,a=r.c;let o=t,l=t+1,c=t+2;e&&(o=e.getX(o),l=e.getX(l),c=e.getX(c)),n.x=i.getX(o),n.y=i.getY(o),n.z=i.getZ(o),s.x=i.getX(l),s.y=i.getY(l),s.z=i.getZ(l),a.x=i.getX(c),a.y=i.getY(c),a.z=i.getZ(c)}function u3(r,t,e,i,n,s){const{geometry:a,_indirectBuffer:o}=r;for(let l=i,c=i+n;l<c;l++)ra(a,t,e,l,s)}function d3(r,t,e,i,n){const{geometry:s,_indirectBuffer:a}=r;let o=1/0,l=null;for(let c=i,h=i+n;c<h;c++){let f;f=ra(s,t,e,c),f&&f.distance<o&&(l=f,o=f.distance)}return l}function g3(r,t,e,i,n,s,a){const{geometry:o}=e,{index:l}=o,c=o.attributes.position;for(let h=r,f=t+r;h<f;h++){let d;if(d=h,jt(a,d*3,l,c),a.needsUpdate=!0,i(a,d,n,s))return!0}return!1}function p3(r,t=null){t&&Array.isArray(t)&&(t=new Set(t));const e=r.geometry,i=e.index?e.index.array:null,n=e.attributes.position;let s,a,o,l,c=0;const h=r._roots;for(let d=0,g=h.length;d<g;d++)s=h[d],a=new Uint32Array(s),o=new Uint16Array(s),l=new Float32Array(s),f(0,c),c+=s.byteLength;function f(d,g,p=!1){const v=d*2;if(o[v+15]===na){const _=a[d+6],w=o[v+14];let u=1/0,m=1/0,y=1/0,S=-1/0,T=-1/0,C=-1/0;for(let A=3*_,k=3*(_+w);A<k;A++){let P=i[A];const x=n.getX(P),M=n.getY(P),F=n.getZ(P);x<u&&(u=x),x>S&&(S=x),M<m&&(m=M),M>T&&(T=M),F<y&&(y=F),F>C&&(C=F)}return l[d+0]!==u||l[d+1]!==m||l[d+2]!==y||l[d+3]!==S||l[d+4]!==T||l[d+5]!==C?(l[d+0]=u,l[d+1]=m,l[d+2]=y,l[d+3]=S,l[d+4]=T,l[d+5]=C,!0):!1}else{const _=d+8,w=a[d+6],u=_+g,m=w+g;let y=p,S=!1,T=!1;t?y||(S=t.has(u),T=t.has(m),y=!S&&!T):(S=!0,T=!0);const C=y||S,A=y||T;let k=!1;C&&(k=f(_,g,y));let P=!1;A&&(P=f(w,g,y));const x=k||P;if(x)for(let M=0;M<3;M++){const F=_+M,N=w+M,I=l[F],V=l[F+3],Z=l[N],lt=l[N+3];l[d+M]=I<Z?I:Z,l[d+M+3]=V>lt?V:lt}return x}}}const Zl=new Pe;function bi(r,t,e,i){return Dt(r,t,Zl),e.intersectBox(Zl,i)}function m3(r,t,e,i,n,s){const{geometry:a,_indirectBuffer:o}=r;for(let l=i,c=i+n;l<c;l++){let h=o?o[l]:l;ra(a,t,e,h,s)}}function _3(r,t,e,i,n){const{geometry:s,_indirectBuffer:a}=r;let o=1/0,l=null;for(let c=i,h=i+n;c<h;c++){let f;f=ra(s,t,e,a?a[c]:c),f&&f.distance<o&&(l=f,o=f.distance)}return l}function v3(r,t,e,i,n,s,a){const{geometry:o}=e,{index:l}=o,c=o.attributes.position;for(let h=r,f=t+r;h<f;h++){let d;if(d=e.resolveTriangleIndex(h),jt(a,d*3,l,c),a.needsUpdate=!0,i(a,d,n,s))return!0}return!1}const tc=new H;function y3(r,t,e,i,n){Rt.setBuffer(r._roots[t]),to(0,r,e,i,n),Rt.clearBuffer()}function to(r,t,e,i,n){const{float32Array:s,uint16Array:a,uint32Array:o}=Rt,l=r*2;if(ae(l,a)){const h=le(r,o),f=pe(l,a);u3(t,e,i,h,f,n)}else{const h=me(r);bi(h,s,i,tc)&&to(h,t,e,i,n);const f=_e(r,o);bi(f,s,i,tc)&&to(f,t,e,i,n)}}const ec=new H,b3=["x","y","z"];function w3(r,t,e,i){Rt.setBuffer(r._roots[t]);const n=eo(0,r,e,i);return Rt.clearBuffer(),n}function eo(r,t,e,i){const{float32Array:n,uint16Array:s,uint32Array:a}=Rt;let o=r*2;if(ae(o,s)){const c=le(r,a),h=pe(o,s);return d3(t,e,i,c,h)}else{const c=$h(r,a),h=b3[c],d=i.direction[h]>=0;let g,p;d?(g=me(r),p=_e(r,a)):(g=_e(r,a),p=me(r));const b=bi(g,n,i,ec)?eo(g,t,e,i):null;if(b){const u=b.point[h];if(d?u<=n[p+c]:u>=n[p+c+3])return b}const w=bi(p,n,i,ec)?eo(p,t,e,i):null;return b&&w?b.distance<=w.distance?b:w:b||w||null}}const Ar=new Pe,on=new we,ln=new we,In=new Re,ic=new re,Tr=new re;function S3(r,t,e,i){Rt.setBuffer(r._roots[t]);const n=io(0,r,e,i);return Rt.clearBuffer(),n}function io(r,t,e,i,n=null){const{float32Array:s,uint16Array:a,uint32Array:o}=Rt;let l=r*2;if(n===null&&(e.boundingBox||e.computeBoundingBox(),ic.set(e.boundingBox.min,e.boundingBox.max,i),n=ic),ae(l,a)){const h=t.geometry,f=h.index,d=h.attributes.position,g=e.index,p=e.attributes.position,v=le(r,o),b=pe(l,a);if(In.copy(i).invert(),e.boundsTree)return Dt(r,s,Tr),Tr.matrix.copy(In),Tr.needsUpdate=!0,e.boundsTree.shapecast({intersectsBounds:w=>Tr.intersectsBox(w),intersectsTriangle:w=>{w.a.applyMatrix4(i),w.b.applyMatrix4(i),w.c.applyMatrix4(i),w.needsUpdate=!0;for(let u=v*3,m=(b+v)*3;u<m;u+=3)if(jt(ln,u,f,d),ln.needsUpdate=!0,w.intersectsTriangle(ln))return!0;return!1}});for(let _=v*3,w=(b+v)*3;_<w;_+=3){jt(on,_,f,d),on.a.applyMatrix4(In),on.b.applyMatrix4(In),on.c.applyMatrix4(In),on.needsUpdate=!0;for(let u=0,m=g.count;u<m;u+=3)if(jt(ln,u,g,p),ln.needsUpdate=!0,on.intersectsTriangle(ln))return!0}}else{const h=r+8,f=o[r+6];return Dt(h,s,Ar),!!(n.intersectsBox(Ar)&&io(h,t,e,i,n)||(Dt(f,s,Ar),n.intersectsBox(Ar)&&io(f,t,e,i,n)))}}const kr=new Re,Ca=new re,Bn=new re,C3=new H,A3=new H,T3=new H,k3=new H;function P3(r,t,e,i={},n={},s=0,a=1/0){t.boundingBox||t.computeBoundingBox(),Ca.set(t.boundingBox.min,t.boundingBox.max,e),Ca.needsUpdate=!0;const o=r.geometry,l=o.attributes.position,c=o.index,h=t.attributes.position,f=t.index,d=ge.getPrimitive(),g=ge.getPrimitive();let p=C3,v=A3,b=null,_=null;n&&(b=T3,_=k3);let w=1/0,u=null,m=null;return kr.copy(e).invert(),Bn.matrix.copy(kr),r.shapecast({boundsTraverseOrder:y=>Ca.distanceToBox(y),intersectsBounds:(y,S,T)=>T<w&&T<a?(S&&(Bn.min.copy(y.min),Bn.max.copy(y.max),Bn.needsUpdate=!0),!0):!1,intersectsRange:(y,S)=>{if(t.boundsTree)return t.boundsTree.shapecast({boundsTraverseOrder:C=>Bn.distanceToBox(C),intersectsBounds:(C,A,k)=>k<w&&k<a,intersectsRange:(C,A)=>{for(let k=C,P=C+A;k<P;k++){jt(g,3*k,f,h),g.a.applyMatrix4(e),g.b.applyMatrix4(e),g.c.applyMatrix4(e),g.needsUpdate=!0;for(let x=y,M=y+S;x<M;x++){jt(d,3*x,c,l),d.needsUpdate=!0;const F=d.distanceToTriangle(g,p,b);if(F<w&&(v.copy(p),_&&_.copy(b),w=F,u=x,m=k),F<s)return!0}}}});{const T=Mn(t);for(let C=0,A=T;C<A;C++){jt(g,3*C,f,h),g.a.applyMatrix4(e),g.b.applyMatrix4(e),g.c.applyMatrix4(e),g.needsUpdate=!0;for(let k=y,P=y+S;k<P;k++){jt(d,3*k,c,l),d.needsUpdate=!0;const x=d.distanceToTriangle(g,p,b);if(x<w&&(v.copy(p),_&&_.copy(b),w=x,u=k,m=C),x<s)return!0}}}}}),ge.releasePrimitive(d),ge.releasePrimitive(g),w===1/0?null:(i.point?i.point.copy(v):i.point=v.clone(),i.distance=w,i.faceIndex=u,n&&(n.point?n.point.copy(_):n.point=_.clone(),n.point.applyMatrix4(kr),v.applyMatrix4(kr),n.distance=v.sub(n.point).length(),n.faceIndex=m),i)}function x3(r,t=null){t&&Array.isArray(t)&&(t=new Set(t));const e=r.geometry,i=e.index?e.index.array:null,n=e.attributes.position;let s,a,o,l,c=0;const h=r._roots;for(let d=0,g=h.length;d<g;d++)s=h[d],a=new Uint32Array(s),o=new Uint16Array(s),l=new Float32Array(s),f(0,c),c+=s.byteLength;function f(d,g,p=!1){const v=d*2;if(o[v+15]===na){const _=a[d+6],w=o[v+14];let u=1/0,m=1/0,y=1/0,S=-1/0,T=-1/0,C=-1/0;for(let A=_,k=_+w;A<k;A++){const P=3*r.resolveTriangleIndex(A);for(let x=0;x<3;x++){let M=P+x;M=i?i[M]:M;const F=n.getX(M),N=n.getY(M),I=n.getZ(M);F<u&&(u=F),F>S&&(S=F),N<m&&(m=N),N>T&&(T=N),I<y&&(y=I),I>C&&(C=I)}}return l[d+0]!==u||l[d+1]!==m||l[d+2]!==y||l[d+3]!==S||l[d+4]!==T||l[d+5]!==C?(l[d+0]=u,l[d+1]=m,l[d+2]=y,l[d+3]=S,l[d+4]=T,l[d+5]=C,!0):!1}else{const _=d+8,w=a[d+6],u=_+g,m=w+g;let y=p,S=!1,T=!1;t?y||(S=t.has(u),T=t.has(m),y=!S&&!T):(S=!0,T=!0);const C=y||S,A=y||T;let k=!1;C&&(k=f(_,g,y));let P=!1;A&&(P=f(w,g,y));const x=k||P;if(x)for(let M=0;M<3;M++){const F=_+M,N=w+M,I=l[F],V=l[F+3],Z=l[N],lt=l[N+3];l[d+M]=I<Z?I:Z,l[d+M+3]=V>lt?V:lt}return x}}}const nc=new H;function E3(r,t,e,i,n){Rt.setBuffer(r._roots[t]),no(0,r,e,i,n),Rt.clearBuffer()}function no(r,t,e,i,n){const{float32Array:s,uint16Array:a,uint32Array:o}=Rt,l=r*2;if(ae(l,a)){const h=le(r,o),f=pe(l,a);m3(t,e,i,h,f,n)}else{const h=me(r);bi(h,s,i,nc)&&no(h,t,e,i,n);const f=_e(r,o);bi(f,s,i,nc)&&no(f,t,e,i,n)}}const rc=new H,M3=["x","y","z"];function F3(r,t,e,i){Rt.setBuffer(r._roots[t]);const n=ro(0,r,e,i);return Rt.clearBuffer(),n}function ro(r,t,e,i){const{float32Array:n,uint16Array:s,uint32Array:a}=Rt;let o=r*2;if(ae(o,s)){const c=le(r,a),h=pe(o,s);return _3(t,e,i,c,h)}else{const c=$h(r,a),h=M3[c],d=i.direction[h]>=0;let g,p;d?(g=me(r),p=_e(r,a)):(g=_e(r,a),p=me(r));const b=bi(g,n,i,rc)?ro(g,t,e,i):null;if(b){const u=b.point[h];if(d?u<=n[p+c]:u>=n[p+c+3])return b}const w=bi(p,n,i,rc)?ro(p,t,e,i):null;return b&&w?b.distance<=w.distance?b:w:b||w||null}}const Pr=new Pe,cn=new we,hn=new we,Gn=new Re,sc=new re,xr=new re;function R3(r,t,e,i){Rt.setBuffer(r._roots[t]);const n=so(0,r,e,i);return Rt.clearBuffer(),n}function so(r,t,e,i,n=null){const{float32Array:s,uint16Array:a,uint32Array:o}=Rt;let l=r*2;if(n===null&&(e.boundingBox||e.computeBoundingBox(),sc.set(e.boundingBox.min,e.boundingBox.max,i),n=sc),ae(l,a)){const h=t.geometry,f=h.index,d=h.attributes.position,g=e.index,p=e.attributes.position,v=le(r,o),b=pe(l,a);if(Gn.copy(i).invert(),e.boundsTree)return Dt(r,s,xr),xr.matrix.copy(Gn),xr.needsUpdate=!0,e.boundsTree.shapecast({intersectsBounds:w=>xr.intersectsBox(w),intersectsTriangle:w=>{w.a.applyMatrix4(i),w.b.applyMatrix4(i),w.c.applyMatrix4(i),w.needsUpdate=!0;for(let u=v,m=b+v;u<m;u++)if(jt(hn,3*t.resolveTriangleIndex(u),f,d),hn.needsUpdate=!0,w.intersectsTriangle(hn))return!0;return!1}});for(let _=v,w=b+v;_<w;_++){const u=t.resolveTriangleIndex(_);jt(cn,3*u,f,d),cn.a.applyMatrix4(Gn),cn.b.applyMatrix4(Gn),cn.c.applyMatrix4(Gn),cn.needsUpdate=!0;for(let m=0,y=g.count;m<y;m+=3)if(jt(hn,m,g,p),hn.needsUpdate=!0,cn.intersectsTriangle(hn))return!0}}else{const h=r+8,f=o[r+6];return Dt(h,s,Pr),!!(n.intersectsBox(Pr)&&so(h,t,e,i,n)||(Dt(f,s,Pr),n.intersectsBox(Pr)&&so(f,t,e,i,n)))}}const Er=new Re,Aa=new re,Un=new re,N3=new H,L3=new H,O3=new H,D3=new H;function I3(r,t,e,i={},n={},s=0,a=1/0){t.boundingBox||t.computeBoundingBox(),Aa.set(t.boundingBox.min,t.boundingBox.max,e),Aa.needsUpdate=!0;const o=r.geometry,l=o.attributes.position,c=o.index,h=t.attributes.position,f=t.index,d=ge.getPrimitive(),g=ge.getPrimitive();let p=N3,v=L3,b=null,_=null;n&&(b=O3,_=D3);let w=1/0,u=null,m=null;return Er.copy(e).invert(),Un.matrix.copy(Er),r.shapecast({boundsTraverseOrder:y=>Aa.distanceToBox(y),intersectsBounds:(y,S,T)=>T<w&&T<a?(S&&(Un.min.copy(y.min),Un.max.copy(y.max),Un.needsUpdate=!0),!0):!1,intersectsRange:(y,S)=>{if(t.boundsTree){const T=t.boundsTree;return T.shapecast({boundsTraverseOrder:C=>Un.distanceToBox(C),intersectsBounds:(C,A,k)=>k<w&&k<a,intersectsRange:(C,A)=>{for(let k=C,P=C+A;k<P;k++){const x=T.resolveTriangleIndex(k);jt(g,3*x,f,h),g.a.applyMatrix4(e),g.b.applyMatrix4(e),g.c.applyMatrix4(e),g.needsUpdate=!0;for(let M=y,F=y+S;M<F;M++){const N=r.resolveTriangleIndex(M);jt(d,3*N,c,l),d.needsUpdate=!0;const I=d.distanceToTriangle(g,p,b);if(I<w&&(v.copy(p),_&&_.copy(b),w=I,u=M,m=k),I<s)return!0}}}})}else{const T=Mn(t);for(let C=0,A=T;C<A;C++){jt(g,3*C,f,h),g.a.applyMatrix4(e),g.b.applyMatrix4(e),g.c.applyMatrix4(e),g.needsUpdate=!0;for(let k=y,P=y+S;k<P;k++){const x=r.resolveTriangleIndex(k);jt(d,3*x,c,l),d.needsUpdate=!0;const M=d.distanceToTriangle(g,p,b);if(M<w&&(v.copy(p),_&&_.copy(b),w=M,u=k,m=C),M<s)return!0}}}}}),ge.releasePrimitive(d),ge.releasePrimitive(g),w===1/0?null:(i.point?i.point.copy(v):i.point=v.clone(),i.distance=w,i.faceIndex=u,n&&(n.point?n.point.copy(_):n.point=_.clone(),n.point.applyMatrix4(Er),v.applyMatrix4(Er),n.distance=v.sub(n.point).length(),n.faceIndex=m),i)}function B3(){return typeof SharedArrayBuffer<"u"}const Wn=new Rt.constructor,es=new Rt.constructor,fi=new Lo(()=>new Pe),fn=new Pe,un=new Pe,Ta=new Pe,ka=new Pe;let Pa=!1;function G3(r,t,e,i){if(Pa)throw new Error("MeshBVH: Recursive calls to bvhcast not supported.");Pa=!0;const n=r._roots,s=t._roots;let a,o=0,l=0;const c=new Re().copy(e).invert();for(let h=0,f=n.length;h<f;h++){Wn.setBuffer(n[h]),l=0;const d=fi.getPrimitive();Dt(0,Wn.float32Array,d),d.applyMatrix4(c);for(let g=0,p=s.length;g<p&&(es.setBuffer(s[h]),a=Se(0,0,e,c,i,o,l,0,0,d),es.clearBuffer(),l+=s[g].length,!a);g++);if(fi.releasePrimitive(d),Wn.clearBuffer(),o+=n[h].length,a)break}return Pa=!1,a}function Se(r,t,e,i,n,s=0,a=0,o=0,l=0,c=null,h=!1){let f,d;h?(f=es,d=Wn):(f=Wn,d=es);const g=f.float32Array,p=f.uint32Array,v=f.uint16Array,b=d.float32Array,_=d.uint32Array,w=d.uint16Array,u=r*2,m=t*2,y=ae(u,v),S=ae(m,w);let T=!1;if(S&&y)h?T=n(le(t,_),pe(t*2,w),le(r,p),pe(r*2,v),l,a+t,o,s+r):T=n(le(r,p),pe(r*2,v),le(t,_),pe(t*2,w),o,s+r,l,a+t);else if(S){const C=fi.getPrimitive();Dt(t,b,C),C.applyMatrix4(e);const A=me(r),k=_e(r,p);Dt(A,g,fn),Dt(k,g,un);const P=C.intersectsBox(fn),x=C.intersectsBox(un);T=P&&Se(t,A,i,e,n,a,s,l,o+1,C,!h)||x&&Se(t,k,i,e,n,a,s,l,o+1,C,!h),fi.releasePrimitive(C)}else{const C=me(t),A=_e(t,_);Dt(C,b,Ta),Dt(A,b,ka);const k=c.intersectsBox(Ta),P=c.intersectsBox(ka);if(k&&P)T=Se(r,C,e,i,n,s,a,o,l+1,c,h)||Se(r,A,e,i,n,s,a,o,l+1,c,h);else if(k)if(y)T=Se(r,C,e,i,n,s,a,o,l+1,c,h);else{const x=fi.getPrimitive();x.copy(Ta).applyMatrix4(e);const M=me(r),F=_e(r,p);Dt(M,g,fn),Dt(F,g,un);const N=x.intersectsBox(fn),I=x.intersectsBox(un);T=N&&Se(C,M,i,e,n,a,s,l,o+1,x,!h)||I&&Se(C,F,i,e,n,a,s,l,o+1,x,!h),fi.releasePrimitive(x)}else if(P)if(y)T=Se(r,A,e,i,n,s,a,o,l+1,c,h);else{const x=fi.getPrimitive();x.copy(ka).applyMatrix4(e);const M=me(r),F=_e(r,p);Dt(M,g,fn),Dt(F,g,un);const N=x.intersectsBox(fn),I=x.intersectsBox(un);T=N&&Se(A,M,i,e,n,a,s,l,o+1,x,!h)||I&&Se(A,F,i,e,n,a,s,l,o+1,x,!h),fi.releasePrimitive(x)}}return T}const Mr=new re,ac=new Pe;class Oo{static serialize(t,e={}){e={cloneBuffers:!0,...e};const i=t.geometry,n=t._roots,s=t._indirectBuffer,a=i.getIndex();let o;return e.cloneBuffers?o={roots:n.map(l=>l.slice()),index:a.array.slice(),indirectBuffer:s?s.slice():null}:o={roots:n,index:a.array,indirectBuffer:s},o}static deserialize(t,e,i={}){i={setIndex:!0,indirect:!!t.indirectBuffer,...i};const{index:n,roots:s,indirectBuffer:a}=t,o=new Oo(e,{...i,[ya]:!0});if(o._roots=s,o._indirectBuffer=a||null,i.setIndex){const l=e.getIndex();if(l===null){const c=new os(t.index,1,!1);e.setIndex(c)}else l.array!==n&&(l.array.set(n),l.needsUpdate=!0)}return o}get indirect(){return!!this._indirectBuffer}constructor(t,e={}){if(t.isBufferGeometry){if(t.index&&t.index.isInterleavedBufferAttribute)throw new Error("MeshBVH: InterleavedBufferAttribute is not supported for the index attribute.")}else throw new Error("MeshBVH: Only BufferGeometries are supported.");if(e=Object.assign({strategy:Yh,maxDepth:40,maxLeafTris:10,verbose:!0,useSharedArrayBuffer:!1,setBoundingBox:!0,onProgress:null,indirect:!1,[ya]:!1},e),e.useSharedArrayBuffer&&!B3())throw new Error("MeshBVH: SharedArrayBuffer is not available.");this.geometry=t,this._roots=null,this._indirectBuffer=null,e[ya]||(i3(this,e),!t.boundingBox&&e.setBoundingBox&&(t.boundingBox=this.getBoundingBox(new Pe)));const{_indirectBuffer:i}=this;this.resolveTriangleIndex=e.indirect?n=>i[n]:n=>n}refit(t=null){return(this.indirect?x3:p3)(this,t)}traverse(t,e=0){const i=this._roots[e],n=new Uint32Array(i),s=new Uint16Array(i);a(0);function a(o,l=0){const c=o*2,h=s[c+15]===na;if(h){const f=n[o+6],d=s[c+14];t(l,h,new Float32Array(i,o*4,6),f,d)}else{const f=o+Ur/4,d=n[o+6],g=n[o+7];t(l,h,new Float32Array(i,o*4,6),g)||(a(f,l+1),a(d,l+1))}}}raycast(t,e=Uo){const i=this._roots,n=this.geometry,s=[],a=e.isMaterial,o=Array.isArray(e),l=n.groups,c=a?e.side:e,h=this.indirect?E3:y3;for(let f=0,d=i.length;f<d;f++){const g=o?e[l[f].materialIndex].side:c,p=s.length;if(h(this,f,g,t,s),o){const v=l[f].materialIndex;for(let b=p,_=s.length;b<_;b++)s[b].face.materialIndex=v}}return s}raycastFirst(t,e=Uo){const i=this._roots,n=this.geometry,s=e.isMaterial,a=Array.isArray(e);let o=null;const l=n.groups,c=s?e.side:e,h=this.indirect?F3:w3;for(let f=0,d=i.length;f<d;f++){const g=a?e[l[f].materialIndex].side:c,p=h(this,f,g,t);p!=null&&(o==null||p.distance<o.distance)&&(o=p,a&&(p.face.materialIndex=l[f].materialIndex))}return o}intersectsGeometry(t,e){let i=!1;const n=this._roots,s=this.indirect?R3:S3;for(let a=0,o=n.length;a<o&&(i=s(this,a,t,e),!i);a++);return i}shapecast(t){const e=ge.getPrimitive(),i=this.indirect?v3:g3;let{boundsTraverseOrder:n,intersectsBounds:s,intersectsRange:a,intersectsTriangle:o}=t;if(a&&o){const f=a;a=(d,g,p,v,b)=>f(d,g,p,v,b)?!0:i(d,g,this,o,p,v,e)}else a||(o?a=(f,d,g,p)=>i(f,d,this,o,g,p,e):a=(f,d,g)=>g);let l=!1,c=0;const h=this._roots;for(let f=0,d=h.length;f<d;f++){const g=h[f];if(l=l3(this,f,s,a,n,c),l)break;c+=g.byteLength}return ge.releasePrimitive(e),l}bvhcast(t,e,i){let{intersectsRanges:n,intersectsTriangles:s}=i;const a=ge.getPrimitive(),o=this.geometry.index,l=this.geometry.attributes.position,c=this.indirect?p=>{const v=this.resolveTriangleIndex(p);jt(a,v*3,o,l)}:p=>{jt(a,p*3,o,l)},h=ge.getPrimitive(),f=t.geometry.index,d=t.geometry.attributes.position,g=t.indirect?p=>{const v=t.resolveTriangleIndex(p);jt(h,v*3,f,d)}:p=>{jt(h,p*3,f,d)};if(s){const p=(v,b,_,w,u,m,y,S)=>{for(let T=_,C=_+w;T<C;T++){g(T),h.a.applyMatrix4(e),h.b.applyMatrix4(e),h.c.applyMatrix4(e),h.needsUpdate=!0;for(let A=v,k=v+b;A<k;A++)if(c(A),a.needsUpdate=!0,s(a,h,A,T,u,m,y,S))return!0}return!1};if(n){const v=n;n=function(b,_,w,u,m,y,S,T){return v(b,_,w,u,m,y,S,T)?!0:p(b,_,w,u,m,y,S,T)}}else n=p}return G3(this,t,e,n)}intersectsBox(t,e){return Mr.set(t.min,t.max,e),Mr.needsUpdate=!0,this.shapecast({intersectsBounds:i=>Mr.intersectsBox(i),intersectsTriangle:i=>Mr.intersectsTriangle(i)})}intersectsSphere(t){return this.shapecast({intersectsBounds:e=>t.intersectsBox(e),intersectsTriangle:e=>e.intersectsSphere(t)})}closestPointToGeometry(t,e,i={},n={},s=0,a=1/0){return(this.indirect?I3:P3)(this,t,e,i,n,s,a)}closestPointToPoint(t,e={},i=0,n=1/0){return c3(this,t,e,i,n)}getBoundingBox(t){return t.makeEmpty(),this._roots.forEach(i=>{Dt(0,new Float32Array(i),ac),t.union(ac)}),t}}const Jh=1e-6,U3=Jh*.5,Qh=Math.pow(10,-Math.log10(Jh)),V3=U3*Qh;function Fe(r){return~~(r*Qh+V3)}function z3(r){return`${Fe(r.x)},${Fe(r.y)}`}function oc(r){return`${Fe(r.x)},${Fe(r.y)},${Fe(r.z)}`}function H3(r){return`${Fe(r.x)},${Fe(r.y)},${Fe(r.z)},${Fe(r.w)}`}function W3(r,t,e){e.direction.subVectors(t,r).normalize();const i=r.dot(e.direction);return e.origin.copy(r).addScaledVector(e.direction,-i),e}function Zh(){return typeof SharedArrayBuffer<"u"}function j3(r){if(r.buffer instanceof SharedArrayBuffer)return r;const t=r.constructor,e=r.buffer,i=new SharedArrayBuffer(e.byteLength),n=new Uint8Array(e);return new Uint8Array(i).set(n,0),new t(i)}function X3(r,t=ArrayBuffer){return r>65535?new Uint32Array(new t(4*r)):new Uint16Array(new t(2*r))}function Y3(r,t){if(!r.index){const e=r.attributes.position.count,i=t.useSharedArrayBuffer?SharedArrayBuffer:ArrayBuffer,n=X3(e,i);r.setIndex(new os(n,1));for(let s=0;s<e;s++)n[s]=s}}function K3(r){return r.index?r.index.count:r.attributes.position.count}function Do(r){return K3(r)/3}const q3=1e-8,$3=new H;function J3(r){return~~(r/3)}function Q3(r){return r%3}function lc(r,t){return r.start-t.start}function cc(r,t){return $3.subVectors(t,r.origin).dot(r.direction)}function Z3(r,t,e,i=q3){r.sort(lc),t.sort(lc);for(let o=0;o<r.length;o++){const l=r[o];for(let c=0;c<t.length;c++){const h=t[c];if(!(h.start>l.end)){if(l.end<h.start||h.end<l.start)continue;if(l.start<=h.start&&l.end>=h.end)s(h.end,l.end)||r.splice(o+1,0,{start:h.end,end:l.end,index:l.index}),l.end=h.start,h.start=0,h.end=0;else if(l.start>=h.start&&l.end<=h.end)s(l.end,h.end)||t.splice(c+1,0,{start:l.end,end:h.end,index:h.index}),h.end=l.start,l.start=0,l.end=0;else if(l.start<=h.start&&l.end<=h.end){const f=l.end;l.end=h.start,h.start=f}else if(l.start>=h.start&&l.end>=h.end){const f=h.end;h.end=l.start,l.start=f}else throw new Error}if(e.has(l.index)||e.set(l.index,[]),e.has(h.index)||e.set(h.index,[]),e.get(l.index).push(h.index),e.get(h.index).push(l.index),a(h)&&(t.splice(c,1),c--),a(l)){r.splice(o,1),o--;break}}}n(r),n(t);function n(o){for(let l=0;l<o.length;l++)a(o[l])&&(o.splice(l,1),l--)}function s(o,l){return Math.abs(l-o)<i}function a(o){return Math.abs(o.end-o.start)<i}}const hc=1e-5,fc=1e-4;class t5{constructor(){this._rays=[]}addRay(t){this._rays.push(t)}findClosestRay(t){const e=this._rays,i=t.clone();i.direction.multiplyScalar(-1);let n=1/0,s=null;for(let l=0,c=e.length;l<c;l++){const h=e[l];if(a(h,t)&&a(h,i))continue;const f=o(h,t),d=o(h,i),g=Math.min(f,d);g<n&&(n=g,s=h)}return s;function a(l,c){const h=l.origin.distanceTo(c.origin)>hc;return l.direction.angleTo(c.direction)>fc||h}function o(l,c){const h=l.origin.distanceTo(c.origin),f=l.direction.angleTo(c.direction);return h/hc+f/fc}}}const xa=new H,Ea=new H,Fr=new zc;function e5(r,t,e){const i=r.attributes,n=r.index,s=i.position,a=new Map,o=new Map,l=Array.from(t),c=new t5;for(let h=0,f=l.length;h<f;h++){const d=l[h],g=J3(d),p=Q3(d);let v=3*g+p,b=3*g+(p+1)%3;n&&(v=n.getX(v),b=n.getX(b)),xa.fromBufferAttribute(s,v),Ea.fromBufferAttribute(s,b),W3(xa,Ea,Fr);let _,w=c.findClosestRay(Fr);w===null&&(w=Fr.clone(),c.addRay(w)),o.has(w)||o.set(w,{forward:[],reverse:[],ray:w}),_=o.get(w);let u=cc(w,xa),m=cc(w,Ea);u>m&&([u,m]=[m,u]),Fr.direction.dot(w.direction)<0?_.reverse.push({start:u,end:m,index:d}):_.forward.push({start:u,end:m,index:d})}return o.forEach(({forward:h,reverse:f},d)=>{Z3(h,f,a,e),h.length===0&&f.length===0&&o.delete(d)}),{disjointConnectivityMap:a,fragmentMap:o}}const i5=new Ii,Ma=new H,n5=new Hi,Fa=["","",""];class r5{constructor(t=null){this.data=null,this.disjointConnections=null,this.unmatchedDisjointEdges=null,this.unmatchedEdges=-1,this.matchedEdges=-1,this.useDrawRange=!0,this.useAllAttributes=!1,this.matchDisjointEdges=!1,this.degenerateEpsilon=1e-8,t&&this.updateFrom(t)}getSiblingTriangleIndex(t,e){const i=this.data[t*3+e];return i===-1?-1:~~(i/3)}getSiblingEdgeIndex(t,e){const i=this.data[t*3+e];return i===-1?-1:i%3}getDisjointSiblingTriangleIndices(t,e){const i=t*3+e,n=this.disjointConnections.get(i);return n?n.map(s=>~~(s/3)):[]}getDisjointSiblingEdgeIndices(t,e){const i=t*3+e,n=this.disjointConnections.get(i);return n?n.map(s=>s%3):[]}isFullyConnected(){return this.unmatchedEdges===0}updateFrom(t){const{useAllAttributes:e,useDrawRange:i,matchDisjointEdges:n,degenerateEpsilon:s}=this,a=e?u:w,o=new Map,{attributes:l}=t,c=e?Object.keys(l):null,h=t.index,f=l.position;let d=Do(t);const g=d;let p=0;i&&(p=t.drawRange.start,t.drawRange.count!==1/0&&(d=~~(t.drawRange.count/3)));let v=this.data;(!v||v.length<3*g)&&(v=new Int32Array(3*g)),v.fill(-1);let b=0,_=new Set;for(let m=p,y=d*3+p;m<y;m+=3){const S=m;for(let T=0;T<3;T++){let C=S+T;h&&(C=h.getX(C)),Fa[T]=a(C)}for(let T=0;T<3;T++){const C=(T+1)%3,A=Fa[T],k=Fa[C],P=`${k}_${A}`;if(o.has(P)){const x=S+T,M=o.get(P);v[x]=M,v[M]=x,o.delete(P),b+=2,_.delete(M)}else{const x=`${A}_${k}`,M=S+T;o.set(x,M),_.add(M)}}}if(n){const{fragmentMap:m,disjointConnectivityMap:y}=e5(t,_,s);_.clear(),m.forEach(({forward:S,reverse:T})=>{S.forEach(({index:C})=>_.add(C)),T.forEach(({index:C})=>_.add(C))}),this.unmatchedDisjointEdges=m,this.disjointConnections=y,b=d*3-_.size}this.matchedEdges=b,this.unmatchedEdges=_.size,this.data=v;function w(m){return Ma.fromBufferAttribute(f,m),oc(Ma)}function u(m){let y="";for(let S=0,T=c.length;S<T;S++){const C=l[c[S]];let A;switch(C.itemSize){case 1:A=Fe(C.getX(m));break;case 2:A=z3(i5.fromBufferAttribute(C,m));break;case 3:A=oc(Ma.fromBufferAttribute(C,m));break;case 4:A=H3(n5.fromBufferAttribute(C,m));break}y!==""&&(y+="|"),y+=A}return y}}}class ao extends Af{constructor(...t){super(...t),this.isBrush=!0,this._previousMatrix=new Re,this._previousMatrix.elements.fill(0)}markUpdated(){this._previousMatrix.copy(this.matrix)}isDirty(){const{matrix:t,_previousMatrix:e}=this,i=t.elements,n=e.elements;for(let s=0;s<16;s++)if(i[s]!==n[s])return!0;return!1}prepareGeometry(){const t=this.geometry,e=t.attributes,i=Zh();if(i)for(const n in e){const s=e[n];if(s.isInterleavedBufferAttribute)throw new Error("Brush: InterleavedBufferAttributes are not supported.");s.array=j3(s.array)}if(t.boundsTree||(Y3(t,{useSharedArrayBuffer:i}),t.boundsTree=new Oo(t,{maxLeafTris:3,indirect:!0,useSharedArrayBuffer:i})),t.halfEdges||(t.halfEdges=new r5(t)),!t.groupIndices){const n=Do(t),s=new Uint16Array(n),a=t.groups;for(let o=0,l=a.length;o<l;o++){const{start:c,count:h}=a[o];for(let f=c/3,d=(c+h)/3;f<d;f++)s[f]=o}t.groupIndices=s}}disposeCacheData(){const{geometry:t}=this;t.halfEdges=null,t.boundsTree=null,t.groupIndices=null}}const s5=1e-14,Ra=new H,uc=new H,dc=new H;function ui(r,t=s5){Ra.subVectors(r.b,r.a),uc.subVectors(r.c,r.a),dc.subVectors(r.b,r.c);const e=Ra.angleTo(uc),i=Ra.angleTo(dc),n=Math.PI-e-i;return Math.abs(e)<t||Math.abs(i)<t||Math.abs(n)<t||r.a.distanceToSquared(r.b)<t||r.a.distanceToSquared(r.c)<t||r.b.distanceToSquared(r.c)<t}const Na=1e-10,Vn=1e-10,a5=1e-10,Ge=new ve,Vt=new ve,Ue=new H,La=new H,gc=new H,Rr=new co,Oa=new we;class o5{constructor(){this._pool=[],this._index=0}getTriangle(){return this._index>=this._pool.length&&this._pool.push(new oe),this._pool[this._index++]}clear(){this._index=0}reset(){this._pool.length=0,this._index=0}}class l5{constructor(){this.trianglePool=new o5,this.triangles=[],this.normal=new H,this.coplanarTriangleUsed=!1}initialize(t){this.reset();const{triangles:e,trianglePool:i,normal:n}=this;if(Array.isArray(t))for(let s=0,a=t.length;s<a;s++){const o=t[s];if(s===0)o.getNormal(n);else if(Math.abs(1-o.getNormal(Ue).dot(n))>Na)throw new Error("Triangle Splitter: Cannot initialize with triangles that have different normals.");const l=i.getTriangle();l.copy(o),e.push(l)}else{t.getNormal(n);const s=i.getTriangle();s.copy(t),e.push(s)}}splitByTriangle(t){const{normal:e,triangles:i}=this;if(t.getNormal(La).normalize(),Math.abs(1-Math.abs(La.dot(e)))<a5){this.coplanarTriangleUsed=!0;for(let s=0,a=i.length;s<a;s++){const o=i[s];o.coplanarCount=0}const n=[t.a,t.b,t.c];for(let s=0;s<3;s++){const a=(s+1)%3,o=n[s],l=n[a];Ue.subVectors(l,o).normalize(),gc.crossVectors(La,Ue),Rr.setFromNormalAndCoplanarPoint(gc,o),this.splitByPlane(Rr,t)}}else t.getPlane(Rr),this.splitByPlane(Rr,t)}splitByPlane(t,e){const{triangles:i,trianglePool:n}=this;Oa.copy(e),Oa.needsUpdate=!0;for(let s=0,a=i.length;s<a;s++){const o=i[s];if(!Oa.intersectsTriangle(o,Ge,!0))continue;const{a:l,b:c,c:h}=o;let f=0,d=-1,g=!1,p=[],v=[];const b=[l,c,h];for(let _=0;_<3;_++){const w=(_+1)%3;Ge.start.copy(b[_]),Ge.end.copy(b[w]);const u=t.distanceToPoint(Ge.start),m=t.distanceToPoint(Ge.end);if(Math.abs(u)<Vn&&Math.abs(m)<Vn){g=!0;break}if(u>0?p.push(_):v.push(_),Math.abs(u)<Vn)continue;let y=!!t.intersectLine(Ge,Ue);!y&&Math.abs(m)<Vn&&(Ue.copy(Ge.end),y=!0),y&&!(Ue.distanceTo(Ge.start)<Na)&&(Ue.distanceTo(Ge.end)<Na&&(d=_),f===0?Vt.start.copy(Ue):Vt.end.copy(Ue),f++)}if(!g&&f===2&&Vt.distance()>Vn)if(d!==-1){d=(d+1)%3;let _=0;_===d&&(_=(_+1)%3);let w=_+1;w===d&&(w=(w+1)%3);const u=n.getTriangle();u.a.copy(b[w]),u.b.copy(Vt.end),u.c.copy(Vt.start),ui(u)||i.push(u),o.a.copy(b[_]),o.b.copy(Vt.start),o.c.copy(Vt.end),ui(o)&&(i.splice(s,1),s--,a--)}else{const _=p.length>=2?v[0]:p[0];if(_===0){let S=Vt.start;Vt.start=Vt.end,Vt.end=S}const w=(_+1)%3,u=(_+2)%3,m=n.getTriangle(),y=n.getTriangle();b[w].distanceToSquared(Vt.start)<b[u].distanceToSquared(Vt.end)?(m.a.copy(b[w]),m.b.copy(Vt.start),m.c.copy(Vt.end),y.a.copy(b[w]),y.b.copy(b[u]),y.c.copy(Vt.start)):(m.a.copy(b[u]),m.b.copy(Vt.start),m.c.copy(Vt.end),y.a.copy(b[w]),y.b.copy(b[u]),y.c.copy(Vt.end)),o.a.copy(b[_]),o.b.copy(Vt.end),o.c.copy(Vt.start),ui(m)||i.push(m),ui(y)||i.push(y),ui(o)&&(i.splice(s,1),s--,a--)}else f===3&&console.warn("TriangleClipper: Coplanar clip not handled")}}reset(){this.triangles.length=0,this.trianglePool.clear(),this.coplanarTriangleUsed=!1}}function c5(r){return r=~~r,r+4-r%4}class pc{constructor(t,e=500){this.expansionFactor=1.5,this.type=t,this.length=0,this.array=null,this.setSize(e)}setType(t){if(this.length!==0)throw new Error("TypeBackedArray: Cannot change the type while there is used data in the buffer.");const e=this.array.buffer;this.array=new t(e),this.type=t}setSize(t){if(this.array&&t===this.array.length)return;const e=this.type,i=Zh()?SharedArrayBuffer:ArrayBuffer,n=new e(new i(c5(t*e.BYTES_PER_ELEMENT)));this.array&&n.set(this.array,0),this.array=n}expand(){const{array:t,expansionFactor:e}=this;this.setSize(t.length*e)}push(...t){let{array:e,length:i}=this;i+t.length>e.length&&(this.expand(),e=this.array);for(let n=0,s=t.length;n<s;n++)e[i+n]=t[n];this.length+=t.length}clear(){this.length=0}}class h5{constructor(){this.groupAttributes=[{}],this.groupCount=0}getType(t){return this.groupAttributes[0][t].type}getItemSize(t){return this.groupAttributes[0][t].itemSize}getNormalized(t){return this.groupAttributes[0][t].normalized}getCount(t){if(this.groupCount<=t)return 0;const e=this.getGroupAttrArray("position",t);return e.length/e.itemSize}getTotalLength(t){const{groupCount:e,groupAttributes:i}=this;let n=0;for(let s=0;s<e;s++){const a=i[s];n+=a[t].length}return n}getGroupAttrSet(t=0){const{groupAttributes:e}=this;if(e[t])return this.groupCount=Math.max(this.groupCount,t+1),e[t];const i=e[0];for(this.groupCount=Math.max(this.groupCount,t+1);t>=e.length;){const n={};e.push(n);for(const s in i){const a=i[s],o=new pc(a.type);o.itemSize=a.itemSize,o.normalized=a.normalized,n[s]=o}}return e[t]}getGroupAttrArray(t,e=0){const{groupAttributes:i}=this;if(!i[0][t])throw new Error(`TypedAttributeData: Attribute with "${t}" has not been initialized`);return this.getGroupAttrSet(e)[t]}initializeArray(t,e,i,n){const{groupAttributes:s}=this,o=s[0][t];if(o){if(o.type!==e)for(let l=0,c=s.length;l<c;l++){const h=s[l][t];h.setType(e),h.itemSize=i,h.normalized=n}}else for(let l=0,c=s.length;l<c;l++){const h=new pc(e);h.itemSize=i,h.normalized=n,s[l][t]=h}}clear(){this.groupCount=0;const{groupAttributes:t}=this;t.forEach(e=>{for(const i in e)e[i].clear()})}delete(t){this.groupAttributes.forEach(e=>{delete e[t]})}reset(){this.groupAttributes=[],this.groupCount=0}}class mc{constructor(){this.intersectionSet={},this.ids=[]}add(t,e){const{intersectionSet:i,ids:n}=this;i[t]||(i[t]=[],n.push(t)),i[t].push(e)}}const oo=0,je=1,f5=2,u5=3,d5=4,tf=5,ef=6,de=new zc,_c=new Re,Zt=new oe,Ve=new H,vc=new Hi,yc=new Hi,bc=new Hi,Da=new Hi,Nr=new Hi,Lr=new Hi,wc=new ve,Ia=new H,Ba=1e-8,g5=1e-15,Ri=-1,Ni=1,Vr=-2,zr=2,jn=0,Ei=1,Io=2,p5=1e-14;let Hr=null;function Sc(r){Hr=r}function nf(r,t){r.getMidpoint(de.origin),r.getNormal(de.direction);const e=t.raycastFirst(de,ho);return!!(e&&de.direction.dot(e.face.normal)>0)?Ri:Ni}function m5(r,t){function e(){return Math.random()-.5}r.getNormal(Ia),de.direction.copy(Ia),r.getMidpoint(de.origin);const i=3;let n=0,s=1/0;for(let a=0;a<i;a++){de.direction.x+=e()*Ba,de.direction.y+=e()*Ba,de.direction.z+=e()*Ba,de.direction.multiplyScalar(-1);const o=t.raycastFirst(de,ho);if(!!(o&&de.direction.dot(o.face.normal)>0)&&n++,o!==null&&(s=Math.min(s,o.distance)),s<=g5)return o.face.normal.dot(Ia)>0?zr:Vr;if(n/i>.5||(a-n+1)/i>.5)break}return n/i>.5?Ri:Ni}function _5(r,t){const e=new mc,i=new mc;return _c.copy(r.matrixWorld).invert().multiply(t.matrixWorld),r.geometry.boundsTree.bvhcast(t.geometry.boundsTree,_c,{intersectsTriangles(n,s,a,o){if(!ui(n)&&!ui(s)){let l=n.intersectsTriangle(s,wc,!0);if(!l){const c=n.plane,h=s.plane,f=c.normal,d=h.normal;f.dot(d)===1&&Math.abs(c.constant-h.constant)<p5&&(l=!0)}if(l){let c=r.geometry.boundsTree.resolveTriangleIndex(a),h=t.geometry.boundsTree.resolveTriangleIndex(o);e.add(c,h),i.add(h,c),Hr&&(Hr.addEdge(wc),Hr.addIntersectingTriangles(a,n,o,s))}}return!1}}),{aIntersections:e,bIntersections:i}}function v5(r,t,e,i,n,s,a=!1){const o=e.attributes,l=e.index,c=r*3,h=l.getX(c+0),f=l.getX(c+1),d=l.getX(c+2);for(const g in s){const p=o[g],v=s[g];if(!(g in o))throw new Error(`CSG Operations: Attribute ${g} not available on geometry.`);const b=p.itemSize;g==="position"?(Zt.a.fromBufferAttribute(p,h).applyMatrix4(i),Zt.b.fromBufferAttribute(p,f).applyMatrix4(i),Zt.c.fromBufferAttribute(p,d).applyMatrix4(i),Ga(Zt.a,Zt.b,Zt.c,t,3,v,a)):g==="normal"?(Zt.a.fromBufferAttribute(p,h).applyNormalMatrix(n),Zt.b.fromBufferAttribute(p,f).applyNormalMatrix(n),Zt.c.fromBufferAttribute(p,d).applyNormalMatrix(n),a&&(Zt.a.multiplyScalar(-1),Zt.b.multiplyScalar(-1),Zt.c.multiplyScalar(-1)),Ga(Zt.a,Zt.b,Zt.c,t,3,v,a,!0)):(vc.fromBufferAttribute(p,h),yc.fromBufferAttribute(p,f),bc.fromBufferAttribute(p,d),Ga(vc,yc,bc,t,b,v,a))}}function y5(r,t,e,i,n,s,a,o=!1){Ua(r,i,n,s,a,o),Ua(o?e:t,i,n,s,a,o),Ua(o?t:e,i,n,s,a,o)}function rf(r,t,e=!1){switch(r){case oo:if(t===Ni||t===zr&&!e)return Ei;break;case je:if(e){if(t===Ri)return jn}else if(t===Ni||t===Vr)return Ei;break;case f5:if(e){if(t===Ni||t===Vr)return Ei}else if(t===Ri)return jn;break;case d5:if(t===Ri)return jn;if(t===Ni)return Ei;break;case u5:if(t===Ri||t===zr&&!e)return Ei;break;case tf:if(!e&&(t===Ni||t===Vr))return Ei;break;case ef:if(!e&&(t===Ri||t===zr))return Ei;break;default:throw new Error(`Unrecognized CSG operation enum "${r}".`)}return Io}function Ga(r,t,e,i,n,s,a=!1,o=!1){const l=c=>{s.push(c.x),n>1&&s.push(c.y),n>2&&s.push(c.z),n>3&&s.push(c.w)};Da.set(0,0,0,0).addScaledVector(r,i.a.x).addScaledVector(t,i.a.y).addScaledVector(e,i.a.z),Nr.set(0,0,0,0).addScaledVector(r,i.b.x).addScaledVector(t,i.b.y).addScaledVector(e,i.b.z),Lr.set(0,0,0,0).addScaledVector(r,i.c.x).addScaledVector(t,i.c.y).addScaledVector(e,i.c.z),o&&(Da.normalize(),Nr.normalize(),Lr.normalize()),l(Da),a?(l(Lr),l(Nr)):(l(Nr),l(Lr))}function Ua(r,t,e,i,n,s=!1){for(const a in n){const o=t[a],l=n[a];if(!(a in t))throw new Error(`CSG Operations: Attribute ${a} no available on geometry.`);const c=o.itemSize;a==="position"?(Ve.fromBufferAttribute(o,r).applyMatrix4(e),l.push(Ve.x,Ve.y,Ve.z)):a==="normal"?(Ve.fromBufferAttribute(o,r).applyNormalMatrix(i),s&&Ve.multiplyScalar(-1),l.push(Ve.x,Ve.y,Ve.z)):(l.push(o.getX(r)),c>1&&l.push(o.getY(r)),c>2&&l.push(o.getZ(r)),c>3&&l.push(o.getW(r)))}}class b5{constructor(t){this.triangle=new oe().copy(t),this.intersects={}}addTriangle(t,e){this.intersects[t]=new oe().copy(e)}getIntersectArray(){const t=[],{intersects:e}=this;for(const i in e)t.push(e[i]);return t}}class Cc{constructor(){this.data={}}addTriangleIntersection(t,e,i,n){const{data:s}=this;s[t]||(s[t]=new b5(e)),s[t].addTriangle(i,n)}getTrianglesAsArray(t=null){const{data:e}=this,i=[];if(t!==null)t in e&&i.push(e[t].triangle);else for(const n in e)i.push(e[n].triangle);return i}getTriangleIndices(){return Object.keys(this.data).map(t=>parseInt(t))}getIntersectionIndices(t){const{data:e}=this;return e[t]?Object.keys(e[t].intersects).map(i=>parseInt(i)):[]}getIntersectionsAsArray(t=null,e=null){const{data:i}=this,n=new Set,s=[],a=o=>{if(i[o])if(e!==null)i[o].intersects[e]&&s.push(i[o].intersects[e]);else{const l=i[o].intersects;for(const c in l)n.has(c)||(n.add(c),s.push(l[c]))}};if(t!==null)a(t);else for(const o in i)a(o);return s}reset(){this.data={}}}class w5{constructor(){this.enabled=!1,this.triangleIntersectsA=new Cc,this.triangleIntersectsB=new Cc,this.intersectionEdges=[]}addIntersectingTriangles(t,e,i,n){const{triangleIntersectsA:s,triangleIntersectsB:a}=this;s.addTriangleIntersection(t,e,i,n),a.addTriangleIntersection(i,n,t,e)}addEdge(t){this.intersectionEdges.push(t.clone())}reset(){this.triangleIntersectsA.reset(),this.triangleIntersectsB.reset(),this.intersectionEdges=[]}init(){this.enabled&&(this.reset(),Sc(this))}complete(){this.enabled&&Sc(null)}}const gi=new Re,is=new Tf,Mi=new oe,Or=new oe,li=new oe,Dr=new oe,Ae=[],Oi=[];function S5(r){for(const t of r)return t}function C5(r,t,e,i,n,s={}){const{useGroups:a=!0}=s,{aIntersections:o,bIntersections:l}=_5(r,t),c=[];let h=null,f;return f=a?0:-1,Ac(r,t,o,e,!1,i,n,f),Tc(r,t,o,e,!1,n,f),e.findIndex(g=>g!==ef&&g!==tf)!==-1&&(f=a?r.geometry.groups.length||1:-1,Ac(t,r,l,e,!0,i,n,f),Tc(t,r,l,e,!0,n,f)),Ae.length=0,Oi.length=0,{groups:c,materials:h}}function Ac(r,t,e,i,n,s,a,o=0){const l=r.matrixWorld.determinant()<0;gi.copy(t.matrixWorld).invert().multiply(r.matrixWorld),is.getNormalMatrix(r.matrixWorld).multiplyScalar(l?-1:1);const c=r.geometry.groupIndices,h=r.geometry.index,f=r.geometry.attributes.position,d=t.geometry.boundsTree,g=t.geometry.index,p=t.geometry.attributes.position,v=e.ids,b=e.intersectionSet;for(let _=0,w=v.length;_<w;_++){const u=v[_],m=o===-1?0:c[u]+o,y=3*u,S=h.getX(y+0),T=h.getX(y+1),C=h.getX(y+2);Mi.a.fromBufferAttribute(f,S).applyMatrix4(gi),Mi.b.fromBufferAttribute(f,T).applyMatrix4(gi),Mi.c.fromBufferAttribute(f,C).applyMatrix4(gi),s.reset(),s.initialize(Mi);const A=b[u];for(let P=0,x=A.length;P<x;P++){const M=3*A[P],F=g.getX(M+0),N=g.getX(M+1),I=g.getX(M+2);Or.a.fromBufferAttribute(p,F),Or.b.fromBufferAttribute(p,N),Or.c.fromBufferAttribute(p,I),s.splitByTriangle(Or)}const k=s.triangles;for(let P=0,x=k.length;P<x;P++){const M=k[P],F=s.coplanarTriangleUsed?m5(M,d):nf(M,d);Ae.length=0,Oi.length=0;for(let N=0,I=i.length;N<I;N++){const V=rf(i[N],F,n);V!==Io&&(Oi.push(V),Ae.push(a[N].getGroupAttrSet(m)))}if(Ae.length!==0){Mi.getBarycoord(M.a,Dr.a),Mi.getBarycoord(M.b,Dr.b),Mi.getBarycoord(M.c,Dr.c);for(let N=0,I=Ae.length;N<I;N++){const V=Ae[N],lt=Oi[N]===jn;v5(u,Dr,r.geometry,r.matrixWorld,is,V,l!==lt)}}}}return v.length}function Tc(r,t,e,i,n,s,a=0){const o=r.matrixWorld.determinant()<0;gi.copy(t.matrixWorld).invert().multiply(r.matrixWorld),is.getNormalMatrix(r.matrixWorld).multiplyScalar(o?-1:1);const l=t.geometry.boundsTree,c=r.geometry.groupIndices,h=r.geometry.index,f=r.geometry.attributes,d=f.position,g=[],p=r.geometry.halfEdges,v=new Set,b=Do(r.geometry);for(let _=0,w=b;_<w;_++)_ in e.intersectionSet||v.add(_);for(;v.size>0;){const _=S5(v);v.delete(_),g.push(_);const w=3*_,u=h.getX(w+0),m=h.getX(w+1),y=h.getX(w+2);li.a.fromBufferAttribute(d,u).applyMatrix4(gi),li.b.fromBufferAttribute(d,m).applyMatrix4(gi),li.c.fromBufferAttribute(d,y).applyMatrix4(gi);const S=nf(li,l);Oi.length=0,Ae.length=0;for(let T=0,C=i.length;T<C;T++){const A=rf(i[T],S,n);A!==Io&&(Oi.push(A),Ae.push(s[T]))}for(;g.length>0;){const T=g.pop();for(let C=0;C<3;C++){const A=p.getSiblingTriangleIndex(T,C);A!==-1&&v.has(A)&&(g.push(A),v.delete(A))}if(Ae.length!==0){const C=3*T,A=h.getX(C+0),k=h.getX(C+1),P=h.getX(C+2),x=a===-1?0:c[T]+a;if(li.a.fromBufferAttribute(d,A),li.b.fromBufferAttribute(d,k),li.c.fromBufferAttribute(d,P),!ui(li))for(let M=0,F=Ae.length;M<F;M++){const N=Oi[M],I=Ae[M].getGroupAttrSet(x),V=N===jn;y5(A,k,P,f,r.matrixWorld,is,I,V!==o)}}}}}function A5(r){for(let t=0;t<r.length-1;t++){const e=r[t],i=r[t+1];if(e.materialIndex===i.materialIndex){const n=e.start,s=i.start+i.count;i.start=n,i.count=s-n,r.splice(t,1),t--}}}function T5(r,t,e,i){e.clear();const n=r.attributes;for(let s=0,a=i.length;s<a;s++){const o=i[s],l=n[o];e.initializeArray(o,l.array.constructor,l.itemSize,l.normalized)}for(const s in e.attributes)i.includes(s)||e.delete(s);for(const s in t.attributes)i.includes(s)||(t.deleteAttribute(s),t.dispose())}function k5(r,t,e){let i=!1,n=-1;const s=r.attributes,a=t.groupAttributes[0];for(const l in a){const c=t.getTotalLength(l),h=t.getType(l),f=t.getItemSize(l),d=t.getNormalized(l);let g=s[l];(!g||g.array.length<c)&&(g=new os(new h(c),f,d),r.setAttribute(l,g),i=!0);let p=0;for(let v=0,b=Math.min(e.length,t.groupCount);v<b;v++){const _=e[v].index,{array:w,type:u,length:m}=t.groupAttributes[_][l],y=new u(w.buffer,0,m);g.array.set(y,p),p+=y.length}g.needsUpdate=!0,n=c/g.itemSize}if(r.index){const l=r.index.array;if(l.length<n)r.index=null,i=!0;else for(let c=0,h=l.length;c<h;c++)l[c]=c}let o=0;r.clearGroups();for(let l=0,c=Math.min(e.length,t.groupCount);l<c;l++){const{index:h,materialIndex:f}=e[l],d=t.getCount(h);d!==0&&(r.addGroup(o,d,f),o+=d)}r.setDrawRange(0,n),r.boundsTree=null,i&&r.dispose()}function kc(r,t){let e=t;return Array.isArray(t)||(e=[],r.forEach(i=>{e[i.materialIndex]=t})),e}class P5{constructor(){this.triangleSplitter=new l5,this.attributeData=[],this.attributes=["position","uv","normal"],this.useGroups=!0,this.consolidateGroups=!0,this.debug=new w5}getGroupRanges(t){return!this.useGroups||t.groups.length===0?[{start:0,count:1/0,materialIndex:0}]:t.groups.map(e=>({...e}))}evaluate(t,e,i,n=new ao){let s=!0;if(Array.isArray(i)||(i=[i]),Array.isArray(n)||(n=[n],s=!1),n.length!==i.length)throw new Error("Evaluator: operations and target array passed as different sizes.");t.prepareGeometry(),e.prepareGeometry();const{triangleSplitter:a,attributeData:o,attributes:l,useGroups:c,consolidateGroups:h,debug:f}=this;for(;o.length<n.length;)o.push(new h5);n.forEach((_,w)=>{T5(t.geometry,_.geometry,o[w],l)}),f.init(),C5(t,e,i,a,o,{useGroups:c}),f.complete();const d=this.getGroupRanges(t.geometry),g=kc(d,t.material),p=this.getGroupRanges(e.geometry),v=kc(p,e.material);p.forEach(_=>_.materialIndex+=g.length);let b=[...d,...p].map((_,w)=>({..._,index:w}));if(c){const _=[...g,...v];h&&(b=b.map(u=>{const m=_[u.materialIndex];return u.materialIndex=_.indexOf(m),u}).sort((u,m)=>u.materialIndex-m.materialIndex));const w=[];for(let u=0,m=_.length;u<m;u++){let y=!1;for(let S=0,T=b.length;S<T;S++){const C=b[S];C.materialIndex===u&&(y=!0,C.materialIndex=w.length)}y&&w.push(_[u])}n.forEach(u=>{u.material=w})}else b=[{start:0,count:1/0,index:0,materialIndex:0}],n.forEach(_=>{_.material=g[0]});return n.forEach((_,w)=>{const u=_.geometry;k5(u,o[w],b),h&&A5(u.groups)}),s?n:n[0]}evaluateHierarchy(t,e=new ao){t.updateMatrixWorld(!0);const i=(s,a)=>{const o=s.children;for(let l=0,c=o.length;l<c;l++){const h=o[l];h.isOperationGroup?i(h,a):a(h)}},n=s=>{const a=s.children;let o=!1;for(let c=0,h=a.length;c<h;c++){const f=a[c];o=n(f)||o}const l=s.isDirty();if(l&&s.markUpdated(),o&&!s.isOperationGroup){let c;return i(s,h=>{c?c=this.evaluate(c,h,h.operation):c=this.evaluate(s,h,h.operation)}),s._cachedGeometry=c.geometry,s._cachedMaterials=c.material,!0}else return o||l};return n(t),e.geometry=t._cachedGeometry,e.material=t._cachedMaterials,e}reset(){this.triangleSplitter.reset()}}const ze=2,ci=2,Ir=1,Fi=r=>{const t=new ao(r.translate(0,0,0));return r instanceof Hc?t.position.z=r.parameters.depth/2:r instanceof Wc&&(t.position.z=r.parameters.height/2,t.rotateX(Math.PI/2)),t.updateMatrixWorld(),t},dn=(r,t,e)=>new Hc(r,t,e),x5=(r,t)=>new Wc(r,r,t,32),E5=r=>{const t=r.panelSettings,e=t.pcbThickness+t.smdHeight,i=Math.max(t.smdHeight,...r.rectangles.map(f=>f.depth),...r.circles.map(f=>f.depth)),n=t.pcbThickness+i,s=t.pcbThickness+t.smdHeight;let a=Fi(dn(t.width+2*ci,t.height+2*ci,n+ze)),o=Fi(dn(t.width+2*ci,t.height+2*ci,s+ze));o.position.z+=n-s,o.updateMatrixWorld();const l=new P5,c=Fi(dn(t.width,t.height,e+Ir));c.position.z+=ze+n-e,c.updateMatrixWorld(),a=l.evaluate(a,c,je),o=l.evaluate(o,c,je);const h=Fi(dn(t.width/3,t.height/3,e+Ir));{h.position.z+=ze+n-e,h.updateMatrixWorld();const f=[{dx:t.width/2,dy:0},{dx:-t.width/2,dy:0},{dx:0,dy:t.height/2},{dx:0,dy:-t.height/2}];for(const d of f){h.position.x+=d.dx,h.position.y+=d.dy;try{h.updateMatrixWorld(),a=l.evaluate(a,h,je),o=l.evaluate(o,h,je)}finally{h.position.x-=d.dx,h.position.y-=d.dy}}}for(const f of r.rectangles){const d=Fi(dn(f.width,f.height,f.depth+Ir));d.position.x+=f.x+f.width/2-t.width/2,d.position.y-=f.y+f.height/2-t.height/2,d.position.z+=ze+(i-f.depth),d.updateMatrixWorld(),a=l.evaluate(a,d,je),o=l.evaluate(o,d,je)}for(const f of r.circles){const d=Fi(x5(f.radius,f.depth+Ir));d.position.x+=f.x-t.width/2,d.position.y-=f.y-t.height/2,d.position.z+=ze+(i-f.depth),d.updateMatrixWorld(),a=l.evaluate(a,d,je),o=l.evaluate(o,d,je)}for(const f of r.legs){const d=Fi(dn(f.width,f.height,t.smdHeight));d.position.x+=f.x+f.width/2-t.width/2,d.position.y-=f.y+f.height/2-t.height/2,d.position.z+=ze+(i-t.smdHeight),d.updateMatrixWorld(),a=l.evaluate(a,d,oo),o=l.evaluate(o,d,oo)}return{main:{vertexArray:new Float32Array(a.geometry.attributes.position.array),dimensions:{x:t.width+2*ci,y:t.height+2*ci,depth:n+ze}},coverage:{vertexArray:new Float32Array(o.geometry.attributes.position.array),dimensions:{x:t.width+2*ci,y:t.height+2*ci,depth:s+ze}}}},M5=async r=>new Promise((t,e)=>setTimeout(()=>{try{t(E5(r))}catch(i){e(i instanceof Error?i.message:i)}}));let Bo=(r=21)=>crypto.getRandomValues(new Uint8Array(r)).reduce((t,e)=>(e&=63,e<36?t+=e.toString(36):e<62?t+=(e-26).toString(36).toUpperCase():e>62?t+="-":t+="_",t),"");const F5=at.object({depth:at.number(),id:at.string(),x:at.number(),y:at.number(),radius:at.number(),fill:at.literal("orange").default("orange"),draggable:at.literal(!0).default(!0),opacity:at.literal(.75).default(.75)}),R5=["fill","draggable","opacity"],ns=2,N5=at.object({id:at.string(),x:at.number(),y:at.number(),width:at.number(),height:at.number(),fill:at.literal("gray").default("gray"),draggable:at.literal(!0).default(!0),opacity:at.literal(.75).default(.75)}),L5=["fill","draggable","opacity"],O5=at.object({width:at.number(),height:at.number(),pcbThickness:at.number(),smdHeight:at.number()}),D5=at.object({depth:at.number(),id:at.string(),x:at.number(),y:at.number(),width:at.number(),height:at.number(),fill:at.literal("green").default("green"),draggable:at.literal(!0).default(!0),opacity:at.literal(.75).default(.75)}),I5=["fill","draggable","opacity"],sf=at.object({image:at.string(),filename:at.string(),panelSettings:O5,circles:at.array(F5),rectangles:at.array(D5),legs:at.array(N5)}),af={image:"",filename:"",panelSettings:{width:100,height:100,pcbThickness:1.6,smdHeight:3},circles:[],rectangles:[],legs:[]},of={parse:r=>{try{return sf.parse(JSON.parse(r))}catch{return af}},stringify:r=>JSON.stringify(r,(t,e)=>{if(![...R5,...I5,...L5].includes(t))return e},2)},zt=kf("project",af,{syncTabs:!0,storage:"local",serializer:of}),si=()=>Vc(zt),Wr=async r=>{const t=si(),e={depth:r?.depth||5,id:Bo(),x:t.panelSettings.width/2,y:t.panelSettings.height/2,radius:r?.radius||10,fill:"orange",draggable:!0,opacity:.75};if(t.circles.push(e),$n(t.circles),!r){const{confirmed:i,settings:n}=await jc(e);i?(e.radius=n.radius,e.depth=n.depth,$n()):cf(e)}},B5=r=>Wr(r),G5=async r=>{const{confirmed:t,name:e}=await Xc("circle");if(t){const i=Yc();i.push({name:e,type:"circle",radius:r.radius,depth:r.depth}),Kc(i)}},lf=async r=>{const{confirmed:t,settings:e}=await jc(r);t&&(r.radius=e.radius,r.depth=e.depth,$n())},cf=r=>{const t=si();t.circles=t.circles.filter(e=>e!=r),$n()},$n=r=>zt.update(t=>(r&&(t.circles=r),t)),U5=r=>{const e=si().circles.find(i=>i.id===r);if(e)return[{name:`Circle ${e.radius}x${e.depth}mm`},{name:"Properties...",onClick:()=>lf(e)},{name:"Duplicate",onClick:()=>B5(e)},{name:"Add to library...",onClick:()=>G5(e)},{name:""},{name:"Delete",onClick:()=>cf(e)}]},Pc=()=>{const r=si(),t={id:Bo(),x:r.panelSettings.width/2,y:r.panelSettings.height/2,width:ns,height:ns,fill:"gray",draggable:!0,opacity:.75};r.legs.push(t),sa(r.legs)},V5=r=>{const t=si();t.legs=t.legs.filter(e=>e!=r),sa(t.legs)},sa=r=>zt.update(t=>(r&&(t.legs=r),t)),z5=r=>{const t=si(),e=t.legs.find(i=>i.id===r);if(e)return[{name:"Leg"},{name:"Delete",onClick:()=>{t.legs=t.legs.filter(i=>i!=e),sa()}}]},jr=async r=>{const t=si(),e={depth:r?.depth||5,id:Bo(),x:t.panelSettings.width/2,y:t.panelSettings.height/2,width:r?.width||10,height:r?.height||5,fill:"green",draggable:!0,opacity:.75};if(t.rectangles.push(e),wn(t.rectangles),!r){const{confirmed:i,settings:n}=await qc(e);i?(e.width=n.width,e.height=n.height,e.depth=n.depth,wn()):ff(e)}},H5=r=>jr(r),W5=r=>{const t=r.width;r.width=r.height,r.height=t,wn()},j5=async r=>{const{confirmed:t,name:e}=await Xc("rectangle");if(t){const i=Yc();i.push({name:e,type:"rectangle",width:r.width,height:r.height,depth:r.depth}),Kc(i)}},hf=async r=>{const{confirmed:t,settings:e}=await qc(r);t&&(r.width=e.width,r.height=e.height,r.depth=e.depth,wn())},ff=r=>{const t=si();t.rectangles=t.rectangles.filter(e=>e!=r),wn()},wn=r=>zt.update(t=>(r&&(t.rectangles=r),t)),X5=r=>{const e=si().rectangles.find(i=>i.id===r);if(e)return[{name:`Rectangle ${e.width}x${e.height}x${e.depth}mm`},{name:"Properties...",onClick:()=>hf(e)},{name:"Rotate",onClick:()=>W5(e)},{name:"Duplicate",onClick:()=>H5(e)},{name:"Add to library...",onClick:()=>j5(e)},{name:""},{name:"Delete",onClick:()=>ff(e)}]};function xc(r,t,e){const i=r.slice();return i[43]=t[e],i[44]=t,i[45]=e,i}function Ec(r,t,e){const i=r.slice();return i[46]=t[e],i[47]=t,i[48]=e,i}function Mc(r,t,e){const i=r.slice();return i[49]=t[e],i[50]=t,i[51]=e,i}function Fc(r,t,e){const i=r.slice();return i[52]=t[e],i}function Y5(r){let t,e,i,n,s="PCB THT Holder",a,o,l,c;return{c(){t=ft("img"),i=mt(),n=ft("span"),n.textContent=s,a=mt(),o=ft("span"),l=vt("v"),c=vt(r[5]),this.h()},l(h){t=ut(h,"IMG",{src:!0,class:!0,alt:!0}),i=_t(h),n=ut(h,"SPAN",{class:!0,"data-svelte-h":!0}),_f(n)!=="svelte-yf58ke"&&(n.textContent=s),a=_t(h),o=ut(h,"SPAN",{class:!0});var f=st(o);l=yt(f,"v"),c=yt(f,r[5]),f.forEach(R),this.h()},h(){vf(t.src,e=Lf+"/favicon.png")||K(t,"src",e),K(t,"class","me-3 h-6 sm:h-9"),K(t,"alt","PCB THT Holder Logo"),K(n,"class","self-center whitespace-nowrap text-xl font-semibold dark:text-white"),K(o,"class","ml-2 self-center whitespace-nowrap text-sm dark:text-white")},m(h,f){O(h,t,f),O(h,i,f),O(h,n,f),O(h,a,f),O(h,o,f),Et(o,l),Et(o,c)},p:Yt,d(h){h&&(R(t),R(i),R(n),R(a),R(o))}}}function K5(r){let t;return{c(){t=vt("D")},l(e){t=yt(e,"D")},m(e,i){O(e,t,i)},d(e){e&&R(t)}}}function q5(r){let t,e,i,n;return t=new dd({props:{class:"mr-2"}}),i=new er({props:{class:"ml-4 px-2 py-1",$$slots:{default:[K5]},$$scope:{ctx:r}}}),{c(){tt(t.$$.fragment),e=vt(`
			Display 3D
			`),tt(i.$$.fragment)},l(s){et(t.$$.fragment,s),e=yt(s,`
			Display 3D
			`),et(i.$$.fragment,s)},m(s,a){it(t,s,a),O(s,e,a),it(i,s,a),n=!0},p(s,a){const o={};a[1]&16777216&&(o.$$scope={dirty:a,ctx:s}),i.$set(o)},i(s){n||(L(t.$$.fragment,s),L(i.$$.fragment,s),n=!0)},o(s){B(t.$$.fragment,s),B(i.$$.fragment,s),n=!1},d(s){s&&R(e),nt(t,s),nt(i,s)}}}function Rc(r){let t,e,i,n,s,a,o,l;return t=new il({props:{class:"cursor-pointer",$$slots:{default:[$5]},$$scope:{ctx:r}}}),i=new Ha({props:{class:"w-60 z-20",$$slots:{default:[e4]},$$scope:{ctx:r}}}),s=new il({props:{class:"cursor-pointer",$$slots:{default:[i4]},$$scope:{ctx:r}}}),o=new Ha({props:{class:"w-60 z-20",$$slots:{default:[d4]},$$scope:{ctx:r}}}),{c(){tt(t.$$.fragment),e=mt(),tt(i.$$.fragment),n=mt(),tt(s.$$.fragment),a=mt(),tt(o.$$.fragment)},l(c){et(t.$$.fragment,c),e=_t(c),et(i.$$.fragment,c),n=_t(c),et(s.$$.fragment,c),a=_t(c),et(o.$$.fragment,c)},m(c,h){it(t,c,h),O(c,e,h),it(i,c,h),O(c,n,h),it(s,c,h),O(c,a,h),it(o,c,h),l=!0},p(c,h){const f={};h[1]&16777216&&(f.$$scope={dirty:h,ctx:c}),t.$set(f);const d={};h[1]&16777216&&(d.$$scope={dirty:h,ctx:c}),i.$set(d);const g={};h[1]&16777216&&(g.$$scope={dirty:h,ctx:c}),s.$set(g);const p={};h[0]&16|h[1]&16777216&&(p.$$scope={dirty:h,ctx:c}),o.$set(p)},i(c){l||(L(t.$$.fragment,c),L(i.$$.fragment,c),L(s.$$.fragment,c),L(o.$$.fragment,c),l=!0)},o(c){B(t.$$.fragment,c),B(i.$$.fragment,c),B(s.$$.fragment,c),B(o.$$.fragment,c),l=!1},d(c){c&&(R(e),R(n),R(a)),nt(t,c),nt(i,c),nt(s,c),nt(o,c)}}}function $5(r){let t,e,i;return e=new lh({props:{class:"w-3 h-3 ms-2 text-primary-800 dark:text-white inline"}}),{c(){t=vt("File"),tt(e.$$.fragment)},l(n){t=yt(n,"File"),et(e.$$.fragment,n)},m(n,s){O(n,t,s),it(e,n,s),i=!0},p:Yt,i(n){i||(L(e.$$.fragment,n),i=!0)},o(n){B(e.$$.fragment,n),i=!1},d(n){n&&R(t),nt(e,n)}}}function J5(r){let t;return{c(){t=vt("New")},l(e){t=yt(e,"New")},m(e,i){O(e,t,i)},d(e){e&&R(t)}}}function Q5(r){let t;return{c(){t=vt("Save project")},l(e){t=yt(e,"Save project")},m(e,i){O(e,t,i)},d(e){e&&R(t)}}}function Z5(r){let t;return{c(){t=vt("shift + P")},l(e){t=yt(e,"shift + P")},m(e,i){O(e,t,i)},d(e){e&&R(t)}}}function t4(r){let t,e,i;return e=new er({props:{class:"float-right px-2",$$slots:{default:[Z5]},$$scope:{ctx:r}}}),{c(){t=vt(`Panel settings...
					`),tt(e.$$.fragment)},l(n){t=yt(n,`Panel settings...
					`),et(e.$$.fragment,n)},m(n,s){O(n,t,s),it(e,n,s),i=!0},p(n,s){const a={};s[1]&16777216&&(a.$$scope={dirty:s,ctx:n}),e.$set(a)},i(n){i||(L(e.$$.fragment,n),i=!0)},o(n){B(e.$$.fragment,n),i=!1},d(n){n&&R(t),nt(e,n)}}}function e4(r){let t,e,i,n,s,a,o,l;return t=new Xe({props:{href:"#",$$slots:{default:[J5]},$$scope:{ctx:r}}}),t.$on("click",r[21]),i=new Xe({props:{href:"#",$$slots:{default:[Q5]},$$scope:{ctx:r}}}),i.$on("click",r[22]),s=new ah({}),o=new Xe({props:{href:"#",$$slots:{default:[t4]},$$scope:{ctx:r}}}),o.$on("click",r[23]),{c(){tt(t.$$.fragment),e=mt(),tt(i.$$.fragment),n=mt(),tt(s.$$.fragment),a=mt(),tt(o.$$.fragment)},l(c){et(t.$$.fragment,c),e=_t(c),et(i.$$.fragment,c),n=_t(c),et(s.$$.fragment,c),a=_t(c),et(o.$$.fragment,c)},m(c,h){it(t,c,h),O(c,e,h),it(i,c,h),O(c,n,h),it(s,c,h),O(c,a,h),it(o,c,h),l=!0},p(c,h){const f={};h[1]&16777216&&(f.$$scope={dirty:h,ctx:c}),t.$set(f);const d={};h[1]&16777216&&(d.$$scope={dirty:h,ctx:c}),i.$set(d);const g={};h[1]&16777216&&(g.$$scope={dirty:h,ctx:c}),o.$set(g)},i(c){l||(L(t.$$.fragment,c),L(i.$$.fragment,c),L(s.$$.fragment,c),L(o.$$.fragment,c),l=!0)},o(c){B(t.$$.fragment,c),B(i.$$.fragment,c),B(s.$$.fragment,c),B(o.$$.fragment,c),l=!1},d(c){c&&(R(e),R(n),R(a)),nt(t,c),nt(i,c),nt(s,c),nt(o,c)}}}function i4(r){let t,e,i;return e=new lh({props:{class:"w-3 h-3 ms-2 text-primary-800 dark:text-white inline"}}),{c(){t=vt("Component"),tt(e.$$.fragment)},l(n){t=yt(n,"Component"),et(e.$$.fragment,n)},m(n,s){O(n,t,s),it(e,n,s),i=!0},p:Yt,i(n){i||(L(e.$$.fragment,n),i=!0)},o(n){B(e.$$.fragment,n),i=!1},d(n){n&&R(t),nt(e,n)}}}function n4(r){let t;return{c(){t=vt("shift + C")},l(e){t=yt(e,"shift + C")},m(e,i){O(e,t,i)},d(e){e&&R(t)}}}function r4(r){let t,e,i;return e=new er({props:{class:"float-right px-2",$$slots:{default:[n4]},$$scope:{ctx:r}}}),{c(){t=vt(`Add circle...
					`),tt(e.$$.fragment)},l(n){t=yt(n,`Add circle...
					`),et(e.$$.fragment,n)},m(n,s){O(n,t,s),it(e,n,s),i=!0},p(n,s){const a={};s[1]&16777216&&(a.$$scope={dirty:s,ctx:n}),e.$set(a)},i(n){i||(L(e.$$.fragment,n),i=!0)},o(n){B(e.$$.fragment,n),i=!1},d(n){n&&R(t),nt(e,n)}}}function s4(r){let t;return{c(){t=vt("shift + R")},l(e){t=yt(e,"shift + R")},m(e,i){O(e,t,i)},d(e){e&&R(t)}}}function a4(r){let t,e,i;return e=new er({props:{class:"float-right px-2",$$slots:{default:[s4]},$$scope:{ctx:r}}}),{c(){t=vt(`Add rectangle...
					`),tt(e.$$.fragment)},l(n){t=yt(n,`Add rectangle...
					`),et(e.$$.fragment,n)},m(n,s){O(n,t,s),it(e,n,s),i=!0},p(n,s){const a={};s[1]&16777216&&(a.$$scope={dirty:s,ctx:n}),e.$set(a)},i(n){i||(L(e.$$.fragment,n),i=!0)},o(n){B(e.$$.fragment,n),i=!1},d(n){n&&R(t),nt(e,n)}}}function o4(r){let t;return{c(){t=vt("shift + L")},l(e){t=yt(e,"shift + L")},m(e,i){O(e,t,i)},d(e){e&&R(t)}}}function l4(r){let t,e,i;return e=new er({props:{class:"float-right px-2",$$slots:{default:[o4]},$$scope:{ctx:r}}}),{c(){t=vt(`Add leg
					`),tt(e.$$.fragment)},l(n){t=yt(n,`Add leg
					`),et(e.$$.fragment,n)},m(n,s){O(n,t,s),it(e,n,s),i=!0},p(n,s){const a={};s[1]&16777216&&(a.$$scope={dirty:s,ctx:n}),e.$set(a)},i(n){i||(L(e.$$.fragment,n),i=!0)},o(n){B(e.$$.fragment,n),i=!1},d(n){n&&R(t),nt(e,n)}}}function Nc(r){let t,e,i,n;return t=new Xe({props:{class:"flex items-center justify-between",$$slots:{default:[c4]},$$scope:{ctx:r}}}),i=new Ha({props:{class:"w-auto min-w-44 z-20",placement:"right-start",$$slots:{default:[f4]},$$scope:{ctx:r}}}),{c(){tt(t.$$.fragment),e=mt(),tt(i.$$.fragment)},l(s){et(t.$$.fragment,s),e=_t(s),et(i.$$.fragment,s)},m(s,a){it(t,s,a),O(s,e,a),it(i,s,a),n=!0},p(s,a){const o={};a[1]&16777216&&(o.$$scope={dirty:a,ctx:s}),t.$set(o);const l={};a[0]&16|a[1]&16777216&&(l.$$scope={dirty:a,ctx:s}),i.$set(l)},i(s){n||(L(t.$$.fragment,s),L(i.$$.fragment,s),n=!0)},o(s){B(t.$$.fragment,s),B(i.$$.fragment,s),n=!1},d(s){s&&R(e),nt(t,s),nt(i,s)}}}function c4(r){let t,e,i;return e=new hd({props:{class:"w-3 h-3 ms-2 text-primary-700 dark:text-white"}}),{c(){t=vt("Add from library"),tt(e.$$.fragment)},l(n){t=yt(n,"Add from library"),et(e.$$.fragment,n)},m(n,s){O(n,t,s),it(e,n,s),i=!0},p:Yt,i(n){i||(L(e.$$.fragment,n),i=!0)},o(n){B(e.$$.fragment,n),i=!1},d(n){n&&R(t),nt(e,n)}}}function h4(r){let t=r[52].name+"",e,i,n=r[52].type+"",s,a;return{c(){e=vt(t),i=vt(" ("),s=vt(n),a=vt(")")},l(o){e=yt(o,t),i=yt(o," ("),s=yt(o,n),a=yt(o,")")},m(o,l){O(o,e,l),O(o,i,l),O(o,s,l),O(o,a,l)},p(o,l){l[0]&16&&t!==(t=o[52].name+"")&&$e(e,t),l[0]&16&&n!==(n=o[52].type+"")&&$e(s,n)},d(o){o&&(R(e),R(i),R(s),R(a))}}}function Lc(r){let t,e;function i(){return r[27](r[52])}return t=new Xe({props:{$$slots:{default:[h4]},$$scope:{ctx:r}}}),t.$on("click",i),{c(){tt(t.$$.fragment)},l(n){et(t.$$.fragment,n)},m(n,s){it(t,n,s),e=!0},p(n,s){r=n;const a={};s[0]&16|s[1]&16777216&&(a.$$scope={dirty:s,ctx:r}),t.$set(a)},i(n){e||(L(t.$$.fragment,n),e=!0)},o(n){B(t.$$.fragment,n),e=!1},d(n){nt(t,n)}}}function f4(r){let t,e,i=Ee(r[4].sort(Gc)),n=[];for(let a=0;a<i.length;a+=1)n[a]=Lc(Fc(r,i,a));const s=a=>B(n[a],1,1,()=>{n[a]=null});return{c(){for(let a=0;a<n.length;a+=1)n[a].c();t=Gt()},l(a){for(let o=0;o<n.length;o+=1)n[o].l(a);t=Gt()},m(a,o){for(let l=0;l<n.length;l+=1)n[l]&&n[l].m(a,o);O(a,t,o),e=!0},p(a,o){if(o[0]&1040){i=Ee(a[4].sort(Gc));let l;for(l=0;l<i.length;l+=1){const c=Fc(a,i,l);n[l]?(n[l].p(c,o),L(n[l],1)):(n[l]=Lc(c),n[l].c(),L(n[l],1),n[l].m(t.parentNode,t))}for(ce(),l=i.length;l<n.length;l+=1)s(l);he()}},i(a){if(!e){for(let o=0;o<i.length;o+=1)L(n[o]);e=!0}},o(a){n=n.filter(Boolean);for(let o=0;o<n.length;o+=1)B(n[o]);e=!1},d(a){a&&R(t),Hn(n,a)}}}function u4(r){let t;return{c(){t=vt("Library...")},l(e){t=yt(e,"Library...")},m(e,i){O(e,t,i)},d(e){e&&R(t)}}}function d4(r){let t,e,i,n,s,a,o,l,c,h,f;t=new Xe({props:{href:"#",$$slots:{default:[r4]},$$scope:{ctx:r}}}),t.$on("click",r[24]),i=new Xe({props:{href:"#",$$slots:{default:[a4]},$$scope:{ctx:r}}}),i.$on("click",r[25]),s=new Xe({props:{href:"#",$$slots:{default:[l4]},$$scope:{ctx:r}}}),s.$on("click",r[26]);let d=r[4].length&&Nc(r);return l=new ah({}),h=new Xe({props:{href:"#",$$slots:{default:[u4]},$$scope:{ctx:r}}}),h.$on("click",r[28]),{c(){tt(t.$$.fragment),e=mt(),tt(i.$$.fragment),n=mt(),tt(s.$$.fragment),a=mt(),d&&d.c(),o=mt(),tt(l.$$.fragment),c=mt(),tt(h.$$.fragment)},l(g){et(t.$$.fragment,g),e=_t(g),et(i.$$.fragment,g),n=_t(g),et(s.$$.fragment,g),a=_t(g),d&&d.l(g),o=_t(g),et(l.$$.fragment,g),c=_t(g),et(h.$$.fragment,g)},m(g,p){it(t,g,p),O(g,e,p),it(i,g,p),O(g,n,p),it(s,g,p),O(g,a,p),d&&d.m(g,p),O(g,o,p),it(l,g,p),O(g,c,p),it(h,g,p),f=!0},p(g,p){const v={};p[1]&16777216&&(v.$$scope={dirty:p,ctx:g}),t.$set(v);const b={};p[1]&16777216&&(b.$$scope={dirty:p,ctx:g}),i.$set(b);const _={};p[1]&16777216&&(_.$$scope={dirty:p,ctx:g}),s.$set(_),g[4].length?d?(d.p(g,p),p[0]&16&&L(d,1)):(d=Nc(g),d.c(),L(d,1),d.m(o.parentNode,o)):d&&(ce(),B(d,1,1,()=>{d=null}),he());const w={};p[1]&16777216&&(w.$$scope={dirty:p,ctx:g}),h.$set(w)},i(g){f||(L(t.$$.fragment,g),L(i.$$.fragment,g),L(s.$$.fragment,g),L(d),L(l.$$.fragment,g),L(h.$$.fragment,g),f=!0)},o(g){B(t.$$.fragment,g),B(i.$$.fragment,g),B(s.$$.fragment,g),B(d),B(l.$$.fragment,g),B(h.$$.fragment,g),f=!1},d(g){g&&(R(e),R(n),R(a),R(o),R(c)),nt(t,g),nt(i,g),nt(s,g),d&&d.d(g),nt(l,g),nt(h,g)}}}function g4(r){let t,e,i=r[0]&&Rc(r);return{c(){i&&i.c(),t=Gt()},l(n){i&&i.l(n),t=Gt()},m(n,s){i&&i.m(n,s),O(n,t,s),e=!0},p(n,s){n[0]?i?(i.p(n,s),s[0]&1&&L(i,1)):(i=Rc(n),i.c(),L(i,1),i.m(t.parentNode,t)):i&&(ce(),B(i,1,1,()=>{i=null}),he())},i(n){e||(L(i),e=!0)},o(n){B(i),e=!1},d(n){n&&R(t),i&&i.d(n)}}}function p4(r){let t,e,i,n,s,a,o,l,c;return t=new Wu({props:{href:"#",$$slots:{default:[Y5]},$$scope:{ctx:r}}}),n=new Pf({props:{disabled:!r[0],$$slots:{default:[q5]},$$scope:{ctx:r}}}),n.$on("click",r[20]),a=new Ju({}),l=new sd({props:{class:"order-1",$$slots:{default:[g4]},$$scope:{ctx:r}}}),{c(){tt(t.$$.fragment),e=mt(),i=ft("div"),tt(n.$$.fragment),s=mt(),tt(a.$$.fragment),o=mt(),tt(l.$$.fragment),this.h()},l(h){et(t.$$.fragment,h),e=_t(h),i=ut(h,"DIV",{class:!0});var f=st(i);et(n.$$.fragment,f),s=_t(f),et(a.$$.fragment,f),f.forEach(R),o=_t(h),et(l.$$.fragment,h),this.h()},h(){K(i,"class","flex md:order-2")},m(h,f){it(t,h,f),O(h,e,f),O(h,i,f),it(n,i,null),Et(i,s),it(a,i,null),O(h,o,f),it(l,h,f),c=!0},p(h,f){const d={};f[1]&16777216&&(d.$$scope={dirty:f,ctx:h}),t.$set(d);const g={};f[0]&1&&(g.disabled=!h[0]),f[1]&16777216&&(g.$$scope={dirty:f,ctx:h}),n.$set(g);const p={};f[0]&17|f[1]&16777216&&(p.$$scope={dirty:f,ctx:h}),l.$set(p)},i(h){c||(L(t.$$.fragment,h),L(n.$$.fragment,h),L(a.$$.fragment,h),L(l.$$.fragment,h),c=!0)},o(h){B(t.$$.fragment,h),B(n.$$.fragment,h),B(a.$$.fragment,h),B(l.$$.fragment,h),c=!1},d(h){h&&(R(e),R(i),R(o)),nt(t,h),nt(n),nt(a),nt(l,h)}}}function Oc(r){let t,e,i=r[1].width+"",n,s,a=r[1].height+"",o,l;return{c(){t=ft("p"),e=vt("("),n=vt(i),s=vt("x"),o=vt(a),l=vt(")"),this.h()},l(c){t=ut(c,"P",{class:!0});var h=st(t);e=yt(h,"("),n=yt(h,i),s=yt(h,"x"),o=yt(h,a),l=yt(h,")"),h.forEach(R),this.h()},h(){K(t,"class","text-sm text-gray-500")},m(c,h){O(c,t,h),Et(t,e),Et(t,n),Et(t,s),Et(t,o),Et(t,l)},p(c,h){h[0]&2&&i!==(i=c[1].width+"")&&$e(n,i),h[0]&2&&a!==(a=c[1].height+"")&&$e(o,a)},d(c){c&&R(t)}}}function m4(r){let t,e;return t=new P2({props:{config:{width:r[1].width,height:r[1].height,scaleX:r[1].width/r[3].panelSettings.width,scaleY:r[1].height/r[3].panelSettings.height},$$slots:{default:[y4]},$$scope:{ctx:r}}}),t.$on("click",r[14]),{c(){tt(t.$$.fragment)},l(i){et(t.$$.fragment,i)},m(i,n){it(t,i,n),e=!0},p(i,n){const s={};n[0]&10&&(s.config={width:i[1].width,height:i[1].height,scaleX:i[1].width/i[3].panelSettings.width,scaleY:i[1].height/i[3].panelSettings.height}),n[0]&15|n[1]&16777216&&(s.$$scope={dirty:n,ctx:i}),t.$set(s)},i(i){e||(L(t.$$.fragment,i),e=!0)},o(i){B(t.$$.fragment,i),e=!1},d(i){nt(t,i)}}}function _4(r){let t,e;return t=new B2({props:{title:"Top view of PCB image or a project file",description:"Click to upload or drag and drop a file. Image file (png, jpg) begins a new project, a .tht3d file restores a previously saved project.",onUpload:r[29]}}),{c(){tt(t.$$.fragment)},l(i){et(t.$$.fragment,i)},m(i,n){it(t,i,n),e=!0},p:Yt,i(i){e||(L(t.$$.fragment,i),e=!0)},o(i){B(t.$$.fragment,i),e=!1},d(i){nt(t,i)}}}function Dc(r){let t,e,i;function n(l){r[31](l,r[49],r[50],r[51])}function s(){return r[32](r[49])}function a(...l){return r[33](r[49],...l)}let o={};return r[49]!==void 0&&(o.config=r[49]),t=new v2({props:o}),wi.push(()=>ss(t,"config",n)),t.$on("dblclick",s),t.$on("dragmove",a),t.$on("dragend",r[34]),{c(){tt(t.$$.fragment)},l(l){et(t.$$.fragment,l)},m(l,c){it(t,l,c),i=!0},p(l,c){r=l;const h={};!e&&c[0]&8&&(e=!0,h.config=r[49],rs(()=>e=!1)),t.$set(h)},i(l){i||(L(t.$$.fragment,l),i=!0)},o(l){B(t.$$.fragment,l),i=!1},d(l){nt(t,l)}}}function Ic(r){let t,e,i;function n(l){r[35](l,r[46],r[47],r[48])}function s(){return r[36](r[46])}function a(...l){return r[37](r[46],...l)}let o={};return r[46]!==void 0&&(o.config=r[46]),t=new Xh({props:o}),wi.push(()=>ss(t,"config",n)),t.$on("dblclick",s),t.$on("dragmove",a),t.$on("dragend",r[38]),{c(){tt(t.$$.fragment)},l(l){et(t.$$.fragment,l)},m(l,c){it(t,l,c),i=!0},p(l,c){r=l;const h={};!e&&c[0]&8&&(e=!0,h.config=r[46],rs(()=>e=!1)),t.$set(h)},i(l){i||(L(t.$$.fragment,l),i=!0)},o(l){B(t.$$.fragment,l),i=!1},d(l){nt(t,l)}}}function Bc(r){let t,e,i;function n(l){r[39](l,r[43],r[44],r[45])}function s(){return r[40](r[43])}function a(...l){return r[41](r[43],...l)}let o={};return r[43]!==void 0&&(o.config=r[43]),t=new Xh({props:o}),wi.push(()=>ss(t,"config",n)),t.$on("dblclick",s),t.$on("dragmove",a),t.$on("dragend",r[42]),{c(){tt(t.$$.fragment)},l(l){et(t.$$.fragment,l)},m(l,c){it(t,l,c),i=!0},p(l,c){r=l;const h={};!e&&c[0]&8&&(e=!0,h.config=r[43],rs(()=>e=!1)),t.$set(h)},i(l){i||(L(t.$$.fragment,l),i=!0)},o(l){B(t.$$.fragment,l),i=!1},d(l){nt(t,l)}}}function v4(r){let t,e,i,n,s,a,o,l;t=new b2({props:{config:{image:r[0],scaleX:r[3].panelSettings.width/r[1].width,scaleY:-1*r[3].panelSettings.height/r[1].height,offsetY:r[1].height,opacity:.25}}});let c={};i=new N2({props:c}),r[30](i);let h=Ee(r[3].circles),f=[];for(let u=0;u<h.length;u+=1)f[u]=Dc(Mc(r,h,u));const d=u=>B(f[u],1,1,()=>{f[u]=null});let g=Ee(r[3].rectangles),p=[];for(let u=0;u<g.length;u+=1)p[u]=Ic(Ec(r,g,u));const v=u=>B(p[u],1,1,()=>{p[u]=null});let b=Ee(r[3].legs),_=[];for(let u=0;u<b.length;u+=1)_[u]=Bc(xc(r,b,u));const w=u=>B(_[u],1,1,()=>{_[u]=null});return{c(){tt(t.$$.fragment),e=mt(),tt(i.$$.fragment),n=mt();for(let u=0;u<f.length;u+=1)f[u].c();s=mt();for(let u=0;u<p.length;u+=1)p[u].c();a=mt();for(let u=0;u<_.length;u+=1)_[u].c();o=Gt()},l(u){et(t.$$.fragment,u),e=_t(u),et(i.$$.fragment,u),n=_t(u);for(let m=0;m<f.length;m+=1)f[m].l(u);s=_t(u);for(let m=0;m<p.length;m+=1)p[m].l(u);a=_t(u);for(let m=0;m<_.length;m+=1)_[m].l(u);o=Gt()},m(u,m){it(t,u,m),O(u,e,m),it(i,u,m),O(u,n,m);for(let y=0;y<f.length;y+=1)f[y]&&f[y].m(u,m);O(u,s,m);for(let y=0;y<p.length;y+=1)p[y]&&p[y].m(u,m);O(u,a,m);for(let y=0;y<_.length;y+=1)_[y]&&_[y].m(u,m);O(u,o,m),l=!0},p(u,m){const y={};m[0]&11&&(y.config={image:u[0],scaleX:u[3].panelSettings.width/u[1].width,scaleY:-1*u[3].panelSettings.height/u[1].height,offsetY:u[1].height,opacity:.25}),t.$set(y);const S={};if(i.$set(S),m[0]&8200){h=Ee(u[3].circles);let T;for(T=0;T<h.length;T+=1){const C=Mc(u,h,T);f[T]?(f[T].p(C,m),L(f[T],1)):(f[T]=Dc(C),f[T].c(),L(f[T],1),f[T].m(s.parentNode,s))}for(ce(),T=h.length;T<f.length;T+=1)d(T);he()}if(m[0]&4104){g=Ee(u[3].rectangles);let T;for(T=0;T<g.length;T+=1){const C=Ec(u,g,T);p[T]?(p[T].p(C,m),L(p[T],1)):(p[T]=Ic(C),p[T].c(),L(p[T],1),p[T].m(a.parentNode,a))}for(ce(),T=g.length;T<p.length;T+=1)v(T);he()}if(m[0]&4104){b=Ee(u[3].legs);let T;for(T=0;T<b.length;T+=1){const C=xc(u,b,T);_[T]?(_[T].p(C,m),L(_[T],1)):(_[T]=Bc(C),_[T].c(),L(_[T],1),_[T].m(o.parentNode,o))}for(ce(),T=b.length;T<_.length;T+=1)w(T);he()}},i(u){if(!l){L(t.$$.fragment,u),L(i.$$.fragment,u);for(let m=0;m<h.length;m+=1)L(f[m]);for(let m=0;m<g.length;m+=1)L(p[m]);for(let m=0;m<b.length;m+=1)L(_[m]);l=!0}},o(u){B(t.$$.fragment,u),B(i.$$.fragment,u),f=f.filter(Boolean);for(let m=0;m<f.length;m+=1)B(f[m]);p=p.filter(Boolean);for(let m=0;m<p.length;m+=1)B(p[m]);_=_.filter(Boolean);for(let m=0;m<_.length;m+=1)B(_[m]);l=!1},d(u){u&&(R(e),R(n),R(s),R(a),R(o)),nt(t,u),r[30](null),nt(i,u),Hn(f,u),Hn(p,u),Hn(_,u)}}}function y4(r){let t,e;return t=new C2({props:{$$slots:{default:[v4]},$$scope:{ctx:r}}}),{c(){tt(t.$$.fragment)},l(i){et(t.$$.fragment,i)},m(i,n){it(t,i,n),e=!0},p(i,n){const s={};n[0]&15|n[1]&16777216&&(s.$$scope={dirty:n,ctx:i}),t.$set(s)},i(i){e||(L(t.$$.fragment,i),e=!0)},o(i){B(t.$$.fragment,i),e=!1},d(i){nt(t,i)}}}function b4(r){let t,e,i,n,s=r[3].filename+"",a,o,l,c,h,f,d,g,p;t=new Vu({props:{$$slots:{default:[p4]},$$scope:{ctx:r}}});let v=r[1]&&Oc(r);const b=[_4,m4],_=[];function w(u,m){return u[0]?u[1]?1:-1:0}return~(h=w(r))&&(f=_[h]=b[h](r)),{c(){tt(t.$$.fragment),e=mt(),i=ft("div"),n=ft("p"),a=vt(s),o=mt(),v&&v.c(),l=mt(),c=ft("div"),f&&f.c(),this.h()},l(u){et(t.$$.fragment,u),e=_t(u),i=ut(u,"DIV",{class:!0});var m=st(i);n=ut(m,"P",{class:!0});var y=st(n);a=yt(y,s),y.forEach(R),o=_t(m),v&&v.l(m),m.forEach(R),l=_t(u),c=ut(u,"DIV",{class:!0});var S=st(c);f&&f.l(S),S.forEach(R),this.h()},h(){K(n,"class","text-sm"),K(i,"class","flex justify-center"),K(c,"class","flex justify-center")},m(u,m){it(t,u,m),O(u,e,m),O(u,i,m),Et(i,n),Et(n,a),Et(i,o),v&&v.m(i,null),O(u,l,m),O(u,c,m),~h&&_[h].m(c,null),d=!0,g||(p=Uc(Of.call(null,window,{trigger:[{key:"C",modifier:["shift"],callback:r[15]},{key:"R",modifier:["shift"],callback:r[16]},{key:"L",modifier:["shift"],callback:r[17]},{key:"P",modifier:["shift"],callback:r[18]},{key:"d",callback:r[19]}]})),g=!0)},p(u,m){const y={};m[0]&17|m[1]&16777216&&(y.$$scope={dirty:m,ctx:u}),t.$set(y),(!d||m[0]&8)&&s!==(s=u[3].filename+"")&&$e(a,s),u[1]?v?v.p(u,m):(v=Oc(u),v.c(),v.m(i,null)):v&&(v.d(1),v=null);let S=h;h=w(u),h===S?~h&&_[h].p(u,m):(f&&(ce(),B(_[S],1,1,()=>{_[S]=null}),he()),~h?(f=_[h],f?f.p(u,m):(f=_[h]=b[h](u),f.c()),L(f,1),f.m(c,null)):f=null)},i(u){d||(L(t.$$.fragment,u),L(f),d=!0)},o(u){B(t.$$.fragment,u),B(f),d=!1},d(u){u&&(R(e),R(i),R(l),R(c)),nt(t,u),v&&v.d(),~h&&_[h].d(),g=!1,p()}}}const Gc=(r,t)=>r.name.localeCompare(t.name);function w4(r,t,e){let i,n;pi(r,zt,G=>e(3,i=G)),pi(r,Nf,G=>e(4,n=G)),Vi(()=>{const G=Vc(zt);G.image&&G.filename&&l(G.image,G.filename,!1,!1)});const s="1.2.1";let a,o;const l=(G,z,$,Tt)=>{if($&&G.startsWith("data:application/octet-stream"))try{const Wt=atob(G.replace("data:application/octet-stream;base64,","")),St=JSON.parse(Wt),$t=sf.safeParse(St);if($t.success){Ie(zt,i.circles=$t.data.circles||[],i),Ie(zt,i.rectangles=$t.data.rectangles||[],i),Ie(zt,i.legs=$t.data.legs||[],i),l($t.data.image,$t.data.filename,!1,!0),Ie(zt,i.panelSettings=$t.data.panelSettings,i);return}}catch{}e(0,a=document.createElement("img")),a.addEventListener("load",()=>{Ie(zt,i.filename=z,i),a&&(e(1,o={width:a.width,height:a.height}),$&&Ie(zt,i.panelSettings.height=Math.round(i.panelSettings.width*(o.height/o.width)),i),Ie(zt,i.image=G,i)),($||Tt)&&zt.update(Wt=>(Wt.image=G,Wt.filename=z,Wt)),$&&f()}),a.addEventListener("error",()=>{e(0,a=void 0),Ie(zt,i.image="",i),Ie(zt,i.filename="",i)}),e(0,a.src=G,a)},c=()=>{const G={image:i.image,filename:i.filename,panelSettings:i.panelSettings,circles:i.circles,rectangles:i.rectangles,legs:i.legs},z=of.stringify(G);xf(i.filename.slice(0,Math.max(0,i.filename.lastIndexOf(".")))+".tht3d",z)},h=async()=>{const{confirmed:G}=await Ef("Are you sure to reset PCB panel?");G&&(e(0,a=void 0),e(1,o=void 0),zt.update(z=>(z.image="",z.filename="",z.circles=[],z.rectangles=[],z.legs=[],z)))},f=async()=>{const{confirmed:G,settings:z}=await Mf(i.panelSettings);G&&zt.update($=>($.panelSettings=z,$))},d=G=>{switch(G.type){case"circle":{Wr({radius:G.radius,depth:G.depth});break}case"rectangle":{jr({width:G.width,height:G.height,depth:G.depth});break}}},g=()=>{if(!o)return;const G=M5({panelSettings:i.panelSettings,rectangles:i.rectangles,circles:i.circles,legs:i.legs});Ff(i.filename,G)},p=(G,z)=>{const $=G.detail.target,Tt=i.panelSettings.width-("sizeX"in z?z.width:ns),Wt=i.panelSettings.height-("sizeY"in z?z.height:ns);$.x()<0&&$.x(0),$.x()>Tt&&$.x(Tt),$.y()<0&&$.y(0),$.y()>Wt&&$.y(Wt)},v=(G,z)=>{const $=G.detail.target,Tt=z.radius,Wt=z.radius,St=i.panelSettings.width-z.radius,$t=i.panelSettings.height-z.radius;$.x()<Tt&&$.x(Tt),$.x()>St&&$.x(St),$.y()<Wt&&$.y(Wt),$.y()>$t&&$.y($t)};let b;const _=G=>{if(G.detail.evt.button===2){const z=G.detail.target.id();for(const $ of[U5,X5,z5]){const Tt=$(z);if(Tt!==void 0){b.setItems(Tt),b.toggleAt(G.detail.evt.pageX,G.detail.evt.pageY);return}}}},w=()=>Wr(),u=()=>jr(),m=()=>Pc(),y=()=>f(),S=()=>g(),T=()=>g(),C=()=>h(),A=()=>c(),k=()=>f(),P=()=>Wr(),x=()=>jr(),M=()=>Pc(),F=G=>d(G),N=()=>Rf(),I=(G,z)=>l(G,z,!0,!1);function V(G){wi[G?"unshift":"push"](()=>{b=G,e(2,b)})}function Z(G,z,$,Tt){$[Tt]=G,zt.set(i)}const lt=G=>lf(G),q=(G,z)=>v(z,G),J=()=>$n();function gt(G,z,$,Tt){$[Tt]=G,zt.set(i)}const At=G=>hf(G),U=(G,z)=>p(z,G),Ft=()=>wn();function Pt(G,z,$,Tt){$[Tt]=G,zt.set(i)}return[a,o,b,i,n,s,l,c,h,f,d,g,p,v,_,w,u,m,y,S,T,C,A,k,P,x,M,F,N,I,V,Z,lt,q,J,gt,At,U,Ft,Pt,G=>V5(G),(G,z)=>p(z,G),()=>sa()]}class F4 extends Nt{constructor(t){super(),Lt(this,t,w4,b4,Mt,{},null,[-1,-1])}}export{F4 as component};
