import{s as Mt,p as J,D as xi,aa as Ir,X as kt,a7 as fh,Y as Ti,q as _t,a0 as j,w as te,b as bt,e as ut,v as Xt,h as St,c as ft,d as at,g as F,o as Y,j as G,x as ee,y as ie,z as ne,a2 as _e,n as Yt,a1 as Ae,Z as Tr,$ as z,r as Mi,k as Et,m as ci,a3 as We,aj as dh,a4 as Xe,ak as gh,ad as hi,i as ph,H as mh,a6 as Ln,B as on,ah as In,ab as _h,C as mn,af as Pn,t as dt,f as gt,l as Ye,ae as Jl,_ as vh,ag as Le,ai as yh,a5 as bh}from"../chunks/scheduler.l0KnbNXC.js";import{S as Nt,i as Lt,f as Dr,b as Q,d as Z,m as tt,t as L,a as O,e as et,g as ge,c as pe,h as no}from"../chunks/index.9iX0w-dm.js";import{P as Sh,g as Qt,a as Ra,t as mt,W as wh,F as Ql,T as Ch,e as Pe,B as Gr,V,b as Pi,c as Na,L as me,d as ae,S as Ah,M as Me,f as ke,h as kh,D as La,i as ro,R as Zl,j as Fi,k as Th,l as Ph,n as tc,C as ec,z as rt,p as Eh,s as ic,q as nc,r as rc,v as sc,w as ac,x as xh,y as Mh,A as Fh,E as Rh,G as Nh,H as Lh,I as Ih}from"../chunks/modalStore.okGP63ih.js";import{w as ln}from"../chunks/index.EojX4vY5.js";import{b as Dh}from"../chunks/paths.JEpaNnS-.js";function Gh(r,t){let{enabled:e=!0,trigger:i,type:n="keydown"}=t;function s(a){const l=Array.isArray(i)?i:[i],o={alt:a.altKey,ctrl:a.ctrlKey,shift:a.shiftKey,meta:a.metaKey};for(const c of l){const h={modifier:[],preventDefault:!1,enabled:!0,...c},{modifier:f,key:d,callback:g,preventDefault:p,enabled:v}=h;if(v){if(f.length&&!(Array.isArray(f)?f:[f]).map(S=>typeof S=="string"?[S]:S).some(S=>S.every(u=>o[u])))continue;if(a.key===d){p&&a.preventDefault();const b={node:r,trigger:h,originalEvent:a};r.dispatchEvent(new CustomEvent("shortcut",{detail:b})),g?.(b)}}}}return e&&r.addEventListener(n,s),{update:a=>{const{enabled:l=!0,type:o="keydown"}=a;e&&(!l||n!==o)?r.removeEventListener(n,s):!e&&l&&r.addEventListener(o,s),e=l,n=o,i=a.trigger},destroy:()=>{r.removeEventListener(n,s)}}}function Oh(r){const t=r-1;return t*t*t+1}function Bh(r){return--r*r*r*r*r+1}function so(r,{delay:t=0,duration:e=400,easing:i=Oh,axis:n="y"}={}){const s=getComputedStyle(r),a=+s.opacity,l=n==="y"?"height":"width",o=parseFloat(s[l]),c=n==="y"?["top","bottom"]:["left","right"],h=c.map(_=>`${_[0].toUpperCase()}${_.slice(1)}`),f=parseFloat(s[`padding${h[0]}`]),d=parseFloat(s[`padding${h[1]}`]),g=parseFloat(s[`margin${h[0]}`]),p=parseFloat(s[`margin${h[1]}`]),v=parseFloat(s[`border${h[0]}Width`]),b=parseFloat(s[`border${h[1]}Width`]);return{delay:t,duration:e,easing:i,css:_=>`overflow: hidden;opacity: ${Math.min(_*20,1)*a};${l}: ${_*o}px;padding-${c[0]}: ${_*f}px;padding-${c[1]}: ${_*d}px;margin-${c[0]}: ${_*g}px;margin-${c[1]}: ${_*p}px;border-${c[0]}-width: ${_*v}px;border-${c[1]}-width: ${_*b}px;`}}const Uh=r=>({}),ao=r=>({}),Vh=r=>({}),oo=r=>({});function lo(r){let t,e;const i=r[12].header,n=te(i,r,r[15],oo);return{c(){t=ut("div"),n&&n.c(),this.h()},l(s){t=ft(s,"DIV",{class:!0});var a=at(t);n&&n.l(a),a.forEach(F),this.h()},h(){Y(t,"class",r[2])},m(s,a){G(s,t,a),n&&n.m(t,null),e=!0},p(s,a){n&&n.p&&(!e||a&32768)&&ee(n,i,s,s[15],e?ne(i,s[15],a,Vh):ie(s[15]),oo)},i(s){e||(L(n,s),e=!0)},o(s){O(n,s),e=!1},d(s){s&&F(t),n&&n.d(s)}}}function co(r){let t,e;const i=r[12].footer,n=te(i,r,r[15],ao);return{c(){t=ut("div"),n&&n.c(),this.h()},l(s){t=ft(s,"DIV",{class:!0});var a=at(t);n&&n.l(a),a.forEach(F),this.h()},h(){Y(t,"class",r[4])},m(s,a){G(s,t,a),n&&n.m(t,null),e=!0},p(s,a){n&&n.p&&(!e||a&32768)&&ee(n,i,s,s[15],e?ne(i,s[15],a,Uh):ie(s[15]),ao)},i(s){e||(L(n,s),e=!0)},o(s){O(n,s),e=!1},d(s){s&&F(t),n&&n.d(s)}}}function zh(r){let t,e,i,n,s,a=r[6].header&&lo(r);const l=r[12].default,o=te(l,r,r[15],null);let c=r[6].footer&&co(r);return{c(){a&&a.c(),t=bt(),e=ut("ul"),o&&o.c(),i=bt(),c&&c.c(),n=Xt(),this.h()},l(h){a&&a.l(h),t=St(h),e=ft(h,"UL",{class:!0});var f=at(e);o&&o.l(f),f.forEach(F),i=St(h),c&&c.l(h),n=Xt(),this.h()},h(){Y(e,"class",r[3])},m(h,f){a&&a.m(h,f),G(h,t,f),G(h,e,f),o&&o.m(e,null),G(h,i,f),c&&c.m(h,f),G(h,n,f),s=!0},p(h,f){h[6].header?a?(a.p(h,f),f&64&&L(a,1)):(a=lo(h),a.c(),L(a,1),a.m(t.parentNode,t)):a&&(ge(),O(a,1,1,()=>{a=null}),pe()),o&&o.p&&(!s||f&32768)&&ee(o,l,h,h[15],s?ne(l,h[15],f,null):ie(h[15]),null),h[6].footer?c?(c.p(h,f),f&64&&L(c,1)):(c=co(h),c.c(),L(c,1),c.m(n.parentNode,n)):c&&(ge(),O(c,1,1,()=>{c=null}),pe())},i(h){s||(L(a),L(o,h),L(c),s=!0)},o(h){O(a),O(o,h),O(c),s=!1},d(h){h&&(F(t),F(e),F(i),F(n)),a&&a.d(h),o&&o.d(h),c&&c.d(h)}}}function Hh(r){let t,e,i;const n=[{activeContent:!0},r[5],{class:r[1]}];function s(l){r[13](l)}let a={$$slots:{default:[zh]},$$scope:{ctx:r}};for(let l=0;l<n.length;l+=1)a=J(a,n[l]);return r[0]!==void 0&&(a.open=r[0]),t=new Sh({props:a}),xi.push(()=>Dr(t,"open",s)),t.$on("show",r[14]),{c(){Q(t.$$.fragment)},l(l){Z(t.$$.fragment,l)},m(l,o){tt(t,l,o),i=!0},p(l,[o]){const c=o&34?Qt(n,[n[0],o&32&&Ra(l[5]),o&2&&{class:l[1]}]):{};o&32832&&(c.$$scope={dirty:o,ctx:l}),!e&&o&1&&(e=!0,c.open=l[0],Ir(()=>e=!1)),t.$set(c)},i(l){i||(L(t.$$.fragment,l),i=!0)},o(l){O(t.$$.fragment,l),i=!1},d(l){et(t,l)}}}function jh(r,t,e){const i=["activeUrl","open","containerClass","headerClass","footerClass","activeClass"];let n=kt(t,i),{$$slots:s={},$$scope:a}=t;const l=fh(s),o=ln("");let{activeUrl:c=""}=t,{open:h=!1}=t,{containerClass:f="divide-y z-50"}=t,{headerClass:d="py-1 overflow-hidden rounded-t-lg"}=t,{footerClass:g="py-1 overflow-hidden rounded-b-lg"}=t,{activeClass:p="text-primary-700 dark:text-primary-700 hover:text-primary-900 dark:hover:text-primary-900"}=t,v=mt(p,t.classActive);Ti("DropdownType",{activeClass:v}),Ti("activeUrl",o);let b=mt(f,t.classContainer),_=mt(d,t.classHeader),S=mt("py-1",t.class),u=mt(g,t.classFooter);function m(w){h=w,e(0,h)}function y(w){j.call(this,r,w)}return r.$$set=w=>{e(18,t=J(J({},t),_t(w))),e(5,n=kt(t,i)),"activeUrl"in w&&e(7,c=w.activeUrl),"open"in w&&e(0,h=w.open),"containerClass"in w&&e(8,f=w.containerClass),"headerClass"in w&&e(9,d=w.headerClass),"footerClass"in w&&e(10,g=w.footerClass),"activeClass"in w&&e(11,p=w.activeClass),"$$scope"in w&&e(15,a=w.$$scope)},r.$$.update=()=>{r.$$.dirty&128&&o.set(c),e(5,n.arrow=n.arrow??!1,n),e(5,n.trigger=n.trigger??"click",n),e(5,n.placement=n.placement??"bottom",n),e(5,n.color=n.color??"dropdown",n),e(5,n.shadow=n.shadow??!0,n),e(5,n.rounded=n.rounded??!0,n)},t=_t(t),[h,b,_,S,u,n,l,c,f,d,g,p,s,m,y,a]}class ga extends Nt{constructor(t){super(),Lt(this,t,jh,Hh,Mt,{activeUrl:7,open:0,containerClass:8,headerClass:9,footerClass:10,activeClass:11})}}function Wh(r){let t,e,i=[r[1],{class:e=mt(r[0],r[2].class)}],n={};for(let s=0;s<i.length;s+=1)n=J(n,i[s]);return{c(){t=ut("div"),this.h()},l(s){t=ft(s,"DIV",{class:!0}),at(t).forEach(F),this.h()},h(){_e(t,n)},m(s,a){G(s,t,a)},p(s,[a]){_e(t,n=Qt(i,[a&2&&s[1],a&5&&e!==(e=mt(s[0],s[2].class))&&{class:e}]))},i:Yt,o:Yt,d(s){s&&F(t)}}}function Xh(r,t,e){const i=["divClass"];let n=kt(t,i),{divClass:s="my-1 h-px bg-gray-100 dark:bg-gray-600"}=t;return r.$$set=a=>{e(2,t=J(J({},t),_t(a))),e(1,n=kt(t,i)),"divClass"in a&&e(0,s=a.divClass)},t=_t(t),[s,n,t]}class oc extends Nt{constructor(t){super(),Lt(this,t,Xh,Wh,Mt,{divClass:0})}}function Ns(r){let t,e,i,n,s,a;const l=r[9].default,o=te(l,r,r[18],null);let c=[{href:r[0]},{type:e=r[0]?void 0:"button"},{role:i=r[0]?"link":"button"},r[4],{class:r[2]}],h={};for(let f=0;f<c.length;f+=1)h=J(h,c[f]);return{c(){t=ut(r[0]?"a":"button"),o&&o.c(),this.h()},l(f){t=ft(f,((r[0]?"a":"button")||"null").toUpperCase(),{href:!0,type:!0,role:!0,class:!0});var d=at(t);o&&o.l(d),d.forEach(F),this.h()},h(){Tr(r[0]?"a":"button")(t,h)},m(f,d){G(f,t,d),o&&o.m(t,null),n=!0,s||(a=[z(t,"click",r[10]),z(t,"change",r[11]),z(t,"keydown",r[12]),z(t,"keyup",r[13]),z(t,"focus",r[14]),z(t,"blur",r[15]),z(t,"mouseenter",r[16]),z(t,"mouseleave",r[17])],s=!0)},p(f,d){o&&o.p&&(!n||d&262144)&&ee(o,l,f,f[18],n?ne(l,f[18],d,null):ie(f[18]),null),Tr(f[0]?"a":"button")(t,h=Qt(c,[(!n||d&1)&&{href:f[0]},(!n||d&1&&e!==(e=f[0]?void 0:"button"))&&{type:e},(!n||d&1&&i!==(i=f[0]?"link":"button"))&&{role:i},d&16&&f[4],(!n||d&4)&&{class:f[2]}]))},i(f){n||(L(o,f),n=!0)},o(f){O(o,f),n=!1},d(f){f&&F(t),o&&o.d(f),s=!1,Mi(a)}}}function Yh(r){let t=r[0]?"a":"button",e,i,n=(r[0]?"a":"button")&&Ns(r);return{c(){n&&n.c(),e=Xt()},l(s){n&&n.l(s),e=Xt()},m(s,a){n&&n.m(s,a),G(s,e,a),i=!0},p(s,a){s[0],t?Mt(t,s[0]?"a":"button")?(n.d(1),n=Ns(s),t=s[0]?"a":"button",n.c(),n.m(e.parentNode,e)):n.p(s,a):(n=Ns(s),t=s[0]?"a":"button",n.c(),n.m(e.parentNode,e))},i(s){i||(L(n,s),i=!0)},o(s){O(n,s),i=!1},d(s){s&&F(e),n&&n.d(s)}}}function Kh(r){let t,e;return t=new wh({props:{tag:"li",show:r[1],use:r[3],$$slots:{default:[Yh]},$$scope:{ctx:r}}}),{c(){Q(t.$$.fragment)},l(i){Z(t.$$.fragment,i)},m(i,n){tt(t,i,n),e=!0},p(i,[n]){const s={};n&2&&(s.show=i[1]),n&262165&&(s.$$scope={dirty:n,ctx:i}),t.$set(s)},i(i){e||(L(t.$$.fragment,i),e=!0)},o(i){O(t.$$.fragment,i),e=!1},d(i){et(t,i)}}}function $h(r,t,e){let i,n;const s=["defaultClass","href","activeClass"];let a=kt(t,s),{$$slots:l={},$$scope:o}=t,{defaultClass:c="font-medium py-2 px-4 text-sm hover:bg-gray-100 dark:hover:bg-gray-600"}=t,{href:h=void 0}=t,{activeClass:f=void 0}=t;const d=Ae("DropdownType")??{},g=Ae("activeUrl");let p="";g.subscribe(A=>{e(7,p=A)});let v=!0;function b(A){e(1,v=A.parentElement?.tagName==="UL")}function _(A){j.call(this,r,A)}function S(A){j.call(this,r,A)}function u(A){j.call(this,r,A)}function m(A){j.call(this,r,A)}function y(A){j.call(this,r,A)}function w(A){j.call(this,r,A)}function k(A){j.call(this,r,A)}function C(A){j.call(this,r,A)}return r.$$set=A=>{e(21,t=J(J({},t),_t(A))),e(4,a=kt(t,s)),"defaultClass"in A&&e(5,c=A.defaultClass),"href"in A&&e(0,h=A.href),"activeClass"in A&&e(6,f=A.activeClass),"$$scope"in A&&e(18,o=A.$$scope)},r.$$.update=()=>{r.$$.dirty&129&&e(8,i=p?h===p:!1),e(2,n=mt(c,h?"block":"w-full text-left",i&&(f??d.activeClass),t.class))},t=_t(t),[h,v,n,b,a,c,f,p,i,l,_,S,u,m,y,w,k,C,o]}class He extends Nt{constructor(t){super(),Lt(this,t,$h,Kh,Mt,{defaultClass:5,href:0,activeClass:6})}}function qh(r){let t,e,i,n,s,a,l,o;const c=r[8].default,h=te(c,r,r[7],null);let f=[r[6],{type:"file"},{class:"hidden"}],d={};for(let g=0;g<f.length;g+=1)d=J(d,f[g]);return{c(){t=ut("button"),e=ut("label"),h&&h.c(),i=bt(),n=ut("input"),this.h()},l(g){t=ft(g,"BUTTON",{class:!0,type:!0});var p=at(t);e=ft(p,"LABEL",{class:!0,tabindex:!0});var v=at(e);h&&h.l(v),i=St(v),n=ft(v,"INPUT",{type:!0,class:!0}),v.forEach(F),p.forEach(F),this.h()},h(){_e(n,d),Y(e,"class","flex flex-col items-center"),Y(e,"tabindex","0"),Y(t,"class",s=mt(r[2],r[5].class)),Y(t,"type","button")},m(g,p){G(g,t,p),Et(t,e),h&&h.m(e,null),Et(e,i),Et(e,n),n.autofocus&&n.focus(),r[21](n),a=!0,l||(o=[z(n,"change",r[20]),z(n,"change",r[18]),z(n,"click",r[19]),z(t,"keydown",r[4]),z(t,"focus",r[9]),z(t,"blur",r[10]),z(t,"mouseenter",r[11]),z(t,"mouseleave",r[12]),z(t,"mouseover",r[13]),z(t,"dragenter",r[14]),z(t,"dragleave",r[15]),z(t,"dragover",r[16]),z(t,"drop",r[17])],l=!0)},p(g,[p]){h&&h.p&&(!a||p&128)&&ee(h,c,g,g[7],a?ne(c,g[7],p,null):ie(g[7]),null),_e(n,d=Qt(f,[p&64&&g[6],{type:"file"},{class:"hidden"}])),(!a||p&36&&s!==(s=mt(g[2],g[5].class)))&&Y(t,"class",s)},i(g){a||(L(h,g),a=!0)},o(g){O(h,g),a=!1},d(g){g&&F(t),h&&h.d(g),r[21](null),l=!1,Mi(o)}}}function Jh(r,t,e){const i=["value","files","defaultClass"];let n=kt(t,i),{$$slots:s={},$$scope:a}=t,{value:l=""}=t,{files:o=void 0}=t,{defaultClass:c="flex flex-col justify-center items-center w-full h-64 bg-gray-50 rounded-lg border-2 border-gray-300 border-dashed cursor-pointer dark:hover:bg-bray-800 dark:bg-gray-700 hover:bg-gray-100 dark:border-gray-600 dark:hover:border-gray-500 dark:hover:bg-gray-600"}=t,h;function f(A){[" ","Enter"].includes(A.key)&&(A.preventDefault(),h.click())}function d(A){j.call(this,r,A)}function g(A){j.call(this,r,A)}function p(A){j.call(this,r,A)}function v(A){j.call(this,r,A)}function b(A){j.call(this,r,A)}function _(A){j.call(this,r,A)}function S(A){j.call(this,r,A)}function u(A){j.call(this,r,A)}function m(A){j.call(this,r,A)}function y(A){j.call(this,r,A)}function w(A){j.call(this,r,A)}function k(){l=this.value,o=this.files,e(0,l),e(1,o)}function C(A){xi[A?"unshift":"push"](()=>{h=A,e(3,h)})}return r.$$set=A=>{e(5,t=J(J({},t),_t(A))),e(6,n=kt(t,i)),"value"in A&&e(0,l=A.value),"files"in A&&e(1,o=A.files),"defaultClass"in A&&e(2,c=A.defaultClass),"$$scope"in A&&e(7,a=A.$$scope)},t=_t(t),[l,o,c,h,f,t,n,a,s,d,g,p,v,b,_,S,u,m,y,w,k,C]}class Qh extends Nt{constructor(t){super(),Lt(this,t,Jh,qh,Mt,{value:0,files:1,defaultClass:2})}}function Zh(r){let t,e,i;const n=r[3].default,s=te(n,r,r[2],null);return{c(){t=ut("kbd"),s&&s.c(),this.h()},l(a){t=ft(a,"KBD",{class:!0});var l=at(t);s&&s.l(l),l.forEach(F),this.h()},h(){Y(t,"class",e=mt(r[0],r[1].class))},m(a,l){G(a,t,l),s&&s.m(t,null),i=!0},p(a,[l]){s&&s.p&&(!i||l&4)&&ee(s,n,a,a[2],i?ne(n,a[2],l,null):ie(a[2]),null),(!i||l&3&&e!==(e=mt(a[0],a[1].class)))&&Y(t,"class",e)},i(a){i||(L(s,a),i=!0)},o(a){O(s,a),i=!1},d(a){a&&F(t),s&&s.d(a)}}}function tu(r,t,e){let{$$slots:i={},$$scope:n}=t,{kbdClass:s="text-xs font-semibold text-gray-800 bg-gray-100 border border-gray-200 rounded-lg dark:bg-gray-600 dark:text-gray-100 dark:border-gray-500"}=t;return r.$$set=a=>{e(1,t=J(J({},t),_t(a))),"kbdClass"in a&&e(0,s=a.kbdClass),"$$scope"in a&&e(2,n=a.$$scope)},t=_t(t),[s,t,n,i]}class Dn extends Nt{constructor(t){super(),Lt(this,t,tu,Zh,Mt,{kbdClass:0})}}function eu(r){let t,e,i;const n=r[3].default,s=te(n,r,r[2],null);return{c(){t=ut("div"),s&&s.c(),this.h()},l(a){t=ft(a,"DIV",{class:!0});var l=at(t);s&&s.l(l),l.forEach(F),this.h()},h(){Y(t,"class",e=mt("mx-auto flex flex-wrap justify-between items-center ",r[0]?"w-full":"container",r[1].class))},m(a,l){G(a,t,l),s&&s.m(t,null),i=!0},p(a,[l]){s&&s.p&&(!i||l&4)&&ee(s,n,a,a[2],i?ne(n,a[2],l,null):ie(a[2]),null),(!i||l&3&&e!==(e=mt("mx-auto flex flex-wrap justify-between items-center ",a[0]?"w-full":"container",a[1].class)))&&Y(t,"class",e)},i(a){i||(L(s,a),i=!0)},o(a){O(s,a),i=!1},d(a){a&&F(t),s&&s.d(a)}}}function iu(r,t,e){let{$$slots:i={},$$scope:n}=t,{fluid:s=!1}=t;return r.$$set=a=>{e(1,t=J(J({},t),_t(a))),"fluid"in a&&e(0,s=a.fluid),"$$scope"in a&&e(2,n=a.$$scope)},t=_t(t),[s,t,n,i]}class lc extends Nt{constructor(t){super(),Lt(this,t,iu,eu,Mt,{fluid:0})}}const nu=r=>({hidden:r&2}),ho=r=>({hidden:r[1],toggle:r[3],NavContainer:lc});function ru(r){let t;const e=r[6].default,i=te(e,r,r[7],ho);return{c(){i&&i.c()},l(n){i&&i.l(n)},m(n,s){i&&i.m(n,s),t=!0},p(n,s){i&&i.p&&(!t||s&130)&&ee(i,e,n,n[7],t?ne(e,n[7],s,nu):ie(n[7]),ho)},i(n){t||(L(i,n),t=!0)},o(n){O(i,n),t=!1},d(n){i&&i.d(n)}}}function su(r){let t,e;return t=new lc({props:{fluid:r[0],$$slots:{default:[ru]},$$scope:{ctx:r}}}),{c(){Q(t.$$.fragment)},l(i){Z(t.$$.fragment,i)},m(i,n){tt(t,i,n),e=!0},p(i,n){const s={};n&1&&(s.fluid=i[0]),n&130&&(s.$$scope={dirty:n,ctx:i}),t.$set(s)},i(i){e||(L(t.$$.fragment,i),e=!0)},o(i){O(t.$$.fragment,i),e=!1},d(i){et(t,i)}}}function au(r){let t,e;const i=[{tag:"nav"},r[4],{class:mt("px-2 sm:px-4 py-2.5 w-full",r[5].class)}];let n={$$slots:{default:[su]},$$scope:{ctx:r}};for(let s=0;s<i.length;s+=1)n=J(n,i[s]);return t=new Ql({props:n}),{c(){Q(t.$$.fragment)},l(s){Z(t.$$.fragment,s)},m(s,a){tt(t,s,a),e=!0},p(s,[a]){const l=a&48?Qt(i,[i[0],a&16&&Ra(s[4]),a&32&&{class:mt("px-2 sm:px-4 py-2.5 w-full",s[5].class)}]):{};a&131&&(l.$$scope={dirty:a,ctx:s}),t.$set(l)},i(s){e||(L(t.$$.fragment,s),e=!0)},o(s){O(t.$$.fragment,s),e=!1},d(s){et(t,s)}}}function ou(r,t,e){const i=["fluid"];let n=kt(t,i),s,{$$slots:a={},$$scope:l}=t,{fluid:o=!1}=t,c=ln(!0);ci(r,c,f=>e(1,s=f)),Ti("navHidden",c);let h=()=>c.update(f=>!f);return r.$$set=f=>{e(5,t=J(J({},t),_t(f))),e(4,n=kt(t,i)),"fluid"in f&&e(0,o=f.fluid),"$$scope"in f&&e(7,l=f.$$scope)},r.$$.update=()=>{e(4,n.color=n.color??"navbar",n)},t=_t(t),[o,s,c,h,n,t,a,l]}class lu extends Nt{constructor(t){super(),Lt(this,t,ou,au,Mt,{fluid:0})}}function cu(r){let t,e,i;const n=r[4].default,s=te(n,r,r[3],null);let a=[{href:r[0]},r[1],{class:e=mt("flex items-center",r[2].class)}],l={};for(let o=0;o<a.length;o+=1)l=J(l,a[o]);return{c(){t=ut("a"),s&&s.c(),this.h()},l(o){t=ft(o,"A",{href:!0,class:!0});var c=at(t);s&&s.l(c),c.forEach(F),this.h()},h(){_e(t,l)},m(o,c){G(o,t,c),s&&s.m(t,null),i=!0},p(o,[c]){s&&s.p&&(!i||c&8)&&ee(s,n,o,o[3],i?ne(n,o[3],c,null):ie(o[3]),null),_e(t,l=Qt(a,[(!i||c&1)&&{href:o[0]},c&2&&o[1],(!i||c&4&&e!==(e=mt("flex items-center",o[2].class)))&&{class:e}]))},i(o){i||(L(s,o),i=!0)},o(o){O(s,o),i=!1},d(o){o&&F(t),s&&s.d(o)}}}function hu(r,t,e){const i=["href"];let n=kt(t,i),{$$slots:s={},$$scope:a}=t,{href:l=""}=t;return r.$$set=o=>{e(2,t=J(J({},t),_t(o))),e(1,n=kt(t,i)),"href"in o&&e(0,l=o.href),"$$scope"in o&&e(3,a=o.$$scope)},t=_t(t),[l,n,t,a,s]}class uu extends Nt{constructor(t){super(),Lt(this,t,hu,cu,Mt,{href:0})}}function fu(r){let t,e,i,n,s,a=[{xmlns:"http://www.w3.org/2000/svg"},{role:"button"},{tabindex:"0"},{width:r[0]},{height:r[0]},{class:i=r[4].class},r[5],{"aria-label":r[1]},{fill:"none"},{viewBox:r[2]},{"stroke-width":"2"}],l={};for(let o=0;o<a.length;o+=1)l=J(l,a[o]);return{c(){t=We("svg"),e=new dh(!0),this.h()},l(o){t=Xe(o,"svg",{xmlns:!0,role:!0,tabindex:!0,width:!0,height:!0,class:!0,"aria-label":!0,fill:!0,viewBox:!0,"stroke-width":!0});var c=at(t);e=gh(c,!0),c.forEach(F),this.h()},h(){e.a=null,hi(t,l)},m(o,c){G(o,t,c),e.m(r[3],t),n||(s=z(t,"click",r[8]),n=!0)},p(o,[c]){c&8&&e.p(o[3]),hi(t,l=Qt(a,[{xmlns:"http://www.w3.org/2000/svg"},{role:"button"},{tabindex:"0"},c&1&&{width:o[0]},c&1&&{height:o[0]},c&16&&i!==(i=o[4].class)&&{class:i},c&32&&o[5],c&2&&{"aria-label":o[1]},{fill:"none"},c&4&&{viewBox:o[2]},{"stroke-width":"2"}]))},i:Yt,o:Yt,d(o){o&&F(t),n=!1,s()}}}function du(r,t,e){const i=["size","color","variation","ariaLabel"];let n=kt(t,i),{size:s="24"}=t,{color:a="currentColor"}=t,{variation:l="outline"}=t,{ariaLabel:o="bars 3"}=t,c,h,f=`<path stroke="${a}" stroke-linecap="round" stroke-linejoin="round" d="M4 6h16M4 12h16M4 18h16"></path> `,d=`<path fill="${a}" clip-rule="evenodd" fill-rule="evenodd" d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z"></path> `;function g(p){j.call(this,r,p)}return r.$$set=p=>{e(4,t=J(J({},t),_t(p))),e(5,n=kt(t,i)),"size"in p&&e(0,s=p.size),"color"in p&&e(6,a=p.color),"variation"in p&&e(7,l=p.variation),"ariaLabel"in p&&e(1,o=p.ariaLabel)},r.$$.update=()=>{if(r.$$.dirty&128)switch(l){case"outline":e(3,h=f),e(2,c="0 0 24 24");break;case"solid":e(3,h=d),e(2,c="0 0 24 24");break;default:e(3,h=f),e(2,c="0 0 24 24")}},t=_t(t),[s,o,c,h,t,n,a,l,g]}class gu extends Nt{constructor(t){super(),Lt(this,t,du,fu,Mt,{size:0,color:6,variation:7,ariaLabel:1})}}function pu(r){let t,e;return t=new gu({props:{class:mt(r[0],r[4].classMenu)}}),{c(){Q(t.$$.fragment)},l(i){Z(t.$$.fragment,i)},m(i,n){tt(t,i,n),e=!0},p(i,n){const s={};n&17&&(s.class=mt(i[0],i[4].classMenu)),t.$set(s)},i(i){e||(L(t.$$.fragment,i),e=!0)},o(i){O(t.$$.fragment,i),e=!1},d(i){et(t,i)}}}function mu(r){let t,e;const i=[{name:"Open main menu"},r[3],{class:mt(uo,r[4].class)}];let n={$$slots:{default:[pu]},$$scope:{ctx:r}};for(let s=0;s<i.length;s+=1)n=J(n,i[s]);return t=new Ch({props:n}),t.$on("click",function(){ph(r[1]||r[2])&&(r[1]||r[2]).apply(this,arguments)}),{c(){Q(t.$$.fragment)},l(s){Z(t.$$.fragment,s)},m(s,a){tt(t,s,a),e=!0},p(s,[a]){r=s;const l=a&24?Qt(i,[i[0],a&8&&Ra(r[3]),a&16&&{class:mt(uo,r[4].class)}]):{};a&81&&(l.$$scope={dirty:a,ctx:r}),t.$set(l)},i(s){e||(L(t.$$.fragment,s),e=!0)},o(s){O(t.$$.fragment,s),e=!1},d(s){et(t,s)}}}let uo="ms-3 md:hidden";function _u(r,t,e){const i=["menuClass","onClick"];let n=kt(t,i),{menuClass:s="h-6 w-6 shrink-0"}=t,{onClick:a=void 0}=t,l=Ae("navHidden")??ln(!0);const o=c=>l.update(h=>!h);return r.$$set=c=>{e(4,t=J(J({},t),_t(c))),e(3,n=kt(t,i)),"menuClass"in c&&e(0,s=c.menuClass),"onClick"in c&&e(1,a=c.onClick)},t=_t(t),[s,a,o,n,t]}class vu extends Nt{constructor(t){super(),Lt(this,t,_u,mu,Mt,{menuClass:0,onClick:1})}}function Ls(r){let t,e,i,n,s;const a=r[8].default,l=te(a,r,r[7],null);let o=[{role:e=r[0]?void 0:"link"},{href:r[0]},r[2],{class:r[1]}],c={};for(let h=0;h<o.length;h+=1)c=J(c,o[h]);return{c(){t=ut(r[0]?"a":"div"),l&&l.c(),this.h()},l(h){t=ft(h,((r[0]?"a":"div")||"null").toUpperCase(),{role:!0,href:!0,class:!0});var f=at(t);l&&l.l(f),f.forEach(F),this.h()},h(){Tr(r[0]?"a":"div")(t,c)},m(h,f){G(h,t,f),l&&l.m(t,null),i=!0,n||(s=[z(t,"blur",r[9]),z(t,"change",r[10]),z(t,"click",r[11]),z(t,"focus",r[12]),z(t,"keydown",r[13]),z(t,"keypress",r[14]),z(t,"keyup",r[15]),z(t,"mouseenter",r[16]),z(t,"mouseleave",r[17]),z(t,"mouseover",r[18])],n=!0)},p(h,f){l&&l.p&&(!i||f&128)&&ee(l,a,h,h[7],i?ne(a,h[7],f,null):ie(h[7]),null),Tr(h[0]?"a":"div")(t,c=Qt(o,[(!i||f&1&&e!==(e=h[0]?void 0:"link"))&&{role:e},(!i||f&1)&&{href:h[0]},f&4&&h[2],(!i||f&2)&&{class:h[1]}]))},i(h){i||(L(l,h),i=!0)},o(h){O(l,h),i=!1},d(h){h&&F(t),l&&l.d(h),n=!1,Mi(s)}}}function yu(r){let t,e=r[0]?"a":"div",i,n=(r[0]?"a":"div")&&Ls(r);return{c(){t=ut("li"),n&&n.c()},l(s){t=ft(s,"LI",{});var a=at(t);n&&n.l(a),a.forEach(F)},m(s,a){G(s,t,a),n&&n.m(t,null),i=!0},p(s,[a]){s[0],e?Mt(e,s[0]?"a":"div")?(n.d(1),n=Ls(s),e=s[0]?"a":"div",n.c(),n.m(t,null)):n.p(s,a):(n=Ls(s),e=s[0]?"a":"div",n.c(),n.m(t,null))},i(s){i||(L(n,s),i=!0)},o(s){O(n,s),i=!1},d(s){s&&F(t),n&&n.d(s)}}}function bu(r,t,e){let i,n;const s=["href","activeClass","nonActiveClass"];let a=kt(t,s),{$$slots:l={},$$scope:o}=t,{href:c=""}=t,{activeClass:h=void 0}=t,{nonActiveClass:f=void 0}=t;const d=Ae("navbarContext")??{},g=Ae("activeUrl");let p="";g.subscribe(A=>{e(5,p=A)});function v(A){j.call(this,r,A)}function b(A){j.call(this,r,A)}function _(A){j.call(this,r,A)}function S(A){j.call(this,r,A)}function u(A){j.call(this,r,A)}function m(A){j.call(this,r,A)}function y(A){j.call(this,r,A)}function w(A){j.call(this,r,A)}function k(A){j.call(this,r,A)}function C(A){j.call(this,r,A)}return r.$$set=A=>{e(21,t=J(J({},t),_t(A))),e(2,a=kt(t,s)),"href"in A&&e(0,c=A.href),"activeClass"in A&&e(3,h=A.activeClass),"nonActiveClass"in A&&e(4,f=A.nonActiveClass),"$$scope"in A&&e(7,o=A.$$scope)},r.$$.update=()=>{r.$$.dirty&33&&e(6,i=p?c===p:!1),e(1,n=mt("block py-2 pe-4 ps-3 md:p-0 rounded md:border-0",i?h??d.activeClass:f??d.nonActiveClass,t.class))},t=_t(t),[c,n,a,h,f,p,i,o,l,v,b,_,S,u,m,y,w,k,C]}class fo extends Nt{constructor(t){super(),Lt(this,t,bu,yu,Mt,{href:0,activeClass:3,nonActiveClass:4})}}function Su(r){let t,e,i;const n=r[13].default,s=te(n,r,r[15],null);let a=[r[5],{class:r[2]},{hidden:r[1]}],l={};for(let o=0;o<a.length;o+=1)l=J(l,a[o]);return{c(){t=ut("div"),e=ut("ul"),s&&s.c(),this.h()},l(o){t=ft(o,"DIV",{class:!0});var c=at(t);e=ft(c,"UL",{class:!0});var h=at(e);s&&s.l(h),h.forEach(F),c.forEach(F),this.h()},h(){Y(e,"class",r[3]),_e(t,l)},m(o,c){G(o,t,c),Et(t,e),s&&s.m(e,null),i=!0},p(o,c){s&&s.p&&(!i||c&32768)&&ee(s,n,o,o[15],i?ne(n,o[15],c,null):ie(o[15]),null),(!i||c&8)&&Y(e,"class",o[3]),_e(t,l=Qt(a,[c&32&&o[5],(!i||c&4)&&{class:o[2]},(!i||c&2)&&{hidden:o[1]}]))},i(o){i||(L(s,o),i=!0)},o(o){O(s,o),i=!1},d(o){o&&F(t),s&&s.d(o)}}}function wu(r){let t,e,i,n,s,a;e=new Ql({props:{tag:"ul",border:!0,rounded:!0,color:"navbarUl",class:r[3],$$slots:{default:[Cu]},$$scope:{ctx:r}}});let l=[r[5],{class:r[2]},{role:"button"},{tabindex:"0"}],o={};for(let c=0;c<l.length;c+=1)o=J(o,l[c]);return{c(){t=ut("div"),Q(e.$$.fragment),this.h()},l(c){t=ft(c,"DIV",{class:!0,role:!0,tabindex:!0});var h=at(t);Z(e.$$.fragment,h),h.forEach(F),this.h()},h(){_e(t,o)},m(c,h){G(c,t,h),tt(e,t,null),n=!0,s||(a=z(t,"click",r[14]),s=!0)},p(c,h){r=c;const f={};h&8&&(f.class=r[3]),h&32768&&(f.$$scope={dirty:h,ctx:r}),e.$set(f),_e(t,o=Qt(l,[h&32&&r[5],(!n||h&4)&&{class:r[2]},{role:"button"},{tabindex:"0"}]))},i(c){n||(L(e.$$.fragment,c),c&&mh(()=>{n&&(i||(i=no(t,so,r[0],!0)),i.run(1))}),n=!0)},o(c){O(e.$$.fragment,c),c&&(i||(i=no(t,so,r[0],!1)),i.run(0)),n=!1},d(c){c&&F(t),et(e),c&&i&&i.end(),s=!1,a()}}}function Cu(r){let t;const e=r[13].default,i=te(e,r,r[15],null);return{c(){i&&i.c()},l(n){i&&i.l(n)},m(n,s){i&&i.m(n,s),t=!0},p(n,s){i&&i.p&&(!t||s&32768)&&ee(i,e,n,n[15],t?ne(e,n[15],s,null):ie(n[15]),null)},i(n){t||(L(i,n),t=!0)},o(n){O(i,n),t=!1},d(n){i&&i.d(n)}}}function Au(r){let t,e,i,n;const s=[wu,Su],a=[];function l(o,c){return o[1]?1:0}return t=l(r),e=a[t]=s[t](r),{c(){e.c(),i=Xt()},l(o){e.l(o),i=Xt()},m(o,c){a[t].m(o,c),G(o,i,c),n=!0},p(o,[c]){let h=t;t=l(o),t===h?a[t].p(o,c):(ge(),O(a[h],1,1,()=>{a[h]=null}),pe(),e=a[t],e?e.p(o,c):(e=a[t]=s[t](o),e.c()),L(e,1),e.m(i.parentNode,i))},i(o){n||(L(e),n=!0)},o(o){O(e),n=!1},d(o){o&&F(i),a[t].d(o)}}}function ku(r,t,e){const i=["activeUrl","divClass","ulClass","hidden","slideParams","activeClass","nonActiveClass"];let n=kt(t,i),s,{$$slots:a={},$$scope:l}=t;const o=ln("");let{activeUrl:c=""}=t,{divClass:h="w-full md:block md:w-auto"}=t,{ulClass:f="flex flex-col p-4 mt-4 md:flex-row md:space-x-8 rtl:space-x-reverse md:mt-0 md:text-sm md:font-medium"}=t,{hidden:d=void 0}=t,{slideParams:g={delay:250,duration:500,easing:Bh}}=t,{activeClass:p="text-white bg-primary-700 md:bg-transparent md:text-primary-700 md:dark:text-white dark:bg-primary-600 md:dark:bg-transparent"}=t,{nonActiveClass:v="text-gray-700 hover:bg-gray-100 md:hover:bg-transparent md:border-0 md:hover:text-primary-700 dark:text-gray-400 md:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white md:dark:hover:bg-transparent"}=t;Ti("navbarContext",{activeClass:p,nonActiveClass:v}),Ti("activeUrl",o);let b=Ae("navHidden");ci(r,b,y=>e(12,s=y));let _,S,u;function m(y){j.call(this,r,y)}return r.$$set=y=>{e(17,t=J(J({},t),_t(y))),e(5,n=kt(t,i)),"activeUrl"in y&&e(6,c=y.activeUrl),"divClass"in y&&e(7,h=y.divClass),"ulClass"in y&&e(8,f=y.ulClass),"hidden"in y&&e(9,d=y.hidden),"slideParams"in y&&e(0,g=y.slideParams),"activeClass"in y&&e(10,p=y.activeClass),"nonActiveClass"in y&&e(11,v=y.nonActiveClass),"$$scope"in y&&e(15,l=y.$$scope)},r.$$.update=()=>{r.$$.dirty&64&&o.set(c),r.$$.dirty&4608&&e(1,_=d??s??!0),e(2,S=mt(h,t.class)),e(3,u=mt(f,t.classUl))},t=_t(t),[g,_,S,u,b,n,c,h,f,d,p,v,s,a,m,l]}class Tu extends Nt{constructor(t){super(),Lt(this,t,ku,Au,Mt,{activeUrl:6,divClass:7,ulClass:8,hidden:9,slideParams:0,activeClass:10,nonActiveClass:11})}}function Pu(r){let t,e,i,n,s,a=[{xmlns:"http://www.w3.org/2000/svg"},{fill:"none"},r[7],{class:i=mt("shrink-0",r[6][r[0]],r[8].class)},{role:r[1]},{"aria-label":r[5]},{viewBox:"0 0 10 7"}],l={};for(let o=0;o<a.length;o+=1)l=J(l,a[o]);return{c(){t=We("svg"),e=We("path"),this.h()},l(o){t=Xe(o,"svg",{xmlns:!0,fill:!0,class:!0,role:!0,"aria-label":!0,viewBox:!0});var c=at(t);e=Xe(c,"path",{stroke:!0,"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),at(e).forEach(F),c.forEach(F),this.h()},h(){Y(e,"stroke","currentColor"),Y(e,"stroke-linecap",r[2]),Y(e,"stroke-linejoin",r[3]),Y(e,"stroke-width",r[4]),Y(e,"d","m1 1.444 4 3.791 4-3.79"),hi(t,l)},m(o,c){G(o,t,c),Et(t,e),n||(s=[z(t,"click",r[9]),z(t,"keydown",r[10]),z(t,"keyup",r[11]),z(t,"focus",r[12]),z(t,"blur",r[13]),z(t,"mouseenter",r[14]),z(t,"mouseleave",r[15]),z(t,"mouseover",r[16]),z(t,"mouseout",r[17])],n=!0)},p(o,[c]){c&4&&Y(e,"stroke-linecap",o[2]),c&8&&Y(e,"stroke-linejoin",o[3]),c&16&&Y(e,"stroke-width",o[4]),hi(t,l=Qt(a,[{xmlns:"http://www.w3.org/2000/svg"},{fill:"none"},c&128&&o[7],c&257&&i!==(i=mt("shrink-0",o[6][o[0]],o[8].class))&&{class:i},c&2&&{role:o[1]},c&32&&{"aria-label":o[5]},{viewBox:"0 0 10 7"}]))},i:Yt,o:Yt,d(o){o&&F(t),n=!1,Mi(s)}}}function Eu(r,t,e){const i=["size","role","strokeLinecap","strokeLinejoin","strokeWidth","ariaLabel"];let n=kt(t,i);const s=Ae("iconCtx")??{},a={xs:"w-3 h-3",sm:"w-4 h-4",md:"w-5 h-5",lg:"w-6 h-6",xl:"w-8 h-8"};let{size:l=s.size||"md"}=t,{role:o=s.role||"img"}=t,{strokeLinecap:c=s.strokeLinecap||"round"}=t,{strokeLinejoin:h=s.strokeLinejoin||"round"}=t,{strokeWidth:f=s.strokeWidth||"2"}=t,{ariaLabel:d="chevron down outline"}=t;function g(w){j.call(this,r,w)}function p(w){j.call(this,r,w)}function v(w){j.call(this,r,w)}function b(w){j.call(this,r,w)}function _(w){j.call(this,r,w)}function S(w){j.call(this,r,w)}function u(w){j.call(this,r,w)}function m(w){j.call(this,r,w)}function y(w){j.call(this,r,w)}return r.$$set=w=>{e(8,t=J(J({},t),_t(w))),e(7,n=kt(t,i)),"size"in w&&e(0,l=w.size),"role"in w&&e(1,o=w.role),"strokeLinecap"in w&&e(2,c=w.strokeLinecap),"strokeLinejoin"in w&&e(3,h=w.strokeLinejoin),"strokeWidth"in w&&e(4,f=w.strokeWidth),"ariaLabel"in w&&e(5,d=w.ariaLabel)},t=_t(t),[l,o,c,h,f,d,a,n,t,g,p,v,b,_,S,u,m,y]}class cc extends Nt{constructor(t){super(),Lt(this,t,Eu,Pu,Mt,{size:0,role:1,strokeLinecap:2,strokeLinejoin:3,strokeWidth:4,ariaLabel:5})}}function xu(r){let t,e,i,n,s,a=[{xmlns:"http://www.w3.org/2000/svg"},{fill:"currentColor"},r[4],{class:i=mt("shrink-0",r[3][r[0]],r[5].class)},{role:r[1]},{"aria-label":r[2]},{viewBox:"0 0 6 10"}],l={};for(let o=0;o<a.length;o+=1)l=J(l,a[o]);return{c(){t=We("svg"),e=We("path"),this.h()},l(o){t=Xe(o,"svg",{xmlns:!0,fill:!0,class:!0,role:!0,"aria-label":!0,viewBox:!0});var c=at(t);e=Xe(c,"path",{fill:!0,d:!0}),at(e).forEach(F),c.forEach(F),this.h()},h(){Y(e,"fill","currentColor"),Y(e,"d","M1.01 10a.997.997 0 0 1-.705-1.705L3.59 5.006.305 1.717A.999.999 0 1 1 1.715.305L5.709 4.3a1 1 0 0 1 0 1.412L1.716 9.707A.998.998 0 0 1 1.01 10Z"),hi(t,l)},m(o,c){G(o,t,c),Et(t,e),n||(s=[z(t,"click",r[6]),z(t,"keydown",r[7]),z(t,"keyup",r[8]),z(t,"focus",r[9]),z(t,"blur",r[10]),z(t,"mouseenter",r[11]),z(t,"mouseleave",r[12]),z(t,"mouseover",r[13]),z(t,"mouseout",r[14])],n=!0)},p(o,[c]){hi(t,l=Qt(a,[{xmlns:"http://www.w3.org/2000/svg"},{fill:"currentColor"},c&16&&o[4],c&33&&i!==(i=mt("shrink-0",o[3][o[0]],o[5].class))&&{class:i},c&2&&{role:o[1]},c&4&&{"aria-label":o[2]},{viewBox:"0 0 6 10"}]))},i:Yt,o:Yt,d(o){o&&F(t),n=!1,Mi(s)}}}function Mu(r,t,e){const i=["size","role","ariaLabel"];let n=kt(t,i);const s=Ae("iconCtx")??{},a={xs:"w-3 h-3",sm:"w-4 h-4",md:"w-5 h-5",lg:"w-6 h-6",xl:"w-8 h-8"};let{size:l=s.size||"md"}=t,{role:o=s.role||"img"}=t,{ariaLabel:c="chevron right solid"}=t;function h(u){j.call(this,r,u)}function f(u){j.call(this,r,u)}function d(u){j.call(this,r,u)}function g(u){j.call(this,r,u)}function p(u){j.call(this,r,u)}function v(u){j.call(this,r,u)}function b(u){j.call(this,r,u)}function _(u){j.call(this,r,u)}function S(u){j.call(this,r,u)}return r.$$set=u=>{e(5,t=J(J({},t),_t(u))),e(4,n=kt(t,i)),"size"in u&&e(0,l=u.size),"role"in u&&e(1,o=u.role),"ariaLabel"in u&&e(2,c=u.ariaLabel)},t=_t(t),[l,o,c,a,n,t,h,f,d,g,p,v,b,_,S]}class Fu extends Nt{constructor(t){super(),Lt(this,t,Mu,xu,Mt,{size:0,role:1,ariaLabel:2})}}function Ru(r){let t,e,i,n,s,a=[{xmlns:"http://www.w3.org/2000/svg"},{fill:"currentColor"},r[4],{class:i=mt("shrink-0",r[3][r[0]],r[5].class)},{role:r[1]},{"aria-label":r[2]},{viewBox:"0 0 20 14"}],l={};for(let o=0;o<a.length;o+=1)l=J(l,a[o]);return{c(){t=We("svg"),e=We("path"),this.h()},l(o){t=Xe(o,"svg",{xmlns:!0,fill:!0,class:!0,role:!0,"aria-label":!0,viewBox:!0});var c=at(t);e=Xe(c,"path",{fill:!0,d:!0}),at(e).forEach(F),c.forEach(F),this.h()},h(){Y(e,"fill","currentColor"),Y(e,"d","M11 0H2a2 2 0 0 0-2 2v10a2 2 0 0 0 2 2h9a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2Zm8.585 1.189a.994.994 0 0 0-.9-.138l-2.965.983a1 1 0 0 0-.685.949v8a1 1 0 0 0 .675.946l2.965 1.02a1.013 1.013 0 0 0 1.032-.242A1 1 0 0 0 20 12V2a1 1 0 0 0-.415-.811Z"),hi(t,l)},m(o,c){G(o,t,c),Et(t,e),n||(s=[z(t,"click",r[6]),z(t,"keydown",r[7]),z(t,"keyup",r[8]),z(t,"focus",r[9]),z(t,"blur",r[10]),z(t,"mouseenter",r[11]),z(t,"mouseleave",r[12]),z(t,"mouseover",r[13]),z(t,"mouseout",r[14])],n=!0)},p(o,[c]){hi(t,l=Qt(a,[{xmlns:"http://www.w3.org/2000/svg"},{fill:"currentColor"},c&16&&o[4],c&33&&i!==(i=mt("shrink-0",o[3][o[0]],o[5].class))&&{class:i},c&2&&{role:o[1]},c&4&&{"aria-label":o[2]},{viewBox:"0 0 20 14"}]))},i:Yt,o:Yt,d(o){o&&F(t),n=!1,Mi(s)}}}function Nu(r,t,e){const i=["size","role","ariaLabel"];let n=kt(t,i);const s=Ae("iconCtx")??{},a={xs:"w-3 h-3",sm:"w-4 h-4",md:"w-5 h-5",lg:"w-6 h-6",xl:"w-8 h-8"};let{size:l=s.size||"md"}=t,{role:o=s.role||"img"}=t,{ariaLabel:c="video solid"}=t;function h(u){j.call(this,r,u)}function f(u){j.call(this,r,u)}function d(u){j.call(this,r,u)}function g(u){j.call(this,r,u)}function p(u){j.call(this,r,u)}function v(u){j.call(this,r,u)}function b(u){j.call(this,r,u)}function _(u){j.call(this,r,u)}function S(u){j.call(this,r,u)}return r.$$set=u=>{e(5,t=J(J({},t),_t(u))),e(4,n=kt(t,i)),"size"in u&&e(0,l=u.size),"role"in u&&e(1,o=u.role),"ariaLabel"in u&&e(2,c=u.ariaLabel)},t=_t(t),[l,o,c,a,n,t,h,f,d,g,p,v,b,_,S]}class Lu extends Nt{constructor(t){super(),Lt(this,t,Nu,Ru,Mt,{size:0,role:1,ariaLabel:2})}}var go=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Iu(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var Ia={exports:{}},Or={},hc={},ot={};(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r._registerNode=r.Konva=r.glob=void 0;const t=Math.PI/180;function e(){return typeof window<"u"&&({}.toString.call(window)==="[object Window]"||{}.toString.call(window)==="[object global]")}r.glob=typeof go<"u"?go:typeof window<"u"?window:typeof WorkerGlobalScope<"u"?self:{},r.Konva={_global:r.glob,version:"9.3.0",isBrowser:e(),isUnminified:/param/.test(function(n){}.toString()),dblClickWindow:400,getAngle(n){return r.Konva.angleDeg?n*t:n},enableTrace:!1,pointerEventsEnabled:!0,autoDrawEnabled:!0,hitOnDragEnabled:!1,capturePointerEventsEnabled:!1,_mouseListenClick:!1,_touchListenClick:!1,_pointerListenClick:!1,_mouseInDblClickWindow:!1,_touchInDblClickWindow:!1,_pointerInDblClickWindow:!1,_mouseDblClickPointerId:null,_touchDblClickPointerId:null,_pointerDblClickPointerId:null,pixelRatio:typeof window<"u"&&window.devicePixelRatio||1,dragDistance:3,angleDeg:!0,showWarnings:!0,dragButtons:[0,1],isDragging(){return r.Konva.DD.isDragging},isDragReady(){return!!r.Konva.DD.node},releaseCanvasOnDestroy:!0,document:r.glob.document,_injectGlobal(n){r.glob.Konva=n}};const i=n=>{r.Konva[n.prototype.getClassName()]=n};r._registerNode=i,r.Konva._injectGlobal(r.Konva)})(ot);var It={};(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.Util=r.Transform=void 0;const t=ot;class e{constructor(m=[1,0,0,1,0,0]){this.dirty=!1,this.m=m&&m.slice()||[1,0,0,1,0,0]}reset(){this.m[0]=1,this.m[1]=0,this.m[2]=0,this.m[3]=1,this.m[4]=0,this.m[5]=0}copy(){return new e(this.m)}copyInto(m){m.m[0]=this.m[0],m.m[1]=this.m[1],m.m[2]=this.m[2],m.m[3]=this.m[3],m.m[4]=this.m[4],m.m[5]=this.m[5]}point(m){var y=this.m;return{x:y[0]*m.x+y[2]*m.y+y[4],y:y[1]*m.x+y[3]*m.y+y[5]}}translate(m,y){return this.m[4]+=this.m[0]*m+this.m[2]*y,this.m[5]+=this.m[1]*m+this.m[3]*y,this}scale(m,y){return this.m[0]*=m,this.m[1]*=m,this.m[2]*=y,this.m[3]*=y,this}rotate(m){var y=Math.cos(m),w=Math.sin(m),k=this.m[0]*y+this.m[2]*w,C=this.m[1]*y+this.m[3]*w,A=this.m[0]*-w+this.m[2]*y,T=this.m[1]*-w+this.m[3]*y;return this.m[0]=k,this.m[1]=C,this.m[2]=A,this.m[3]=T,this}getTranslation(){return{x:this.m[4],y:this.m[5]}}skew(m,y){var w=this.m[0]+this.m[2]*y,k=this.m[1]+this.m[3]*y,C=this.m[2]+this.m[0]*m,A=this.m[3]+this.m[1]*m;return this.m[0]=w,this.m[1]=k,this.m[2]=C,this.m[3]=A,this}multiply(m){var y=this.m[0]*m.m[0]+this.m[2]*m.m[1],w=this.m[1]*m.m[0]+this.m[3]*m.m[1],k=this.m[0]*m.m[2]+this.m[2]*m.m[3],C=this.m[1]*m.m[2]+this.m[3]*m.m[3],A=this.m[0]*m.m[4]+this.m[2]*m.m[5]+this.m[4],T=this.m[1]*m.m[4]+this.m[3]*m.m[5]+this.m[5];return this.m[0]=y,this.m[1]=w,this.m[2]=k,this.m[3]=C,this.m[4]=A,this.m[5]=T,this}invert(){var m=1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]),y=this.m[3]*m,w=-this.m[1]*m,k=-this.m[2]*m,C=this.m[0]*m,A=m*(this.m[2]*this.m[5]-this.m[3]*this.m[4]),T=m*(this.m[1]*this.m[4]-this.m[0]*this.m[5]);return this.m[0]=y,this.m[1]=w,this.m[2]=k,this.m[3]=C,this.m[4]=A,this.m[5]=T,this}getMatrix(){return this.m}decompose(){var m=this.m[0],y=this.m[1],w=this.m[2],k=this.m[3],C=this.m[4],A=this.m[5],T=m*k-y*w;let P={x:C,y:A,rotation:0,scaleX:0,scaleY:0,skewX:0,skewY:0};if(m!=0||y!=0){var E=Math.sqrt(m*m+y*y);P.rotation=y>0?Math.acos(m/E):-Math.acos(m/E),P.scaleX=E,P.scaleY=T/E,P.skewX=(m*w+y*k)/T,P.skewY=0}else if(w!=0||k!=0){var M=Math.sqrt(w*w+k*k);P.rotation=Math.PI/2-(k>0?Math.acos(-w/M):-Math.acos(w/M)),P.scaleX=T/M,P.scaleY=M,P.skewX=0,P.skewY=(m*w+y*k)/T}return P.rotation=r.Util._getRotation(P.rotation),P}}r.Transform=e;var i="[object Array]",n="[object Number]",s="[object String]",a="[object Boolean]",l=Math.PI/180,o=180/Math.PI,c="#",h="",f="0",d="Konva warning: ",g="Konva error: ",p="rgb(",v={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,132,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,255,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,203],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[119,128,144],slategrey:[119,128,144],snow:[255,255,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],transparent:[255,255,255,0],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,5]},b=/rgb\((\d{1,3}),(\d{1,3}),(\d{1,3})\)/,_=[];const S=typeof requestAnimationFrame<"u"&&requestAnimationFrame||function(u){setTimeout(u,60)};r.Util={_isElement(u){return!!(u&&u.nodeType==1)},_isFunction(u){return!!(u&&u.constructor&&u.call&&u.apply)},_isPlainObject(u){return!!u&&u.constructor===Object},_isArray(u){return Object.prototype.toString.call(u)===i},_isNumber(u){return Object.prototype.toString.call(u)===n&&!isNaN(u)&&isFinite(u)},_isString(u){return Object.prototype.toString.call(u)===s},_isBoolean(u){return Object.prototype.toString.call(u)===a},isObject(u){return u instanceof Object},isValidSelector(u){if(typeof u!="string")return!1;var m=u[0];return m==="#"||m==="."||m===m.toUpperCase()},_sign(u){return u===0||u>0?1:-1},requestAnimFrame(u){_.push(u),_.length===1&&S(function(){const m=_;_=[],m.forEach(function(y){y()})})},createCanvasElement(){var u=document.createElement("canvas");try{u.style=u.style||{}}catch{}return u},createImageElement(){return document.createElement("img")},_isInDocument(u){for(;u=u.parentNode;)if(u==document)return!0;return!1},_urlToImage(u,m){var y=r.Util.createImageElement();y.onload=function(){m(y)},y.src=u},_rgbToHex(u,m,y){return((1<<24)+(u<<16)+(m<<8)+y).toString(16).slice(1)},_hexToRgb(u){u=u.replace(c,h);var m=parseInt(u,16);return{r:m>>16&255,g:m>>8&255,b:m&255}},getRandomColor(){for(var u=(Math.random()*16777215<<0).toString(16);u.length<6;)u=f+u;return c+u},getRGB(u){var m;return u in v?(m=v[u],{r:m[0],g:m[1],b:m[2]}):u[0]===c?this._hexToRgb(u.substring(1)):u.substr(0,4)===p?(m=b.exec(u.replace(/ /g,"")),{r:parseInt(m[1],10),g:parseInt(m[2],10),b:parseInt(m[3],10)}):{r:0,g:0,b:0}},colorToRGBA(u){return u=u||"black",r.Util._namedColorToRBA(u)||r.Util._hex3ColorToRGBA(u)||r.Util._hex4ColorToRGBA(u)||r.Util._hex6ColorToRGBA(u)||r.Util._hex8ColorToRGBA(u)||r.Util._rgbColorToRGBA(u)||r.Util._rgbaColorToRGBA(u)||r.Util._hslColorToRGBA(u)},_namedColorToRBA(u){var m=v[u.toLowerCase()];return m?{r:m[0],g:m[1],b:m[2],a:1}:null},_rgbColorToRGBA(u){if(u.indexOf("rgb(")===0){u=u.match(/rgb\(([^)]+)\)/)[1];var m=u.split(/ *, */).map(Number);return{r:m[0],g:m[1],b:m[2],a:1}}},_rgbaColorToRGBA(u){if(u.indexOf("rgba(")===0){u=u.match(/rgba\(([^)]+)\)/)[1];var m=u.split(/ *, */).map((y,w)=>y.slice(-1)==="%"?w===3?parseInt(y)/100:parseInt(y)/100*255:Number(y));return{r:m[0],g:m[1],b:m[2],a:m[3]}}},_hex8ColorToRGBA(u){if(u[0]==="#"&&u.length===9)return{r:parseInt(u.slice(1,3),16),g:parseInt(u.slice(3,5),16),b:parseInt(u.slice(5,7),16),a:parseInt(u.slice(7,9),16)/255}},_hex6ColorToRGBA(u){if(u[0]==="#"&&u.length===7)return{r:parseInt(u.slice(1,3),16),g:parseInt(u.slice(3,5),16),b:parseInt(u.slice(5,7),16),a:1}},_hex4ColorToRGBA(u){if(u[0]==="#"&&u.length===5)return{r:parseInt(u[1]+u[1],16),g:parseInt(u[2]+u[2],16),b:parseInt(u[3]+u[3],16),a:parseInt(u[4]+u[4],16)/255}},_hex3ColorToRGBA(u){if(u[0]==="#"&&u.length===4)return{r:parseInt(u[1]+u[1],16),g:parseInt(u[2]+u[2],16),b:parseInt(u[3]+u[3],16),a:1}},_hslColorToRGBA(u){if(/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.test(u)){const[m,...y]=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(u),w=Number(y[0])/360,k=Number(y[1])/100,C=Number(y[2])/100;let A,T,P;if(k===0)return P=C*255,{r:Math.round(P),g:Math.round(P),b:Math.round(P),a:1};C<.5?A=C*(1+k):A=C+k-C*k;const E=2*C-A,M=[0,0,0];for(let R=0;R<3;R++)T=w+1/3*-(R-1),T<0&&T++,T>1&&T--,6*T<1?P=E+(A-E)*6*T:2*T<1?P=A:3*T<2?P=E+(A-E)*(2/3-T)*6:P=E,M[R]=P*255;return{r:Math.round(M[0]),g:Math.round(M[1]),b:Math.round(M[2]),a:1}}},haveIntersection(u,m){return!(m.x>u.x+u.width||m.x+m.width<u.x||m.y>u.y+u.height||m.y+m.height<u.y)},cloneObject(u){var m={};for(var y in u)this._isPlainObject(u[y])?m[y]=this.cloneObject(u[y]):this._isArray(u[y])?m[y]=this.cloneArray(u[y]):m[y]=u[y];return m},cloneArray(u){return u.slice(0)},degToRad(u){return u*l},radToDeg(u){return u*o},_degToRad(u){return r.Util.warn("Util._degToRad is removed. Please use public Util.degToRad instead."),r.Util.degToRad(u)},_radToDeg(u){return r.Util.warn("Util._radToDeg is removed. Please use public Util.radToDeg instead."),r.Util.radToDeg(u)},_getRotation(u){return t.Konva.angleDeg?r.Util.radToDeg(u):u},_capitalize(u){return u.charAt(0).toUpperCase()+u.slice(1)},throw(u){throw new Error(g+u)},error(u){console.error(g+u)},warn(u){t.Konva.showWarnings&&console.warn(d+u)},each(u,m){for(var y in u)m(y,u[y])},_inRange(u,m,y){return m<=u&&u<y},_getProjectionToSegment(u,m,y,w,k,C){var A,T,P,E=(u-y)*(u-y)+(m-w)*(m-w);if(E==0)A=u,T=m,P=(k-y)*(k-y)+(C-w)*(C-w);else{var M=((k-u)*(y-u)+(C-m)*(w-m))/E;M<0?(A=u,T=m,P=(u-k)*(u-k)+(m-C)*(m-C)):M>1?(A=y,T=w,P=(y-k)*(y-k)+(w-C)*(w-C)):(A=u+M*(y-u),T=m+M*(w-m),P=(A-k)*(A-k)+(T-C)*(T-C))}return[A,T,P]},_getProjectionToLine(u,m,y){var w=r.Util.cloneObject(u),k=Number.MAX_VALUE;return m.forEach(function(C,A){if(!(!y&&A===m.length-1)){var T=m[(A+1)%m.length],P=r.Util._getProjectionToSegment(C.x,C.y,T.x,T.y,u.x,u.y),E=P[0],M=P[1],R=P[2];R<k&&(w.x=E,w.y=M,k=R)}}),w},_prepareArrayForTween(u,m,y){var w,k=[],C=[];if(u.length>m.length){var A=m;m=u,u=A}for(w=0;w<u.length;w+=2)k.push({x:u[w],y:u[w+1]});for(w=0;w<m.length;w+=2)C.push({x:m[w],y:m[w+1]});var T=[];return C.forEach(function(P){var E=r.Util._getProjectionToLine(P,k,y);T.push(E.x),T.push(E.y)}),T},_prepareToStringify(u){var m;u.visitedByCircularReferenceRemoval=!0;for(var y in u)if(u.hasOwnProperty(y)&&u[y]&&typeof u[y]=="object"){if(m=Object.getOwnPropertyDescriptor(u,y),u[y].visitedByCircularReferenceRemoval||r.Util._isElement(u[y]))if(m.configurable)delete u[y];else return null;else if(r.Util._prepareToStringify(u[y])===null)if(m.configurable)delete u[y];else return null}return delete u.visitedByCircularReferenceRemoval,u},_assign(u,m){for(var y in m)u[y]=m[y];return u},_getFirstPointerId(u){return u.touches?u.changedTouches[0].identifier:u.pointerId||999},releaseCanvas(...u){t.Konva.releaseCanvasOnDestroy&&u.forEach(m=>{m.width=0,m.height=0})},drawRoundedRectPath(u,m,y,w){let k=0,C=0,A=0,T=0;typeof w=="number"?k=C=A=T=Math.min(w,m/2,y/2):(k=Math.min(w[0]||0,m/2,y/2),C=Math.min(w[1]||0,m/2,y/2),T=Math.min(w[2]||0,m/2,y/2),A=Math.min(w[3]||0,m/2,y/2)),u.moveTo(k,0),u.lineTo(m-C,0),u.arc(m-C,C,C,Math.PI*3/2,0,!1),u.lineTo(m,y-T),u.arc(m-T,y-T,T,0,Math.PI/2,!1),u.lineTo(A,y),u.arc(A,y-A,A,Math.PI/2,Math.PI,!1),u.lineTo(0,k),u.arc(k,k,k,Math.PI,Math.PI*3/2,!1)}}})(It);var Ft={},st={},H={};Object.defineProperty(H,"__esModule",{value:!0});H.getComponentValidator=H.getBooleanValidator=H.getNumberArrayValidator=H.getFunctionValidator=H.getStringOrGradientValidator=H.getStringValidator=H.getNumberOrAutoValidator=H.getNumberOrArrayOfNumbersValidator=H.getNumberValidator=H.alphaComponent=H.RGBComponent=void 0;const qe=ot,Dt=It;function Je(r){return Dt.Util._isString(r)?'"'+r+'"':Object.prototype.toString.call(r)==="[object Number]"||Dt.Util._isBoolean(r)?r:Object.prototype.toString.call(r)}function Du(r){return r>255?255:r<0?0:Math.round(r)}H.RGBComponent=Du;function Gu(r){return r>1?1:r<1e-4?1e-4:r}H.alphaComponent=Gu;function Ou(){if(qe.Konva.isUnminified)return function(r,t){return Dt.Util._isNumber(r)||Dt.Util.warn(Je(r)+' is a not valid value for "'+t+'" attribute. The value should be a number.'),r}}H.getNumberValidator=Ou;function Bu(r){if(qe.Konva.isUnminified)return function(t,e){let i=Dt.Util._isNumber(t),n=Dt.Util._isArray(t)&&t.length==r;return!i&&!n&&Dt.Util.warn(Je(t)+' is a not valid value for "'+e+'" attribute. The value should be a number or Array<number>('+r+")"),t}}H.getNumberOrArrayOfNumbersValidator=Bu;function Uu(){if(qe.Konva.isUnminified)return function(r,t){var e=Dt.Util._isNumber(r),i=r==="auto";return e||i||Dt.Util.warn(Je(r)+' is a not valid value for "'+t+'" attribute. The value should be a number or "auto".'),r}}H.getNumberOrAutoValidator=Uu;function Vu(){if(qe.Konva.isUnminified)return function(r,t){return Dt.Util._isString(r)||Dt.Util.warn(Je(r)+' is a not valid value for "'+t+'" attribute. The value should be a string.'),r}}H.getStringValidator=Vu;function zu(){if(qe.Konva.isUnminified)return function(r,t){const e=Dt.Util._isString(r),i=Object.prototype.toString.call(r)==="[object CanvasGradient]"||r&&r.addColorStop;return e||i||Dt.Util.warn(Je(r)+' is a not valid value for "'+t+'" attribute. The value should be a string or a native gradient.'),r}}H.getStringOrGradientValidator=zu;function Hu(){if(qe.Konva.isUnminified)return function(r,t){return Dt.Util._isFunction(r)||Dt.Util.warn(Je(r)+' is a not valid value for "'+t+'" attribute. The value should be a function.'),r}}H.getFunctionValidator=Hu;function ju(){if(qe.Konva.isUnminified)return function(r,t){const e=Int8Array?Object.getPrototypeOf(Int8Array):null;return e&&r instanceof e||(Dt.Util._isArray(r)?r.forEach(function(i){Dt.Util._isNumber(i)||Dt.Util.warn('"'+t+'" attribute has non numeric element '+i+". Make sure that all elements are numbers.")}):Dt.Util.warn(Je(r)+' is a not valid value for "'+t+'" attribute. The value should be a array of numbers.')),r}}H.getNumberArrayValidator=ju;function Wu(){if(qe.Konva.isUnminified)return function(r,t){var e=r===!0||r===!1;return e||Dt.Util.warn(Je(r)+' is a not valid value for "'+t+'" attribute. The value should be a boolean.'),r}}H.getBooleanValidator=Wu;function Xu(r){if(qe.Konva.isUnminified)return function(t,e){return t==null||Dt.Util.isObject(t)||Dt.Util.warn(Je(t)+' is a not valid value for "'+e+'" attribute. The value should be an object with properties '+r),t}}H.getComponentValidator=Xu;(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.Factory=void 0;const t=It,e=H;var i="get",n="set";r.Factory={addGetterSetter(s,a,l,o,c){r.Factory.addGetter(s,a,l),r.Factory.addSetter(s,a,o,c),r.Factory.addOverloadedGetterSetter(s,a)},addGetter(s,a,l){var o=i+t.Util._capitalize(a);s.prototype[o]=s.prototype[o]||function(){var c=this.attrs[a];return c===void 0?l:c}},addSetter(s,a,l,o){var c=n+t.Util._capitalize(a);s.prototype[c]||r.Factory.overWriteSetter(s,a,l,o)},overWriteSetter(s,a,l,o){var c=n+t.Util._capitalize(a);s.prototype[c]=function(h){return l&&h!==void 0&&h!==null&&(h=l.call(this,h,a)),this._setAttr(a,h),o&&o.call(this),this}},addComponentsGetterSetter(s,a,l,o,c){var h=l.length,f=t.Util._capitalize,d=i+f(a),g=n+f(a),p,v;s.prototype[d]=function(){var _={};for(p=0;p<h;p++)v=l[p],_[v]=this.getAttr(a+f(v));return _};var b=(0,e.getComponentValidator)(l);s.prototype[g]=function(_){var S=this.attrs[a],u;o&&(_=o.call(this,_)),b&&b.call(this,_,a);for(u in _)_.hasOwnProperty(u)&&this._setAttr(a+f(u),_[u]);return _||l.forEach(m=>{this._setAttr(a+f(m),void 0)}),this._fireChangeEvent(a,S,_),c&&c.call(this),this},r.Factory.addOverloadedGetterSetter(s,a)},addOverloadedGetterSetter(s,a){var l=t.Util._capitalize(a),o=n+l,c=i+l;s.prototype[a]=function(){return arguments.length?(this[o](arguments[0]),this):this[c]()}},addDeprecatedGetterSetter(s,a,l,o){t.Util.error("Adding deprecated "+a);var c=i+t.Util._capitalize(a),h=a+" property is deprecated and will be removed soon. Look at Konva change log for more information.";s.prototype[c]=function(){t.Util.error(h);var f=this.attrs[a];return f===void 0?l:f},r.Factory.addSetter(s,a,o,function(){t.Util.error(h)}),r.Factory.addOverloadedGetterSetter(s,a)},backCompat(s,a){t.Util.each(a,function(l,o){var c=s.prototype[o],h=i+t.Util._capitalize(l),f=n+t.Util._capitalize(l);function d(){c.apply(this,arguments),t.Util.error('"'+l+'" method is deprecated and will be removed soon. Use ""'+o+'" instead.')}s.prototype[l]=d,s.prototype[h]=d,s.prototype[f]=d})},afterSetFilter(){this._filterUpToDate=!1}}})(st);var Ce={},je={};Object.defineProperty(je,"__esModule",{value:!0});je.HitContext=je.SceneContext=je.Context=void 0;const uc=It,Yu=ot;function Ku(r){var t=[],e=r.length,i=uc.Util,n,s;for(n=0;n<e;n++)s=r[n],i._isNumber(s)?s=Math.round(s*1e3)/1e3:i._isString(s)||(s=s+""),t.push(s);return t}var po=",",$u="(",qu=")",Ju="([",Qu="])",Zu=";",tf="()",ef="=",mo=["arc","arcTo","beginPath","bezierCurveTo","clearRect","clip","closePath","createLinearGradient","createPattern","createRadialGradient","drawImage","ellipse","fill","fillText","getImageData","createImageData","lineTo","moveTo","putImageData","quadraticCurveTo","rect","restore","rotate","save","scale","setLineDash","setTransform","stroke","strokeText","transform","translate"],nf=["fillStyle","strokeStyle","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","letterSpacing","lineCap","lineDashOffset","lineJoin","lineWidth","miterLimit","direction","font","textAlign","textBaseline","globalAlpha","globalCompositeOperation","imageSmoothingEnabled"];const rf=100;class Br{constructor(t){this.canvas=t,Yu.Konva.enableTrace&&(this.traceArr=[],this._enableTrace())}fillShape(t){t.fillEnabled()&&this._fill(t)}_fill(t){}strokeShape(t){t.hasStroke()&&this._stroke(t)}_stroke(t){}fillStrokeShape(t){t.attrs.fillAfterStrokeEnabled?(this.strokeShape(t),this.fillShape(t)):(this.fillShape(t),this.strokeShape(t))}getTrace(t,e){var i=this.traceArr,n=i.length,s="",a,l,o,c;for(a=0;a<n;a++)l=i[a],o=l.method,o?(c=l.args,s+=o,t?s+=tf:uc.Util._isArray(c[0])?s+=Ju+c.join(po)+Qu:(e&&(c=c.map(h=>typeof h=="number"?Math.floor(h):h)),s+=$u+c.join(po)+qu)):(s+=l.property,t||(s+=ef+l.val)),s+=Zu;return s}clearTrace(){this.traceArr=[]}_trace(t){var e=this.traceArr,i;e.push(t),i=e.length,i>=rf&&e.shift()}reset(){var t=this.getCanvas().getPixelRatio();this.setTransform(1*t,0,0,1*t,0,0)}getCanvas(){return this.canvas}clear(t){var e=this.getCanvas();t?this.clearRect(t.x||0,t.y||0,t.width||0,t.height||0):this.clearRect(0,0,e.getWidth()/e.pixelRatio,e.getHeight()/e.pixelRatio)}_applyLineCap(t){const e=t.attrs.lineCap;e&&this.setAttr("lineCap",e)}_applyOpacity(t){var e=t.getAbsoluteOpacity();e!==1&&this.setAttr("globalAlpha",e)}_applyLineJoin(t){const e=t.attrs.lineJoin;e&&this.setAttr("lineJoin",e)}setAttr(t,e){this._context[t]=e}arc(t,e,i,n,s,a){this._context.arc(t,e,i,n,s,a)}arcTo(t,e,i,n,s){this._context.arcTo(t,e,i,n,s)}beginPath(){this._context.beginPath()}bezierCurveTo(t,e,i,n,s,a){this._context.bezierCurveTo(t,e,i,n,s,a)}clearRect(t,e,i,n){this._context.clearRect(t,e,i,n)}clip(...t){this._context.clip.apply(this._context,t)}closePath(){this._context.closePath()}createImageData(t,e){var i=arguments;if(i.length===2)return this._context.createImageData(t,e);if(i.length===1)return this._context.createImageData(t)}createLinearGradient(t,e,i,n){return this._context.createLinearGradient(t,e,i,n)}createPattern(t,e){return this._context.createPattern(t,e)}createRadialGradient(t,e,i,n,s,a){return this._context.createRadialGradient(t,e,i,n,s,a)}drawImage(t,e,i,n,s,a,l,o,c){var h=arguments,f=this._context;h.length===3?f.drawImage(t,e,i):h.length===5?f.drawImage(t,e,i,n,s):h.length===9&&f.drawImage(t,e,i,n,s,a,l,o,c)}ellipse(t,e,i,n,s,a,l,o){this._context.ellipse(t,e,i,n,s,a,l,o)}isPointInPath(t,e,i,n){return i?this._context.isPointInPath(i,t,e,n):this._context.isPointInPath(t,e,n)}fill(...t){this._context.fill.apply(this._context,t)}fillRect(t,e,i,n){this._context.fillRect(t,e,i,n)}strokeRect(t,e,i,n){this._context.strokeRect(t,e,i,n)}fillText(t,e,i,n){n?this._context.fillText(t,e,i,n):this._context.fillText(t,e,i)}measureText(t){return this._context.measureText(t)}getImageData(t,e,i,n){return this._context.getImageData(t,e,i,n)}lineTo(t,e){this._context.lineTo(t,e)}moveTo(t,e){this._context.moveTo(t,e)}rect(t,e,i,n){this._context.rect(t,e,i,n)}putImageData(t,e,i){this._context.putImageData(t,e,i)}quadraticCurveTo(t,e,i,n){this._context.quadraticCurveTo(t,e,i,n)}restore(){this._context.restore()}rotate(t){this._context.rotate(t)}save(){this._context.save()}scale(t,e){this._context.scale(t,e)}setLineDash(t){this._context.setLineDash?this._context.setLineDash(t):"mozDash"in this._context?this._context.mozDash=t:"webkitLineDash"in this._context&&(this._context.webkitLineDash=t)}getLineDash(){return this._context.getLineDash()}setTransform(t,e,i,n,s,a){this._context.setTransform(t,e,i,n,s,a)}stroke(t){t?this._context.stroke(t):this._context.stroke()}strokeText(t,e,i,n){this._context.strokeText(t,e,i,n)}transform(t,e,i,n,s,a){this._context.transform(t,e,i,n,s,a)}translate(t,e){this._context.translate(t,e)}_enableTrace(){var t=this,e=mo.length,i=this.setAttr,n,s,a=function(l){var o=t[l],c;t[l]=function(){return s=Ku(Array.prototype.slice.call(arguments,0)),c=o.apply(t,arguments),t._trace({method:l,args:s}),c}};for(n=0;n<e;n++)a(mo[n]);t.setAttr=function(){i.apply(t,arguments);var l=arguments[0],o=arguments[1];(l==="shadowOffsetX"||l==="shadowOffsetY"||l==="shadowBlur")&&(o=o/this.canvas.getPixelRatio()),t._trace({property:l,val:o})}}_applyGlobalCompositeOperation(t){const e=t.attrs.globalCompositeOperation;var i=!e||e==="source-over";i||this.setAttr("globalCompositeOperation",e)}}je.Context=Br;nf.forEach(function(r){Object.defineProperty(Br.prototype,r,{get(){return this._context[r]},set(t){this._context[r]=t}})});class sf extends Br{constructor(t,{willReadFrequently:e=!1}={}){super(t),this._context=t._canvas.getContext("2d",{willReadFrequently:e})}_fillColor(t){var e=t.fill();this.setAttr("fillStyle",e),t._fillFunc(this)}_fillPattern(t){this.setAttr("fillStyle",t._getFillPattern()),t._fillFunc(this)}_fillLinearGradient(t){var e=t._getLinearGradient();e&&(this.setAttr("fillStyle",e),t._fillFunc(this))}_fillRadialGradient(t){const e=t._getRadialGradient();e&&(this.setAttr("fillStyle",e),t._fillFunc(this))}_fill(t){const e=t.fill(),i=t.getFillPriority();if(e&&i==="color"){this._fillColor(t);return}const n=t.getFillPatternImage();if(n&&i==="pattern"){this._fillPattern(t);return}const s=t.getFillLinearGradientColorStops();if(s&&i==="linear-gradient"){this._fillLinearGradient(t);return}const a=t.getFillRadialGradientColorStops();if(a&&i==="radial-gradient"){this._fillRadialGradient(t);return}e?this._fillColor(t):n?this._fillPattern(t):s?this._fillLinearGradient(t):a&&this._fillRadialGradient(t)}_strokeLinearGradient(t){const e=t.getStrokeLinearGradientStartPoint(),i=t.getStrokeLinearGradientEndPoint(),n=t.getStrokeLinearGradientColorStops(),s=this.createLinearGradient(e.x,e.y,i.x,i.y);if(n){for(var a=0;a<n.length;a+=2)s.addColorStop(n[a],n[a+1]);this.setAttr("strokeStyle",s)}}_stroke(t){var e=t.dash(),i=t.getStrokeScaleEnabled();if(t.hasStroke()){if(!i){this.save();var n=this.getCanvas().getPixelRatio();this.setTransform(n,0,0,n,0,0)}this._applyLineCap(t),e&&t.dashEnabled()&&(this.setLineDash(e),this.setAttr("lineDashOffset",t.dashOffset())),this.setAttr("lineWidth",t.strokeWidth()),t.getShadowForStrokeEnabled()||this.setAttr("shadowColor","rgba(0,0,0,0)");var s=t.getStrokeLinearGradientColorStops();s?this._strokeLinearGradient(t):this.setAttr("strokeStyle",t.stroke()),t._strokeFunc(this),i||this.restore()}}_applyShadow(t){var e,i,n,s=(e=t.getShadowRGBA())!==null&&e!==void 0?e:"black",a=(i=t.getShadowBlur())!==null&&i!==void 0?i:5,l=(n=t.getShadowOffset())!==null&&n!==void 0?n:{x:0,y:0},o=t.getAbsoluteScale(),c=this.canvas.getPixelRatio(),h=o.x*c,f=o.y*c;this.setAttr("shadowColor",s),this.setAttr("shadowBlur",a*Math.min(Math.abs(h),Math.abs(f))),this.setAttr("shadowOffsetX",l.x*h),this.setAttr("shadowOffsetY",l.y*f)}}je.SceneContext=sf;class af extends Br{constructor(t){super(t),this._context=t._canvas.getContext("2d",{willReadFrequently:!0})}_fill(t){this.save(),this.setAttr("fillStyle",t.colorKey),t._fillFuncHit(this),this.restore()}strokeShape(t){t.hasHitStroke()&&this._stroke(t)}_stroke(t){if(t.hasHitStroke()){const s=t.getStrokeScaleEnabled();if(!s){this.save();var e=this.getCanvas().getPixelRatio();this.setTransform(e,0,0,e,0,0)}this._applyLineCap(t);var i=t.hitStrokeWidth(),n=i==="auto"?t.strokeWidth():i;this.setAttr("lineWidth",n),this.setAttr("strokeStyle",t.colorKey),t._strokeFuncHit(this),s||this.restore()}}}je.HitContext=af;Object.defineProperty(Ce,"__esModule",{value:!0});Ce.HitCanvas=Ce.SceneCanvas=Ce.Canvas=void 0;const Pr=It,fc=je,dc=ot,of=st,lf=H;var jn;function cf(){if(jn)return jn;var r=Pr.Util.createCanvasElement(),t=r.getContext("2d");return jn=function(){var e=dc.Konva._global.devicePixelRatio||1,i=t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1;return e/i}(),Pr.Util.releaseCanvas(r),jn}class Ur{constructor(t){this.pixelRatio=1,this.width=0,this.height=0,this.isCache=!1;var e=t||{},i=e.pixelRatio||dc.Konva.pixelRatio||cf();this.pixelRatio=i,this._canvas=Pr.Util.createCanvasElement(),this._canvas.style.padding="0",this._canvas.style.margin="0",this._canvas.style.border="0",this._canvas.style.background="transparent",this._canvas.style.position="absolute",this._canvas.style.top="0",this._canvas.style.left="0"}getContext(){return this.context}getPixelRatio(){return this.pixelRatio}setPixelRatio(t){var e=this.pixelRatio;this.pixelRatio=t,this.setSize(this.getWidth()/e,this.getHeight()/e)}setWidth(t){this.width=this._canvas.width=t*this.pixelRatio,this._canvas.style.width=t+"px";var e=this.pixelRatio,i=this.getContext()._context;i.scale(e,e)}setHeight(t){this.height=this._canvas.height=t*this.pixelRatio,this._canvas.style.height=t+"px";var e=this.pixelRatio,i=this.getContext()._context;i.scale(e,e)}getWidth(){return this.width}getHeight(){return this.height}setSize(t,e){this.setWidth(t||0),this.setHeight(e||0)}toDataURL(t,e){try{return this._canvas.toDataURL(t,e)}catch{try{return this._canvas.toDataURL()}catch(n){return Pr.Util.error("Unable to get data URL. "+n.message+" For more info read https://konvajs.org/docs/posts/Tainted_Canvas.html."),""}}}}Ce.Canvas=Ur;of.Factory.addGetterSetter(Ur,"pixelRatio",void 0,(0,lf.getNumberValidator)());class hf extends Ur{constructor(t={width:0,height:0,willReadFrequently:!1}){super(t),this.context=new fc.SceneContext(this,{willReadFrequently:t.willReadFrequently}),this.setSize(t.width,t.height)}}Ce.SceneCanvas=hf;class uf extends Ur{constructor(t={width:0,height:0}){super(t),this.hitCanvas=!0,this.context=new fc.HitContext(this),this.setSize(t.width,t.height)}}Ce.HitCanvas=uf;var Vr={};(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.DD=void 0;const t=ot,e=It;r.DD={get isDragging(){var i=!1;return r.DD._dragElements.forEach(n=>{n.dragStatus==="dragging"&&(i=!0)}),i},justDragged:!1,get node(){var i;return r.DD._dragElements.forEach(n=>{i=n.node}),i},_dragElements:new Map,_drag(i){const n=[];r.DD._dragElements.forEach((s,a)=>{const{node:l}=s,o=l.getStage();o.setPointersPositions(i),s.pointerId===void 0&&(s.pointerId=e.Util._getFirstPointerId(i));const c=o._changedPointerPositions.find(d=>d.id===s.pointerId);if(c){if(s.dragStatus!=="dragging"){var h=l.dragDistance(),f=Math.max(Math.abs(c.x-s.startPointerPos.x),Math.abs(c.y-s.startPointerPos.y));if(f<h||(l.startDrag({evt:i}),!l.isDragging()))return}l._setDragPosition(i,s),n.push(l)}}),n.forEach(s=>{s.fire("dragmove",{type:"dragmove",target:s,evt:i},!0)})},_endDragBefore(i){const n=[];r.DD._dragElements.forEach(s=>{const{node:a}=s,l=a.getStage();if(i&&l.setPointersPositions(i),!l._changedPointerPositions.find(h=>h.id===s.pointerId))return;(s.dragStatus==="dragging"||s.dragStatus==="stopped")&&(r.DD.justDragged=!0,t.Konva._mouseListenClick=!1,t.Konva._touchListenClick=!1,t.Konva._pointerListenClick=!1,s.dragStatus="stopped");const c=s.node.getLayer()||s.node instanceof t.Konva.Stage&&s.node;c&&n.indexOf(c)===-1&&n.push(c)}),n.forEach(s=>{s.draw()})},_endDragAfter(i){r.DD._dragElements.forEach((n,s)=>{n.dragStatus==="stopped"&&n.node.fire("dragend",{type:"dragend",target:n.node,evt:i},!0),n.dragStatus!=="dragging"&&r.DD._dragElements.delete(s)})}},t.Konva.isBrowser&&(window.addEventListener("mouseup",r.DD._endDragBefore,!0),window.addEventListener("touchend",r.DD._endDragBefore,!0),window.addEventListener("mousemove",r.DD._drag),window.addEventListener("touchmove",r.DD._drag),window.addEventListener("mouseup",r.DD._endDragAfter,!1),window.addEventListener("touchend",r.DD._endDragAfter,!1))})(Vr);Object.defineProperty(Ft,"__esModule",{value:!0});Ft.Node=void 0;const lt=It,Gn=st,Wn=Ce,vi=ot,le=Vr,Ut=H;var vr="absoluteOpacity",Xn="allEventListeners",Ue="absoluteTransform",_o="absoluteScale",yi="canvas",ff="Change",df="children",gf="konva",pa="listening",vo="mouseenter",yo="mouseleave",bo="set",So="Shape",yr=" ",wo="stage",ri="transform",pf="Stage",ma="visible",mf=["xChange.konva","yChange.konva","scaleXChange.konva","scaleYChange.konva","skewXChange.konva","skewYChange.konva","rotationChange.konva","offsetXChange.konva","offsetYChange.konva","transformsEnabledChange.konva"].join(yr);let _f=1;class it{constructor(t){this._id=_f++,this.eventListeners={},this.attrs={},this.index=0,this._allEventListeners=null,this.parent=null,this._cache=new Map,this._attachedDepsListeners=new Map,this._lastPos=null,this._batchingTransformChange=!1,this._needClearTransformCache=!1,this._filterUpToDate=!1,this._isUnderCache=!1,this._dragEventId=null,this._shouldFireChangeEvents=!1,this.setAttrs(t),this._shouldFireChangeEvents=!0}hasChildren(){return!1}_clearCache(t){(t===ri||t===Ue)&&this._cache.get(t)?this._cache.get(t).dirty=!0:t?this._cache.delete(t):this._cache.clear()}_getCache(t,e){var i=this._cache.get(t),n=t===ri||t===Ue,s=i===void 0||n&&i.dirty===!0;return s&&(i=e.call(this),this._cache.set(t,i)),i}_calculate(t,e,i){if(!this._attachedDepsListeners.get(t)){const n=e.map(s=>s+"Change.konva").join(yr);this.on(n,()=>{this._clearCache(t)}),this._attachedDepsListeners.set(t,!0)}return this._getCache(t,i)}_getCanvasCache(){return this._cache.get(yi)}_clearSelfAndDescendantCache(t){this._clearCache(t),t===Ue&&this.fire("absoluteTransformChange")}clearCache(){if(this._cache.has(yi)){const{scene:t,filter:e,hit:i}=this._cache.get(yi);lt.Util.releaseCanvas(t,e,i),this._cache.delete(yi)}return this._clearSelfAndDescendantCache(),this._requestDraw(),this}cache(t){var e=t||{},i={};(e.x===void 0||e.y===void 0||e.width===void 0||e.height===void 0)&&(i=this.getClientRect({skipTransform:!0,relativeTo:this.getParent()||void 0}));var n=Math.ceil(e.width||i.width),s=Math.ceil(e.height||i.height),a=e.pixelRatio,l=e.x===void 0?Math.floor(i.x):e.x,o=e.y===void 0?Math.floor(i.y):e.y,c=e.offset||0,h=e.drawBorder||!1,f=e.hitCanvasPixelRatio||1;if(!n||!s){lt.Util.error("Can not cache the node. Width or height of the node equals 0. Caching is skipped.");return}n+=c*2+1,s+=c*2+1,l-=c,o-=c;var d=new Wn.SceneCanvas({pixelRatio:a,width:n,height:s}),g=new Wn.SceneCanvas({pixelRatio:a,width:0,height:0,willReadFrequently:!0}),p=new Wn.HitCanvas({pixelRatio:f,width:n,height:s}),v=d.getContext(),b=p.getContext();return p.isCache=!0,d.isCache=!0,this._cache.delete(yi),this._filterUpToDate=!1,e.imageSmoothingEnabled===!1&&(d.getContext()._context.imageSmoothingEnabled=!1,g.getContext()._context.imageSmoothingEnabled=!1),v.save(),b.save(),v.translate(-l,-o),b.translate(-l,-o),this._isUnderCache=!0,this._clearSelfAndDescendantCache(vr),this._clearSelfAndDescendantCache(_o),this.drawScene(d,this),this.drawHit(p,this),this._isUnderCache=!1,v.restore(),b.restore(),h&&(v.save(),v.beginPath(),v.rect(0,0,n,s),v.closePath(),v.setAttr("strokeStyle","red"),v.setAttr("lineWidth",5),v.stroke(),v.restore()),this._cache.set(yi,{scene:d,filter:g,hit:p,x:l,y:o}),this._requestDraw(),this}isCached(){return this._cache.has(yi)}getClientRect(t){throw new Error('abstract "getClientRect" method call')}_transformedRect(t,e){var i=[{x:t.x,y:t.y},{x:t.x+t.width,y:t.y},{x:t.x+t.width,y:t.y+t.height},{x:t.x,y:t.y+t.height}],n=1/0,s=1/0,a=-1/0,l=-1/0,o=this.getAbsoluteTransform(e);return i.forEach(function(c){var h=o.point(c);n===void 0&&(n=a=h.x,s=l=h.y),n=Math.min(n,h.x),s=Math.min(s,h.y),a=Math.max(a,h.x),l=Math.max(l,h.y)}),{x:n,y:s,width:a-n,height:l-s}}_drawCachedSceneCanvas(t){t.save(),t._applyOpacity(this),t._applyGlobalCompositeOperation(this);const e=this._getCanvasCache();t.translate(e.x,e.y);var i=this._getCachedSceneCanvas(),n=i.pixelRatio;t.drawImage(i._canvas,0,0,i.width/n,i.height/n),t.restore()}_drawCachedHitCanvas(t){var e=this._getCanvasCache(),i=e.hit;t.save(),t.translate(e.x,e.y),t.drawImage(i._canvas,0,0,i.width/i.pixelRatio,i.height/i.pixelRatio),t.restore()}_getCachedSceneCanvas(){var t=this.filters(),e=this._getCanvasCache(),i=e.scene,n=e.filter,s=n.getContext(),a,l,o,c;if(t){if(!this._filterUpToDate){var h=i.pixelRatio;n.setSize(i.width/i.pixelRatio,i.height/i.pixelRatio);try{for(a=t.length,s.clear(),s.drawImage(i._canvas,0,0,i.getWidth()/h,i.getHeight()/h),l=s.getImageData(0,0,n.getWidth(),n.getHeight()),o=0;o<a;o++){if(c=t[o],typeof c!="function"){lt.Util.error("Filter should be type of function, but got "+typeof c+" instead. Please check correct filters");continue}c.call(this,l),s.putImageData(l,0,0)}}catch(f){lt.Util.error("Unable to apply filter. "+f.message+" This post my help you https://konvajs.org/docs/posts/Tainted_Canvas.html.")}this._filterUpToDate=!0}return n}return i}on(t,e){if(this._cache&&this._cache.delete(Xn),arguments.length===3)return this._delegate.apply(this,arguments);var i=t.split(yr),n=i.length,s,a,l,o,c;for(s=0;s<n;s++)a=i[s],l=a.split("."),o=l[0],c=l[1]||"",this.eventListeners[o]||(this.eventListeners[o]=[]),this.eventListeners[o].push({name:c,handler:e});return this}off(t,e){var i=(t||"").split(yr),n=i.length,s,a,l,o,c,h;if(this._cache&&this._cache.delete(Xn),!t)for(a in this.eventListeners)this._off(a);for(s=0;s<n;s++)if(l=i[s],o=l.split("."),c=o[0],h=o[1],c)this.eventListeners[c]&&this._off(c,h,e);else for(a in this.eventListeners)this._off(a,h,e);return this}dispatchEvent(t){var e={target:this,type:t.type,evt:t};return this.fire(t.type,e),this}addEventListener(t,e){return this.on(t,function(i){e.call(this,i.evt)}),this}removeEventListener(t){return this.off(t),this}_delegate(t,e,i){var n=this;this.on(t,function(s){for(var a=s.target.findAncestors(e,!0,n),l=0;l<a.length;l++)s=lt.Util.cloneObject(s),s.currentTarget=a[l],i.call(a[l],s)})}remove(){return this.isDragging()&&this.stopDrag(),le.DD._dragElements.delete(this._id),this._remove(),this}_clearCaches(){this._clearSelfAndDescendantCache(Ue),this._clearSelfAndDescendantCache(vr),this._clearSelfAndDescendantCache(_o),this._clearSelfAndDescendantCache(wo),this._clearSelfAndDescendantCache(ma),this._clearSelfAndDescendantCache(pa)}_remove(){this._clearCaches();var t=this.getParent();t&&t.children&&(t.children.splice(this.index,1),t._setChildrenIndices(),this.parent=null)}destroy(){return this.remove(),this.clearCache(),this}getAttr(t){var e="get"+lt.Util._capitalize(t);return lt.Util._isFunction(this[e])?this[e]():this.attrs[t]}getAncestors(){for(var t=this.getParent(),e=[];t;)e.push(t),t=t.getParent();return e}getAttrs(){return this.attrs||{}}setAttrs(t){return this._batchTransformChanges(()=>{var e,i;if(!t)return this;for(e in t)e!==df&&(i=bo+lt.Util._capitalize(e),lt.Util._isFunction(this[i])?this[i](t[e]):this._setAttr(e,t[e]))}),this}isListening(){return this._getCache(pa,this._isListening)}_isListening(t){if(!this.listening())return!1;const i=this.getParent();return i&&i!==t&&this!==t?i._isListening(t):!0}isVisible(){return this._getCache(ma,this._isVisible)}_isVisible(t){if(!this.visible())return!1;const i=this.getParent();return i&&i!==t&&this!==t?i._isVisible(t):!0}shouldDrawHit(t,e=!1){if(t)return this._isVisible(t)&&this._isListening(t);var i=this.getLayer(),n=!1;le.DD._dragElements.forEach(a=>{a.dragStatus==="dragging"&&(a.node.nodeType==="Stage"||a.node.getLayer()===i)&&(n=!0)});var s=!e&&!vi.Konva.hitOnDragEnabled&&n;return this.isListening()&&this.isVisible()&&!s}show(){return this.visible(!0),this}hide(){return this.visible(!1),this}getZIndex(){return this.index||0}getAbsoluteZIndex(){var t=this.getDepth(),e=this,i=0,n,s,a,l;function o(h){for(n=[],s=h.length,a=0;a<s;a++)l=h[a],i++,l.nodeType!==So&&(n=n.concat(l.getChildren().slice())),l._id===e._id&&(a=s);n.length>0&&n[0].getDepth()<=t&&o(n)}const c=this.getStage();return e.nodeType!==pf&&c&&o(c.getChildren()),i}getDepth(){for(var t=0,e=this.parent;e;)t++,e=e.parent;return t}_batchTransformChanges(t){this._batchingTransformChange=!0,t(),this._batchingTransformChange=!1,this._needClearTransformCache&&(this._clearCache(ri),this._clearSelfAndDescendantCache(Ue)),this._needClearTransformCache=!1}setPosition(t){return this._batchTransformChanges(()=>{this.x(t.x),this.y(t.y)}),this}getPosition(){return{x:this.x(),y:this.y()}}getRelativePointerPosition(){const t=this.getStage();if(!t)return null;var e=t.getPointerPosition();if(!e)return null;var i=this.getAbsoluteTransform().copy();return i.invert(),i.point(e)}getAbsolutePosition(t){let e=!1,i=this.parent;for(;i;){if(i.isCached()){e=!0;break}i=i.parent}e&&!t&&(t=!0);var n=this.getAbsoluteTransform(t).getMatrix(),s=new lt.Transform,a=this.offset();return s.m=n.slice(),s.translate(a.x,a.y),s.getTranslation()}setAbsolutePosition(t){const{x:e,y:i,...n}=this._clearTransform();this.attrs.x=e,this.attrs.y=i,this._clearCache(ri);var s=this._getAbsoluteTransform().copy();return s.invert(),s.translate(t.x,t.y),t={x:this.attrs.x+s.getTranslation().x,y:this.attrs.y+s.getTranslation().y},this._setTransform(n),this.setPosition({x:t.x,y:t.y}),this._clearCache(ri),this._clearSelfAndDescendantCache(Ue),this}_setTransform(t){var e;for(e in t)this.attrs[e]=t[e]}_clearTransform(){var t={x:this.x(),y:this.y(),rotation:this.rotation(),scaleX:this.scaleX(),scaleY:this.scaleY(),offsetX:this.offsetX(),offsetY:this.offsetY(),skewX:this.skewX(),skewY:this.skewY()};return this.attrs.x=0,this.attrs.y=0,this.attrs.rotation=0,this.attrs.scaleX=1,this.attrs.scaleY=1,this.attrs.offsetX=0,this.attrs.offsetY=0,this.attrs.skewX=0,this.attrs.skewY=0,t}move(t){var e=t.x,i=t.y,n=this.x(),s=this.y();return e!==void 0&&(n+=e),i!==void 0&&(s+=i),this.setPosition({x:n,y:s}),this}_eachAncestorReverse(t,e){var i=[],n=this.getParent(),s,a;if(!(e&&e._id===this._id)){for(i.unshift(this);n&&(!e||n._id!==e._id);)i.unshift(n),n=n.parent;for(s=i.length,a=0;a<s;a++)t(i[a])}}rotate(t){return this.rotation(this.rotation()+t),this}moveToTop(){if(!this.parent)return lt.Util.warn("Node has no parent. moveToTop function is ignored."),!1;var t=this.index,e=this.parent.getChildren().length;return t<e-1?(this.parent.children.splice(t,1),this.parent.children.push(this),this.parent._setChildrenIndices(),!0):!1}moveUp(){if(!this.parent)return lt.Util.warn("Node has no parent. moveUp function is ignored."),!1;var t=this.index,e=this.parent.getChildren().length;return t<e-1?(this.parent.children.splice(t,1),this.parent.children.splice(t+1,0,this),this.parent._setChildrenIndices(),!0):!1}moveDown(){if(!this.parent)return lt.Util.warn("Node has no parent. moveDown function is ignored."),!1;var t=this.index;return t>0?(this.parent.children.splice(t,1),this.parent.children.splice(t-1,0,this),this.parent._setChildrenIndices(),!0):!1}moveToBottom(){if(!this.parent)return lt.Util.warn("Node has no parent. moveToBottom function is ignored."),!1;var t=this.index;return t>0?(this.parent.children.splice(t,1),this.parent.children.unshift(this),this.parent._setChildrenIndices(),!0):!1}setZIndex(t){if(!this.parent)return lt.Util.warn("Node has no parent. zIndex parameter is ignored."),this;(t<0||t>=this.parent.children.length)&&lt.Util.warn("Unexpected value "+t+" for zIndex property. zIndex is just index of a node in children of its parent. Expected value is from 0 to "+(this.parent.children.length-1)+".");var e=this.index;return this.parent.children.splice(e,1),this.parent.children.splice(t,0,this),this.parent._setChildrenIndices(),this}getAbsoluteOpacity(){return this._getCache(vr,this._getAbsoluteOpacity)}_getAbsoluteOpacity(){var t=this.opacity(),e=this.getParent();return e&&!e._isUnderCache&&(t*=e.getAbsoluteOpacity()),t}moveTo(t){return this.getParent()!==t&&(this._remove(),t.add(this)),this}toObject(){var t={},e=this.getAttrs(),i,n,s,a,l;t.attrs={};for(i in e)n=e[i],l=lt.Util.isObject(n)&&!lt.Util._isPlainObject(n)&&!lt.Util._isArray(n),!l&&(s=typeof this[i]=="function"&&this[i],delete e[i],a=s?s.call(this):null,e[i]=n,a!==n&&(t.attrs[i]=n));return t.className=this.getClassName(),lt.Util._prepareToStringify(t)}toJSON(){return JSON.stringify(this.toObject())}getParent(){return this.parent}findAncestors(t,e,i){var n=[];e&&this._isMatch(t)&&n.push(this);for(var s=this.parent;s;){if(s===i)return n;s._isMatch(t)&&n.push(s),s=s.parent}return n}isAncestorOf(t){return!1}findAncestor(t,e,i){return this.findAncestors(t,e,i)[0]}_isMatch(t){if(!t)return!1;if(typeof t=="function")return t(this);var e=t.replace(/ /g,"").split(","),i=e.length,n,s;for(n=0;n<i;n++)if(s=e[n],lt.Util.isValidSelector(s)||(lt.Util.warn('Selector "'+s+'" is invalid. Allowed selectors examples are "#foo", ".bar" or "Group".'),lt.Util.warn('If you have a custom shape with such className, please change it to start with upper letter like "Triangle".'),lt.Util.warn("Konva is awesome, right?")),s.charAt(0)==="#"){if(this.id()===s.slice(1))return!0}else if(s.charAt(0)==="."){if(this.hasName(s.slice(1)))return!0}else if(this.className===s||this.nodeType===s)return!0;return!1}getLayer(){var t=this.getParent();return t?t.getLayer():null}getStage(){return this._getCache(wo,this._getStage)}_getStage(){var t=this.getParent();return t?t.getStage():null}fire(t,e={},i){return e.target=e.target||this,i?this._fireAndBubble(t,e):this._fire(t,e),this}getAbsoluteTransform(t){return t?this._getAbsoluteTransform(t):this._getCache(Ue,this._getAbsoluteTransform)}_getAbsoluteTransform(t){var e;if(t)return e=new lt.Transform,this._eachAncestorReverse(function(n){var s=n.transformsEnabled();s==="all"?e.multiply(n.getTransform()):s==="position"&&e.translate(n.x()-n.offsetX(),n.y()-n.offsetY())},t),e;e=this._cache.get(Ue)||new lt.Transform,this.parent?this.parent.getAbsoluteTransform().copyInto(e):e.reset();var i=this.transformsEnabled();if(i==="all")e.multiply(this.getTransform());else if(i==="position"){const n=this.attrs.x||0,s=this.attrs.y||0,a=this.attrs.offsetX||0,l=this.attrs.offsetY||0;e.translate(n-a,s-l)}return e.dirty=!1,e}getAbsoluteScale(t){for(var e=this;e;)e._isUnderCache&&(t=e),e=e.getParent();const n=this.getAbsoluteTransform(t).decompose();return{x:n.scaleX,y:n.scaleY}}getAbsoluteRotation(){return this.getAbsoluteTransform().decompose().rotation}getTransform(){return this._getCache(ri,this._getTransform)}_getTransform(){var t,e,i=this._cache.get(ri)||new lt.Transform;i.reset();var n=this.x(),s=this.y(),a=vi.Konva.getAngle(this.rotation()),l=(t=this.attrs.scaleX)!==null&&t!==void 0?t:1,o=(e=this.attrs.scaleY)!==null&&e!==void 0?e:1,c=this.attrs.skewX||0,h=this.attrs.skewY||0,f=this.attrs.offsetX||0,d=this.attrs.offsetY||0;return(n!==0||s!==0)&&i.translate(n,s),a!==0&&i.rotate(a),(c!==0||h!==0)&&i.skew(c,h),(l!==1||o!==1)&&i.scale(l,o),(f!==0||d!==0)&&i.translate(-1*f,-1*d),i.dirty=!1,i}clone(t){var e=lt.Util.cloneObject(this.attrs),i,n,s,a,l;for(i in t)e[i]=t[i];var o=new this.constructor(e);for(i in this.eventListeners)for(n=this.eventListeners[i],s=n.length,a=0;a<s;a++)l=n[a],l.name.indexOf(gf)<0&&(o.eventListeners[i]||(o.eventListeners[i]=[]),o.eventListeners[i].push(l));return o}_toKonvaCanvas(t){t=t||{};var e=this.getClientRect(),i=this.getStage(),n=t.x!==void 0?t.x:Math.floor(e.x),s=t.y!==void 0?t.y:Math.floor(e.y),a=t.pixelRatio||1,l=new Wn.SceneCanvas({width:t.width||Math.ceil(e.width)||(i?i.width():0),height:t.height||Math.ceil(e.height)||(i?i.height():0),pixelRatio:a}),o=l.getContext();return t.imageSmoothingEnabled===!1&&(o._context.imageSmoothingEnabled=!1),o.save(),(n||s)&&o.translate(-1*n,-1*s),this.drawScene(l),o.restore(),l}toCanvas(t){return this._toKonvaCanvas(t)._canvas}toDataURL(t){t=t||{};var e=t.mimeType||null,i=t.quality||null,n=this._toKonvaCanvas(t).toDataURL(e,i);return t.callback&&t.callback(n),n}toImage(t){return new Promise((e,i)=>{try{const n=t?.callback;n&&delete t.callback,lt.Util._urlToImage(this.toDataURL(t),function(s){e(s),n?.(s)})}catch(n){i(n)}})}toBlob(t){return new Promise((e,i)=>{try{const n=t?.callback;n&&delete t.callback,this.toCanvas(t).toBlob(s=>{e(s),n?.(s)},t?.mimeType,t?.quality)}catch(n){i(n)}})}setSize(t){return this.width(t.width),this.height(t.height),this}getSize(){return{width:this.width(),height:this.height()}}getClassName(){return this.className||this.nodeType}getType(){return this.nodeType}getDragDistance(){return this.attrs.dragDistance!==void 0?this.attrs.dragDistance:this.parent?this.parent.getDragDistance():vi.Konva.dragDistance}_off(t,e,i){var n=this.eventListeners[t],s,a,l;for(s=0;s<n.length;s++)if(a=n[s].name,l=n[s].handler,(a!=="konva"||e==="konva")&&(!e||a===e)&&(!i||i===l)){if(n.splice(s,1),n.length===0){delete this.eventListeners[t];break}s--}}_fireChangeEvent(t,e,i){this._fire(t+ff,{oldVal:e,newVal:i})}addName(t){if(!this.hasName(t)){var e=this.name(),i=e?e+" "+t:t;this.name(i)}return this}hasName(t){if(!t)return!1;const e=this.name();if(!e)return!1;var i=(e||"").split(/\s/g);return i.indexOf(t)!==-1}removeName(t){var e=(this.name()||"").split(/\s/g),i=e.indexOf(t);return i!==-1&&(e.splice(i,1),this.name(e.join(" "))),this}setAttr(t,e){var i=this[bo+lt.Util._capitalize(t)];return lt.Util._isFunction(i)?i.call(this,e):this._setAttr(t,e),this}_requestDraw(){if(vi.Konva.autoDrawEnabled){const t=this.getLayer()||this.getStage();t?.batchDraw()}}_setAttr(t,e){var i=this.attrs[t];i===e&&!lt.Util.isObject(e)||(e==null?delete this.attrs[t]:this.attrs[t]=e,this._shouldFireChangeEvents&&this._fireChangeEvent(t,i,e),this._requestDraw())}_setComponentAttr(t,e,i){var n;i!==void 0&&(n=this.attrs[t],n||(this.attrs[t]=this.getAttr(t)),this.attrs[t][e]=i,this._fireChangeEvent(t,n,i))}_fireAndBubble(t,e,i){e&&this.nodeType===So&&(e.target=this);var n=(t===vo||t===yo)&&(i&&(this===i||this.isAncestorOf&&this.isAncestorOf(i))||this.nodeType==="Stage"&&!i);if(!n){this._fire(t,e);var s=(t===vo||t===yo)&&i&&i.isAncestorOf&&i.isAncestorOf(this)&&!i.isAncestorOf(this.parent);(e&&!e.cancelBubble||!e)&&this.parent&&this.parent.isListening()&&!s&&(i&&i.parent?this._fireAndBubble.call(this.parent,t,e,i):this._fireAndBubble.call(this.parent,t,e))}}_getProtoListeners(t){var e,i,n;const s=(e=this._cache.get(Xn))!==null&&e!==void 0?e:{};let a=s?.[t];if(a===void 0){a=[];let l=Object.getPrototypeOf(this);for(;l;){const o=(n=(i=l.eventListeners)===null||i===void 0?void 0:i[t])!==null&&n!==void 0?n:[];a.push(...o),l=Object.getPrototypeOf(l)}s[t]=a,this._cache.set(Xn,s)}return a}_fire(t,e){e=e||{},e.currentTarget=this,e.type=t;const i=this._getProtoListeners(t);if(i)for(var n=0;n<i.length;n++)i[n].handler.call(this,e);const s=this.eventListeners[t];if(s)for(var n=0;n<s.length;n++)s[n].handler.call(this,e)}draw(){return this.drawScene(),this.drawHit(),this}_createDragElement(t){var e=t?t.pointerId:void 0,i=this.getStage(),n=this.getAbsolutePosition();if(i){var s=i._getPointerById(e)||i._changedPointerPositions[0]||n;le.DD._dragElements.set(this._id,{node:this,startPointerPos:s,offset:{x:s.x-n.x,y:s.y-n.y},dragStatus:"ready",pointerId:e})}}startDrag(t,e=!0){le.DD._dragElements.has(this._id)||this._createDragElement(t);const i=le.DD._dragElements.get(this._id);i.dragStatus="dragging",this.fire("dragstart",{type:"dragstart",target:this,evt:t&&t.evt},e)}_setDragPosition(t,e){const i=this.getStage()._getPointerById(e.pointerId);if(i){var n={x:i.x-e.offset.x,y:i.y-e.offset.y},s=this.dragBoundFunc();if(s!==void 0){const a=s.call(this,n,t);a?n=a:lt.Util.warn("dragBoundFunc did not return any value. That is unexpected behavior. You must return new absolute position from dragBoundFunc.")}(!this._lastPos||this._lastPos.x!==n.x||this._lastPos.y!==n.y)&&(this.setAbsolutePosition(n),this._requestDraw()),this._lastPos=n}}stopDrag(t){const e=le.DD._dragElements.get(this._id);e&&(e.dragStatus="stopped"),le.DD._endDragBefore(t),le.DD._endDragAfter(t)}setDraggable(t){this._setAttr("draggable",t),this._dragChange()}isDragging(){const t=le.DD._dragElements.get(this._id);return t?t.dragStatus==="dragging":!1}_listenDrag(){this._dragCleanup(),this.on("mousedown.konva touchstart.konva",function(t){var e=t.evt.button!==void 0,i=!e||vi.Konva.dragButtons.indexOf(t.evt.button)>=0;if(i&&!this.isDragging()){var n=!1;le.DD._dragElements.forEach(s=>{this.isAncestorOf(s.node)&&(n=!0)}),n||this._createDragElement(t)}})}_dragChange(){if(this.attrs.draggable)this._listenDrag();else{this._dragCleanup();var t=this.getStage();if(!t)return;const e=le.DD._dragElements.get(this._id),i=e&&e.dragStatus==="dragging",n=e&&e.dragStatus==="ready";i?this.stopDrag():n&&le.DD._dragElements.delete(this._id)}}_dragCleanup(){this.off("mousedown.konva"),this.off("touchstart.konva")}isClientRectOnScreen(t={x:0,y:0}){const e=this.getStage();if(!e)return!1;const i={x:-t.x,y:-t.y,width:e.width()+2*t.x,height:e.height()+2*t.y};return lt.Util.haveIntersection(i,this.getClientRect())}static create(t,e){return lt.Util._isString(t)&&(t=JSON.parse(t)),this._createNode(t,e)}static _createNode(t,e){var i=it.prototype.getClassName.call(t),n=t.children,s,a,l;e&&(t.attrs.container=e),vi.Konva[i]||(lt.Util.warn('Can not find a node with class name "'+i+'". Fallback to "Shape".'),i="Shape");const o=vi.Konva[i];if(s=new o(t.attrs),n)for(a=n.length,l=0;l<a;l++)s.add(it._createNode(n[l]));return s}}Ft.Node=it;it.prototype.nodeType="Node";it.prototype._attrsAffectingSize=[];it.prototype.eventListeners={};it.prototype.on.call(it.prototype,mf,function(){if(this._batchingTransformChange){this._needClearTransformCache=!0;return}this._clearCache(ri),this._clearSelfAndDescendantCache(Ue)});it.prototype.on.call(it.prototype,"visibleChange.konva",function(){this._clearSelfAndDescendantCache(ma)});it.prototype.on.call(it.prototype,"listeningChange.konva",function(){this._clearSelfAndDescendantCache(pa)});it.prototype.on.call(it.prototype,"opacityChange.konva",function(){this._clearSelfAndDescendantCache(vr)});const Pt=Gn.Factory.addGetterSetter;Pt(it,"zIndex");Pt(it,"absolutePosition");Pt(it,"position");Pt(it,"x",0,(0,Ut.getNumberValidator)());Pt(it,"y",0,(0,Ut.getNumberValidator)());Pt(it,"globalCompositeOperation","source-over",(0,Ut.getStringValidator)());Pt(it,"opacity",1,(0,Ut.getNumberValidator)());Pt(it,"name","",(0,Ut.getStringValidator)());Pt(it,"id","",(0,Ut.getStringValidator)());Pt(it,"rotation",0,(0,Ut.getNumberValidator)());Gn.Factory.addComponentsGetterSetter(it,"scale",["x","y"]);Pt(it,"scaleX",1,(0,Ut.getNumberValidator)());Pt(it,"scaleY",1,(0,Ut.getNumberValidator)());Gn.Factory.addComponentsGetterSetter(it,"skew",["x","y"]);Pt(it,"skewX",0,(0,Ut.getNumberValidator)());Pt(it,"skewY",0,(0,Ut.getNumberValidator)());Gn.Factory.addComponentsGetterSetter(it,"offset",["x","y"]);Pt(it,"offsetX",0,(0,Ut.getNumberValidator)());Pt(it,"offsetY",0,(0,Ut.getNumberValidator)());Pt(it,"dragDistance",null,(0,Ut.getNumberValidator)());Pt(it,"width",0,(0,Ut.getNumberValidator)());Pt(it,"height",0,(0,Ut.getNumberValidator)());Pt(it,"listening",!0,(0,Ut.getBooleanValidator)());Pt(it,"preventDefault",!0,(0,Ut.getBooleanValidator)());Pt(it,"filters",null,function(r){return this._filterUpToDate=!1,r});Pt(it,"visible",!0,(0,Ut.getBooleanValidator)());Pt(it,"transformsEnabled","all",(0,Ut.getStringValidator)());Pt(it,"size");Pt(it,"dragBoundFunc");Pt(it,"draggable",!1,(0,Ut.getBooleanValidator)());Gn.Factory.backCompat(it,{rotateDeg:"rotate",setRotationDeg:"setRotation",getRotationDeg:"getRotation"});var Ri={};Object.defineProperty(Ri,"__esModule",{value:!0});Ri.Container=void 0;const cn=st,Is=Ft,zr=H;let Ni=class extends Is.Node{constructor(){super(...arguments),this.children=[]}getChildren(t){if(!t)return this.children||[];const e=this.children||[];var i=[];return e.forEach(function(n){t(n)&&i.push(n)}),i}hasChildren(){return this.getChildren().length>0}removeChildren(){return this.getChildren().forEach(t=>{t.parent=null,t.index=0,t.remove()}),this.children=[],this._requestDraw(),this}destroyChildren(){return this.getChildren().forEach(t=>{t.parent=null,t.index=0,t.destroy()}),this.children=[],this._requestDraw(),this}add(...t){if(t.length===0)return this;if(t.length>1){for(var e=0;e<t.length;e++)this.add(t[e]);return this}const i=t[0];return i.getParent()?(i.moveTo(this),this):(this._validateAdd(i),i.index=this.getChildren().length,i.parent=this,i._clearCaches(),this.getChildren().push(i),this._fire("add",{child:i}),this._requestDraw(),this)}destroy(){return this.hasChildren()&&this.destroyChildren(),super.destroy(),this}find(t){return this._generalFind(t,!1)}findOne(t){var e=this._generalFind(t,!0);return e.length>0?e[0]:void 0}_generalFind(t,e){var i=[];return this._descendants(n=>{const s=n._isMatch(t);return s&&i.push(n),!!(s&&e)}),i}_descendants(t){let e=!1;const i=this.getChildren();for(const n of i){if(e=t(n),e)return!0;if(n.hasChildren()&&(e=n._descendants(t),e))return!0}return!1}toObject(){var t=Is.Node.prototype.toObject.call(this);return t.children=[],this.getChildren().forEach(e=>{t.children.push(e.toObject())}),t}isAncestorOf(t){for(var e=t.getParent();e;){if(e._id===this._id)return!0;e=e.getParent()}return!1}clone(t){var e=Is.Node.prototype.clone.call(this,t);return this.getChildren().forEach(function(i){e.add(i.clone())}),e}getAllIntersections(t){var e=[];return this.find("Shape").forEach(i=>{i.isVisible()&&i.intersects(t)&&e.push(i)}),e}_clearSelfAndDescendantCache(t){var e;super._clearSelfAndDescendantCache(t),!this.isCached()&&((e=this.children)===null||e===void 0||e.forEach(function(i){i._clearSelfAndDescendantCache(t)}))}_setChildrenIndices(){var t;(t=this.children)===null||t===void 0||t.forEach(function(e,i){e.index=i}),this._requestDraw()}drawScene(t,e){var i=this.getLayer(),n=t||i&&i.getCanvas(),s=n&&n.getContext(),a=this._getCanvasCache(),l=a&&a.scene,o=n&&n.isCache;if(!this.isVisible()&&!o)return this;if(l){s.save();var c=this.getAbsoluteTransform(e).getMatrix();s.transform(c[0],c[1],c[2],c[3],c[4],c[5]),this._drawCachedSceneCanvas(s),s.restore()}else this._drawChildren("drawScene",n,e);return this}drawHit(t,e){if(!this.shouldDrawHit(e))return this;var i=this.getLayer(),n=t||i&&i.hitCanvas,s=n&&n.getContext(),a=this._getCanvasCache(),l=a&&a.hit;if(l){s.save();var o=this.getAbsoluteTransform(e).getMatrix();s.transform(o[0],o[1],o[2],o[3],o[4],o[5]),this._drawCachedHitCanvas(s),s.restore()}else this._drawChildren("drawHit",n,e);return this}_drawChildren(t,e,i){var n,s=e&&e.getContext(),a=this.clipWidth(),l=this.clipHeight(),o=this.clipFunc(),c=a&&l||o;const h=i===this;if(c){s.save();var f=this.getAbsoluteTransform(i),d=f.getMatrix();s.transform(d[0],d[1],d[2],d[3],d[4],d[5]),s.beginPath();let b;if(o)b=o.call(this,s,this);else{var g=this.clipX(),p=this.clipY();s.rect(g,p,a,l)}s.clip.apply(s,b),d=f.copy().invert().getMatrix(),s.transform(d[0],d[1],d[2],d[3],d[4],d[5])}var v=!h&&this.globalCompositeOperation()!=="source-over"&&t==="drawScene";v&&(s.save(),s._applyGlobalCompositeOperation(this)),(n=this.children)===null||n===void 0||n.forEach(function(b){b[t](e,i)}),v&&s.restore(),c&&s.restore()}getClientRect(t={}){var e,i=t.skipTransform,n=t.relativeTo,s,a,l,o,c={x:1/0,y:1/0,width:0,height:0},h=this;(e=this.children)===null||e===void 0||e.forEach(function(v){if(v.visible()){var b=v.getClientRect({relativeTo:h,skipShadow:t.skipShadow,skipStroke:t.skipStroke});b.width===0&&b.height===0||(s===void 0?(s=b.x,a=b.y,l=b.x+b.width,o=b.y+b.height):(s=Math.min(s,b.x),a=Math.min(a,b.y),l=Math.max(l,b.x+b.width),o=Math.max(o,b.y+b.height)))}});for(var f=this.find("Shape"),d=!1,g=0;g<f.length;g++){var p=f[g];if(p._isVisible(this)){d=!0;break}}return d&&s!==void 0?c={x:s,y:a,width:l-s,height:o-a}:c={x:0,y:0,width:0,height:0},i?c:this._transformedRect(c,n)}};Ri.Container=Ni;cn.Factory.addComponentsGetterSetter(Ni,"clip",["x","y","width","height"]);cn.Factory.addGetterSetter(Ni,"clipX",void 0,(0,zr.getNumberValidator)());cn.Factory.addGetterSetter(Ni,"clipY",void 0,(0,zr.getNumberValidator)());cn.Factory.addGetterSetter(Ni,"clipWidth",void 0,(0,zr.getNumberValidator)());cn.Factory.addGetterSetter(Ni,"clipHeight",void 0,(0,zr.getNumberValidator)());cn.Factory.addGetterSetter(Ni,"clipFunc");var gc={},re={};Object.defineProperty(re,"__esModule",{value:!0});re.releaseCapture=re.setPointerCapture=re.hasPointerCapture=re.createEvent=re.getCapturedShape=void 0;const vf=ot,Mn=new Map,pc=vf.Konva._global.PointerEvent!==void 0;function yf(r){return Mn.get(r)}re.getCapturedShape=yf;function Da(r){return{evt:r,pointerId:r.pointerId}}re.createEvent=Da;function bf(r,t){return Mn.get(r)===t}re.hasPointerCapture=bf;function Sf(r,t){mc(r),t.getStage()&&(Mn.set(r,t),pc&&t._fire("gotpointercapture",Da(new PointerEvent("gotpointercapture"))))}re.setPointerCapture=Sf;function mc(r,t){const e=Mn.get(r);if(!e)return;const i=e.getStage();i&&i.content,Mn.delete(r),pc&&e._fire("lostpointercapture",Da(new PointerEvent("lostpointercapture")))}re.releaseCapture=mc;(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.Stage=r.stages=void 0;const t=It,e=st,i=Ri,n=ot,s=Ce,a=Vr,l=ot,o=re;var c="Stage",h="string",f="px",d="mouseout",g="mouseleave",p="mouseover",v="mouseenter",b="mousemove",_="mousedown",S="mouseup",u="pointermove",m="pointerdown",y="pointerup",w="pointercancel",k="lostpointercapture",C="pointerout",A="pointerleave",T="pointerover",P="pointerenter",E="contextmenu",M="touchstart",R="touchend",N="touchmove",B="touchcancel",q="wheel",nt=5,ct=[[v,"_pointerenter"],[_,"_pointerdown"],[b,"_pointermove"],[S,"_pointerup"],[g,"_pointerleave"],[M,"_pointerdown"],[N,"_pointermove"],[R,"_pointerup"],[B,"_pointercancel"],[p,"_pointerover"],[q,"_wheel"],[E,"_contextmenu"],[m,"_pointerdown"],[u,"_pointermove"],[y,"_pointerup"],[w,"_pointercancel"],[k,"_lostpointercapture"]];const K={mouse:{[C]:d,[A]:g,[T]:p,[P]:v,[u]:b,[m]:_,[y]:S,[w]:"mousecancel",pointerclick:"click",pointerdblclick:"dblclick"},touch:{[C]:"touchout",[A]:"touchleave",[T]:"touchover",[P]:"touchenter",[u]:N,[m]:M,[y]:R,[w]:B,pointerclick:"tap",pointerdblclick:"dbltap"},pointer:{[C]:C,[A]:A,[T]:T,[P]:P,[u]:u,[m]:m,[y]:y,[w]:w,pointerclick:"pointerclick",pointerdblclick:"pointerdblclick"}},$=qt=>qt.indexOf("pointer")>=0?"pointer":qt.indexOf("touch")>=0?"touch":"mouse",pt=qt=>{const x=$(qt);if(x==="pointer")return n.Konva.pointerEventsEnabled&&K.pointer;if(x==="touch")return K.touch;if(x==="mouse")return K.mouse};function Tt(qt={}){return(qt.clipFunc||qt.clipWidth||qt.clipHeight)&&t.Util.warn("Stage does not support clipping. Please use clip for Layers or Groups."),qt}const Ct="Pointer position is missing and not registered by the stage. Looks like it is outside of the stage container. You can set it manually from event: stage.setPointersPositions(event);";r.stages=[];class ye extends i.Container{constructor(x){super(Tt(x)),this._pointerPositions=[],this._changedPointerPositions=[],this._buildDOM(),this._bindContentEvents(),r.stages.push(this),this.on("widthChange.konva heightChange.konva",this._resizeDOM),this.on("visibleChange.konva",this._checkVisibility),this.on("clipWidthChange.konva clipHeightChange.konva clipFuncChange.konva",()=>{Tt(this.attrs)}),this._checkVisibility()}_validateAdd(x){const I=x.getType()==="Layer",W=x.getType()==="FastLayer";I||W||t.Util.throw("You may only add layers to the stage.")}_checkVisibility(){if(!this.content)return;const x=this.visible()?"":"none";this.content.style.display=x}setContainer(x){if(typeof x===h){if(x.charAt(0)==="."){var I=x.slice(1);x=document.getElementsByClassName(I)[0]}else{var W;x.charAt(0)!=="#"?W=x:W=x.slice(1),x=document.getElementById(W)}if(!x)throw"Can not find container in document with id "+W}return this._setAttr("container",x),this.content&&(this.content.parentElement&&this.content.parentElement.removeChild(this.content),x.appendChild(this.content)),this}shouldDrawHit(){return!0}clear(){var x=this.children,I=x.length,W;for(W=0;W<I;W++)x[W].clear();return this}clone(x){return x||(x={}),x.container=typeof document<"u"&&document.createElement("div"),i.Container.prototype.clone.call(this,x)}destroy(){super.destroy();var x=this.content;x&&t.Util._isInDocument(x)&&this.container().removeChild(x);var I=r.stages.indexOf(this);return I>-1&&r.stages.splice(I,1),t.Util.releaseCanvas(this.bufferCanvas._canvas,this.bufferHitCanvas._canvas),this}getPointerPosition(){const x=this._pointerPositions[0]||this._changedPointerPositions[0];return x?{x:x.x,y:x.y}:(t.Util.warn(Ct),null)}_getPointerById(x){return this._pointerPositions.find(I=>I.id===x)}getPointersPositions(){return this._pointerPositions}getStage(){return this}getContent(){return this.content}_toKonvaCanvas(x){x=x||{},x.x=x.x||0,x.y=x.y||0,x.width=x.width||this.width(),x.height=x.height||this.height();var I=new s.SceneCanvas({width:x.width,height:x.height,pixelRatio:x.pixelRatio||1}),W=I.getContext()._context,D=this.children;return(x.x||x.y)&&W.translate(-1*x.x,-1*x.y),D.forEach(function(U){if(U.isVisible()){var X=U._toKonvaCanvas(x);W.drawImage(X._canvas,x.x,x.y,X.getWidth()/X.getPixelRatio(),X.getHeight()/X.getPixelRatio())}}),I}getIntersection(x){if(!x)return null;var I=this.children,W=I.length,D=W-1,U;for(U=D;U>=0;U--){const X=I[U].getIntersection(x);if(X)return X}return null}_resizeDOM(){var x=this.width(),I=this.height();this.content&&(this.content.style.width=x+f,this.content.style.height=I+f),this.bufferCanvas.setSize(x,I),this.bufferHitCanvas.setSize(x,I),this.children.forEach(W=>{W.setSize({width:x,height:I}),W.draw()})}add(x,...I){if(arguments.length>1){for(var W=0;W<arguments.length;W++)this.add(arguments[W]);return this}super.add(x);var D=this.children.length;return D>nt&&t.Util.warn("The stage has "+D+" layers. Recommended maximum number of layers is 3-5. Adding more layers into the stage may drop the performance. Rethink your tree structure, you can use Konva.Group."),x.setSize({width:this.width(),height:this.height()}),x.draw(),n.Konva.isBrowser&&this.content.appendChild(x.canvas._canvas),this}getParent(){return null}getLayer(){return null}hasPointerCapture(x){return o.hasPointerCapture(x,this)}setPointerCapture(x){o.setPointerCapture(x,this)}releaseCapture(x){o.releaseCapture(x,this)}getLayers(){return this.children}_bindContentEvents(){n.Konva.isBrowser&&ct.forEach(([x,I])=>{this.content.addEventListener(x,W=>{this[I](W)},{passive:!1})})}_pointerenter(x){this.setPointersPositions(x);const I=pt(x.type);I&&this._fire(I.pointerenter,{evt:x,target:this,currentTarget:this})}_pointerover(x){this.setPointersPositions(x);const I=pt(x.type);I&&this._fire(I.pointerover,{evt:x,target:this,currentTarget:this})}_getTargetShape(x){let I=this[x+"targetShape"];return I&&!I.getStage()&&(I=null),I}_pointerleave(x){const I=pt(x.type),W=$(x.type);if(I){this.setPointersPositions(x);var D=this._getTargetShape(W),U=!a.DD.isDragging||n.Konva.hitOnDragEnabled;D&&U?(D._fireAndBubble(I.pointerout,{evt:x}),D._fireAndBubble(I.pointerleave,{evt:x}),this._fire(I.pointerleave,{evt:x,target:this,currentTarget:this}),this[W+"targetShape"]=null):U&&(this._fire(I.pointerleave,{evt:x,target:this,currentTarget:this}),this._fire(I.pointerout,{evt:x,target:this,currentTarget:this})),this.pointerPos=null,this._pointerPositions=[]}}_pointerdown(x){const I=pt(x.type),W=$(x.type);if(I){this.setPointersPositions(x);var D=!1;this._changedPointerPositions.forEach(U=>{var X=this.getIntersection(U);if(a.DD.justDragged=!1,n.Konva["_"+W+"ListenClick"]=!0,!X||!X.isListening())return;n.Konva.capturePointerEventsEnabled&&X.setPointerCapture(U.id),this[W+"ClickStartShape"]=X,X._fireAndBubble(I.pointerdown,{evt:x,pointerId:U.id}),D=!0;const wt=x.type.indexOf("touch")>=0;X.preventDefault()&&x.cancelable&&wt&&x.preventDefault()}),D||this._fire(I.pointerdown,{evt:x,target:this,currentTarget:this,pointerId:this._pointerPositions[0].id})}}_pointermove(x){const I=pt(x.type),W=$(x.type);if(!I)return;a.DD.isDragging&&a.DD.node.preventDefault()&&x.cancelable&&x.preventDefault(),this.setPointersPositions(x);var D=!a.DD.isDragging||n.Konva.hitOnDragEnabled;if(!D)return;var U={};let X=!1;var wt=this._getTargetShape(W);this._changedPointerPositions.forEach(Vt=>{const yt=o.getCapturedShape(Vt.id)||this.getIntersection(Vt),Kt=Vt.id,Ne={evt:x,pointerId:Kt};var Ui=wt!==yt;if(Ui&&wt&&(wt._fireAndBubble(I.pointerout,{...Ne},yt),wt._fireAndBubble(I.pointerleave,{...Ne},yt)),yt){if(U[yt._id])return;U[yt._id]=!0}yt&&yt.isListening()?(X=!0,Ui&&(yt._fireAndBubble(I.pointerover,{...Ne},wt),yt._fireAndBubble(I.pointerenter,{...Ne},wt),this[W+"targetShape"]=yt),yt._fireAndBubble(I.pointermove,{...Ne})):wt&&(this._fire(I.pointerover,{evt:x,target:this,currentTarget:this,pointerId:Kt}),this[W+"targetShape"]=null)}),X||this._fire(I.pointermove,{evt:x,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id})}_pointerup(x){const I=pt(x.type),W=$(x.type);if(!I)return;this.setPointersPositions(x);const D=this[W+"ClickStartShape"],U=this[W+"ClickEndShape"];var X={};let wt=!1;this._changedPointerPositions.forEach(Vt=>{const yt=o.getCapturedShape(Vt.id)||this.getIntersection(Vt);if(yt){if(yt.releaseCapture(Vt.id),X[yt._id])return;X[yt._id]=!0}const Kt=Vt.id,Ne={evt:x,pointerId:Kt};let Ui=!1;n.Konva["_"+W+"InDblClickWindow"]?(Ui=!0,clearTimeout(this[W+"DblTimeout"])):a.DD.justDragged||(n.Konva["_"+W+"InDblClickWindow"]=!0,clearTimeout(this[W+"DblTimeout"])),this[W+"DblTimeout"]=setTimeout(function(){n.Konva["_"+W+"InDblClickWindow"]=!1},n.Konva.dblClickWindow),yt&&yt.isListening()?(wt=!0,this[W+"ClickEndShape"]=yt,yt._fireAndBubble(I.pointerup,{...Ne}),n.Konva["_"+W+"ListenClick"]&&D&&D===yt&&(yt._fireAndBubble(I.pointerclick,{...Ne}),Ui&&U&&U===yt&&yt._fireAndBubble(I.pointerdblclick,{...Ne}))):(this[W+"ClickEndShape"]=null,n.Konva["_"+W+"ListenClick"]&&this._fire(I.pointerclick,{evt:x,target:this,currentTarget:this,pointerId:Kt}),Ui&&this._fire(I.pointerdblclick,{evt:x,target:this,currentTarget:this,pointerId:Kt}))}),wt||this._fire(I.pointerup,{evt:x,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id}),n.Konva["_"+W+"ListenClick"]=!1,x.cancelable&&W!=="touch"&&x.preventDefault()}_contextmenu(x){this.setPointersPositions(x);var I=this.getIntersection(this.getPointerPosition());I&&I.isListening()?I._fireAndBubble(E,{evt:x}):this._fire(E,{evt:x,target:this,currentTarget:this})}_wheel(x){this.setPointersPositions(x);var I=this.getIntersection(this.getPointerPosition());I&&I.isListening()?I._fireAndBubble(q,{evt:x}):this._fire(q,{evt:x,target:this,currentTarget:this})}_pointercancel(x){this.setPointersPositions(x);const I=o.getCapturedShape(x.pointerId)||this.getIntersection(this.getPointerPosition());I&&I._fireAndBubble(y,o.createEvent(x)),o.releaseCapture(x.pointerId)}_lostpointercapture(x){o.releaseCapture(x.pointerId)}setPointersPositions(x){var I=this._getContentPosition(),W=null,D=null;x=x||window.event,x.touches!==void 0?(this._pointerPositions=[],this._changedPointerPositions=[],Array.prototype.forEach.call(x.touches,U=>{this._pointerPositions.push({id:U.identifier,x:(U.clientX-I.left)/I.scaleX,y:(U.clientY-I.top)/I.scaleY})}),Array.prototype.forEach.call(x.changedTouches||x.touches,U=>{this._changedPointerPositions.push({id:U.identifier,x:(U.clientX-I.left)/I.scaleX,y:(U.clientY-I.top)/I.scaleY})})):(W=(x.clientX-I.left)/I.scaleX,D=(x.clientY-I.top)/I.scaleY,this.pointerPos={x:W,y:D},this._pointerPositions=[{x:W,y:D,id:t.Util._getFirstPointerId(x)}],this._changedPointerPositions=[{x:W,y:D,id:t.Util._getFirstPointerId(x)}])}_setPointerPosition(x){t.Util.warn('Method _setPointerPosition is deprecated. Use "stage.setPointersPositions(event)" instead.'),this.setPointersPositions(x)}_getContentPosition(){if(!this.content||!this.content.getBoundingClientRect)return{top:0,left:0,scaleX:1,scaleY:1};var x=this.content.getBoundingClientRect();return{top:x.top,left:x.left,scaleX:x.width/this.content.clientWidth||1,scaleY:x.height/this.content.clientHeight||1}}_buildDOM(){if(this.bufferCanvas=new s.SceneCanvas({width:this.width(),height:this.height()}),this.bufferHitCanvas=new s.HitCanvas({pixelRatio:1,width:this.width(),height:this.height()}),!!n.Konva.isBrowser){var x=this.container();if(!x)throw"Stage has no container. A container is required.";x.innerHTML="",this.content=document.createElement("div"),this.content.style.position="relative",this.content.style.userSelect="none",this.content.className="konvajs-content",this.content.setAttribute("role","presentation"),x.appendChild(this.content),this._resizeDOM()}}cache(){return t.Util.warn("Cache function is not allowed for stage. You may use cache only for layers, groups and shapes."),this}clearCache(){return this}batchDraw(){return this.getChildren().forEach(function(x){x.batchDraw()}),this}}r.Stage=ye,ye.prototype.nodeType=c,(0,l._registerNode)(ye),e.Factory.addGetterSetter(ye,"container")})(gc);var On={},jt={};(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.Shape=r.shapes=void 0;const t=ot,e=It,i=st,n=Ft,s=H,a=ot,l=re;var o="hasShadow",c="shadowRGBA",h="patternImage",f="linearGradient",d="radialGradient";let g;function p(){return g||(g=e.Util.createCanvasElement().getContext("2d"),g)}r.shapes={};function v(A){const T=this.attrs.fillRule;T?A.fill(T):A.fill()}function b(A){A.stroke()}function _(A){A.fill()}function S(A){A.stroke()}function u(){this._clearCache(o)}function m(){this._clearCache(c)}function y(){this._clearCache(h)}function w(){this._clearCache(f)}function k(){this._clearCache(d)}class C extends n.Node{constructor(T){super(T);let P;for(;P=e.Util.getRandomColor(),!(P&&!(P in r.shapes)););this.colorKey=P,r.shapes[P]=this}getContext(){return e.Util.warn("shape.getContext() method is deprecated. Please do not use it."),this.getLayer().getContext()}getCanvas(){return e.Util.warn("shape.getCanvas() method is deprecated. Please do not use it."),this.getLayer().getCanvas()}getSceneFunc(){return this.attrs.sceneFunc||this._sceneFunc}getHitFunc(){return this.attrs.hitFunc||this._hitFunc}hasShadow(){return this._getCache(o,this._hasShadow)}_hasShadow(){return this.shadowEnabled()&&this.shadowOpacity()!==0&&!!(this.shadowColor()||this.shadowBlur()||this.shadowOffsetX()||this.shadowOffsetY())}_getFillPattern(){return this._getCache(h,this.__getFillPattern)}__getFillPattern(){if(this.fillPatternImage()){var T=p();const P=T.createPattern(this.fillPatternImage(),this.fillPatternRepeat()||"repeat");if(P&&P.setTransform){const E=new e.Transform;E.translate(this.fillPatternX(),this.fillPatternY()),E.rotate(t.Konva.getAngle(this.fillPatternRotation())),E.scale(this.fillPatternScaleX(),this.fillPatternScaleY()),E.translate(-1*this.fillPatternOffsetX(),-1*this.fillPatternOffsetY());const M=E.getMatrix(),R=typeof DOMMatrix>"u"?{a:M[0],b:M[1],c:M[2],d:M[3],e:M[4],f:M[5]}:new DOMMatrix(M);P.setTransform(R)}return P}}_getLinearGradient(){return this._getCache(f,this.__getLinearGradient)}__getLinearGradient(){var T=this.fillLinearGradientColorStops();if(T){for(var P=p(),E=this.fillLinearGradientStartPoint(),M=this.fillLinearGradientEndPoint(),R=P.createLinearGradient(E.x,E.y,M.x,M.y),N=0;N<T.length;N+=2)R.addColorStop(T[N],T[N+1]);return R}}_getRadialGradient(){return this._getCache(d,this.__getRadialGradient)}__getRadialGradient(){var T=this.fillRadialGradientColorStops();if(T){for(var P=p(),E=this.fillRadialGradientStartPoint(),M=this.fillRadialGradientEndPoint(),R=P.createRadialGradient(E.x,E.y,this.fillRadialGradientStartRadius(),M.x,M.y,this.fillRadialGradientEndRadius()),N=0;N<T.length;N+=2)R.addColorStop(T[N],T[N+1]);return R}}getShadowRGBA(){return this._getCache(c,this._getShadowRGBA)}_getShadowRGBA(){if(this.hasShadow()){var T=e.Util.colorToRGBA(this.shadowColor());if(T)return"rgba("+T.r+","+T.g+","+T.b+","+T.a*(this.shadowOpacity()||1)+")"}}hasFill(){return this._calculate("hasFill",["fillEnabled","fill","fillPatternImage","fillLinearGradientColorStops","fillRadialGradientColorStops"],()=>this.fillEnabled()&&!!(this.fill()||this.fillPatternImage()||this.fillLinearGradientColorStops()||this.fillRadialGradientColorStops()))}hasStroke(){return this._calculate("hasStroke",["strokeEnabled","strokeWidth","stroke","strokeLinearGradientColorStops"],()=>this.strokeEnabled()&&this.strokeWidth()&&!!(this.stroke()||this.strokeLinearGradientColorStops()))}hasHitStroke(){const T=this.hitStrokeWidth();return T==="auto"?this.hasStroke():this.strokeEnabled()&&!!T}intersects(T){var P=this.getStage();if(!P)return!1;const E=P.bufferHitCanvas;return E.getContext().clear(),this.drawHit(E,void 0,!0),E.context.getImageData(Math.round(T.x),Math.round(T.y),1,1).data[3]>0}destroy(){return n.Node.prototype.destroy.call(this),delete r.shapes[this.colorKey],delete this.colorKey,this}_useBufferCanvas(T){var P;if(!this.getStage()||!((P=this.attrs.perfectDrawEnabled)!==null&&P!==void 0?P:!0))return!1;const M=T||this.hasFill(),R=this.hasStroke(),N=this.getAbsoluteOpacity()!==1;if(M&&R&&N)return!0;const B=this.hasShadow(),q=this.shadowForStrokeEnabled();return!!(M&&R&&B&&q)}setStrokeHitEnabled(T){e.Util.warn("strokeHitEnabled property is deprecated. Please use hitStrokeWidth instead."),T?this.hitStrokeWidth("auto"):this.hitStrokeWidth(0)}getStrokeHitEnabled(){return this.hitStrokeWidth()!==0}getSelfRect(){var T=this.size();return{x:this._centroid?-T.width/2:0,y:this._centroid?-T.height/2:0,width:T.width,height:T.height}}getClientRect(T={}){const P=T.skipTransform,E=T.relativeTo,M=this.getSelfRect(),N=!T.skipStroke&&this.hasStroke()&&this.strokeWidth()||0,B=M.width+N,q=M.height+N,nt=!T.skipShadow&&this.hasShadow(),ct=nt?this.shadowOffsetX():0,K=nt?this.shadowOffsetY():0,$=B+Math.abs(ct),pt=q+Math.abs(K),Tt=nt&&this.shadowBlur()||0,Ct=$+Tt*2,ye=pt+Tt*2,qt={width:Ct,height:ye,x:-(N/2+Tt)+Math.min(ct,0)+M.x,y:-(N/2+Tt)+Math.min(K,0)+M.y};return P?qt:this._transformedRect(qt,E)}drawScene(T,P){var E=this.getLayer(),M=T||E.getCanvas(),R=M.getContext(),N=this._getCanvasCache(),B=this.getSceneFunc(),q=this.hasShadow(),nt,ct,K,$=M.isCache,pt=P===this;if(!this.isVisible()&&!pt)return this;if(N){R.save();var Tt=this.getAbsoluteTransform(P).getMatrix();return R.transform(Tt[0],Tt[1],Tt[2],Tt[3],Tt[4],Tt[5]),this._drawCachedSceneCanvas(R),R.restore(),this}if(!B)return this;if(R.save(),this._useBufferCanvas()&&!$){nt=this.getStage(),ct=nt.bufferCanvas,K=ct.getContext(),K.clear(),K.save(),K._applyLineJoin(this);var Ct=this.getAbsoluteTransform(P).getMatrix();K.transform(Ct[0],Ct[1],Ct[2],Ct[3],Ct[4],Ct[5]),B.call(this,K,this),K.restore();var ye=ct.pixelRatio;q&&R._applyShadow(this),R._applyOpacity(this),R._applyGlobalCompositeOperation(this),R.drawImage(ct._canvas,0,0,ct.width/ye,ct.height/ye)}else{if(R._applyLineJoin(this),!pt){var Ct=this.getAbsoluteTransform(P).getMatrix();R.transform(Ct[0],Ct[1],Ct[2],Ct[3],Ct[4],Ct[5]),R._applyOpacity(this),R._applyGlobalCompositeOperation(this)}q&&R._applyShadow(this),B.call(this,R,this)}return R.restore(),this}drawHit(T,P,E=!1){if(!this.shouldDrawHit(P,E))return this;var M=this.getLayer(),R=T||M.hitCanvas,N=R&&R.getContext(),B=this.hitFunc()||this.sceneFunc(),q=this._getCanvasCache(),nt=q&&q.hit;if(this.colorKey||e.Util.warn("Looks like your canvas has a destroyed shape in it. Do not reuse shape after you destroyed it. If you want to reuse shape you should call remove() instead of destroy()"),nt){N.save();var ct=this.getAbsoluteTransform(P).getMatrix();return N.transform(ct[0],ct[1],ct[2],ct[3],ct[4],ct[5]),this._drawCachedHitCanvas(N),N.restore(),this}if(!B)return this;if(N.save(),N._applyLineJoin(this),!(this===P)){var $=this.getAbsoluteTransform(P).getMatrix();N.transform($[0],$[1],$[2],$[3],$[4],$[5])}return B.call(this,N,this),N.restore(),this}drawHitFromCache(T=0){var P=this._getCanvasCache(),E=this._getCachedSceneCanvas(),M=P.hit,R=M.getContext(),N=M.getWidth(),B=M.getHeight(),q,nt,ct,K,$,pt;R.clear(),R.drawImage(E._canvas,0,0,N,B);try{for(q=R.getImageData(0,0,N,B),nt=q.data,ct=nt.length,K=e.Util._hexToRgb(this.colorKey),$=0;$<ct;$+=4)pt=nt[$+3],pt>T?(nt[$]=K.r,nt[$+1]=K.g,nt[$+2]=K.b,nt[$+3]=255):nt[$+3]=0;R.putImageData(q,0,0)}catch(Tt){e.Util.error("Unable to draw hit graph from cached scene canvas. "+Tt.message)}return this}hasPointerCapture(T){return l.hasPointerCapture(T,this)}setPointerCapture(T){l.setPointerCapture(T,this)}releaseCapture(T){l.releaseCapture(T,this)}}r.Shape=C,C.prototype._fillFunc=v,C.prototype._strokeFunc=b,C.prototype._fillFuncHit=_,C.prototype._strokeFuncHit=S,C.prototype._centroid=!1,C.prototype.nodeType="Shape",(0,a._registerNode)(C),C.prototype.eventListeners={},C.prototype.on.call(C.prototype,"shadowColorChange.konva shadowBlurChange.konva shadowOffsetChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",u),C.prototype.on.call(C.prototype,"shadowColorChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",m),C.prototype.on.call(C.prototype,"fillPriorityChange.konva fillPatternImageChange.konva fillPatternRepeatChange.konva fillPatternScaleXChange.konva fillPatternScaleYChange.konva fillPatternOffsetXChange.konva fillPatternOffsetYChange.konva fillPatternXChange.konva fillPatternYChange.konva fillPatternRotationChange.konva",y),C.prototype.on.call(C.prototype,"fillPriorityChange.konva fillLinearGradientColorStopsChange.konva fillLinearGradientStartPointXChange.konva fillLinearGradientStartPointYChange.konva fillLinearGradientEndPointXChange.konva fillLinearGradientEndPointYChange.konva",w),C.prototype.on.call(C.prototype,"fillPriorityChange.konva fillRadialGradientColorStopsChange.konva fillRadialGradientStartPointXChange.konva fillRadialGradientStartPointYChange.konva fillRadialGradientEndPointXChange.konva fillRadialGradientEndPointYChange.konva fillRadialGradientStartRadiusChange.konva fillRadialGradientEndRadiusChange.konva",k),i.Factory.addGetterSetter(C,"stroke",void 0,(0,s.getStringOrGradientValidator)()),i.Factory.addGetterSetter(C,"strokeWidth",2,(0,s.getNumberValidator)()),i.Factory.addGetterSetter(C,"fillAfterStrokeEnabled",!1),i.Factory.addGetterSetter(C,"hitStrokeWidth","auto",(0,s.getNumberOrAutoValidator)()),i.Factory.addGetterSetter(C,"strokeHitEnabled",!0,(0,s.getBooleanValidator)()),i.Factory.addGetterSetter(C,"perfectDrawEnabled",!0,(0,s.getBooleanValidator)()),i.Factory.addGetterSetter(C,"shadowForStrokeEnabled",!0,(0,s.getBooleanValidator)()),i.Factory.addGetterSetter(C,"lineJoin"),i.Factory.addGetterSetter(C,"lineCap"),i.Factory.addGetterSetter(C,"sceneFunc"),i.Factory.addGetterSetter(C,"hitFunc"),i.Factory.addGetterSetter(C,"dash"),i.Factory.addGetterSetter(C,"dashOffset",0,(0,s.getNumberValidator)()),i.Factory.addGetterSetter(C,"shadowColor",void 0,(0,s.getStringValidator)()),i.Factory.addGetterSetter(C,"shadowBlur",0,(0,s.getNumberValidator)()),i.Factory.addGetterSetter(C,"shadowOpacity",1,(0,s.getNumberValidator)()),i.Factory.addComponentsGetterSetter(C,"shadowOffset",["x","y"]),i.Factory.addGetterSetter(C,"shadowOffsetX",0,(0,s.getNumberValidator)()),i.Factory.addGetterSetter(C,"shadowOffsetY",0,(0,s.getNumberValidator)()),i.Factory.addGetterSetter(C,"fillPatternImage"),i.Factory.addGetterSetter(C,"fill",void 0,(0,s.getStringOrGradientValidator)()),i.Factory.addGetterSetter(C,"fillPatternX",0,(0,s.getNumberValidator)()),i.Factory.addGetterSetter(C,"fillPatternY",0,(0,s.getNumberValidator)()),i.Factory.addGetterSetter(C,"fillLinearGradientColorStops"),i.Factory.addGetterSetter(C,"strokeLinearGradientColorStops"),i.Factory.addGetterSetter(C,"fillRadialGradientStartRadius",0),i.Factory.addGetterSetter(C,"fillRadialGradientEndRadius",0),i.Factory.addGetterSetter(C,"fillRadialGradientColorStops"),i.Factory.addGetterSetter(C,"fillPatternRepeat","repeat"),i.Factory.addGetterSetter(C,"fillEnabled",!0),i.Factory.addGetterSetter(C,"strokeEnabled",!0),i.Factory.addGetterSetter(C,"shadowEnabled",!0),i.Factory.addGetterSetter(C,"dashEnabled",!0),i.Factory.addGetterSetter(C,"strokeScaleEnabled",!0),i.Factory.addGetterSetter(C,"fillPriority","color"),i.Factory.addComponentsGetterSetter(C,"fillPatternOffset",["x","y"]),i.Factory.addGetterSetter(C,"fillPatternOffsetX",0,(0,s.getNumberValidator)()),i.Factory.addGetterSetter(C,"fillPatternOffsetY",0,(0,s.getNumberValidator)()),i.Factory.addComponentsGetterSetter(C,"fillPatternScale",["x","y"]),i.Factory.addGetterSetter(C,"fillPatternScaleX",1,(0,s.getNumberValidator)()),i.Factory.addGetterSetter(C,"fillPatternScaleY",1,(0,s.getNumberValidator)()),i.Factory.addComponentsGetterSetter(C,"fillLinearGradientStartPoint",["x","y"]),i.Factory.addComponentsGetterSetter(C,"strokeLinearGradientStartPoint",["x","y"]),i.Factory.addGetterSetter(C,"fillLinearGradientStartPointX",0),i.Factory.addGetterSetter(C,"strokeLinearGradientStartPointX",0),i.Factory.addGetterSetter(C,"fillLinearGradientStartPointY",0),i.Factory.addGetterSetter(C,"strokeLinearGradientStartPointY",0),i.Factory.addComponentsGetterSetter(C,"fillLinearGradientEndPoint",["x","y"]),i.Factory.addComponentsGetterSetter(C,"strokeLinearGradientEndPoint",["x","y"]),i.Factory.addGetterSetter(C,"fillLinearGradientEndPointX",0),i.Factory.addGetterSetter(C,"strokeLinearGradientEndPointX",0),i.Factory.addGetterSetter(C,"fillLinearGradientEndPointY",0),i.Factory.addGetterSetter(C,"strokeLinearGradientEndPointY",0),i.Factory.addComponentsGetterSetter(C,"fillRadialGradientStartPoint",["x","y"]),i.Factory.addGetterSetter(C,"fillRadialGradientStartPointX",0),i.Factory.addGetterSetter(C,"fillRadialGradientStartPointY",0),i.Factory.addComponentsGetterSetter(C,"fillRadialGradientEndPoint",["x","y"]),i.Factory.addGetterSetter(C,"fillRadialGradientEndPointX",0),i.Factory.addGetterSetter(C,"fillRadialGradientEndPointY",0),i.Factory.addGetterSetter(C,"fillPatternRotation",0),i.Factory.addGetterSetter(C,"fillRule",void 0,(0,s.getStringValidator)()),i.Factory.backCompat(C,{dashArray:"dash",getDashArray:"getDash",setDashArray:"getDash",drawFunc:"sceneFunc",getDrawFunc:"getSceneFunc",setDrawFunc:"setSceneFunc",drawHitFunc:"hitFunc",getDrawHitFunc:"getHitFunc",setDrawHitFunc:"setHitFunc"})})(jt);Object.defineProperty(On,"__esModule",{value:!0});On.Layer=void 0;const Ie=It,Ds=Ri,Vi=Ft,Ga=st,Co=Ce,wf=H,Cf=jt,Af=ot;var kf="#",Tf="beforeDraw",Pf="draw",_c=[{x:0,y:0},{x:-1,y:-1},{x:1,y:-1},{x:1,y:1},{x:-1,y:1}],Ef=_c.length;let hn=class extends Ds.Container{constructor(t){super(t),this.canvas=new Co.SceneCanvas,this.hitCanvas=new Co.HitCanvas({pixelRatio:1}),this._waitingForDraw=!1,this.on("visibleChange.konva",this._checkVisibility),this._checkVisibility(),this.on("imageSmoothingEnabledChange.konva",this._setSmoothEnabled),this._setSmoothEnabled()}createPNGStream(){return this.canvas._canvas.createPNGStream()}getCanvas(){return this.canvas}getNativeCanvasElement(){return this.canvas._canvas}getHitCanvas(){return this.hitCanvas}getContext(){return this.getCanvas().getContext()}clear(t){return this.getContext().clear(t),this.getHitCanvas().getContext().clear(t),this}setZIndex(t){super.setZIndex(t);var e=this.getStage();return e&&e.content&&(e.content.removeChild(this.getNativeCanvasElement()),t<e.children.length-1?e.content.insertBefore(this.getNativeCanvasElement(),e.children[t+1].getCanvas()._canvas):e.content.appendChild(this.getNativeCanvasElement())),this}moveToTop(){Vi.Node.prototype.moveToTop.call(this);var t=this.getStage();return t&&t.content&&(t.content.removeChild(this.getNativeCanvasElement()),t.content.appendChild(this.getNativeCanvasElement())),!0}moveUp(){var t=Vi.Node.prototype.moveUp.call(this);if(!t)return!1;var e=this.getStage();return!e||!e.content?!1:(e.content.removeChild(this.getNativeCanvasElement()),this.index<e.children.length-1?e.content.insertBefore(this.getNativeCanvasElement(),e.children[this.index+1].getCanvas()._canvas):e.content.appendChild(this.getNativeCanvasElement()),!0)}moveDown(){if(Vi.Node.prototype.moveDown.call(this)){var t=this.getStage();if(t){var e=t.children;t.content&&(t.content.removeChild(this.getNativeCanvasElement()),t.content.insertBefore(this.getNativeCanvasElement(),e[this.index+1].getCanvas()._canvas))}return!0}return!1}moveToBottom(){if(Vi.Node.prototype.moveToBottom.call(this)){var t=this.getStage();if(t){var e=t.children;t.content&&(t.content.removeChild(this.getNativeCanvasElement()),t.content.insertBefore(this.getNativeCanvasElement(),e[1].getCanvas()._canvas))}return!0}return!1}getLayer(){return this}remove(){var t=this.getNativeCanvasElement();return Vi.Node.prototype.remove.call(this),t&&t.parentNode&&Ie.Util._isInDocument(t)&&t.parentNode.removeChild(t),this}getStage(){return this.parent}setSize({width:t,height:e}){return this.canvas.setSize(t,e),this.hitCanvas.setSize(t,e),this._setSmoothEnabled(),this}_validateAdd(t){var e=t.getType();e!=="Group"&&e!=="Shape"&&Ie.Util.throw("You may only add groups and shapes to a layer.")}_toKonvaCanvas(t){return t=t||{},t.width=t.width||this.getWidth(),t.height=t.height||this.getHeight(),t.x=t.x!==void 0?t.x:this.x(),t.y=t.y!==void 0?t.y:this.y(),Vi.Node.prototype._toKonvaCanvas.call(this,t)}_checkVisibility(){this.visible()?this.canvas._canvas.style.display="block":this.canvas._canvas.style.display="none"}_setSmoothEnabled(){this.getContext()._context.imageSmoothingEnabled=this.imageSmoothingEnabled()}getWidth(){if(this.parent)return this.parent.width()}setWidth(){Ie.Util.warn('Can not change width of layer. Use "stage.width(value)" function instead.')}getHeight(){if(this.parent)return this.parent.height()}setHeight(){Ie.Util.warn('Can not change height of layer. Use "stage.height(value)" function instead.')}batchDraw(){return this._waitingForDraw||(this._waitingForDraw=!0,Ie.Util.requestAnimFrame(()=>{this.draw(),this._waitingForDraw=!1})),this}getIntersection(t){if(!this.isListening()||!this.isVisible())return null;for(var e=1,i=!1;;){for(let n=0;n<Ef;n++){const s=_c[n],a=this._getIntersection({x:t.x+s.x*e,y:t.y+s.y*e}),l=a.shape;if(l)return l;if(i=!!a.antialiased,!a.antialiased)break}if(i)e+=1;else return null}}_getIntersection(t){const e=this.hitCanvas.pixelRatio,i=this.hitCanvas.context.getImageData(Math.round(t.x*e),Math.round(t.y*e),1,1).data,n=i[3];if(n===255){const s=Ie.Util._rgbToHex(i[0],i[1],i[2]),a=Cf.shapes[kf+s];return a?{shape:a}:{antialiased:!0}}else if(n>0)return{antialiased:!0};return{}}drawScene(t,e){var i=this.getLayer(),n=t||i&&i.getCanvas();return this._fire(Tf,{node:this}),this.clearBeforeDraw()&&n.getContext().clear(),Ds.Container.prototype.drawScene.call(this,n,e),this._fire(Pf,{node:this}),this}drawHit(t,e){var i=this.getLayer(),n=t||i&&i.hitCanvas;return i&&i.clearBeforeDraw()&&i.getHitCanvas().getContext().clear(),Ds.Container.prototype.drawHit.call(this,n,e),this}enableHitGraph(){return this.hitGraphEnabled(!0),this}disableHitGraph(){return this.hitGraphEnabled(!1),this}setHitGraphEnabled(t){Ie.Util.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening(t)}getHitGraphEnabled(t){return Ie.Util.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening()}toggleHitCanvas(){if(!(!this.parent||!this.parent.content)){var t=this.parent,e=!!this.hitCanvas._canvas.parentNode;e?t.content.removeChild(this.hitCanvas._canvas):t.content.appendChild(this.hitCanvas._canvas)}}destroy(){return Ie.Util.releaseCanvas(this.getNativeCanvasElement(),this.getHitCanvas()._canvas),super.destroy()}};On.Layer=hn;hn.prototype.nodeType="Layer";(0,Af._registerNode)(hn);Ga.Factory.addGetterSetter(hn,"imageSmoothingEnabled",!0);Ga.Factory.addGetterSetter(hn,"clearBeforeDraw",!0);Ga.Factory.addGetterSetter(hn,"hitGraphEnabled",!0,(0,wf.getBooleanValidator)());var Hr={};Object.defineProperty(Hr,"__esModule",{value:!0});Hr.FastLayer=void 0;const xf=It,Mf=On,Ff=ot;class Oa extends Mf.Layer{constructor(t){super(t),this.listening(!1),xf.Util.warn('Konva.Fast layer is deprecated. Please use "new Konva.Layer({ listening: false })" instead.')}}Hr.FastLayer=Oa;Oa.prototype.nodeType="FastLayer";(0,Ff._registerNode)(Oa);var un={};Object.defineProperty(un,"__esModule",{value:!0});un.Group=void 0;const Rf=It,Nf=Ri,Lf=ot;class Ba extends Nf.Container{_validateAdd(t){var e=t.getType();e!=="Group"&&e!=="Shape"&&Rf.Util.throw("You may only add groups and shapes to groups.")}}un.Group=Ba;Ba.prototype.nodeType="Group";(0,Lf._registerNode)(Ba);var fn={};Object.defineProperty(fn,"__esModule",{value:!0});fn.Animation=void 0;const Gs=ot,Ao=It,Os=function(){return Gs.glob.performance&&Gs.glob.performance.now?function(){return Gs.glob.performance.now()}:function(){return new Date().getTime()}}();class Ee{constructor(t,e){this.id=Ee.animIdCounter++,this.frame={time:0,timeDiff:0,lastTime:Os(),frameRate:0},this.func=t,this.setLayers(e)}setLayers(t){let e=[];return t&&(e=Array.isArray(t)?t:[t]),this.layers=e,this}getLayers(){return this.layers}addLayer(t){const e=this.layers,i=e.length;for(let n=0;n<i;n++)if(e[n]._id===t._id)return!1;return this.layers.push(t),!0}isRunning(){const e=Ee.animations,i=e.length;for(let n=0;n<i;n++)if(e[n].id===this.id)return!0;return!1}start(){return this.stop(),this.frame.timeDiff=0,this.frame.lastTime=Os(),Ee._addAnimation(this),this}stop(){return Ee._removeAnimation(this),this}_updateFrameObject(t){this.frame.timeDiff=t-this.frame.lastTime,this.frame.lastTime=t,this.frame.time+=this.frame.timeDiff,this.frame.frameRate=1e3/this.frame.timeDiff}static _addAnimation(t){this.animations.push(t),this._handleAnimation()}static _removeAnimation(t){const e=t.id,i=this.animations,n=i.length;for(let s=0;s<n;s++)if(i[s].id===e){this.animations.splice(s,1);break}}static _runFrames(){const t={},e=this.animations;for(let i=0;i<e.length;i++){const n=e[i],s=n.layers,a=n.func;n._updateFrameObject(Os());const l=s.length;let o;if(a?o=a.call(n,n.frame)!==!1:o=!0,!!o)for(let c=0;c<l;c++){const h=s[c];h._id!==void 0&&(t[h._id]=h)}}for(let i in t)t.hasOwnProperty(i)&&t[i].batchDraw()}static _animationLoop(){const t=Ee;t.animations.length?(t._runFrames(),Ao.Util.requestAnimFrame(t._animationLoop)):t.animRunning=!1}static _handleAnimation(){this.animRunning||(this.animRunning=!0,Ao.Util.requestAnimFrame(this._animationLoop))}}fn.Animation=Ee;Ee.animations=[];Ee.animIdCounter=0;Ee.animRunning=!1;var vc={};(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.Easings=r.Tween=void 0;const t=It,e=fn,i=Ft,n=ot;var s={node:1,duration:1,easing:1,onFinish:1,yoyo:1},a=1,l=2,o=3,c=0,h=["fill","stroke","shadowColor"];class f{constructor(p,v,b,_,S,u,m){this.prop=p,this.propFunc=v,this.begin=_,this._pos=_,this.duration=u,this._change=0,this.prevPos=0,this.yoyo=m,this._time=0,this._position=0,this._startTime=0,this._finish=0,this.func=b,this._change=S-this.begin,this.pause()}fire(p){var v=this[p];v&&v()}setTime(p){p>this.duration?this.yoyo?(this._time=this.duration,this.reverse()):this.finish():p<0?this.yoyo?(this._time=0,this.play()):this.reset():(this._time=p,this.update())}getTime(){return this._time}setPosition(p){this.prevPos=this._pos,this.propFunc(p),this._pos=p}getPosition(p){return p===void 0&&(p=this._time),this.func(p,this.begin,this._change,this.duration)}play(){this.state=l,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onPlay")}reverse(){this.state=o,this._time=this.duration-this._time,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onReverse")}seek(p){this.pause(),this._time=p,this.update(),this.fire("onSeek")}reset(){this.pause(),this._time=0,this.update(),this.fire("onReset")}finish(){this.pause(),this._time=this.duration,this.update(),this.fire("onFinish")}update(){this.setPosition(this.getPosition(this._time)),this.fire("onUpdate")}onEnterFrame(){var p=this.getTimer()-this._startTime;this.state===l?this.setTime(p):this.state===o&&this.setTime(this.duration-p)}pause(){this.state=a,this.fire("onPause")}getTimer(){return new Date().getTime()}}class d{constructor(p){var v=this,b=p.node,_=b._id,S,u=p.easing||r.Easings.Linear,m=!!p.yoyo,y;typeof p.duration>"u"?S=.3:p.duration===0?S=.001:S=p.duration,this.node=b,this._id=c++;var w=b.getLayer()||(b instanceof n.Konva.Stage?b.getLayers():null);w||t.Util.error("Tween constructor have `node` that is not in a layer. Please add node into layer first."),this.anim=new e.Animation(function(){v.tween.onEnterFrame()},w),this.tween=new f(y,function(k){v._tweenFunc(k)},u,0,1,S*1e3,m),this._addListeners(),d.attrs[_]||(d.attrs[_]={}),d.attrs[_][this._id]||(d.attrs[_][this._id]={}),d.tweens[_]||(d.tweens[_]={});for(y in p)s[y]===void 0&&this._addAttr(y,p[y]);this.reset(),this.onFinish=p.onFinish,this.onReset=p.onReset,this.onUpdate=p.onUpdate}_addAttr(p,v){var b=this.node,_=b._id,S,u,m,y,w,k,C,A;if(m=d.tweens[_][p],m&&delete d.attrs[_][m][p],S=b.getAttr(p),t.Util._isArray(v))if(u=[],w=Math.max(v.length,S.length),p==="points"&&v.length!==S.length&&(v.length>S.length?(C=S,S=t.Util._prepareArrayForTween(S,v,b.closed())):(k=v,v=t.Util._prepareArrayForTween(v,S,b.closed()))),p.indexOf("fill")===0)for(y=0;y<w;y++)if(y%2===0)u.push(v[y]-S[y]);else{var T=t.Util.colorToRGBA(S[y]);A=t.Util.colorToRGBA(v[y]),S[y]=T,u.push({r:A.r-T.r,g:A.g-T.g,b:A.b-T.b,a:A.a-T.a})}else for(y=0;y<w;y++)u.push(v[y]-S[y]);else h.indexOf(p)!==-1?(S=t.Util.colorToRGBA(S),A=t.Util.colorToRGBA(v),u={r:A.r-S.r,g:A.g-S.g,b:A.b-S.b,a:A.a-S.a}):u=v-S;d.attrs[_][this._id][p]={start:S,diff:u,end:v,trueEnd:k,trueStart:C},d.tweens[_][p]=this._id}_tweenFunc(p){var v=this.node,b=d.attrs[v._id][this._id],_,S,u,m,y,w,k,C;for(_ in b){if(S=b[_],u=S.start,m=S.diff,C=S.end,t.Util._isArray(u))if(y=[],k=Math.max(u.length,C.length),_.indexOf("fill")===0)for(w=0;w<k;w++)w%2===0?y.push((u[w]||0)+m[w]*p):y.push("rgba("+Math.round(u[w].r+m[w].r*p)+","+Math.round(u[w].g+m[w].g*p)+","+Math.round(u[w].b+m[w].b*p)+","+(u[w].a+m[w].a*p)+")");else for(w=0;w<k;w++)y.push((u[w]||0)+m[w]*p);else h.indexOf(_)!==-1?y="rgba("+Math.round(u.r+m.r*p)+","+Math.round(u.g+m.g*p)+","+Math.round(u.b+m.b*p)+","+(u.a+m.a*p)+")":y=u+m*p;v.setAttr(_,y)}}_addListeners(){this.tween.onPlay=()=>{this.anim.start()},this.tween.onReverse=()=>{this.anim.start()},this.tween.onPause=()=>{this.anim.stop()},this.tween.onFinish=()=>{var p=this.node,v=d.attrs[p._id][this._id];v.points&&v.points.trueEnd&&p.setAttr("points",v.points.trueEnd),this.onFinish&&this.onFinish.call(this)},this.tween.onReset=()=>{var p=this.node,v=d.attrs[p._id][this._id];v.points&&v.points.trueStart&&p.points(v.points.trueStart),this.onReset&&this.onReset()},this.tween.onUpdate=()=>{this.onUpdate&&this.onUpdate.call(this)}}play(){return this.tween.play(),this}reverse(){return this.tween.reverse(),this}reset(){return this.tween.reset(),this}seek(p){return this.tween.seek(p*1e3),this}pause(){return this.tween.pause(),this}finish(){return this.tween.finish(),this}destroy(){var p=this.node._id,v=this._id,b=d.tweens[p],_;this.pause();for(_ in b)delete d.tweens[p][_];delete d.attrs[p][v]}}r.Tween=d,d.attrs={},d.tweens={},i.Node.prototype.to=function(g){var p=g.onFinish;g.node=this,g.onFinish=function(){this.destroy(),p&&p()};var v=new d(g);v.play()},r.Easings={BackEaseIn(g,p,v,b){var _=1.70158;return v*(g/=b)*g*((_+1)*g-_)+p},BackEaseOut(g,p,v,b){var _=1.70158;return v*((g=g/b-1)*g*((_+1)*g+_)+1)+p},BackEaseInOut(g,p,v,b){var _=1.70158;return(g/=b/2)<1?v/2*(g*g*(((_*=1.525)+1)*g-_))+p:v/2*((g-=2)*g*(((_*=1.525)+1)*g+_)+2)+p},ElasticEaseIn(g,p,v,b,_,S){var u=0;return g===0?p:(g/=b)===1?p+v:(S||(S=b*.3),!_||_<Math.abs(v)?(_=v,u=S/4):u=S/(2*Math.PI)*Math.asin(v/_),-(_*Math.pow(2,10*(g-=1))*Math.sin((g*b-u)*(2*Math.PI)/S))+p)},ElasticEaseOut(g,p,v,b,_,S){var u=0;return g===0?p:(g/=b)===1?p+v:(S||(S=b*.3),!_||_<Math.abs(v)?(_=v,u=S/4):u=S/(2*Math.PI)*Math.asin(v/_),_*Math.pow(2,-10*g)*Math.sin((g*b-u)*(2*Math.PI)/S)+v+p)},ElasticEaseInOut(g,p,v,b,_,S){var u=0;return g===0?p:(g/=b/2)===2?p+v:(S||(S=b*(.3*1.5)),!_||_<Math.abs(v)?(_=v,u=S/4):u=S/(2*Math.PI)*Math.asin(v/_),g<1?-.5*(_*Math.pow(2,10*(g-=1))*Math.sin((g*b-u)*(2*Math.PI)/S))+p:_*Math.pow(2,-10*(g-=1))*Math.sin((g*b-u)*(2*Math.PI)/S)*.5+v+p)},BounceEaseOut(g,p,v,b){return(g/=b)<1/2.75?v*(7.5625*g*g)+p:g<2/2.75?v*(7.5625*(g-=1.5/2.75)*g+.75)+p:g<2.5/2.75?v*(7.5625*(g-=2.25/2.75)*g+.9375)+p:v*(7.5625*(g-=2.625/2.75)*g+.984375)+p},BounceEaseIn(g,p,v,b){return v-r.Easings.BounceEaseOut(b-g,0,v,b)+p},BounceEaseInOut(g,p,v,b){return g<b/2?r.Easings.BounceEaseIn(g*2,0,v,b)*.5+p:r.Easings.BounceEaseOut(g*2-b,0,v,b)*.5+v*.5+p},EaseIn(g,p,v,b){return v*(g/=b)*g+p},EaseOut(g,p,v,b){return-v*(g/=b)*(g-2)+p},EaseInOut(g,p,v,b){return(g/=b/2)<1?v/2*g*g+p:-v/2*(--g*(g-2)-1)+p},StrongEaseIn(g,p,v,b){return v*(g/=b)*g*g*g*g+p},StrongEaseOut(g,p,v,b){return v*((g=g/b-1)*g*g*g*g+1)+p},StrongEaseInOut(g,p,v,b){return(g/=b/2)<1?v/2*g*g*g*g*g+p:v/2*((g-=2)*g*g*g*g+2)+p},Linear(g,p,v,b){return v*g/b+p}}})(vc);(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.Konva=void 0;const t=ot,e=It,i=Ft,n=Ri,s=gc,a=On,l=Hr,o=un,c=Vr,h=jt,f=fn,d=vc,g=je,p=Ce;r.Konva=e.Util._assign(t.Konva,{Util:e.Util,Transform:e.Transform,Node:i.Node,Container:n.Container,Stage:s.Stage,stages:s.stages,Layer:a.Layer,FastLayer:l.FastLayer,Group:o.Group,DD:c.DD,Shape:h.Shape,shapes:h.shapes,Animation:f.Animation,Tween:d.Tween,Easings:d.Easings,Context:g.Context,Canvas:p.Canvas}),r.default=r.Konva})(hc);var jr={};Object.defineProperty(jr,"__esModule",{value:!0});jr.Arc=void 0;const Wr=st,If=jt,ko=ot,Xr=H,Df=ot;class Qe extends If.Shape{_sceneFunc(t){var e=ko.Konva.getAngle(this.angle()),i=this.clockwise();t.beginPath(),t.arc(0,0,this.outerRadius(),0,e,i),t.arc(0,0,this.innerRadius(),e,0,!i),t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(t){this.outerRadius(t/2)}setHeight(t){this.outerRadius(t/2)}getSelfRect(){const t=this.innerRadius(),e=this.outerRadius(),i=this.clockwise(),n=ko.Konva.getAngle(i?360-this.angle():this.angle()),s=Math.cos(Math.min(n,Math.PI)),a=1,l=Math.sin(Math.min(Math.max(Math.PI,n),3*Math.PI/2)),o=Math.sin(Math.min(n,Math.PI/2)),c=s*(s>0?t:e),h=a*e,f=l*(l>0?t:e),d=o*(o>0?e:t);return{x:c,y:i?-1*d:f,width:h-c,height:d-f}}}jr.Arc=Qe;Qe.prototype._centroid=!0;Qe.prototype.className="Arc";Qe.prototype._attrsAffectingSize=["innerRadius","outerRadius"];(0,Df._registerNode)(Qe);Wr.Factory.addGetterSetter(Qe,"innerRadius",0,(0,Xr.getNumberValidator)());Wr.Factory.addGetterSetter(Qe,"outerRadius",0,(0,Xr.getNumberValidator)());Wr.Factory.addGetterSetter(Qe,"angle",0,(0,Xr.getNumberValidator)());Wr.Factory.addGetterSetter(Qe,"clockwise",!1,(0,Xr.getBooleanValidator)());var Yr={},Bn={};Object.defineProperty(Bn,"__esModule",{value:!0});Bn.Line=void 0;const Kr=st,Gf=jt,yc=H,Of=ot;function _a(r,t,e,i,n,s,a){var l=Math.sqrt(Math.pow(e-r,2)+Math.pow(i-t,2)),o=Math.sqrt(Math.pow(n-e,2)+Math.pow(s-i,2)),c=a*l/(l+o),h=a*o/(l+o),f=e-c*(n-r),d=i-c*(s-t),g=e+h*(n-r),p=i+h*(s-t);return[f,d,g,p]}function To(r,t){var e=r.length,i=[],n,s;for(n=2;n<e-2;n+=2)s=_a(r[n-2],r[n-1],r[n],r[n+1],r[n+2],r[n+3],t),!isNaN(s[0])&&(i.push(s[0]),i.push(s[1]),i.push(r[n]),i.push(r[n+1]),i.push(s[2]),i.push(s[3]));return i}class di extends Gf.Shape{constructor(t){super(t),this.on("pointsChange.konva tensionChange.konva closedChange.konva bezierChange.konva",function(){this._clearCache("tensionPoints")})}_sceneFunc(t){var e=this.points(),i=e.length,n=this.tension(),s=this.closed(),a=this.bezier(),l,o,c;if(i){if(t.beginPath(),t.moveTo(e[0],e[1]),n!==0&&i>4){for(l=this.getTensionPoints(),o=l.length,c=s?0:4,s||t.quadraticCurveTo(l[0],l[1],l[2],l[3]);c<o-2;)t.bezierCurveTo(l[c++],l[c++],l[c++],l[c++],l[c++],l[c++]);s||t.quadraticCurveTo(l[o-2],l[o-1],e[i-2],e[i-1])}else if(a)for(c=2;c<i;)t.bezierCurveTo(e[c++],e[c++],e[c++],e[c++],e[c++],e[c++]);else for(c=2;c<i;c+=2)t.lineTo(e[c],e[c+1]);s?(t.closePath(),t.fillStrokeShape(this)):t.strokeShape(this)}}getTensionPoints(){return this._getCache("tensionPoints",this._getTensionPoints)}_getTensionPoints(){return this.closed()?this._getTensionPointsClosed():To(this.points(),this.tension())}_getTensionPointsClosed(){var t=this.points(),e=t.length,i=this.tension(),n=_a(t[e-2],t[e-1],t[0],t[1],t[2],t[3],i),s=_a(t[e-4],t[e-3],t[e-2],t[e-1],t[0],t[1],i),a=To(t,i),l=[n[2],n[3]].concat(a).concat([s[0],s[1],t[e-2],t[e-1],s[2],s[3],n[0],n[1],t[0],t[1]]);return l}getWidth(){return this.getSelfRect().width}getHeight(){return this.getSelfRect().height}getSelfRect(){var t=this.points();if(t.length<4)return{x:t[0]||0,y:t[1]||0,width:0,height:0};this.tension()!==0?t=[t[0],t[1],...this._getTensionPoints(),t[t.length-2],t[t.length-1]]:t=this.points();for(var e=t[0],i=t[0],n=t[1],s=t[1],a,l,o=0;o<t.length/2;o++)a=t[o*2],l=t[o*2+1],e=Math.min(e,a),i=Math.max(i,a),n=Math.min(n,l),s=Math.max(s,l);return{x:e,y:n,width:i-e,height:s-n}}}Bn.Line=di;di.prototype.className="Line";di.prototype._attrsAffectingSize=["points","bezier","tension"];(0,Of._registerNode)(di);Kr.Factory.addGetterSetter(di,"closed",!1);Kr.Factory.addGetterSetter(di,"bezier",!1);Kr.Factory.addGetterSetter(di,"tension",0,(0,yc.getNumberValidator)());Kr.Factory.addGetterSetter(di,"points",[],(0,yc.getNumberArrayValidator)());var dn={},bc={};(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.t2length=r.getQuadraticArcLength=r.getCubicArcLength=r.binomialCoefficients=r.cValues=r.tValues=void 0,r.tValues=[[],[],[-.5773502691896257,.5773502691896257],[0,-.7745966692414834,.7745966692414834],[-.33998104358485626,.33998104358485626,-.8611363115940526,.8611363115940526],[0,-.5384693101056831,.5384693101056831,-.906179845938664,.906179845938664],[.6612093864662645,-.6612093864662645,-.2386191860831969,.2386191860831969,-.932469514203152,.932469514203152],[0,.4058451513773972,-.4058451513773972,-.7415311855993945,.7415311855993945,-.9491079123427585,.9491079123427585],[-.1834346424956498,.1834346424956498,-.525532409916329,.525532409916329,-.7966664774136267,.7966664774136267,-.9602898564975363,.9602898564975363],[0,-.8360311073266358,.8360311073266358,-.9681602395076261,.9681602395076261,-.3242534234038089,.3242534234038089,-.6133714327005904,.6133714327005904],[-.14887433898163122,.14887433898163122,-.4333953941292472,.4333953941292472,-.6794095682990244,.6794095682990244,-.8650633666889845,.8650633666889845,-.9739065285171717,.9739065285171717],[0,-.26954315595234496,.26954315595234496,-.5190961292068118,.5190961292068118,-.7301520055740494,.7301520055740494,-.8870625997680953,.8870625997680953,-.978228658146057,.978228658146057],[-.1252334085114689,.1252334085114689,-.3678314989981802,.3678314989981802,-.5873179542866175,.5873179542866175,-.7699026741943047,.7699026741943047,-.9041172563704749,.9041172563704749,-.9815606342467192,.9815606342467192],[0,-.2304583159551348,.2304583159551348,-.44849275103644687,.44849275103644687,-.6423493394403402,.6423493394403402,-.8015780907333099,.8015780907333099,-.9175983992229779,.9175983992229779,-.9841830547185881,.9841830547185881],[-.10805494870734367,.10805494870734367,-.31911236892788974,.31911236892788974,-.5152486363581541,.5152486363581541,-.6872929048116855,.6872929048116855,-.827201315069765,.827201315069765,-.9284348836635735,.9284348836635735,-.9862838086968123,.9862838086968123],[0,-.20119409399743451,.20119409399743451,-.3941513470775634,.3941513470775634,-.5709721726085388,.5709721726085388,-.7244177313601701,.7244177313601701,-.8482065834104272,.8482065834104272,-.937273392400706,.937273392400706,-.9879925180204854,.9879925180204854],[-.09501250983763744,.09501250983763744,-.2816035507792589,.2816035507792589,-.45801677765722737,.45801677765722737,-.6178762444026438,.6178762444026438,-.755404408355003,.755404408355003,-.8656312023878318,.8656312023878318,-.9445750230732326,.9445750230732326,-.9894009349916499,.9894009349916499],[0,-.17848418149584785,.17848418149584785,-.3512317634538763,.3512317634538763,-.5126905370864769,.5126905370864769,-.6576711592166907,.6576711592166907,-.7815140038968014,.7815140038968014,-.8802391537269859,.8802391537269859,-.9506755217687678,.9506755217687678,-.9905754753144174,.9905754753144174],[-.0847750130417353,.0847750130417353,-.2518862256915055,.2518862256915055,-.41175116146284263,.41175116146284263,-.5597708310739475,.5597708310739475,-.6916870430603532,.6916870430603532,-.8037049589725231,.8037049589725231,-.8926024664975557,.8926024664975557,-.9558239495713977,.9558239495713977,-.9915651684209309,.9915651684209309],[0,-.16035864564022537,.16035864564022537,-.31656409996362983,.31656409996362983,-.46457074137596094,.46457074137596094,-.600545304661681,.600545304661681,-.7209661773352294,.7209661773352294,-.8227146565371428,.8227146565371428,-.9031559036148179,.9031559036148179,-.96020815213483,.96020815213483,-.9924068438435844,.9924068438435844],[-.07652652113349734,.07652652113349734,-.22778585114164507,.22778585114164507,-.37370608871541955,.37370608871541955,-.5108670019508271,.5108670019508271,-.636053680726515,.636053680726515,-.7463319064601508,.7463319064601508,-.8391169718222188,.8391169718222188,-.912234428251326,.912234428251326,-.9639719272779138,.9639719272779138,-.9931285991850949,.9931285991850949],[0,-.1455618541608951,.1455618541608951,-.2880213168024011,.2880213168024011,-.4243421202074388,.4243421202074388,-.5516188358872198,.5516188358872198,-.6671388041974123,.6671388041974123,-.7684399634756779,.7684399634756779,-.8533633645833173,.8533633645833173,-.9200993341504008,.9200993341504008,-.9672268385663063,.9672268385663063,-.9937521706203895,.9937521706203895],[-.06973927331972223,.06973927331972223,-.20786042668822127,.20786042668822127,-.34193582089208424,.34193582089208424,-.469355837986757,.469355837986757,-.5876404035069116,.5876404035069116,-.6944872631866827,.6944872631866827,-.7878168059792081,.7878168059792081,-.8658125777203002,.8658125777203002,-.926956772187174,.926956772187174,-.9700604978354287,.9700604978354287,-.9942945854823992,.9942945854823992],[0,-.1332568242984661,.1332568242984661,-.26413568097034495,.26413568097034495,-.3903010380302908,.3903010380302908,-.5095014778460075,.5095014778460075,-.6196098757636461,.6196098757636461,-.7186613631319502,.7186613631319502,-.8048884016188399,.8048884016188399,-.8767523582704416,.8767523582704416,-.9329710868260161,.9329710868260161,-.9725424712181152,.9725424712181152,-.9947693349975522,.9947693349975522],[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213]],r.cValues=[[],[],[1,1],[.8888888888888888,.5555555555555556,.5555555555555556],[.6521451548625461,.6521451548625461,.34785484513745385,.34785484513745385],[.5688888888888889,.47862867049936647,.47862867049936647,.23692688505618908,.23692688505618908],[.3607615730481386,.3607615730481386,.46791393457269104,.46791393457269104,.17132449237917036,.17132449237917036],[.4179591836734694,.3818300505051189,.3818300505051189,.27970539148927664,.27970539148927664,.1294849661688697,.1294849661688697],[.362683783378362,.362683783378362,.31370664587788727,.31370664587788727,.22238103445337448,.22238103445337448,.10122853629037626,.10122853629037626],[.3302393550012598,.1806481606948574,.1806481606948574,.08127438836157441,.08127438836157441,.31234707704000286,.31234707704000286,.26061069640293544,.26061069640293544],[.29552422471475287,.29552422471475287,.26926671930999635,.26926671930999635,.21908636251598204,.21908636251598204,.1494513491505806,.1494513491505806,.06667134430868814,.06667134430868814],[.2729250867779006,.26280454451024665,.26280454451024665,.23319376459199048,.23319376459199048,.18629021092773426,.18629021092773426,.1255803694649046,.1255803694649046,.05566856711617366,.05566856711617366],[.24914704581340277,.24914704581340277,.2334925365383548,.2334925365383548,.20316742672306592,.20316742672306592,.16007832854334622,.16007832854334622,.10693932599531843,.10693932599531843,.04717533638651183,.04717533638651183],[.2325515532308739,.22628318026289723,.22628318026289723,.2078160475368885,.2078160475368885,.17814598076194574,.17814598076194574,.13887351021978725,.13887351021978725,.09212149983772845,.09212149983772845,.04048400476531588,.04048400476531588],[.2152638534631578,.2152638534631578,.2051984637212956,.2051984637212956,.18553839747793782,.18553839747793782,.15720316715819355,.15720316715819355,.12151857068790319,.12151857068790319,.08015808715976021,.08015808715976021,.03511946033175186,.03511946033175186],[.2025782419255613,.19843148532711158,.19843148532711158,.1861610000155622,.1861610000155622,.16626920581699392,.16626920581699392,.13957067792615432,.13957067792615432,.10715922046717194,.10715922046717194,.07036604748810812,.07036604748810812,.03075324199611727,.03075324199611727],[.1894506104550685,.1894506104550685,.18260341504492358,.18260341504492358,.16915651939500254,.16915651939500254,.14959598881657674,.14959598881657674,.12462897125553388,.12462897125553388,.09515851168249279,.09515851168249279,.062253523938647894,.062253523938647894,.027152459411754096,.027152459411754096],[.17944647035620653,.17656270536699264,.17656270536699264,.16800410215645004,.16800410215645004,.15404576107681028,.15404576107681028,.13513636846852548,.13513636846852548,.11188384719340397,.11188384719340397,.08503614831717918,.08503614831717918,.0554595293739872,.0554595293739872,.02414830286854793,.02414830286854793],[.1691423829631436,.1691423829631436,.16427648374583273,.16427648374583273,.15468467512626524,.15468467512626524,.14064291467065065,.14064291467065065,.12255520671147846,.12255520671147846,.10094204410628717,.10094204410628717,.07642573025488905,.07642573025488905,.0497145488949698,.0497145488949698,.02161601352648331,.02161601352648331],[.1610544498487837,.15896884339395434,.15896884339395434,.15276604206585967,.15276604206585967,.1426067021736066,.1426067021736066,.12875396253933621,.12875396253933621,.11156664554733399,.11156664554733399,.09149002162245,.09149002162245,.06904454273764123,.06904454273764123,.0448142267656996,.0448142267656996,.019461788229726478,.019461788229726478],[.15275338713072584,.15275338713072584,.14917298647260374,.14917298647260374,.14209610931838204,.14209610931838204,.13168863844917664,.13168863844917664,.11819453196151841,.11819453196151841,.10193011981724044,.10193011981724044,.08327674157670475,.08327674157670475,.06267204833410907,.06267204833410907,.04060142980038694,.04060142980038694,.017614007139152118,.017614007139152118],[.14608113364969041,.14452440398997005,.14452440398997005,.13988739479107315,.13988739479107315,.13226893863333747,.13226893863333747,.12183141605372853,.12183141605372853,.10879729916714838,.10879729916714838,.09344442345603386,.09344442345603386,.0761001136283793,.0761001136283793,.057134425426857205,.057134425426857205,.036953789770852494,.036953789770852494,.016017228257774335,.016017228257774335],[.13925187285563198,.13925187285563198,.13654149834601517,.13654149834601517,.13117350478706238,.13117350478706238,.12325237681051242,.12325237681051242,.11293229608053922,.11293229608053922,.10041414444288096,.10041414444288096,.08594160621706773,.08594160621706773,.06979646842452049,.06979646842452049,.052293335152683286,.052293335152683286,.03377490158481415,.03377490158481415,.0146279952982722,.0146279952982722],[.13365457218610619,.1324620394046966,.1324620394046966,.12890572218808216,.12890572218808216,.12304908430672953,.12304908430672953,.11499664022241136,.11499664022241136,.10489209146454141,.10489209146454141,.09291576606003515,.09291576606003515,.07928141177671895,.07928141177671895,.06423242140852585,.06423242140852585,.04803767173108467,.04803767173108467,.030988005856979445,.030988005856979445,.013411859487141771,.013411859487141771],[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872]],r.binomialCoefficients=[[1],[1,1],[1,2,1],[1,3,3,1]];const t=(a,l,o)=>{let c,h,f;c=o/2,h=0;for(let g=0;g<20;g++)f=c*r.tValues[20][g]+c,h+=r.cValues[20][g]*i(a,l,f);return c*h};r.getCubicArcLength=t;const e=(a,l,o)=>{o===void 0&&(o=1);const c=a[0]-2*a[1]+a[2],h=l[0]-2*l[1]+l[2],f=2*a[1]-2*a[0],d=2*l[1]-2*l[0],g=4*(c*c+h*h),p=4*(c*f+h*d),v=f*f+d*d;if(g===0)return o*Math.sqrt(Math.pow(a[2]-a[0],2)+Math.pow(l[2]-l[0],2));const b=p/(2*g),_=v/g,S=o+b,u=_-b*b,m=S*S+u>0?Math.sqrt(S*S+u):0,y=b*b+u>0?Math.sqrt(b*b+u):0,w=b+Math.sqrt(b*b+u)!==0?u*Math.log(Math.abs((S+m)/(b+y))):0;return Math.sqrt(g)/2*(S*m-b*y+w)};r.getQuadraticArcLength=e;function i(a,l,o){const c=n(1,o,a),h=n(1,o,l),f=c*c+h*h;return Math.sqrt(f)}const n=(a,l,o)=>{const c=o.length-1;let h,f;if(c===0)return 0;if(a===0){f=0;for(let d=0;d<=c;d++)f+=r.binomialCoefficients[c][d]*Math.pow(1-l,c-d)*Math.pow(l,d)*o[d];return f}else{h=new Array(c);for(let d=0;d<c;d++)h[d]=c*(o[d+1]-o[d]);return n(a-1,l,h)}},s=(a,l,o)=>{let c=1,h=a/l,f=(a-o(h))/l,d=0;for(;c>.001;){const g=o(h+f),p=Math.abs(a-g)/l;if(p<c)c=p,h+=f;else{const v=o(h-f),b=Math.abs(a-v)/l;b<c?(c=b,h-=f):f/=2}if(d++,d>500)break}return h};r.t2length=s})(bc);Object.defineProperty(dn,"__esModule",{value:!0});dn.Path=void 0;const Bf=st,Uf=jt,Vf=ot,zi=bc;class Ht extends Uf.Shape{constructor(t){super(t),this.dataArray=[],this.pathLength=0,this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute()})}_readDataAttribute(){this.dataArray=Ht.parsePathData(this.data()),this.pathLength=Ht.getPathLength(this.dataArray)}_sceneFunc(t){var e=this.dataArray;t.beginPath();for(var i=!1,n=0;n<e.length;n++){var s=e[n].command,a=e[n].points;switch(s){case"L":t.lineTo(a[0],a[1]);break;case"M":t.moveTo(a[0],a[1]);break;case"C":t.bezierCurveTo(a[0],a[1],a[2],a[3],a[4],a[5]);break;case"Q":t.quadraticCurveTo(a[0],a[1],a[2],a[3]);break;case"A":var l=a[0],o=a[1],c=a[2],h=a[3],f=a[4],d=a[5],g=a[6],p=a[7],v=c>h?c:h,b=c>h?1:c/h,_=c>h?h/c:1;t.translate(l,o),t.rotate(g),t.scale(b,_),t.arc(0,0,v,f,f+d,1-p),t.scale(1/b,1/_),t.rotate(-g),t.translate(-l,-o);break;case"z":i=!0,t.closePath();break}}!i&&!this.hasFill()?t.strokeShape(this):t.fillStrokeShape(this)}getSelfRect(){var t=[];this.dataArray.forEach(function(c){if(c.command==="A"){var h=c.points[4],f=c.points[5],d=c.points[4]+f,g=Math.PI/180;if(Math.abs(h-d)<g&&(g=Math.abs(h-d)),f<0)for(let p=h-g;p>d;p-=g){const v=Ht.getPointOnEllipticalArc(c.points[0],c.points[1],c.points[2],c.points[3],p,0);t.push(v.x,v.y)}else for(let p=h+g;p<d;p+=g){const v=Ht.getPointOnEllipticalArc(c.points[0],c.points[1],c.points[2],c.points[3],p,0);t.push(v.x,v.y)}}else if(c.command==="C")for(let p=0;p<=1;p+=.01){const v=Ht.getPointOnCubicBezier(p,c.start.x,c.start.y,c.points[0],c.points[1],c.points[2],c.points[3],c.points[4],c.points[5]);t.push(v.x,v.y)}else t=t.concat(c.points)});for(var e=t[0],i=t[0],n=t[1],s=t[1],a,l,o=0;o<t.length/2;o++)a=t[o*2],l=t[o*2+1],isNaN(a)||(e=Math.min(e,a),i=Math.max(i,a)),isNaN(l)||(n=Math.min(n,l),s=Math.max(s,l));return{x:e,y:n,width:i-e,height:s-n}}getLength(){return this.pathLength}getPointAtLength(t){return Ht.getPointAtLengthOfDataArray(t,this.dataArray)}static getLineLength(t,e,i,n){return Math.sqrt((i-t)*(i-t)+(n-e)*(n-e))}static getPathLength(t){let e=0;for(var i=0;i<t.length;++i)e+=t[i].pathLength;return e}static getPointAtLengthOfDataArray(t,e){var i,n=0,s=e.length;if(!s)return null;for(;n<s&&t>e[n].pathLength;)t-=e[n].pathLength,++n;if(n===s)return i=e[n-1].points.slice(-2),{x:i[0],y:i[1]};if(t<.01)return i=e[n].points.slice(0,2),{x:i[0],y:i[1]};var a=e[n],l=a.points;switch(a.command){case"L":return Ht.getPointOnLine(t,a.start.x,a.start.y,l[0],l[1]);case"C":return Ht.getPointOnCubicBezier((0,zi.t2length)(t,Ht.getPathLength(e),v=>(0,zi.getCubicArcLength)([a.start.x,l[0],l[2],l[4]],[a.start.y,l[1],l[3],l[5]],v)),a.start.x,a.start.y,l[0],l[1],l[2],l[3],l[4],l[5]);case"Q":return Ht.getPointOnQuadraticBezier((0,zi.t2length)(t,Ht.getPathLength(e),v=>(0,zi.getQuadraticArcLength)([a.start.x,l[0],l[2]],[a.start.y,l[1],l[3]],v)),a.start.x,a.start.y,l[0],l[1],l[2],l[3]);case"A":var o=l[0],c=l[1],h=l[2],f=l[3],d=l[4],g=l[5],p=l[6];return d+=g*t/a.pathLength,Ht.getPointOnEllipticalArc(o,c,h,f,d,p)}return null}static getPointOnLine(t,e,i,n,s,a,l){a===void 0&&(a=e),l===void 0&&(l=i);var o=(s-i)/(n-e+1e-8),c=Math.sqrt(t*t/(1+o*o));n<e&&(c*=-1);var h=o*c,f;if(n===e)f={x:a,y:l+h};else if((l-i)/(a-e+1e-8)===o)f={x:a+c,y:l+h};else{var d,g,p=this.getLineLength(e,i,n,s),v=(a-e)*(n-e)+(l-i)*(s-i);v=v/(p*p),d=e+v*(n-e),g=i+v*(s-i);var b=this.getLineLength(a,l,d,g),_=Math.sqrt(t*t-b*b);c=Math.sqrt(_*_/(1+o*o)),n<e&&(c*=-1),h=o*c,f={x:d+c,y:g+h}}return f}static getPointOnCubicBezier(t,e,i,n,s,a,l,o,c){function h(b){return b*b*b}function f(b){return 3*b*b*(1-b)}function d(b){return 3*b*(1-b)*(1-b)}function g(b){return(1-b)*(1-b)*(1-b)}var p=o*h(t)+a*f(t)+n*d(t)+e*g(t),v=c*h(t)+l*f(t)+s*d(t)+i*g(t);return{x:p,y:v}}static getPointOnQuadraticBezier(t,e,i,n,s,a,l){function o(g){return g*g}function c(g){return 2*g*(1-g)}function h(g){return(1-g)*(1-g)}var f=a*o(t)+n*c(t)+e*h(t),d=l*o(t)+s*c(t)+i*h(t);return{x:f,y:d}}static getPointOnEllipticalArc(t,e,i,n,s,a){var l=Math.cos(a),o=Math.sin(a),c={x:i*Math.cos(s),y:n*Math.sin(s)};return{x:t+(c.x*l-c.y*o),y:e+(c.x*o+c.y*l)}}static parsePathData(t){if(!t)return[];var e=t,i=["m","M","l","L","v","V","h","H","z","Z","c","C","q","Q","t","T","s","S","a","A"];e=e.replace(new RegExp(" ","g"),",");for(var n=0;n<i.length;n++)e=e.replace(new RegExp(i[n],"g"),"|"+i[n]);var s=e.split("|"),a=[],l=[],o=0,c=0,h=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:e[-+]?\d+)?)/gi,f;for(n=1;n<s.length;n++){var d=s[n],g=d.charAt(0);for(d=d.slice(1),l.length=0;f=h.exec(d);)l.push(f[0]);for(var p=[],v=0,b=l.length;v<b;v++){if(l[v]==="00"){p.push(0,0);continue}var _=parseFloat(l[v]);isNaN(_)?p.push(0):p.push(_)}for(;p.length>0&&!isNaN(p[0]);){var S="",u=[],m=o,y=c,w,k,C,A,T,P,E,M,R,N;switch(g){case"l":o+=p.shift(),c+=p.shift(),S="L",u.push(o,c);break;case"L":o=p.shift(),c=p.shift(),u.push(o,c);break;case"m":var B=p.shift(),q=p.shift();if(o+=B,c+=q,S="M",a.length>2&&a[a.length-1].command==="z"){for(var nt=a.length-2;nt>=0;nt--)if(a[nt].command==="M"){o=a[nt].points[0]+B,c=a[nt].points[1]+q;break}}u.push(o,c),g="l";break;case"M":o=p.shift(),c=p.shift(),S="M",u.push(o,c),g="L";break;case"h":o+=p.shift(),S="L",u.push(o,c);break;case"H":o=p.shift(),S="L",u.push(o,c);break;case"v":c+=p.shift(),S="L",u.push(o,c);break;case"V":c=p.shift(),S="L",u.push(o,c);break;case"C":u.push(p.shift(),p.shift(),p.shift(),p.shift()),o=p.shift(),c=p.shift(),u.push(o,c);break;case"c":u.push(o+p.shift(),c+p.shift(),o+p.shift(),c+p.shift()),o+=p.shift(),c+=p.shift(),S="C",u.push(o,c);break;case"S":k=o,C=c,w=a[a.length-1],w.command==="C"&&(k=o+(o-w.points[2]),C=c+(c-w.points[3])),u.push(k,C,p.shift(),p.shift()),o=p.shift(),c=p.shift(),S="C",u.push(o,c);break;case"s":k=o,C=c,w=a[a.length-1],w.command==="C"&&(k=o+(o-w.points[2]),C=c+(c-w.points[3])),u.push(k,C,o+p.shift(),c+p.shift()),o+=p.shift(),c+=p.shift(),S="C",u.push(o,c);break;case"Q":u.push(p.shift(),p.shift()),o=p.shift(),c=p.shift(),u.push(o,c);break;case"q":u.push(o+p.shift(),c+p.shift()),o+=p.shift(),c+=p.shift(),S="Q",u.push(o,c);break;case"T":k=o,C=c,w=a[a.length-1],w.command==="Q"&&(k=o+(o-w.points[0]),C=c+(c-w.points[1])),o=p.shift(),c=p.shift(),S="Q",u.push(k,C,o,c);break;case"t":k=o,C=c,w=a[a.length-1],w.command==="Q"&&(k=o+(o-w.points[0]),C=c+(c-w.points[1])),o+=p.shift(),c+=p.shift(),S="Q",u.push(k,C,o,c);break;case"A":A=p.shift(),T=p.shift(),P=p.shift(),E=p.shift(),M=p.shift(),R=o,N=c,o=p.shift(),c=p.shift(),S="A",u=this.convertEndpointToCenterParameterization(R,N,o,c,E,M,A,T,P);break;case"a":A=p.shift(),T=p.shift(),P=p.shift(),E=p.shift(),M=p.shift(),R=o,N=c,o+=p.shift(),c+=p.shift(),S="A",u=this.convertEndpointToCenterParameterization(R,N,o,c,E,M,A,T,P);break}a.push({command:S||g,points:u,start:{x:m,y},pathLength:this.calcLength(m,y,S||g,u)})}(g==="z"||g==="Z")&&a.push({command:"z",points:[],start:void 0,pathLength:0})}return a}static calcLength(t,e,i,n){var s,a,l,o,c=Ht;switch(i){case"L":return c.getLineLength(t,e,n[0],n[1]);case"C":return(0,zi.getCubicArcLength)([t,n[0],n[2],n[4]],[e,n[1],n[3],n[5]],1);case"Q":return(0,zi.getQuadraticArcLength)([t,n[0],n[2]],[e,n[1],n[3]],1);case"A":s=0;var h=n[4],f=n[5],d=n[4]+f,g=Math.PI/180;if(Math.abs(h-d)<g&&(g=Math.abs(h-d)),a=c.getPointOnEllipticalArc(n[0],n[1],n[2],n[3],h,0),f<0)for(o=h-g;o>d;o-=g)l=c.getPointOnEllipticalArc(n[0],n[1],n[2],n[3],o,0),s+=c.getLineLength(a.x,a.y,l.x,l.y),a=l;else for(o=h+g;o<d;o+=g)l=c.getPointOnEllipticalArc(n[0],n[1],n[2],n[3],o,0),s+=c.getLineLength(a.x,a.y,l.x,l.y),a=l;return l=c.getPointOnEllipticalArc(n[0],n[1],n[2],n[3],d,0),s+=c.getLineLength(a.x,a.y,l.x,l.y),s}return 0}static convertEndpointToCenterParameterization(t,e,i,n,s,a,l,o,c){var h=c*(Math.PI/180),f=Math.cos(h)*(t-i)/2+Math.sin(h)*(e-n)/2,d=-1*Math.sin(h)*(t-i)/2+Math.cos(h)*(e-n)/2,g=f*f/(l*l)+d*d/(o*o);g>1&&(l*=Math.sqrt(g),o*=Math.sqrt(g));var p=Math.sqrt((l*l*(o*o)-l*l*(d*d)-o*o*(f*f))/(l*l*(d*d)+o*o*(f*f)));s===a&&(p*=-1),isNaN(p)&&(p=0);var v=p*l*d/o,b=p*-o*f/l,_=(t+i)/2+Math.cos(h)*v-Math.sin(h)*b,S=(e+n)/2+Math.sin(h)*v+Math.cos(h)*b,u=function(T){return Math.sqrt(T[0]*T[0]+T[1]*T[1])},m=function(T,P){return(T[0]*P[0]+T[1]*P[1])/(u(T)*u(P))},y=function(T,P){return(T[0]*P[1]<T[1]*P[0]?-1:1)*Math.acos(m(T,P))},w=y([1,0],[(f-v)/l,(d-b)/o]),k=[(f-v)/l,(d-b)/o],C=[(-1*f-v)/l,(-1*d-b)/o],A=y(k,C);return m(k,C)<=-1&&(A=Math.PI),m(k,C)>=1&&(A=0),a===0&&A>0&&(A=A-2*Math.PI),a===1&&A<0&&(A=A+2*Math.PI),[_,S,l,o,w,A,h,a]}}dn.Path=Ht;Ht.prototype.className="Path";Ht.prototype._attrsAffectingSize=["data"];(0,Vf._registerNode)(Ht);Bf.Factory.addGetterSetter(Ht,"data");Object.defineProperty(Yr,"__esModule",{value:!0});Yr.Arrow=void 0;const $r=st,zf=Bn,Sc=H,Hf=ot,Po=dn;class Li extends zf.Line{_sceneFunc(t){super._sceneFunc(t);var e=Math.PI*2,i=this.points(),n=i,s=this.tension()!==0&&i.length>4;s&&(n=this.getTensionPoints());var a=this.pointerLength(),l=i.length,o,c;if(s){const d=[n[n.length-4],n[n.length-3],n[n.length-2],n[n.length-1],i[l-2],i[l-1]],g=Po.Path.calcLength(n[n.length-4],n[n.length-3],"C",d),p=Po.Path.getPointOnQuadraticBezier(Math.min(1,1-a/g),d[0],d[1],d[2],d[3],d[4],d[5]);o=i[l-2]-p.x,c=i[l-1]-p.y}else o=i[l-2]-i[l-4],c=i[l-1]-i[l-3];var h=(Math.atan2(c,o)+e)%e,f=this.pointerWidth();this.pointerAtEnding()&&(t.save(),t.beginPath(),t.translate(i[l-2],i[l-1]),t.rotate(h),t.moveTo(0,0),t.lineTo(-a,f/2),t.lineTo(-a,-f/2),t.closePath(),t.restore(),this.__fillStroke(t)),this.pointerAtBeginning()&&(t.save(),t.beginPath(),t.translate(i[0],i[1]),s?(o=(n[0]+n[2])/2-i[0],c=(n[1]+n[3])/2-i[1]):(o=i[2]-i[0],c=i[3]-i[1]),t.rotate((Math.atan2(-c,-o)+e)%e),t.moveTo(0,0),t.lineTo(-a,f/2),t.lineTo(-a,-f/2),t.closePath(),t.restore(),this.__fillStroke(t))}__fillStroke(t){var e=this.dashEnabled();e&&(this.attrs.dashEnabled=!1,t.setLineDash([])),t.fillStrokeShape(this),e&&(this.attrs.dashEnabled=!0)}getSelfRect(){const t=super.getSelfRect(),e=this.pointerWidth()/2;return{x:t.x-e,y:t.y-e,width:t.width+e*2,height:t.height+e*2}}}Yr.Arrow=Li;Li.prototype.className="Arrow";(0,Hf._registerNode)(Li);$r.Factory.addGetterSetter(Li,"pointerLength",10,(0,Sc.getNumberValidator)());$r.Factory.addGetterSetter(Li,"pointerWidth",10,(0,Sc.getNumberValidator)());$r.Factory.addGetterSetter(Li,"pointerAtBeginning",!1);$r.Factory.addGetterSetter(Li,"pointerAtEnding",!0);var qr={};Object.defineProperty(qr,"__esModule",{value:!0});qr.Circle=void 0;const jf=st,Wf=jt,Xf=H,Yf=ot;let gn=class extends Wf.Shape{_sceneFunc(t){t.beginPath(),t.arc(0,0,this.attrs.radius||0,0,Math.PI*2,!1),t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(t){this.radius()!==t/2&&this.radius(t/2)}setHeight(t){this.radius()!==t/2&&this.radius(t/2)}};qr.Circle=gn;gn.prototype._centroid=!0;gn.prototype.className="Circle";gn.prototype._attrsAffectingSize=["radius"];(0,Yf._registerNode)(gn);jf.Factory.addGetterSetter(gn,"radius",0,(0,Xf.getNumberValidator)());var Jr={};Object.defineProperty(Jr,"__esModule",{value:!0});Jr.Ellipse=void 0;const Ua=st,Kf=jt,wc=H,$f=ot;class gi extends Kf.Shape{_sceneFunc(t){var e=this.radiusX(),i=this.radiusY();t.beginPath(),t.save(),e!==i&&t.scale(1,i/e),t.arc(0,0,e,0,Math.PI*2,!1),t.restore(),t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.radiusX()*2}getHeight(){return this.radiusY()*2}setWidth(t){this.radiusX(t/2)}setHeight(t){this.radiusY(t/2)}}Jr.Ellipse=gi;gi.prototype.className="Ellipse";gi.prototype._centroid=!0;gi.prototype._attrsAffectingSize=["radiusX","radiusY"];(0,$f._registerNode)(gi);Ua.Factory.addComponentsGetterSetter(gi,"radius",["x","y"]);Ua.Factory.addGetterSetter(gi,"radiusX",0,(0,wc.getNumberValidator)());Ua.Factory.addGetterSetter(gi,"radiusY",0,(0,wc.getNumberValidator)());var Qr={};Object.defineProperty(Qr,"__esModule",{value:!0});Qr.Image=void 0;const Bs=It,Ii=st,qf=jt,Jf=ot,Un=H;let Fe=class Cc extends qf.Shape{constructor(t){super(t),this.on("imageChange.konva",()=>{this._setImageLoad()}),this._setImageLoad()}_setImageLoad(){const t=this.image();t&&t.complete||t&&t.readyState===4||t&&t.addEventListener&&t.addEventListener("load",()=>{this._requestDraw()})}_useBufferCanvas(){return super._useBufferCanvas(!0)}_sceneFunc(t){const e=this.getWidth(),i=this.getHeight(),n=this.cornerRadius(),s=this.attrs.image;let a;if(s){const l=this.attrs.cropWidth,o=this.attrs.cropHeight;l&&o?a=[s,this.cropX(),this.cropY(),l,o,0,0,e,i]:a=[s,0,0,e,i]}(this.hasFill()||this.hasStroke()||n)&&(t.beginPath(),n?Bs.Util.drawRoundedRectPath(t,e,i,n):t.rect(0,0,e,i),t.closePath(),t.fillStrokeShape(this)),s&&(n&&t.clip(),t.drawImage.apply(t,a))}_hitFunc(t){var e=this.width(),i=this.height(),n=this.cornerRadius();t.beginPath(),n?Bs.Util.drawRoundedRectPath(t,e,i,n):t.rect(0,0,e,i),t.closePath(),t.fillStrokeShape(this)}getWidth(){var t,e;return(t=this.attrs.width)!==null&&t!==void 0?t:(e=this.image())===null||e===void 0?void 0:e.width}getHeight(){var t,e;return(t=this.attrs.height)!==null&&t!==void 0?t:(e=this.image())===null||e===void 0?void 0:e.height}static fromURL(t,e,i=null){var n=Bs.Util.createImageElement();n.onload=function(){var s=new Cc({image:n});e(s)},n.onerror=i,n.crossOrigin="Anonymous",n.src=t}};Qr.Image=Fe;Fe.prototype.className="Image";(0,Jf._registerNode)(Fe);Ii.Factory.addGetterSetter(Fe,"cornerRadius",0,(0,Un.getNumberOrArrayOfNumbersValidator)(4));Ii.Factory.addGetterSetter(Fe,"image");Ii.Factory.addComponentsGetterSetter(Fe,"crop",["x","y","width","height"]);Ii.Factory.addGetterSetter(Fe,"cropX",0,(0,Un.getNumberValidator)());Ii.Factory.addGetterSetter(Fe,"cropY",0,(0,Un.getNumberValidator)());Ii.Factory.addGetterSetter(Fe,"cropWidth",0,(0,Un.getNumberValidator)());Ii.Factory.addGetterSetter(Fe,"cropHeight",0,(0,Un.getNumberValidator)());var nn={};Object.defineProperty(nn,"__esModule",{value:!0});nn.Tag=nn.Label=void 0;const Zr=st,Qf=jt,Zf=un,Va=H,Ac=ot;var kc=["fontFamily","fontSize","fontStyle","padding","lineHeight","text","width","height","pointerDirection","pointerWidth","pointerHeight"],t0="Change.konva",e0="none",va="up",ya="right",ba="down",Sa="left",i0=kc.length;class za extends Zf.Group{constructor(t){super(t),this.on("add.konva",function(e){this._addListeners(e.child),this._sync()})}getText(){return this.find("Text")[0]}getTag(){return this.find("Tag")[0]}_addListeners(t){var e=this,i,n=function(){e._sync()};for(i=0;i<i0;i++)t.on(kc[i]+t0,n)}getWidth(){return this.getText().width()}getHeight(){return this.getText().height()}_sync(){var t=this.getText(),e=this.getTag(),i,n,s,a,l,o,c;if(t&&e){switch(i=t.width(),n=t.height(),s=e.pointerDirection(),a=e.pointerWidth(),c=e.pointerHeight(),l=0,o=0,s){case va:l=i/2,o=-1*c;break;case ya:l=i+a,o=n/2;break;case ba:l=i/2,o=n+c;break;case Sa:l=-1*a,o=n/2;break}e.setAttrs({x:-1*l,y:-1*o,width:i,height:n}),t.setAttrs({x:-1*l,y:-1*o})}}}nn.Label=za;za.prototype.className="Label";(0,Ac._registerNode)(za);class Di extends Qf.Shape{_sceneFunc(t){var e=this.width(),i=this.height(),n=this.pointerDirection(),s=this.pointerWidth(),a=this.pointerHeight(),l=this.cornerRadius();let o=0,c=0,h=0,f=0;typeof l=="number"?o=c=h=f=Math.min(l,e/2,i/2):(o=Math.min(l[0]||0,e/2,i/2),c=Math.min(l[1]||0,e/2,i/2),f=Math.min(l[2]||0,e/2,i/2),h=Math.min(l[3]||0,e/2,i/2)),t.beginPath(),t.moveTo(o,0),n===va&&(t.lineTo((e-s)/2,0),t.lineTo(e/2,-1*a),t.lineTo((e+s)/2,0)),t.lineTo(e-c,0),t.arc(e-c,c,c,Math.PI*3/2,0,!1),n===ya&&(t.lineTo(e,(i-a)/2),t.lineTo(e+s,i/2),t.lineTo(e,(i+a)/2)),t.lineTo(e,i-f),t.arc(e-f,i-f,f,0,Math.PI/2,!1),n===ba&&(t.lineTo((e+s)/2,i),t.lineTo(e/2,i+a),t.lineTo((e-s)/2,i)),t.lineTo(h,i),t.arc(h,i-h,h,Math.PI/2,Math.PI,!1),n===Sa&&(t.lineTo(0,(i+a)/2),t.lineTo(-1*s,i/2),t.lineTo(0,(i-a)/2)),t.lineTo(0,o),t.arc(o,o,o,Math.PI,Math.PI*3/2,!1),t.closePath(),t.fillStrokeShape(this)}getSelfRect(){var t=0,e=0,i=this.pointerWidth(),n=this.pointerHeight(),s=this.pointerDirection(),a=this.width(),l=this.height();return s===va?(e-=n,l+=n):s===ba?l+=n:s===Sa?(t-=i*1.5,a+=i):s===ya&&(a+=i*1.5),{x:t,y:e,width:a,height:l}}}nn.Tag=Di;Di.prototype.className="Tag";(0,Ac._registerNode)(Di);Zr.Factory.addGetterSetter(Di,"pointerDirection",e0);Zr.Factory.addGetterSetter(Di,"pointerWidth",0,(0,Va.getNumberValidator)());Zr.Factory.addGetterSetter(Di,"pointerHeight",0,(0,Va.getNumberValidator)());Zr.Factory.addGetterSetter(Di,"cornerRadius",0,(0,Va.getNumberOrArrayOfNumbersValidator)(4));var Vn={};Object.defineProperty(Vn,"__esModule",{value:!0});Vn.Rect=void 0;const n0=st,r0=jt,s0=ot,a0=It,o0=H;let ts=class extends r0.Shape{_sceneFunc(t){var e=this.cornerRadius(),i=this.width(),n=this.height();t.beginPath(),e?a0.Util.drawRoundedRectPath(t,i,n,e):t.rect(0,0,i,n),t.closePath(),t.fillStrokeShape(this)}};Vn.Rect=ts;ts.prototype.className="Rect";(0,s0._registerNode)(ts);n0.Factory.addGetterSetter(ts,"cornerRadius",0,(0,o0.getNumberOrArrayOfNumbersValidator)(4));var es={};Object.defineProperty(es,"__esModule",{value:!0});es.RegularPolygon=void 0;const Tc=st,l0=jt,Pc=H,c0=ot;class Gi extends l0.Shape{_sceneFunc(t){const e=this._getPoints();t.beginPath(),t.moveTo(e[0].x,e[0].y);for(var i=1;i<e.length;i++)t.lineTo(e[i].x,e[i].y);t.closePath(),t.fillStrokeShape(this)}_getPoints(){const t=this.attrs.sides,e=this.attrs.radius||0,i=[];for(var n=0;n<t;n++)i.push({x:e*Math.sin(n*2*Math.PI/t),y:-1*e*Math.cos(n*2*Math.PI/t)});return i}getSelfRect(){const t=this._getPoints();var e=t[0].x,i=t[0].y,n=t[0].x,s=t[0].y;return t.forEach(a=>{e=Math.min(e,a.x),i=Math.max(i,a.x),n=Math.min(n,a.y),s=Math.max(s,a.y)}),{x:e,y:n,width:i-e,height:s-n}}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(t){this.radius(t/2)}setHeight(t){this.radius(t/2)}}es.RegularPolygon=Gi;Gi.prototype.className="RegularPolygon";Gi.prototype._centroid=!0;Gi.prototype._attrsAffectingSize=["radius"];(0,c0._registerNode)(Gi);Tc.Factory.addGetterSetter(Gi,"radius",0,(0,Pc.getNumberValidator)());Tc.Factory.addGetterSetter(Gi,"sides",0,(0,Pc.getNumberValidator)());var is={};Object.defineProperty(is,"__esModule",{value:!0});is.Ring=void 0;const Ec=st,h0=jt,xc=H,u0=ot;var Eo=Math.PI*2;class Oi extends h0.Shape{_sceneFunc(t){t.beginPath(),t.arc(0,0,this.innerRadius(),0,Eo,!1),t.moveTo(this.outerRadius(),0),t.arc(0,0,this.outerRadius(),Eo,0,!0),t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(t){this.outerRadius(t/2)}setHeight(t){this.outerRadius(t/2)}}is.Ring=Oi;Oi.prototype.className="Ring";Oi.prototype._centroid=!0;Oi.prototype._attrsAffectingSize=["innerRadius","outerRadius"];(0,u0._registerNode)(Oi);Ec.Factory.addGetterSetter(Oi,"innerRadius",0,(0,xc.getNumberValidator)());Ec.Factory.addGetterSetter(Oi,"outerRadius",0,(0,xc.getNumberValidator)());var ns={};Object.defineProperty(ns,"__esModule",{value:!0});ns.Sprite=void 0;const Bi=st,f0=jt,d0=fn,Mc=H,g0=ot;class Re extends f0.Shape{constructor(t){super(t),this._updated=!0,this.anim=new d0.Animation(()=>{var e=this._updated;return this._updated=!1,e}),this.on("animationChange.konva",function(){this.frameIndex(0)}),this.on("frameIndexChange.konva",function(){this._updated=!0}),this.on("frameRateChange.konva",function(){this.anim.isRunning()&&(clearInterval(this.interval),this._setInterval())})}_sceneFunc(t){var e=this.animation(),i=this.frameIndex(),n=i*4,s=this.animations()[e],a=this.frameOffsets(),l=s[n+0],o=s[n+1],c=s[n+2],h=s[n+3],f=this.image();if((this.hasFill()||this.hasStroke())&&(t.beginPath(),t.rect(0,0,c,h),t.closePath(),t.fillStrokeShape(this)),f)if(a){var d=a[e],g=i*2;t.drawImage(f,l,o,c,h,d[g+0],d[g+1],c,h)}else t.drawImage(f,l,o,c,h,0,0,c,h)}_hitFunc(t){var e=this.animation(),i=this.frameIndex(),n=i*4,s=this.animations()[e],a=this.frameOffsets(),l=s[n+2],o=s[n+3];if(t.beginPath(),a){var c=a[e],h=i*2;t.rect(c[h+0],c[h+1],l,o)}else t.rect(0,0,l,o);t.closePath(),t.fillShape(this)}_useBufferCanvas(){return super._useBufferCanvas(!0)}_setInterval(){var t=this;this.interval=setInterval(function(){t._updateIndex()},1e3/this.frameRate())}start(){if(!this.isRunning()){var t=this.getLayer();this.anim.setLayers(t),this._setInterval(),this.anim.start()}}stop(){this.anim.stop(),clearInterval(this.interval)}isRunning(){return this.anim.isRunning()}_updateIndex(){var t=this.frameIndex(),e=this.animation(),i=this.animations(),n=i[e],s=n.length/4;t<s-1?this.frameIndex(t+1):this.frameIndex(0)}}ns.Sprite=Re;Re.prototype.className="Sprite";(0,g0._registerNode)(Re);Bi.Factory.addGetterSetter(Re,"animation");Bi.Factory.addGetterSetter(Re,"animations");Bi.Factory.addGetterSetter(Re,"frameOffsets");Bi.Factory.addGetterSetter(Re,"image");Bi.Factory.addGetterSetter(Re,"frameIndex",0,(0,Mc.getNumberValidator)());Bi.Factory.addGetterSetter(Re,"frameRate",17,(0,Mc.getNumberValidator)());Bi.Factory.backCompat(Re,{index:"frameIndex",getIndex:"getFrameIndex",setIndex:"setFrameIndex"});var rs={};Object.defineProperty(rs,"__esModule",{value:!0});rs.Star=void 0;const Ha=st,p0=jt,ja=H,m0=ot;class pi extends p0.Shape{_sceneFunc(t){var e=this.innerRadius(),i=this.outerRadius(),n=this.numPoints();t.beginPath(),t.moveTo(0,0-i);for(var s=1;s<n*2;s++){var a=s%2===0?i:e,l=a*Math.sin(s*Math.PI/n),o=-1*a*Math.cos(s*Math.PI/n);t.lineTo(l,o)}t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(t){this.outerRadius(t/2)}setHeight(t){this.outerRadius(t/2)}}rs.Star=pi;pi.prototype.className="Star";pi.prototype._centroid=!0;pi.prototype._attrsAffectingSize=["innerRadius","outerRadius"];(0,m0._registerNode)(pi);Ha.Factory.addGetterSetter(pi,"numPoints",5,(0,ja.getNumberValidator)());Ha.Factory.addGetterSetter(pi,"innerRadius",0,(0,ja.getNumberValidator)());Ha.Factory.addGetterSetter(pi,"outerRadius",0,(0,ja.getNumberValidator)());var Ei={};Object.defineProperty(Ei,"__esModule",{value:!0});Ei.Text=Ei.stringToArray=void 0;const wa=It,$t=st,_0=jt,mi=H,v0=ot;function Fc(r){return Array.from(r)}Ei.stringToArray=Fc;var Hi="auto",y0="center",Rc="inherit",_n="justify",b0="Change.konva",S0="2d",xo="-",Nc="left",w0="text",C0="Text",A0="top",k0="bottom",Mo="middle",Lc="normal",T0="px ",Yn=" ",P0="right",Fo="rtl",E0="word",x0="char",Ro="none",Us="…",Ic=["direction","fontFamily","fontSize","fontStyle","fontVariant","padding","align","verticalAlign","lineHeight","text","width","height","wrap","ellipsis","letterSpacing"],M0=Ic.length;function F0(r){return r.split(",").map(t=>{t=t.trim();const e=t.indexOf(" ")>=0,i=t.indexOf('"')>=0||t.indexOf("'")>=0;return e&&!i&&(t=`"${t}"`),t}).join(", ")}var Kn;function Vs(){return Kn||(Kn=wa.Util.createCanvasElement().getContext(S0),Kn)}function R0(r){r.fillText(this._partialText,this._partialTextX,this._partialTextY)}function N0(r){r.setAttr("miterLimit",2),r.strokeText(this._partialText,this._partialTextX,this._partialTextY)}function L0(r){return r=r||{},!r.fillLinearGradientColorStops&&!r.fillRadialGradientColorStops&&!r.fillPatternImage&&(r.fill=r.fill||"black"),r}class Gt extends _0.Shape{constructor(t){super(L0(t)),this._partialTextX=0,this._partialTextY=0;for(var e=0;e<M0;e++)this.on(Ic[e]+b0,this._setTextData);this._setTextData()}_sceneFunc(t){var e=this.textArr,i=e.length;if(this.text()){var n=this.padding(),s=this.fontSize(),a=this.lineHeight()*s,l=this.verticalAlign(),o=this.direction(),c=0,h=this.align(),f=this.getWidth(),d=this.letterSpacing(),g=this.fill(),p=this.textDecoration(),v=p.indexOf("underline")!==-1,b=p.indexOf("line-through")!==-1,_;o=o===Rc?t.direction:o;var S=0,S=a/2,u=0,m=0;for(o===Fo&&t.setAttr("direction",o),t.setAttr("font",this._getContextFont()),t.setAttr("textBaseline",Mo),t.setAttr("textAlign",Nc),l===Mo?c=(this.getHeight()-i*a-n*2)/2:l===k0&&(c=this.getHeight()-i*a-n*2),t.translate(n,c+n),_=0;_<i;_++){var u=0,m=0,y=e[_],w=y.text,k=y.width,C=y.lastInParagraph,A,T,P;if(t.save(),h===P0?u+=f-k-n*2:h===y0&&(u+=(f-k-n*2)/2),v){t.save(),t.beginPath(),t.moveTo(u,S+m+Math.round(s/2)),A=w.split(" ").length-1,T=A===0,P=h===_n&&!C?f-n*2:k,t.lineTo(u+Math.round(P),S+m+Math.round(s/2)),t.lineWidth=s/15;const q=this._getLinearGradient();t.strokeStyle=q||g,t.stroke(),t.restore()}if(b){t.save(),t.beginPath(),t.moveTo(u,S+m),A=w.split(" ").length-1,T=A===0,P=h===_n&&C&&!T?f-n*2:k,t.lineTo(u+Math.round(P),S+m),t.lineWidth=s/15;const q=this._getLinearGradient();t.strokeStyle=q||g,t.stroke(),t.restore()}if(o!==Fo&&(d!==0||h===_n)){A=w.split(" ").length-1;for(var E=Fc(w),M=0;M<E.length;M++){var R=E[M];R===" "&&!C&&h===_n&&(u+=(f-n*2-k)/A),this._partialTextX=u,this._partialTextY=S+m,this._partialText=R,t.fillStrokeShape(this),u+=this.measureSize(R).width+d}}else d!==0&&t.setAttr("letterSpacing",`${d}px`),this._partialTextX=u,this._partialTextY=S+m,this._partialText=w,t.fillStrokeShape(this);t.restore(),i>1&&(S+=a)}}}_hitFunc(t){var e=this.getWidth(),i=this.getHeight();t.beginPath(),t.rect(0,0,e,i),t.closePath(),t.fillStrokeShape(this)}setText(t){var e=wa.Util._isString(t)?t:t==null?"":t+"";return this._setAttr(w0,e),this}getWidth(){var t=this.attrs.width===Hi||this.attrs.width===void 0;return t?this.getTextWidth()+this.padding()*2:this.attrs.width}getHeight(){var t=this.attrs.height===Hi||this.attrs.height===void 0;return t?this.fontSize()*this.textArr.length*this.lineHeight()+this.padding()*2:this.attrs.height}getTextWidth(){return this.textWidth}getTextHeight(){return wa.Util.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}measureSize(t){var e=Vs(),i=this.fontSize(),n;return e.save(),e.font=this._getContextFont(),n=e.measureText(t),e.restore(),{width:n.width,height:i}}_getContextFont(){return this.fontStyle()+Yn+this.fontVariant()+Yn+(this.fontSize()+T0)+F0(this.fontFamily())}_addTextLine(t){this.align()===_n&&(t=t.trim());var i=this._getTextWidth(t);return this.textArr.push({text:t,width:i,lastInParagraph:!1})}_getTextWidth(t){var e=this.letterSpacing(),i=t.length;return Vs().measureText(t).width+(i?e*(i-1):0)}_setTextData(){var t=this.text().split(`
`),e=+this.fontSize(),i=0,n=this.lineHeight()*e,s=this.attrs.width,a=this.attrs.height,l=s!==Hi&&s!==void 0,o=a!==Hi&&a!==void 0,c=this.padding(),h=s-c*2,f=a-c*2,d=0,g=this.wrap(),p=g!==Ro,v=g!==x0&&p,b=this.ellipsis();this.textArr=[],Vs().font=this._getContextFont();for(var _=b?this._getTextWidth(Us):0,S=0,u=t.length;S<u;++S){var m=t[S],y=this._getTextWidth(m);if(l&&y>h)for(;m.length>0;){for(var w=0,k=m.length,C="",A=0;w<k;){var T=w+k>>>1,P=m.slice(0,T+1),E=this._getTextWidth(P)+_;E<=h?(w=T+1,C=P,A=E):k=T}if(C){if(v){var M,R=m[C.length],N=R===Yn||R===xo;N&&A<=h?M=C.length:M=Math.max(C.lastIndexOf(Yn),C.lastIndexOf(xo))+1,M>0&&(w=M,C=C.slice(0,w),A=this._getTextWidth(C))}C=C.trimRight(),this._addTextLine(C),i=Math.max(i,A),d+=n;var B=this._shouldHandleEllipsis(d);if(B){this._tryToAddEllipsisToLastLine();break}if(m=m.slice(w),m=m.trimLeft(),m.length>0&&(y=this._getTextWidth(m),y<=h)){this._addTextLine(m),d+=n,i=Math.max(i,y);break}}else break}else this._addTextLine(m),d+=n,i=Math.max(i,y),this._shouldHandleEllipsis(d)&&S<u-1&&this._tryToAddEllipsisToLastLine();if(this.textArr[this.textArr.length-1]&&(this.textArr[this.textArr.length-1].lastInParagraph=!0),o&&d+n>f)break}this.textHeight=e,this.textWidth=i}_shouldHandleEllipsis(t){var e=+this.fontSize(),i=this.lineHeight()*e,n=this.attrs.height,s=n!==Hi&&n!==void 0,a=this.padding(),l=n-a*2,o=this.wrap(),c=o!==Ro;return!c||s&&t+i>l}_tryToAddEllipsisToLastLine(){var t=this.attrs.width,e=t!==Hi&&t!==void 0,i=this.padding(),n=t-i*2,s=this.ellipsis(),a=this.textArr[this.textArr.length-1];if(!(!a||!s)){if(e){var l=this._getTextWidth(a.text+Us)<n;l||(a.text=a.text.slice(0,a.text.length-3))}this.textArr.splice(this.textArr.length-1,1),this._addTextLine(a.text+Us)}}getStrokeScaleEnabled(){return!0}_useBufferCanvas(){const t=this.textDecoration().indexOf("underline")!==-1||this.textDecoration().indexOf("line-through")!==-1,e=this.hasShadow();return t&&e?!0:super._useBufferCanvas()}}Ei.Text=Gt;Gt.prototype._fillFunc=R0;Gt.prototype._strokeFunc=N0;Gt.prototype.className=C0;Gt.prototype._attrsAffectingSize=["text","fontSize","padding","wrap","lineHeight","letterSpacing"];(0,v0._registerNode)(Gt);$t.Factory.overWriteSetter(Gt,"width",(0,mi.getNumberOrAutoValidator)());$t.Factory.overWriteSetter(Gt,"height",(0,mi.getNumberOrAutoValidator)());$t.Factory.addGetterSetter(Gt,"direction",Rc);$t.Factory.addGetterSetter(Gt,"fontFamily","Arial");$t.Factory.addGetterSetter(Gt,"fontSize",12,(0,mi.getNumberValidator)());$t.Factory.addGetterSetter(Gt,"fontStyle",Lc);$t.Factory.addGetterSetter(Gt,"fontVariant",Lc);$t.Factory.addGetterSetter(Gt,"padding",0,(0,mi.getNumberValidator)());$t.Factory.addGetterSetter(Gt,"align",Nc);$t.Factory.addGetterSetter(Gt,"verticalAlign",A0);$t.Factory.addGetterSetter(Gt,"lineHeight",1,(0,mi.getNumberValidator)());$t.Factory.addGetterSetter(Gt,"wrap",E0);$t.Factory.addGetterSetter(Gt,"ellipsis",!1,(0,mi.getBooleanValidator)());$t.Factory.addGetterSetter(Gt,"letterSpacing",0,(0,mi.getNumberValidator)());$t.Factory.addGetterSetter(Gt,"text","",(0,mi.getStringValidator)());$t.Factory.addGetterSetter(Gt,"textDecoration","");var ss={};Object.defineProperty(ss,"__esModule",{value:!0});ss.TextPath=void 0;const zs=It,Te=st,I0=jt,vn=dn,Hs=Ei,Dc=H,D0=ot;var G0="",Gc="normal";function Oc(r){r.fillText(this.partialText,0,0)}function Bc(r){r.strokeText(this.partialText,0,0)}class Wt extends I0.Shape{constructor(t){super(t),this.dummyCanvas=zs.Util.createCanvasElement(),this.dataArray=[],this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute(),this._setTextData()}),this.on("textChange.konva alignChange.konva letterSpacingChange.konva kerningFuncChange.konva fontSizeChange.konva fontFamilyChange.konva",this._setTextData),this._setTextData()}_getTextPathLength(){return vn.Path.getPathLength(this.dataArray)}_getPointAtLength(t){if(!this.attrs.data)return null;const e=this.pathLength;return t-1>e?null:vn.Path.getPointAtLengthOfDataArray(t,this.dataArray)}_readDataAttribute(){this.dataArray=vn.Path.parsePathData(this.attrs.data),this.pathLength=this._getTextPathLength()}_sceneFunc(t){t.setAttr("font",this._getContextFont()),t.setAttr("textBaseline",this.textBaseline()),t.setAttr("textAlign","left"),t.save();var e=this.textDecoration(),i=this.fill(),n=this.fontSize(),s=this.glyphInfo;e==="underline"&&t.beginPath();for(var a=0;a<s.length;a++){t.save();var l=s[a].p0;t.translate(l.x,l.y),t.rotate(s[a].rotation),this.partialText=s[a].text,t.fillStrokeShape(this),e==="underline"&&(a===0&&t.moveTo(0,n/2+1),t.lineTo(n,n/2+1)),t.restore()}e==="underline"&&(t.strokeStyle=i,t.lineWidth=n/20,t.stroke()),t.restore()}_hitFunc(t){t.beginPath();var e=this.glyphInfo;if(e.length>=1){var i=e[0].p0;t.moveTo(i.x,i.y)}for(var n=0;n<e.length;n++){var s=e[n].p1;t.lineTo(s.x,s.y)}t.setAttr("lineWidth",this.fontSize()),t.setAttr("strokeStyle",this.colorKey),t.stroke()}getTextWidth(){return this.textWidth}getTextHeight(){return zs.Util.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}setText(t){return Hs.Text.prototype.setText.call(this,t)}_getContextFont(){return Hs.Text.prototype._getContextFont.call(this)}_getTextSize(t){var e=this.dummyCanvas,i=e.getContext("2d");i.save(),i.font=this._getContextFont();var n=i.measureText(t);return i.restore(),{width:n.width,height:parseInt(`${this.fontSize()}`,10)}}_setTextData(){const{width:t,height:e}=this._getTextSize(this.attrs.text);if(this.textWidth=t,this.textHeight=e,this.glyphInfo=[],!this.attrs.data)return null;const i=this.letterSpacing(),n=this.align(),s=this.kerningFunc(),a=Math.max(this.textWidth+((this.attrs.text||"").length-1)*i,0);let l=0;n==="center"&&(l=Math.max(0,this.pathLength/2-a/2)),n==="right"&&(l=Math.max(0,this.pathLength-a));const o=(0,Hs.stringToArray)(this.text());let c=l;for(var h=0;h<o.length;h++){const f=this._getPointAtLength(c);if(!f)return;let d=this._getTextSize(o[h]).width+i;if(o[h]===" "&&n==="justify"){const S=this.text().split(" ").length-1;d+=(this.pathLength-a)/S}const g=this._getPointAtLength(c+d);if(!g)return;const p=vn.Path.getLineLength(f.x,f.y,g.x,g.y);let v=0;if(s)try{v=s(o[h-1],o[h])*this.fontSize()}catch{v=0}f.x+=v,g.x+=v,this.textWidth+=v;const b=vn.Path.getPointOnLine(v+p/2,f.x,f.y,g.x,g.y),_=Math.atan2(g.y-f.y,g.x-f.x);this.glyphInfo.push({transposeX:b.x,transposeY:b.y,text:o[h],rotation:_,p0:f,p1:g}),c+=d}}getSelfRect(){if(!this.glyphInfo.length)return{x:0,y:0,width:0,height:0};var t=[];this.glyphInfo.forEach(function(h){t.push(h.p0.x),t.push(h.p0.y),t.push(h.p1.x),t.push(h.p1.y)});for(var e=t[0]||0,i=t[0]||0,n=t[1]||0,s=t[1]||0,a,l,o=0;o<t.length/2;o++)a=t[o*2],l=t[o*2+1],e=Math.min(e,a),i=Math.max(i,a),n=Math.min(n,l),s=Math.max(s,l);var c=this.fontSize();return{x:e-c/2,y:n-c/2,width:i-e+c,height:s-n+c}}destroy(){return zs.Util.releaseCanvas(this.dummyCanvas),super.destroy()}}ss.TextPath=Wt;Wt.prototype._fillFunc=Oc;Wt.prototype._strokeFunc=Bc;Wt.prototype._fillFuncHit=Oc;Wt.prototype._strokeFuncHit=Bc;Wt.prototype.className="TextPath";Wt.prototype._attrsAffectingSize=["text","fontSize","data"];(0,D0._registerNode)(Wt);Te.Factory.addGetterSetter(Wt,"data");Te.Factory.addGetterSetter(Wt,"fontFamily","Arial");Te.Factory.addGetterSetter(Wt,"fontSize",12,(0,Dc.getNumberValidator)());Te.Factory.addGetterSetter(Wt,"fontStyle",Gc);Te.Factory.addGetterSetter(Wt,"align","left");Te.Factory.addGetterSetter(Wt,"letterSpacing",0,(0,Dc.getNumberValidator)());Te.Factory.addGetterSetter(Wt,"textBaseline","middle");Te.Factory.addGetterSetter(Wt,"fontVariant",Gc);Te.Factory.addGetterSetter(Wt,"text",G0);Te.Factory.addGetterSetter(Wt,"textDecoration",null);Te.Factory.addGetterSetter(Wt,"kerningFunc",null);var as={};Object.defineProperty(as,"__esModule",{value:!0});as.Transformer=void 0;const At=It,vt=st,No=Ft,O0=jt,B0=Vn,Lo=un,Se=ot,_i=H,U0=ot;var Uc="tr-konva",V0=["resizeEnabledChange","rotateAnchorOffsetChange","rotateEnabledChange","enabledAnchorsChange","anchorSizeChange","borderEnabledChange","borderStrokeChange","borderStrokeWidthChange","borderDashChange","anchorStrokeChange","anchorStrokeWidthChange","anchorFillChange","anchorCornerRadiusChange","ignoreStrokeChange","anchorStyleFuncChange"].map(r=>r+`.${Uc}`).join(" "),Io="nodesRect",z0=["widthChange","heightChange","scaleXChange","scaleYChange","skewXChange","skewYChange","rotationChange","offsetXChange","offsetYChange","transformsEnabledChange","strokeWidthChange"],H0={"top-left":-45,"top-center":0,"top-right":45,"middle-right":-90,"middle-left":90,"bottom-left":-135,"bottom-center":180,"bottom-right":135};const j0="ontouchstart"in Se.Konva._global;function W0(r,t,e){if(r==="rotater")return e;t+=At.Util.degToRad(H0[r]||0);var i=(At.Util.radToDeg(t)%360+360)%360;return At.Util._inRange(i,315+22.5,360)||At.Util._inRange(i,0,22.5)?"ns-resize":At.Util._inRange(i,45-22.5,45+22.5)?"nesw-resize":At.Util._inRange(i,90-22.5,90+22.5)?"ew-resize":At.Util._inRange(i,135-22.5,135+22.5)?"nwse-resize":At.Util._inRange(i,180-22.5,180+22.5)?"ns-resize":At.Util._inRange(i,225-22.5,225+22.5)?"nesw-resize":At.Util._inRange(i,270-22.5,270+22.5)?"ew-resize":At.Util._inRange(i,315-22.5,315+22.5)?"nwse-resize":(At.Util.error("Transformer has unknown angle for cursor detection: "+i),"pointer")}var Er=["top-left","top-center","top-right","middle-right","middle-left","bottom-left","bottom-center","bottom-right"],Do=1e8;function X0(r){return{x:r.x+r.width/2*Math.cos(r.rotation)+r.height/2*Math.sin(-r.rotation),y:r.y+r.height/2*Math.cos(r.rotation)+r.width/2*Math.sin(r.rotation)}}function Vc(r,t,e){const i=e.x+(r.x-e.x)*Math.cos(t)-(r.y-e.y)*Math.sin(t),n=e.y+(r.x-e.x)*Math.sin(t)+(r.y-e.y)*Math.cos(t);return{...r,rotation:r.rotation+t,x:i,y:n}}function Y0(r,t){const e=X0(r);return Vc(r,t,e)}function K0(r,t,e){let i=t;for(let n=0;n<r.length;n++){const s=Se.Konva.getAngle(r[n]),a=Math.abs(s-t)%(Math.PI*2);Math.min(a,Math.PI*2-a)<e&&(i=s)}return i}class ht extends Lo.Group{constructor(t){super(t),this._movingAnchorName=null,this._transforming=!1,this._createElements(),this._handleMouseMove=this._handleMouseMove.bind(this),this._handleMouseUp=this._handleMouseUp.bind(this),this.update=this.update.bind(this),this.on(V0,this.update),this.getNode()&&this.update()}attachTo(t){return this.setNode(t),this}setNode(t){return At.Util.warn("tr.setNode(shape), tr.node(shape) and tr.attachTo(shape) methods are deprecated. Please use tr.nodes(nodesArray) instead."),this.setNodes([t])}getNode(){return this._nodes&&this._nodes[0]}_getEventNamespace(){return Uc+this._id}setNodes(t=[]){this._nodes&&this._nodes.length&&this.detach();const e=t.filter(n=>n.isAncestorOf(this)?(At.Util.error("Konva.Transformer cannot be an a child of the node you are trying to attach"),!1):!0);this._nodes=t=e,t.length===1&&this.useSingleNodeRotation()?this.rotation(t[0].getAbsoluteRotation()):this.rotation(0),this._nodes.forEach(n=>{const s=()=>{this.nodes().length===1&&this.useSingleNodeRotation()&&this.rotation(this.nodes()[0].getAbsoluteRotation()),this._resetTransformCache(),!this._transforming&&!this.isDragging()&&this.update()},a=n._attrsAffectingSize.map(l=>l+"Change."+this._getEventNamespace()).join(" ");n.on(a,s),n.on(z0.map(l=>l+`.${this._getEventNamespace()}`).join(" "),s),n.on(`absoluteTransformChange.${this._getEventNamespace()}`,s),this._proxyDrag(n)}),this._resetTransformCache();var i=!!this.findOne(".top-left");return i&&this.update(),this}_proxyDrag(t){let e;t.on(`dragstart.${this._getEventNamespace()}`,i=>{e=t.getAbsolutePosition(),!this.isDragging()&&t!==this.findOne(".back")&&this.startDrag(i,!1)}),t.on(`dragmove.${this._getEventNamespace()}`,i=>{if(!e)return;const n=t.getAbsolutePosition(),s=n.x-e.x,a=n.y-e.y;this.nodes().forEach(l=>{if(l===t||l.isDragging())return;const o=l.getAbsolutePosition();l.setAbsolutePosition({x:o.x+s,y:o.y+a}),l.startDrag(i)}),e=null})}getNodes(){return this._nodes||[]}getActiveAnchor(){return this._movingAnchorName}detach(){this._nodes&&this._nodes.forEach(t=>{t.off("."+this._getEventNamespace())}),this._nodes=[],this._resetTransformCache()}_resetTransformCache(){this._clearCache(Io),this._clearCache("transform"),this._clearSelfAndDescendantCache("absoluteTransform")}_getNodeRect(){return this._getCache(Io,this.__getNodeRect)}__getNodeShape(t,e=this.rotation(),i){var n=t.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),s=t.getAbsoluteScale(i),a=t.getAbsolutePosition(i),l=n.x*s.x-t.offsetX()*s.x,o=n.y*s.y-t.offsetY()*s.y;const c=(Se.Konva.getAngle(t.getAbsoluteRotation())+Math.PI*2)%(Math.PI*2),h={x:a.x+l*Math.cos(c)+o*Math.sin(-c),y:a.y+o*Math.cos(c)+l*Math.sin(c),width:n.width*s.x,height:n.height*s.y,rotation:c};return Vc(h,-Se.Konva.getAngle(e),{x:0,y:0})}__getNodeRect(){var t=this.getNode();if(!t)return{x:-Do,y:-Do,width:0,height:0,rotation:0};const e=[];this.nodes().map(c=>{const h=c.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()});var f=[{x:h.x,y:h.y},{x:h.x+h.width,y:h.y},{x:h.x+h.width,y:h.y+h.height},{x:h.x,y:h.y+h.height}],d=c.getAbsoluteTransform();f.forEach(function(g){var p=d.point(g);e.push(p)})});const i=new At.Transform;i.rotate(-Se.Konva.getAngle(this.rotation()));var n=1/0,s=1/0,a=-1/0,l=-1/0;e.forEach(function(c){var h=i.point(c);n===void 0&&(n=a=h.x,s=l=h.y),n=Math.min(n,h.x),s=Math.min(s,h.y),a=Math.max(a,h.x),l=Math.max(l,h.y)}),i.invert();const o=i.point({x:n,y:s});return{x:o.x,y:o.y,width:a-n,height:l-s,rotation:Se.Konva.getAngle(this.rotation())}}getX(){return this._getNodeRect().x}getY(){return this._getNodeRect().y}getWidth(){return this._getNodeRect().width}getHeight(){return this._getNodeRect().height}_createElements(){this._createBack(),Er.forEach(t=>{this._createAnchor(t)}),this._createAnchor("rotater")}_createAnchor(t){var e=new B0.Rect({stroke:"rgb(0, 161, 255)",fill:"white",strokeWidth:1,name:t+" _anchor",dragDistance:0,draggable:!0,hitStrokeWidth:j0?10:"auto"}),i=this;e.on("mousedown touchstart",function(n){i._handleMouseDown(n)}),e.on("dragstart",n=>{e.stopDrag(),n.cancelBubble=!0}),e.on("dragend",n=>{n.cancelBubble=!0}),e.on("mouseenter",()=>{var n=Se.Konva.getAngle(this.rotation()),s=this.rotateAnchorCursor(),a=W0(t,n,s);e.getStage().content&&(e.getStage().content.style.cursor=a),this._cursorChange=!0}),e.on("mouseout",()=>{e.getStage().content&&(e.getStage().content.style.cursor=""),this._cursorChange=!1}),this.add(e)}_createBack(){var t=new O0.Shape({name:"back",width:0,height:0,draggable:!0,sceneFunc(e,i){var n=i.getParent(),s=n.padding();e.beginPath(),e.rect(-s,-s,i.width()+s*2,i.height()+s*2),e.moveTo(i.width()/2,-s),n.rotateEnabled()&&n.rotateLineVisible()&&e.lineTo(i.width()/2,-n.rotateAnchorOffset()*At.Util._sign(i.height())-s),e.fillStrokeShape(i)},hitFunc:(e,i)=>{if(this.shouldOverdrawWholeArea()){var n=this.padding();e.beginPath(),e.rect(-n,-n,i.width()+n*2,i.height()+n*2),e.fillStrokeShape(i)}}});this.add(t),this._proxyDrag(t),t.on("dragstart",e=>{e.cancelBubble=!0}),t.on("dragmove",e=>{e.cancelBubble=!0}),t.on("dragend",e=>{e.cancelBubble=!0}),this.on("dragmove",e=>{this.update()})}_handleMouseDown(t){this._movingAnchorName=t.target.name().split(" ")[0];var e=this._getNodeRect(),i=e.width,n=e.height,s=Math.sqrt(Math.pow(i,2)+Math.pow(n,2));this.sin=Math.abs(n/s),this.cos=Math.abs(i/s),typeof window<"u"&&(window.addEventListener("mousemove",this._handleMouseMove),window.addEventListener("touchmove",this._handleMouseMove),window.addEventListener("mouseup",this._handleMouseUp,!0),window.addEventListener("touchend",this._handleMouseUp,!0)),this._transforming=!0;var a=t.target.getAbsolutePosition(),l=t.target.getStage().getPointerPosition();this._anchorDragOffset={x:l.x-a.x,y:l.y-a.y},this._fire("transformstart",{evt:t.evt,target:this.getNode()}),this._nodes.forEach(o=>{o._fire("transformstart",{evt:t.evt,target:o})})}_handleMouseMove(t){var e,i,n,s=this.findOne("."+this._movingAnchorName),a=s.getStage();a.setPointersPositions(t);const l=a.getPointerPosition();let o={x:l.x-this._anchorDragOffset.x,y:l.y-this._anchorDragOffset.y};const c=s.getAbsolutePosition();this.anchorDragBoundFunc()&&(o=this.anchorDragBoundFunc()(c,o,t)),s.setAbsolutePosition(o);const h=s.getAbsolutePosition();if(!(c.x===h.x&&c.y===h.y)){if(this._movingAnchorName==="rotater"){var f=this._getNodeRect();e=s.x()-f.width/2,i=-s.y()+f.height/2;let M=Math.atan2(-i,e)+Math.PI/2;f.height<0&&(M-=Math.PI);var d=Se.Konva.getAngle(this.rotation());const R=d+M,N=Se.Konva.getAngle(this.rotationSnapTolerance()),q=K0(this.rotationSnaps(),R,N)-f.rotation,nt=Y0(f,q);this._fitNodesInto(nt,t);return}var g=this.shiftBehavior(),p;g==="inverted"?p=this.keepRatio()&&!t.shiftKey:g==="none"?p=this.keepRatio():p=this.keepRatio()||t.shiftKey;var u=this.centeredScaling()||t.altKey;if(this._movingAnchorName==="top-left"){if(p){var v=u?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-right").x(),y:this.findOne(".bottom-right").y()};n=Math.sqrt(Math.pow(v.x-s.x(),2)+Math.pow(v.y-s.y(),2));var b=this.findOne(".top-left").x()>v.x?-1:1,_=this.findOne(".top-left").y()>v.y?-1:1;e=n*this.cos*b,i=n*this.sin*_,this.findOne(".top-left").x(v.x-e),this.findOne(".top-left").y(v.y-i)}}else if(this._movingAnchorName==="top-center")this.findOne(".top-left").y(s.y());else if(this._movingAnchorName==="top-right"){if(p){var v=u?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-left").x(),y:this.findOne(".bottom-left").y()};n=Math.sqrt(Math.pow(s.x()-v.x,2)+Math.pow(v.y-s.y(),2));var b=this.findOne(".top-right").x()<v.x?-1:1,_=this.findOne(".top-right").y()>v.y?-1:1;e=n*this.cos*b,i=n*this.sin*_,this.findOne(".top-right").x(v.x+e),this.findOne(".top-right").y(v.y-i)}var S=s.position();this.findOne(".top-left").y(S.y),this.findOne(".bottom-right").x(S.x)}else if(this._movingAnchorName==="middle-left")this.findOne(".top-left").x(s.x());else if(this._movingAnchorName==="middle-right")this.findOne(".bottom-right").x(s.x());else if(this._movingAnchorName==="bottom-left"){if(p){var v=u?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-right").x(),y:this.findOne(".top-right").y()};n=Math.sqrt(Math.pow(v.x-s.x(),2)+Math.pow(s.y()-v.y,2));var b=v.x<s.x()?-1:1,_=s.y()<v.y?-1:1;e=n*this.cos*b,i=n*this.sin*_,s.x(v.x-e),s.y(v.y+i)}S=s.position(),this.findOne(".top-left").x(S.x),this.findOne(".bottom-right").y(S.y)}else if(this._movingAnchorName==="bottom-center")this.findOne(".bottom-right").y(s.y());else if(this._movingAnchorName==="bottom-right"){if(p){var v=u?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-left").x(),y:this.findOne(".top-left").y()};n=Math.sqrt(Math.pow(s.x()-v.x,2)+Math.pow(s.y()-v.y,2));var b=this.findOne(".bottom-right").x()<v.x?-1:1,_=this.findOne(".bottom-right").y()<v.y?-1:1;e=n*this.cos*b,i=n*this.sin*_,this.findOne(".bottom-right").x(v.x+e),this.findOne(".bottom-right").y(v.y+i)}}else console.error(new Error("Wrong position argument of selection resizer: "+this._movingAnchorName));var u=this.centeredScaling()||t.altKey;if(u){var m=this.findOne(".top-left"),y=this.findOne(".bottom-right"),w=m.x(),k=m.y(),C=this.getWidth()-y.x(),A=this.getHeight()-y.y();y.move({x:-w,y:-k}),m.move({x:C,y:A})}var T=this.findOne(".top-left").getAbsolutePosition();e=T.x,i=T.y;var P=this.findOne(".bottom-right").x()-this.findOne(".top-left").x(),E=this.findOne(".bottom-right").y()-this.findOne(".top-left").y();this._fitNodesInto({x:e,y:i,width:P,height:E,rotation:Se.Konva.getAngle(this.rotation())},t)}}_handleMouseUp(t){this._removeEvents(t)}getAbsoluteTransform(){return this.getTransform()}_removeEvents(t){if(this._transforming){this._transforming=!1,typeof window<"u"&&(window.removeEventListener("mousemove",this._handleMouseMove),window.removeEventListener("touchmove",this._handleMouseMove),window.removeEventListener("mouseup",this._handleMouseUp,!0),window.removeEventListener("touchend",this._handleMouseUp,!0));var e=this.getNode();this._fire("transformend",{evt:t,target:e}),e&&this._nodes.forEach(i=>{i._fire("transformend",{evt:t,target:i})}),this._movingAnchorName=null}}_fitNodesInto(t,e){var i=this._getNodeRect();const n=1;if(At.Util._inRange(t.width,-this.padding()*2-n,n)){this.update();return}if(At.Util._inRange(t.height,-this.padding()*2-n,n)){this.update();return}var s=new At.Transform;if(s.rotate(Se.Konva.getAngle(this.rotation())),this._movingAnchorName&&t.width<0&&this._movingAnchorName.indexOf("left")>=0){const d=s.point({x:-this.padding()*2,y:0});t.x+=d.x,t.y+=d.y,t.width+=this.padding()*2,this._movingAnchorName=this._movingAnchorName.replace("left","right"),this._anchorDragOffset.x-=d.x,this._anchorDragOffset.y-=d.y}else if(this._movingAnchorName&&t.width<0&&this._movingAnchorName.indexOf("right")>=0){const d=s.point({x:this.padding()*2,y:0});this._movingAnchorName=this._movingAnchorName.replace("right","left"),this._anchorDragOffset.x-=d.x,this._anchorDragOffset.y-=d.y,t.width+=this.padding()*2}if(this._movingAnchorName&&t.height<0&&this._movingAnchorName.indexOf("top")>=0){const d=s.point({x:0,y:-this.padding()*2});t.x+=d.x,t.y+=d.y,this._movingAnchorName=this._movingAnchorName.replace("top","bottom"),this._anchorDragOffset.x-=d.x,this._anchorDragOffset.y-=d.y,t.height+=this.padding()*2}else if(this._movingAnchorName&&t.height<0&&this._movingAnchorName.indexOf("bottom")>=0){const d=s.point({x:0,y:this.padding()*2});this._movingAnchorName=this._movingAnchorName.replace("bottom","top"),this._anchorDragOffset.x-=d.x,this._anchorDragOffset.y-=d.y,t.height+=this.padding()*2}if(this.boundBoxFunc()){const d=this.boundBoxFunc()(i,t);d?t=d:At.Util.warn("boundBoxFunc returned falsy. You should return new bound rect from it!")}const a=1e7,l=new At.Transform;l.translate(i.x,i.y),l.rotate(i.rotation),l.scale(i.width/a,i.height/a);const o=new At.Transform,c=t.width/a,h=t.height/a;this.flipEnabled()===!1?(o.translate(t.x,t.y),o.rotate(t.rotation),o.translate(t.width<0?t.width:0,t.height<0?t.height:0),o.scale(Math.abs(c),Math.abs(h))):(o.translate(t.x,t.y),o.rotate(t.rotation),o.scale(c,h));const f=o.multiply(l.invert());this._nodes.forEach(d=>{var g;const p=d.getParent().getAbsoluteTransform(),v=d.getTransform().copy();v.translate(d.offsetX(),d.offsetY());const b=new At.Transform;b.multiply(p.copy().invert()).multiply(f).multiply(p).multiply(v);const _=b.decompose();d.setAttrs(_),this._fire("transform",{evt:e,target:d}),d._fire("transform",{evt:e,target:d}),(g=d.getLayer())===null||g===void 0||g.batchDraw()}),this.rotation(At.Util._getRotation(t.rotation)),this._resetTransformCache(),this.update(),this.getLayer().batchDraw()}forceUpdate(){this._resetTransformCache(),this.update()}_batchChangeChild(t,e){this.findOne(t).setAttrs(e)}update(){var t,e=this._getNodeRect();this.rotation(At.Util._getRotation(e.rotation));var i=e.width,n=e.height,s=this.enabledAnchors(),a=this.resizeEnabled(),l=this.padding(),o=this.anchorSize();const c=this.find("._anchor");c.forEach(f=>{f.setAttrs({width:o,height:o,offsetX:o/2,offsetY:o/2,stroke:this.anchorStroke(),strokeWidth:this.anchorStrokeWidth(),fill:this.anchorFill(),cornerRadius:this.anchorCornerRadius()})}),this._batchChangeChild(".top-left",{x:0,y:0,offsetX:o/2+l,offsetY:o/2+l,visible:a&&s.indexOf("top-left")>=0}),this._batchChangeChild(".top-center",{x:i/2,y:0,offsetY:o/2+l,visible:a&&s.indexOf("top-center")>=0}),this._batchChangeChild(".top-right",{x:i,y:0,offsetX:o/2-l,offsetY:o/2+l,visible:a&&s.indexOf("top-right")>=0}),this._batchChangeChild(".middle-left",{x:0,y:n/2,offsetX:o/2+l,visible:a&&s.indexOf("middle-left")>=0}),this._batchChangeChild(".middle-right",{x:i,y:n/2,offsetX:o/2-l,visible:a&&s.indexOf("middle-right")>=0}),this._batchChangeChild(".bottom-left",{x:0,y:n,offsetX:o/2+l,offsetY:o/2-l,visible:a&&s.indexOf("bottom-left")>=0}),this._batchChangeChild(".bottom-center",{x:i/2,y:n,offsetY:o/2-l,visible:a&&s.indexOf("bottom-center")>=0}),this._batchChangeChild(".bottom-right",{x:i,y:n,offsetX:o/2-l,offsetY:o/2-l,visible:a&&s.indexOf("bottom-right")>=0}),this._batchChangeChild(".rotater",{x:i/2,y:-this.rotateAnchorOffset()*At.Util._sign(n)-l,visible:this.rotateEnabled()}),this._batchChangeChild(".back",{width:i,height:n,visible:this.borderEnabled(),stroke:this.borderStroke(),strokeWidth:this.borderStrokeWidth(),dash:this.borderDash(),x:0,y:0});const h=this.anchorStyleFunc();h&&c.forEach(f=>{h(f)}),(t=this.getLayer())===null||t===void 0||t.batchDraw()}isTransforming(){return this._transforming}stopTransform(){if(this._transforming){this._removeEvents();var t=this.findOne("."+this._movingAnchorName);t&&t.stopDrag()}}destroy(){return this.getStage()&&this._cursorChange&&this.getStage().content&&(this.getStage().content.style.cursor=""),Lo.Group.prototype.destroy.call(this),this.detach(),this._removeEvents(),this}toObject(){return No.Node.prototype.toObject.call(this)}clone(t){var e=No.Node.prototype.clone.call(this,t);return e}getClientRect(){return this.nodes().length>0?super.getClientRect():{x:0,y:0,width:0,height:0}}}as.Transformer=ht;function $0(r){return r instanceof Array||At.Util.warn("enabledAnchors value should be an array"),r instanceof Array&&r.forEach(function(t){Er.indexOf(t)===-1&&At.Util.warn("Unknown anchor name: "+t+". Available names are: "+Er.join(", "))}),r||[]}ht.prototype.className="Transformer";(0,U0._registerNode)(ht);vt.Factory.addGetterSetter(ht,"enabledAnchors",Er,$0);vt.Factory.addGetterSetter(ht,"flipEnabled",!0,(0,_i.getBooleanValidator)());vt.Factory.addGetterSetter(ht,"resizeEnabled",!0);vt.Factory.addGetterSetter(ht,"anchorSize",10,(0,_i.getNumberValidator)());vt.Factory.addGetterSetter(ht,"rotateEnabled",!0);vt.Factory.addGetterSetter(ht,"rotateLineVisible",!0);vt.Factory.addGetterSetter(ht,"rotationSnaps",[]);vt.Factory.addGetterSetter(ht,"rotateAnchorOffset",50,(0,_i.getNumberValidator)());vt.Factory.addGetterSetter(ht,"rotateAnchorCursor","crosshair");vt.Factory.addGetterSetter(ht,"rotationSnapTolerance",5,(0,_i.getNumberValidator)());vt.Factory.addGetterSetter(ht,"borderEnabled",!0);vt.Factory.addGetterSetter(ht,"anchorStroke","rgb(0, 161, 255)");vt.Factory.addGetterSetter(ht,"anchorStrokeWidth",1,(0,_i.getNumberValidator)());vt.Factory.addGetterSetter(ht,"anchorFill","white");vt.Factory.addGetterSetter(ht,"anchorCornerRadius",0,(0,_i.getNumberValidator)());vt.Factory.addGetterSetter(ht,"borderStroke","rgb(0, 161, 255)");vt.Factory.addGetterSetter(ht,"borderStrokeWidth",1,(0,_i.getNumberValidator)());vt.Factory.addGetterSetter(ht,"borderDash");vt.Factory.addGetterSetter(ht,"keepRatio",!0);vt.Factory.addGetterSetter(ht,"shiftBehavior","default");vt.Factory.addGetterSetter(ht,"centeredScaling",!1);vt.Factory.addGetterSetter(ht,"ignoreStroke",!1);vt.Factory.addGetterSetter(ht,"padding",0,(0,_i.getNumberValidator)());vt.Factory.addGetterSetter(ht,"node");vt.Factory.addGetterSetter(ht,"nodes");vt.Factory.addGetterSetter(ht,"boundBoxFunc");vt.Factory.addGetterSetter(ht,"anchorDragBoundFunc");vt.Factory.addGetterSetter(ht,"anchorStyleFunc");vt.Factory.addGetterSetter(ht,"shouldOverdrawWholeArea",!1);vt.Factory.addGetterSetter(ht,"useSingleNodeRotation",!0);vt.Factory.backCompat(ht,{lineEnabled:"borderEnabled",rotateHandlerOffset:"rotateAnchorOffset",enabledHandlers:"enabledAnchors"});var os={};Object.defineProperty(os,"__esModule",{value:!0});os.Wedge=void 0;const ls=st,q0=jt,J0=ot,zc=H,Q0=ot;class Ze extends q0.Shape{_sceneFunc(t){t.beginPath(),t.arc(0,0,this.radius(),0,J0.Konva.getAngle(this.angle()),this.clockwise()),t.lineTo(0,0),t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(t){this.radius(t/2)}setHeight(t){this.radius(t/2)}}os.Wedge=Ze;Ze.prototype.className="Wedge";Ze.prototype._centroid=!0;Ze.prototype._attrsAffectingSize=["radius"];(0,Q0._registerNode)(Ze);ls.Factory.addGetterSetter(Ze,"radius",0,(0,zc.getNumberValidator)());ls.Factory.addGetterSetter(Ze,"angle",0,(0,zc.getNumberValidator)());ls.Factory.addGetterSetter(Ze,"clockwise",!1);ls.Factory.backCompat(Ze,{angleDeg:"angle",getAngleDeg:"getAngle",setAngleDeg:"setAngle"});var cs={};Object.defineProperty(cs,"__esModule",{value:!0});cs.Blur=void 0;const Go=st,Z0=Ft,td=H;function Oo(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}var ed=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],id=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];function nd(r,t){var e=r.data,i=r.width,n=r.height,s,a,l,o,c,h,f,d,g,p,v,b,_,S,u,m,y,w,k,C,A,T,P,E,M=t+t+1,R=i-1,N=n-1,B=t+1,q=B*(B+1)/2,nt=new Oo,ct=null,K=nt,$=null,pt=null,Tt=ed[t],Ct=id[t];for(l=1;l<M;l++)K=K.next=new Oo,l===B&&(ct=K);for(K.next=nt,f=h=0,a=0;a<n;a++){for(m=y=w=k=d=g=p=v=0,b=B*(C=e[h]),_=B*(A=e[h+1]),S=B*(T=e[h+2]),u=B*(P=e[h+3]),d+=q*C,g+=q*A,p+=q*T,v+=q*P,K=nt,l=0;l<B;l++)K.r=C,K.g=A,K.b=T,K.a=P,K=K.next;for(l=1;l<B;l++)o=h+((R<l?R:l)<<2),d+=(K.r=C=e[o])*(E=B-l),g+=(K.g=A=e[o+1])*E,p+=(K.b=T=e[o+2])*E,v+=(K.a=P=e[o+3])*E,m+=C,y+=A,w+=T,k+=P,K=K.next;for($=nt,pt=ct,s=0;s<i;s++)e[h+3]=P=v*Tt>>Ct,P!==0?(P=255/P,e[h]=(d*Tt>>Ct)*P,e[h+1]=(g*Tt>>Ct)*P,e[h+2]=(p*Tt>>Ct)*P):e[h]=e[h+1]=e[h+2]=0,d-=b,g-=_,p-=S,v-=u,b-=$.r,_-=$.g,S-=$.b,u-=$.a,o=f+((o=s+t+1)<R?o:R)<<2,m+=$.r=e[o],y+=$.g=e[o+1],w+=$.b=e[o+2],k+=$.a=e[o+3],d+=m,g+=y,p+=w,v+=k,$=$.next,b+=C=pt.r,_+=A=pt.g,S+=T=pt.b,u+=P=pt.a,m-=C,y-=A,w-=T,k-=P,pt=pt.next,h+=4;f+=i}for(s=0;s<i;s++){for(y=w=k=m=g=p=v=d=0,h=s<<2,b=B*(C=e[h]),_=B*(A=e[h+1]),S=B*(T=e[h+2]),u=B*(P=e[h+3]),d+=q*C,g+=q*A,p+=q*T,v+=q*P,K=nt,l=0;l<B;l++)K.r=C,K.g=A,K.b=T,K.a=P,K=K.next;for(c=i,l=1;l<=t;l++)h=c+s<<2,d+=(K.r=C=e[h])*(E=B-l),g+=(K.g=A=e[h+1])*E,p+=(K.b=T=e[h+2])*E,v+=(K.a=P=e[h+3])*E,m+=C,y+=A,w+=T,k+=P,K=K.next,l<N&&(c+=i);for(h=s,$=nt,pt=ct,a=0;a<n;a++)o=h<<2,e[o+3]=P=v*Tt>>Ct,P>0?(P=255/P,e[o]=(d*Tt>>Ct)*P,e[o+1]=(g*Tt>>Ct)*P,e[o+2]=(p*Tt>>Ct)*P):e[o]=e[o+1]=e[o+2]=0,d-=b,g-=_,p-=S,v-=u,b-=$.r,_-=$.g,S-=$.b,u-=$.a,o=s+((o=a+B)<N?o:N)*i<<2,d+=m+=$.r=e[o],g+=y+=$.g=e[o+1],p+=w+=$.b=e[o+2],v+=k+=$.a=e[o+3],$=$.next,b+=C=pt.r,_+=A=pt.g,S+=T=pt.b,u+=P=pt.a,m-=C,y-=A,w-=T,k-=P,pt=pt.next,h+=i}}const rd=function(t){var e=Math.round(this.blurRadius());e>0&&nd(t,e)};cs.Blur=rd;Go.Factory.addGetterSetter(Z0.Node,"blurRadius",0,(0,td.getNumberValidator)(),Go.Factory.afterSetFilter);var hs={};Object.defineProperty(hs,"__esModule",{value:!0});hs.Brighten=void 0;const Bo=st,sd=Ft,ad=H,od=function(r){var t=this.brightness()*255,e=r.data,i=e.length,n;for(n=0;n<i;n+=4)e[n]+=t,e[n+1]+=t,e[n+2]+=t};hs.Brighten=od;Bo.Factory.addGetterSetter(sd.Node,"brightness",0,(0,ad.getNumberValidator)(),Bo.Factory.afterSetFilter);var us={};Object.defineProperty(us,"__esModule",{value:!0});us.Contrast=void 0;const Uo=st,ld=Ft,cd=H,hd=function(r){var t=Math.pow((this.contrast()+100)/100,2),e=r.data,i=e.length,n=150,s=150,a=150,l;for(l=0;l<i;l+=4)n=e[l],s=e[l+1],a=e[l+2],n/=255,n-=.5,n*=t,n+=.5,n*=255,s/=255,s-=.5,s*=t,s+=.5,s*=255,a/=255,a-=.5,a*=t,a+=.5,a*=255,n=n<0?0:n>255?255:n,s=s<0?0:s>255?255:s,a=a<0?0:a>255?255:a,e[l]=n,e[l+1]=s,e[l+2]=a};us.Contrast=hd;Uo.Factory.addGetterSetter(ld.Node,"contrast",0,(0,cd.getNumberValidator)(),Uo.Factory.afterSetFilter);var fs={};Object.defineProperty(fs,"__esModule",{value:!0});fs.Emboss=void 0;const ui=st,ds=Ft,ud=It,Hc=H,fd=function(r){var t=this.embossStrength()*10,e=this.embossWhiteLevel()*255,i=this.embossDirection(),n=this.embossBlend(),s=0,a=0,l=r.data,o=r.width,c=r.height,h=o*4,f=c;switch(i){case"top-left":s=-1,a=-1;break;case"top":s=-1,a=0;break;case"top-right":s=-1,a=1;break;case"right":s=0,a=1;break;case"bottom-right":s=1,a=1;break;case"bottom":s=1,a=0;break;case"bottom-left":s=1,a=-1;break;case"left":s=0,a=-1;break;default:ud.Util.error("Unknown emboss direction: "+i)}do{var d=(f-1)*h,g=s;f+g<1&&(g=0),f+g>c&&(g=0);var p=(f-1+g)*o*4,v=o;do{var b=d+(v-1)*4,_=a;v+_<1&&(_=0),v+_>o&&(_=0);var S=p+(v-1+_)*4,u=l[b]-l[S],m=l[b+1]-l[S+1],y=l[b+2]-l[S+2],w=u,k=w>0?w:-w,C=m>0?m:-m,A=y>0?y:-y;if(C>k&&(w=m),A>k&&(w=y),w*=t,n){var T=l[b]+w,P=l[b+1]+w,E=l[b+2]+w;l[b]=T>255?255:T<0?0:T,l[b+1]=P>255?255:P<0?0:P,l[b+2]=E>255?255:E<0?0:E}else{var M=e-w;M<0?M=0:M>255&&(M=255),l[b]=l[b+1]=l[b+2]=M}}while(--v)}while(--f)};fs.Emboss=fd;ui.Factory.addGetterSetter(ds.Node,"embossStrength",.5,(0,Hc.getNumberValidator)(),ui.Factory.afterSetFilter);ui.Factory.addGetterSetter(ds.Node,"embossWhiteLevel",.5,(0,Hc.getNumberValidator)(),ui.Factory.afterSetFilter);ui.Factory.addGetterSetter(ds.Node,"embossDirection","top-left",null,ui.Factory.afterSetFilter);ui.Factory.addGetterSetter(ds.Node,"embossBlend",!1,null,ui.Factory.afterSetFilter);var gs={};Object.defineProperty(gs,"__esModule",{value:!0});gs.Enhance=void 0;const Vo=st,dd=Ft,gd=H;function js(r,t,e,i,n){var s=e-t,a=n-i,l;return s===0?i+a/2:a===0?i:(l=(r-t)/s,l=a*l+i,l)}const pd=function(r){var t=r.data,e=t.length,i=t[0],n=i,s,a=t[1],l=a,o,c=t[2],h=c,f,d,g=this.enhance();if(g!==0){for(d=0;d<e;d+=4)s=t[d+0],s<i?i=s:s>n&&(n=s),o=t[d+1],o<a?a=o:o>l&&(l=o),f=t[d+2],f<c?c=f:f>h&&(h=f);n===i&&(n=255,i=0),l===a&&(l=255,a=0),h===c&&(h=255,c=0);var p,v,b,_,S,u,m,y,w;for(g>0?(v=n+g*(255-n),b=i-g*(i-0),S=l+g*(255-l),u=a-g*(a-0),y=h+g*(255-h),w=c-g*(c-0)):(p=(n+i)*.5,v=n+g*(n-p),b=i+g*(i-p),_=(l+a)*.5,S=l+g*(l-_),u=a+g*(a-_),m=(h+c)*.5,y=h+g*(h-m),w=c+g*(c-m)),d=0;d<e;d+=4)t[d+0]=js(t[d+0],i,n,b,v),t[d+1]=js(t[d+1],a,l,u,S),t[d+2]=js(t[d+2],c,h,w,y)}};gs.Enhance=pd;Vo.Factory.addGetterSetter(dd.Node,"enhance",0,(0,gd.getNumberValidator)(),Vo.Factory.afterSetFilter);var ps={};Object.defineProperty(ps,"__esModule",{value:!0});ps.Grayscale=void 0;const md=function(r){var t=r.data,e=t.length,i,n;for(i=0;i<e;i+=4)n=.34*t[i]+.5*t[i+1]+.16*t[i+2],t[i]=n,t[i+1]=n,t[i+2]=n};ps.Grayscale=md;var ms={};Object.defineProperty(ms,"__esModule",{value:!0});ms.HSL=void 0;const rn=st,Wa=Ft,Xa=H;rn.Factory.addGetterSetter(Wa.Node,"hue",0,(0,Xa.getNumberValidator)(),rn.Factory.afterSetFilter);rn.Factory.addGetterSetter(Wa.Node,"saturation",0,(0,Xa.getNumberValidator)(),rn.Factory.afterSetFilter);rn.Factory.addGetterSetter(Wa.Node,"luminance",0,(0,Xa.getNumberValidator)(),rn.Factory.afterSetFilter);const _d=function(r){var t=r.data,e=t.length,i=1,n=Math.pow(2,this.saturation()),s=Math.abs(this.hue()+360)%360,a=this.luminance()*127,l,o=i*n*Math.cos(s*Math.PI/180),c=i*n*Math.sin(s*Math.PI/180),h=.299*i+.701*o+.167*c,f=.587*i-.587*o+.33*c,d=.114*i-.114*o-.497*c,g=.299*i-.299*o-.328*c,p=.587*i+.413*o+.035*c,v=.114*i-.114*o+.293*c,b=.299*i-.3*o+1.25*c,_=.587*i-.586*o-1.05*c,S=.114*i+.886*o-.2*c,u,m,y,w;for(l=0;l<e;l+=4)u=t[l+0],m=t[l+1],y=t[l+2],w=t[l+3],t[l+0]=h*u+f*m+d*y+a,t[l+1]=g*u+p*m+v*y+a,t[l+2]=b*u+_*m+S*y+a,t[l+3]=w};ms.HSL=_d;var _s={};Object.defineProperty(_s,"__esModule",{value:!0});_s.HSV=void 0;const sn=st,Ya=Ft,Ka=H,vd=function(r){var t=r.data,e=t.length,i=Math.pow(2,this.value()),n=Math.pow(2,this.saturation()),s=Math.abs(this.hue()+360)%360,a,l=i*n*Math.cos(s*Math.PI/180),o=i*n*Math.sin(s*Math.PI/180),c=.299*i+.701*l+.167*o,h=.587*i-.587*l+.33*o,f=.114*i-.114*l-.497*o,d=.299*i-.299*l-.328*o,g=.587*i+.413*l+.035*o,p=.114*i-.114*l+.293*o,v=.299*i-.3*l+1.25*o,b=.587*i-.586*l-1.05*o,_=.114*i+.886*l-.2*o,S,u,m,y;for(a=0;a<e;a+=4)S=t[a+0],u=t[a+1],m=t[a+2],y=t[a+3],t[a+0]=c*S+h*u+f*m,t[a+1]=d*S+g*u+p*m,t[a+2]=v*S+b*u+_*m,t[a+3]=y};_s.HSV=vd;sn.Factory.addGetterSetter(Ya.Node,"hue",0,(0,Ka.getNumberValidator)(),sn.Factory.afterSetFilter);sn.Factory.addGetterSetter(Ya.Node,"saturation",0,(0,Ka.getNumberValidator)(),sn.Factory.afterSetFilter);sn.Factory.addGetterSetter(Ya.Node,"value",0,(0,Ka.getNumberValidator)(),sn.Factory.afterSetFilter);var vs={};Object.defineProperty(vs,"__esModule",{value:!0});vs.Invert=void 0;const yd=function(r){var t=r.data,e=t.length,i;for(i=0;i<e;i+=4)t[i]=255-t[i],t[i+1]=255-t[i+1],t[i+2]=255-t[i+2]};vs.Invert=yd;var ys={};Object.defineProperty(ys,"__esModule",{value:!0});ys.Kaleidoscope=void 0;const xr=st,jc=Ft,zo=It,Wc=H;var bd=function(r,t,e){var i=r.data,n=t.data,s=r.width,a=r.height,l=e.polarCenterX||s/2,o=e.polarCenterY||a/2,c,h,f,d=0,g=0,p=0,v=0,b,_=Math.sqrt(l*l+o*o);h=s-l,f=a-o,b=Math.sqrt(h*h+f*f),_=b>_?b:_;var S=a,u=s,m,y,w=360/u*Math.PI/180,k,C;for(y=0;y<u;y+=1)for(k=Math.sin(y*w),C=Math.cos(y*w),m=0;m<S;m+=1)h=Math.floor(l+_*m/S*C),f=Math.floor(o+_*m/S*k),c=(f*s+h)*4,d=i[c+0],g=i[c+1],p=i[c+2],v=i[c+3],c=(y+m*s)*4,n[c+0]=d,n[c+1]=g,n[c+2]=p,n[c+3]=v},Sd=function(r,t,e){var i=r.data,n=t.data,s=r.width,a=r.height,l=e.polarCenterX||s/2,o=e.polarCenterY||a/2,c,h,f,d,g,p=0,v=0,b=0,_=0,S,u=Math.sqrt(l*l+o*o);h=s-l,f=a-o,S=Math.sqrt(h*h+f*f),u=S>u?S:u;var m=a,y=s,w,k,C=e.polarRotation||0,A,T;for(h=0;h<s;h+=1)for(f=0;f<a;f+=1)d=h-l,g=f-o,w=Math.sqrt(d*d+g*g)*m/u,k=(Math.atan2(g,d)*180/Math.PI+360+C)%360,k=k*y/360,A=Math.floor(k),T=Math.floor(w),c=(T*s+A)*4,p=i[c+0],v=i[c+1],b=i[c+2],_=i[c+3],c=(f*s+h)*4,n[c+0]=p,n[c+1]=v,n[c+2]=b,n[c+3]=_};const wd=function(r){var t=r.width,e=r.height,i,n,s,a,l,o,c,h,f,d,g=Math.round(this.kaleidoscopePower()),p=Math.round(this.kaleidoscopeAngle()),v=Math.floor(t*(p%360)/360);if(!(g<1)){var b=zo.Util.createCanvasElement();b.width=t,b.height=e;var _=b.getContext("2d").getImageData(0,0,t,e);zo.Util.releaseCanvas(b),bd(r,_,{polarCenterX:t/2,polarCenterY:e/2});for(var S=t/Math.pow(2,g);S<=8;)S=S*2,g-=1;S=Math.ceil(S);var u=S,m=0,y=u,w=1;for(v+S>t&&(m=u,y=0,w=-1),n=0;n<e;n+=1)for(i=m;i!==y;i+=w)s=Math.round(i+v)%t,f=(t*n+s)*4,l=_.data[f+0],o=_.data[f+1],c=_.data[f+2],h=_.data[f+3],d=(t*n+i)*4,_.data[d+0]=l,_.data[d+1]=o,_.data[d+2]=c,_.data[d+3]=h;for(n=0;n<e;n+=1)for(u=Math.floor(S),a=0;a<g;a+=1){for(i=0;i<u+1;i+=1)f=(t*n+i)*4,l=_.data[f+0],o=_.data[f+1],c=_.data[f+2],h=_.data[f+3],d=(t*n+u*2-i-1)*4,_.data[d+0]=l,_.data[d+1]=o,_.data[d+2]=c,_.data[d+3]=h;u*=2}Sd(_,r,{polarRotation:0})}};ys.Kaleidoscope=wd;xr.Factory.addGetterSetter(jc.Node,"kaleidoscopePower",2,(0,Wc.getNumberValidator)(),xr.Factory.afterSetFilter);xr.Factory.addGetterSetter(jc.Node,"kaleidoscopeAngle",0,(0,Wc.getNumberValidator)(),xr.Factory.afterSetFilter);var bs={};Object.defineProperty(bs,"__esModule",{value:!0});bs.Mask=void 0;const Ho=st,Cd=Ft,Ad=H;function $n(r,t,e){var i=(e*r.width+t)*4,n=[];return n.push(r.data[i++],r.data[i++],r.data[i++],r.data[i++]),n}function yn(r,t){return Math.sqrt(Math.pow(r[0]-t[0],2)+Math.pow(r[1]-t[1],2)+Math.pow(r[2]-t[2],2))}function kd(r){for(var t=[0,0,0],e=0;e<r.length;e++)t[0]+=r[e][0],t[1]+=r[e][1],t[2]+=r[e][2];return t[0]/=r.length,t[1]/=r.length,t[2]/=r.length,t}function Td(r,t){var e=$n(r,0,0),i=$n(r,r.width-1,0),n=$n(r,0,r.height-1),s=$n(r,r.width-1,r.height-1),a=t||10;if(yn(e,i)<a&&yn(i,s)<a&&yn(s,n)<a&&yn(n,e)<a){for(var l=kd([i,e,s,n]),o=[],c=0;c<r.width*r.height;c++){var h=yn(l,[r.data[c*4],r.data[c*4+1],r.data[c*4+2]]);o[c]=h<a?0:255}return o}}function Pd(r,t){for(var e=0;e<r.width*r.height;e++)r.data[4*e+3]=t[e]}function Ed(r,t,e){for(var i=[1,1,1,1,0,1,1,1,1],n=Math.round(Math.sqrt(i.length)),s=Math.floor(n/2),a=[],l=0;l<e;l++)for(var o=0;o<t;o++){for(var c=l*t+o,h=0,f=0;f<n;f++)for(var d=0;d<n;d++){var g=l+f-s,p=o+d-s;if(g>=0&&g<e&&p>=0&&p<t){var v=g*t+p,b=i[f*n+d];h+=r[v]*b}}a[c]=h===255*8?255:0}return a}function xd(r,t,e){for(var i=[1,1,1,1,1,1,1,1,1],n=Math.round(Math.sqrt(i.length)),s=Math.floor(n/2),a=[],l=0;l<e;l++)for(var o=0;o<t;o++){for(var c=l*t+o,h=0,f=0;f<n;f++)for(var d=0;d<n;d++){var g=l+f-s,p=o+d-s;if(g>=0&&g<e&&p>=0&&p<t){var v=g*t+p,b=i[f*n+d];h+=r[v]*b}}a[c]=h>=255*4?255:0}return a}function Md(r,t,e){for(var i=[.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111],n=Math.round(Math.sqrt(i.length)),s=Math.floor(n/2),a=[],l=0;l<e;l++)for(var o=0;o<t;o++){for(var c=l*t+o,h=0,f=0;f<n;f++)for(var d=0;d<n;d++){var g=l+f-s,p=o+d-s;if(g>=0&&g<e&&p>=0&&p<t){var v=g*t+p,b=i[f*n+d];h+=r[v]*b}}a[c]=h}return a}const Fd=function(r){var t=this.threshold(),e=Td(r,t);return e&&(e=Ed(e,r.width,r.height),e=xd(e,r.width,r.height),e=Md(e,r.width,r.height),Pd(r,e)),r};bs.Mask=Fd;Ho.Factory.addGetterSetter(Cd.Node,"threshold",0,(0,Ad.getNumberValidator)(),Ho.Factory.afterSetFilter);var Ss={};Object.defineProperty(Ss,"__esModule",{value:!0});Ss.Noise=void 0;const jo=st,Rd=Ft,Nd=H,Ld=function(r){var t=this.noise()*255,e=r.data,i=e.length,n=t/2,s;for(s=0;s<i;s+=4)e[s+0]+=n-2*n*Math.random(),e[s+1]+=n-2*n*Math.random(),e[s+2]+=n-2*n*Math.random()};Ss.Noise=Ld;jo.Factory.addGetterSetter(Rd.Node,"noise",.2,(0,Nd.getNumberValidator)(),jo.Factory.afterSetFilter);var ws={};Object.defineProperty(ws,"__esModule",{value:!0});ws.Pixelate=void 0;const Wo=st,Id=It,Dd=Ft,Gd=H,Od=function(r){var t=Math.ceil(this.pixelSize()),e=r.width,i=r.height,n,s,a,l,o,c,h,f=Math.ceil(e/t),d=Math.ceil(i/t),g,p,v,b,_,S,u,m=r.data;if(t<=0){Id.Util.error("pixelSize value can not be <= 0");return}for(_=0;_<f;_+=1)for(S=0;S<d;S+=1){for(l=0,o=0,c=0,h=0,g=_*t,p=g+t,v=S*t,b=v+t,u=0,n=g;n<p;n+=1)if(!(n>=e))for(s=v;s<b;s+=1)s>=i||(a=(e*s+n)*4,l+=m[a+0],o+=m[a+1],c+=m[a+2],h+=m[a+3],u+=1);for(l=l/u,o=o/u,c=c/u,h=h/u,n=g;n<p;n+=1)if(!(n>=e))for(s=v;s<b;s+=1)s>=i||(a=(e*s+n)*4,m[a+0]=l,m[a+1]=o,m[a+2]=c,m[a+3]=h)}};ws.Pixelate=Od;Wo.Factory.addGetterSetter(Dd.Node,"pixelSize",8,(0,Gd.getNumberValidator)(),Wo.Factory.afterSetFilter);var Cs={};Object.defineProperty(Cs,"__esModule",{value:!0});Cs.Posterize=void 0;const Xo=st,Bd=Ft,Ud=H,Vd=function(r){var t=Math.round(this.levels()*254)+1,e=r.data,i=e.length,n=255/t,s;for(s=0;s<i;s+=1)e[s]=Math.floor(e[s]/n)*n};Cs.Posterize=Vd;Xo.Factory.addGetterSetter(Bd.Node,"levels",.5,(0,Ud.getNumberValidator)(),Xo.Factory.afterSetFilter);var As={};Object.defineProperty(As,"__esModule",{value:!0});As.RGB=void 0;const Mr=st,$a=Ft,zd=H,Hd=function(r){var t=r.data,e=t.length,i=this.red(),n=this.green(),s=this.blue(),a,l;for(a=0;a<e;a+=4)l=(.34*t[a]+.5*t[a+1]+.16*t[a+2])/255,t[a]=l*i,t[a+1]=l*n,t[a+2]=l*s,t[a+3]=t[a+3]};As.RGB=Hd;Mr.Factory.addGetterSetter($a.Node,"red",0,function(r){return this._filterUpToDate=!1,r>255?255:r<0?0:Math.round(r)});Mr.Factory.addGetterSetter($a.Node,"green",0,function(r){return this._filterUpToDate=!1,r>255?255:r<0?0:Math.round(r)});Mr.Factory.addGetterSetter($a.Node,"blue",0,zd.RGBComponent,Mr.Factory.afterSetFilter);var ks={};Object.defineProperty(ks,"__esModule",{value:!0});ks.RGBA=void 0;const Fn=st,Ts=Ft,jd=H,Wd=function(r){var t=r.data,e=t.length,i=this.red(),n=this.green(),s=this.blue(),a=this.alpha(),l,o;for(l=0;l<e;l+=4)o=1-a,t[l]=i*a+t[l]*o,t[l+1]=n*a+t[l+1]*o,t[l+2]=s*a+t[l+2]*o};ks.RGBA=Wd;Fn.Factory.addGetterSetter(Ts.Node,"red",0,function(r){return this._filterUpToDate=!1,r>255?255:r<0?0:Math.round(r)});Fn.Factory.addGetterSetter(Ts.Node,"green",0,function(r){return this._filterUpToDate=!1,r>255?255:r<0?0:Math.round(r)});Fn.Factory.addGetterSetter(Ts.Node,"blue",0,jd.RGBComponent,Fn.Factory.afterSetFilter);Fn.Factory.addGetterSetter(Ts.Node,"alpha",1,function(r){return this._filterUpToDate=!1,r>1?1:r<0?0:r});var Ps={};Object.defineProperty(Ps,"__esModule",{value:!0});Ps.Sepia=void 0;const Xd=function(r){var t=r.data,e=t.length,i,n,s,a;for(i=0;i<e;i+=4)n=t[i+0],s=t[i+1],a=t[i+2],t[i+0]=Math.min(255,n*.393+s*.769+a*.189),t[i+1]=Math.min(255,n*.349+s*.686+a*.168),t[i+2]=Math.min(255,n*.272+s*.534+a*.131)};Ps.Sepia=Xd;var Es={};Object.defineProperty(Es,"__esModule",{value:!0});Es.Solarize=void 0;const Yd=function(r){var t=r.data,e=r.width,i=r.height,n=e*4,s=i;do{var a=(s-1)*n,l=e;do{var o=a+(l-1)*4,c=t[o],h=t[o+1],f=t[o+2];c>127&&(c=255-c),h>127&&(h=255-h),f>127&&(f=255-f),t[o]=c,t[o+1]=h,t[o+2]=f}while(--l)}while(--s)};Es.Solarize=Yd;var xs={};Object.defineProperty(xs,"__esModule",{value:!0});xs.Threshold=void 0;const Yo=st,Kd=Ft,$d=H,qd=function(r){var t=this.threshold()*255,e=r.data,i=e.length,n;for(n=0;n<i;n+=1)e[n]=e[n]<t?0:255};xs.Threshold=qd;Yo.Factory.addGetterSetter(Kd.Node,"threshold",.5,(0,$d.getNumberValidator)(),Yo.Factory.afterSetFilter);Object.defineProperty(Or,"__esModule",{value:!0});Or.Konva=void 0;const Ko=hc,Jd=jr,Qd=Yr,Zd=qr,t1=Jr,e1=Qr,$o=nn,i1=Bn,n1=dn,r1=Vn,s1=es,a1=is,o1=ns,l1=rs,c1=Ei,h1=ss,u1=as,f1=os,d1=cs,g1=hs,p1=us,m1=fs,_1=gs,v1=ps,y1=ms,b1=_s,S1=vs,w1=ys,C1=bs,A1=Ss,k1=ws,T1=Cs,P1=As,E1=ks,x1=Ps,M1=Es,F1=xs;Or.Konva=Ko.Konva.Util._assign(Ko.Konva,{Arc:Jd.Arc,Arrow:Qd.Arrow,Circle:Zd.Circle,Ellipse:t1.Ellipse,Image:e1.Image,Label:$o.Label,Tag:$o.Tag,Line:i1.Line,Path:n1.Path,Rect:r1.Rect,RegularPolygon:s1.RegularPolygon,Ring:a1.Ring,Sprite:o1.Sprite,Star:l1.Star,Text:c1.Text,TextPath:h1.TextPath,Transformer:u1.Transformer,Wedge:f1.Wedge,Filters:{Blur:d1.Blur,Brighten:g1.Brighten,Contrast:p1.Contrast,Emboss:m1.Emboss,Enhance:_1.Enhance,Grayscale:v1.Grayscale,HSL:y1.HSL,HSV:b1.HSV,Invert:S1.Invert,Kaleidoscope:w1.Kaleidoscope,Mask:C1.Mask,Noise:A1.Noise,Pixelate:k1.Pixelate,Posterize:T1.Posterize,RGB:P1.RGB,RGBA:E1.RGBA,Sepia:x1.Sepia,Solarize:M1.Solarize,Threshold:F1.Threshold}});var R1=Ia.exports;Object.defineProperty(R1,"__esModule",{value:!0});const N1=Or;Ia.exports=N1.Konva;var L1=Ia.exports;const zn=Iu(L1),I1=["mouseover","mouseout","mouseenter","mouseleave","mousemove","mousedown","mouseup","wheel","click","dblclick","touchstart","touchmove","touchend","tap","dbltap","pointerdown","pointermove","pointerup","pointercancel","pointerover","pointerenter","pointerout","pointerleave","pointerclick","pointerdblclick","dragstart","dragmove","dragend","transformstart","transform","transformend"];function Hn(r,t){I1.forEach(e=>{t.on(e,i=>{r(e,i,{cancelable:!0})||(i.cancelBubble=!0)})})}const Fr=["svelte-konva-stage","svelte-konva-layer","svelte-konva-group","svelte-konva-label"];var Rn;(function(r){r[r.Stage=0]="Stage",r[r.Layer=1]="Layer",r[r.Group=2]="Group",r[r.Label=3]="Label"})(Rn||(Rn={}));const D1="svelte-konva: Component does not have any parent container. Please make sure that the component is wrapped inside a Layer or Group.",G1="svelte-konva: A Layer needs to have a Stage as parent.";function Xc(r,t){Fr.forEach(e=>{Ti(e,null)}),Ti(Fr[r],t)}function qa(){for(let r=1;r<4;r++){const t=Ae(Fr[r]);if(t)return t}throw new Error(D1)}function O1(){const r=Ae(Fr[Rn.Stage]);if(r)return r;throw new Error(G1)}function Ke(r,t){for(const e in r)Object.prototype.hasOwnProperty.call(t,e)&&(r[e]=t[e])}function B1(r,t,e){let i,{config:n}=t,{handle:s=new zn.Circle(n)}=t,{staticConfig:a=!1}=t,l=qa();ci(r,l,c=>e(4,i=c));let o=Ln();return on(()=>{i.add(s),a||(s.on("transformend",()=>{Ke(n,s.getAttrs()),e(1,n)}),s.on("dragend",()=>{Ke(n,s.getAttrs()),e(1,n)})),Hn(o,s)}),In(()=>{s.destroy()}),r.$$set=c=>{"config"in c&&e(1,n=c.config),"handle"in c&&e(2,s=c.handle),"staticConfig"in c&&e(3,a=c.staticConfig)},r.$$.update=()=>{r.$$.dirty&6&&s.setAttrs(n)},[l,n,s,a]}class U1 extends Nt{constructor(t){super(),Lt(this,t,B1,null,Mt,{config:1,handle:2,staticConfig:3})}}function V1(r,t,e){let i,{config:n}=t,{handle:s=new zn.Image(n)}=t,{staticConfig:a=!1}=t,l=qa();ci(r,l,c=>e(4,i=c));let o=Ln();return on(()=>{i.add(s),a||(s.on("transformend",()=>{Ke(n,s.getAttrs()),e(1,n)}),s.on("dragend",()=>{Ke(n,s.getAttrs()),e(1,n)})),Hn(o,s)}),In(()=>{s.destroy()}),r.$$set=c=>{"config"in c&&e(1,n=c.config),"handle"in c&&e(2,s=c.handle),"staticConfig"in c&&e(3,a=c.staticConfig)},r.$$.update=()=>{r.$$.dirty&6&&s.setAttrs(n)},[l,n,s,a]}class z1 extends Nt{constructor(t){super(),Lt(this,t,V1,null,Mt,{config:1,handle:2,staticConfig:3})}}function qo(r){let t;const e=r[6].default,i=te(e,r,r[5],null);return{c(){i&&i.c()},l(n){i&&i.l(n)},m(n,s){i&&i.m(n,s),t=!0},p(n,s){i&&i.p&&(!t||s&32)&&ee(i,e,n,n[5],t?ne(e,n[5],s,null):ie(n[5]),null)},i(n){t||(L(i,n),t=!0)},o(n){O(i,n),t=!1},d(n){i&&i.d(n)}}}function H1(r){let t,e,i=r[0]&&qo(r);return{c(){i&&i.c(),t=Xt()},l(n){i&&i.l(n),t=Xt()},m(n,s){i&&i.m(n,s),G(n,t,s),e=!0},p(n,[s]){n[0]?i?(i.p(n,s),s&1&&L(i,1)):(i=qo(n),i.c(),L(i,1),i.m(t.parentNode,t)):i&&(ge(),O(i,1,1,()=>{i=null}),pe())},i(n){e||(L(i),e=!0)},o(n){O(i),e=!1},d(n){n&&F(t),i&&i.d(n)}}}function j1(r,t,e){let i,{$$slots:n={},$$scope:s}=t,{config:a={}}=t,{handle:l=new zn.Layer(a)}=t,{staticConfig:o=!1}=t,c=ln(null),h=Ln(),f=!1,d=O1();return ci(r,d,g=>e(7,i=g)),on(()=>{i.add(l),o||(l.on("transformend",()=>{Ke(a,l.getAttrs()),e(2,a)}),l.on("dragend",()=>{Ke(a,l.getAttrs()),e(2,a)})),Hn(h,l),c.set(l),e(0,f=!0)}),In(()=>{l&&l.destroy()}),Xc(Rn.Layer,c),r.$$set=g=>{"config"in g&&e(2,a=g.config),"handle"in g&&e(3,l=g.handle),"staticConfig"in g&&e(4,o=g.staticConfig),"$$scope"in g&&e(5,s=g.$$scope)},r.$$.update=()=>{r.$$.dirty&12&&l&&l.setAttrs(a)},[f,d,a,l,o,s,n]}class W1 extends Nt{constructor(t){super(),Lt(this,t,j1,H1,Mt,{config:2,handle:3,staticConfig:4})}}function X1(r,t,e){let i,{config:n}=t,{handle:s=new zn.Rect(n)}=t,{staticConfig:a=!1}=t,l=qa();ci(r,l,c=>e(4,i=c));let o=Ln();return on(()=>{i.add(s),a||(s.on("transformend",()=>{Ke(n,s.getAttrs()),e(1,n)}),s.on("dragend",()=>{Ke(n,s.getAttrs()),e(1,n)})),Hn(o,s)}),In(()=>{s.destroy()}),r.$$set=c=>{"config"in c&&e(1,n=c.config),"handle"in c&&e(2,s=c.handle),"staticConfig"in c&&e(3,a=c.staticConfig)},r.$$.update=()=>{r.$$.dirty&6&&s.setAttrs(n)},[l,n,s,a]}class Yc extends Nt{constructor(t){super(),Lt(this,t,X1,null,Mt,{config:1,handle:2,staticConfig:3})}}function Jo(r){let t;const e=r[7].default,i=te(e,r,r[6],null);return{c(){i&&i.c()},l(n){i&&i.l(n)},m(n,s){i&&i.m(n,s),t=!0},p(n,s){i&&i.p&&(!t||s&64)&&ee(i,e,n,n[6],t?ne(e,n[6],s,null):ie(n[6]),null)},i(n){t||(L(i,n),t=!0)},o(n){O(i,n),t=!1},d(n){i&&i.d(n)}}}function Y1(r){let t,e,i=r[1]&&Jo(r),n=[r[2]],s={};for(let a=0;a<n.length;a+=1)s=J(s,n[a]);return{c(){t=ut("div"),i&&i.c(),this.h()},l(a){t=ft(a,"DIV",{});var l=at(t);i&&i.l(l),l.forEach(F),this.h()},h(){_e(t,s)},m(a,l){G(a,t,l),i&&i.m(t,null),r[8](t),e=!0},p(a,[l]){a[1]?i?(i.p(a,l),l&2&&L(i,1)):(i=Jo(a),i.c(),L(i,1),i.m(t,null)):i&&(ge(),O(i,1,1,()=>{i=null}),pe()),_e(t,s=Qt(n,[l&4&&a[2]]))},i(a){e||(L(i),e=!0)},o(a){O(i),e=!1},d(a){a&&F(t),i&&i.d(),r[8](null)}}}function K1(r,t,e){const i=["config","handle","staticConfig"];let n=kt(t,i),{$$slots:s={},$$scope:a}=t,{config:l}=t,{handle:o=null}=t,{staticConfig:c=!1}=t,h=ln(null),f,d=Ln(),g=!1;on(()=>{e(4,o=new zn.Stage({container:f,...l})),c||o.on("dragend",()=>{Ke(l,o.getAttrs()),e(3,l)}),Hn(d,o),h.set(o),e(1,g=!0)}),In(()=>{o&&o.destroy()}),Xc(Rn.Stage,h);function p(v){xi[v?"unshift":"push"](()=>{f=v,e(0,f)})}return r.$$set=v=>{t=J(J({},t),_t(v)),e(2,n=kt(t,i)),"config"in v&&e(3,l=v.config),"handle"in v&&e(4,o=v.handle),"staticConfig"in v&&e(5,c=v.staticConfig),"$$scope"in v&&e(6,a=v.$$scope)},r.$$.update=()=>{r.$$.dirty&24&&o&&o.setAttrs(l)},[f,g,n,l,o,c,a,s,p]}class $1 extends Nt{constructor(t){super(),Lt(this,t,K1,Y1,Mt,{config:3,handle:4,staticConfig:5})}}function Qo(r,t,e){const i=r.slice();return i[9]=t[e],i}function Zo(r){let t,e,i=Pe(r[0]),n=[];for(let s=0;s<i.length;s+=1)n[s]=tl(Qo(r,i,s));return{c(){t=ut("nav"),e=ut("ul");for(let s=0;s<n.length;s+=1)n[s].c();this.h()},l(s){t=ft(s,"NAV",{class:!0,style:!0});var a=at(t);e=ft(a,"UL",{class:!0});var l=at(e);for(let o=0;o<n.length;o+=1)n[o].l(l);l.forEach(F),a.forEach(F),this.h()},h(){Y(e,"class","svelte-clk954"),Y(t,"class","navbar svelte-clk954"),mn(t,"position","absolute"),mn(t,"top",r[2]+"px"),mn(t,"left",r[1]+"px")},m(s,a){G(s,t,a),Et(t,e);for(let l=0;l<n.length;l+=1)n[l]&&n[l].m(e,null)},p(s,a){if(a&9){i=Pe(s[0]);let l;for(l=0;l<i.length;l+=1){const o=Qo(s,i,l);n[l]?n[l].p(o,a):(n[l]=tl(o),n[l].c(),n[l].m(e,null))}for(;l<n.length;l+=1)n[l].d(1);n.length=i.length}a&4&&mn(t,"top",s[2]+"px"),a&2&&mn(t,"left",s[1]+"px")},d(s){s&&F(t),Pn(n,s)}}}function q1(r){let t,e,i=r[9].name+"",n,s,a,l;function o(){return r[8](r[9])}return{c(){t=ut("li"),e=ut("button"),n=dt(i),s=bt(),this.h()},l(c){t=ft(c,"LI",{class:!0});var h=at(t);e=ft(h,"BUTTON",{class:!0});var f=at(e);n=gt(f,i),f.forEach(F),s=St(h),h.forEach(F),this.h()},h(){Y(e,"class","svelte-clk954"),Y(t,"class","svelte-clk954")},m(c,h){G(c,t,h),Et(t,e),Et(e,n),Et(t,s),a||(l=z(e,"click",o),a=!0)},p(c,h){r=c,h&1&&i!==(i=r[9].name+"")&&Ye(n,i)},d(c){c&&F(t),a=!1,l()}}}function J1(r){let t,e=r[9].name+"",i;return{c(){t=ut("li"),i=dt(e),this.h()},l(n){t=ft(n,"LI",{class:!0});var s=at(t);i=gt(s,e),s.forEach(F),this.h()},h(){Y(t,"class","group svelte-clk954")},m(n,s){G(n,t,s),Et(t,i)},p(n,s){s&1&&e!==(e=n[9].name+"")&&Ye(i,e)},d(n){n&&F(t)}}}function Q1(r){let t;return{c(){t=ut("hr"),this.h()},l(e){t=ft(e,"HR",{class:!0}),this.h()},h(){Y(t,"class","svelte-clk954")},m(e,i){G(e,t,i)},p:Yt,d(e){e&&F(t)}}}function tl(r){let t;function e(s,a){return s[9].name===""?Q1:s[9].onClick?q1:J1}let i=e(r),n=i(r);return{c(){n.c(),t=Xt()},l(s){n.l(s),t=Xt()},m(s,a){n.m(s,a),G(s,t,a)},p(s,a){i===(i=e(s))&&n?n.p(s,a):(n.d(1),n=i(s),n&&(n.c(),n.m(t.parentNode,t)))},d(s){s&&F(t),n.d(s)}}}function Z1(r){let t,e,i,n=r[3]&&Zo(r);return{c(){n&&n.c(),t=Xt()},l(s){n&&n.l(s),t=Xt()},m(s,a){n&&n.m(s,a),G(s,t,a),e||(i=[z(window,"contextmenu",_h(r[6])),z(window,"click",r[7])],e=!0)},p(s,[a]){s[3]?n?n.p(s,a):(n=Zo(s),n.c(),n.m(t.parentNode,t)):n&&(n.d(1),n=null)},i:Yt,o:Yt,d(s){s&&F(t),n&&n.d(s),e=!1,Mi(i)}}}const el=16;function t2(r,t,e){let i;const n=(d,g)=>{i.length!==0&&(e(1,a=d-el),e(2,l=g-el),e(3,o=!o))},s=d=>e(0,i=d);let a=0,l=0,o=!1;return[i,a,l,o,n,s,()=>e(3,o=!1),()=>e(3,o=!1),d=>{d.onClick&&(e(3,o=!1),d.onClick(d.extra))}]}class e2 extends Nt{constructor(t){super(),Lt(this,t,t2,Z1,Mt,{toggleAt:4,setItems:5})}get toggleAt(){return this.$$.ctx[4]}get setItems(){return this.$$.ctx[5]}}function i2(r){let t,e,i,n,s,a,l,o;return{c(){t=ut("p"),e=dt(r[0]),i=bt(),n=We("svg"),s=We("path"),a=bt(),l=ut("p"),o=dt(r[1]),this.h()},l(c){t=ft(c,"P",{class:!0});var h=at(t);e=gt(h,r[0]),h.forEach(F),i=St(c),n=Xe(c,"svg",{"aria-hidden":!0,class:!0,fill:!0,stroke:!0,viewBox:!0,xmlns:!0});var f=at(n);s=Xe(f,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),at(s).forEach(F),f.forEach(F),a=St(c),l=ft(c,"P",{class:!0});var d=at(l);o=gt(d,r[1]),d.forEach(F),this.h()},h(){Y(t,"class","mb-2 text-lg text-gray-500 dark:text-gray-400 font-semibold"),Y(s,"stroke-linecap","round"),Y(s,"stroke-linejoin","round"),Y(s,"stroke-width","2"),Y(s,"d","M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"),Y(n,"aria-hidden","true"),Y(n,"class","mb-3 w-10 h-10 text-gray-400"),Y(n,"fill","none"),Y(n,"stroke","currentColor"),Y(n,"viewBox","0 0 24 24"),Y(n,"xmlns","http://www.w3.org/2000/svg"),Y(l,"class","mb-2 text-sm text-gray-500 dark:text-gray-400")},m(c,h){G(c,t,h),Et(t,e),G(c,i,h),G(c,n,h),Et(n,s),G(c,a,h),G(c,l,h),Et(l,o)},p(c,h){h&1&&Ye(e,c[0]),h&2&&Ye(o,c[1])},d(c){c&&(F(t),F(i),F(n),F(a),F(l))}}}function n2(r){let t,e;return t=new Qh({props:{class:"m-4",$$slots:{default:[i2]},$$scope:{ctx:r}}}),t.$on("dragover",r2),t.$on("drop",r[2]),t.$on("change",r[3]),{c(){Q(t.$$.fragment)},l(i){Z(t.$$.fragment,i)},m(i,n){tt(t,i,n),e=!0},p(i,[n]){const s={};n&67&&(s.$$scope={dirty:n,ctx:i}),t.$set(s)},i(i){e||(L(t.$$.fragment,i),e=!0)},o(i){O(t.$$.fragment,i),e=!1},d(i){et(t,i)}}}const r2=r=>r.preventDefault();function s2(r,t,e){let{title:i}=t,{description:n}=t,{onUpload:s}=t;const a=c=>{const h=new FileReader;h.addEventListener("load",f=>{f.target&&f.target.result&&!(f.target.result instanceof ArrayBuffer)&&s(f.target.result,c.name)}),h.readAsDataURL(c)},l=c=>{if(c.preventDefault(),c.dataTransfer){if(c.dataTransfer.items&&c.dataTransfer.items.length>0){if(c.dataTransfer.items[0].kind==="file"){const h=c.dataTransfer.items[0].getAsFile();h&&a(h)}}else if(c.dataTransfer.files&&c.dataTransfer.files.length>0){const h=c.dataTransfer.files[0];h&&a(h)}}},o=c=>{const h=c.target.files;h&&h.length>0&&a(h[0])};return r.$$set=c=>{"title"in c&&e(0,i=c.title),"description"in c&&e(1,n=c.description),"onUpload"in c&&e(4,s=c.onUpload)},[i,n,l,o,s]}class a2 extends Nt{constructor(t){super(),Lt(this,t,s2,n2,Mt,{title:0,description:1,onUpload:4})}}const Kc=0,o2=1,l2=2,il=2,Ws=1.25,nl=1,br=6*4+4+4,Ms=65535,c2=Math.pow(2,-24),Xs=Symbol("SKIP_GENERATION");function h2(r){return r.index?r.index.count:r.attributes.position.count}function pn(r){return h2(r)/3}function u2(r,t=ArrayBuffer){return r>65535?new Uint32Array(new t(4*r)):new Uint16Array(new t(2*r))}function f2(r,t){if(!r.index){const e=r.attributes.position.count,i=t.useSharedArrayBuffer?SharedArrayBuffer:ArrayBuffer,n=u2(e,i);r.setIndex(new Gr(n,1));for(let s=0;s<e;s++)n[s]=s}}function $c(r){const t=pn(r),e=r.drawRange,i=e.start/3,n=(e.start+e.count)/3,s=Math.max(0,i),a=Math.min(t,n)-s;return[{offset:Math.floor(s),count:Math.floor(a)}]}function qc(r){if(!r.groups||!r.groups.length)return $c(r);const t=[],e=new Set,i=r.drawRange,n=i.start/3,s=(i.start+i.count)/3;for(const l of r.groups){const o=l.start/3,c=(l.start+l.count)/3;e.add(Math.max(n,o)),e.add(Math.min(s,c))}const a=Array.from(e.values()).sort((l,o)=>l-o);for(let l=0;l<a.length-1;l++){const o=a[l],c=a[l+1];t.push({offset:Math.floor(o),count:Math.floor(c-o)})}return t}function d2(r){if(r.groups.length===0)return!1;const t=pn(r),e=qc(r).sort((s,a)=>s.offset-a.offset),i=e[e.length-1];i.count=Math.min(t-i.offset,i.count);let n=0;return e.forEach(({count:s})=>n+=s),t!==n}function Rt(r,t,e){return e.min.x=t[r],e.min.y=t[r+1],e.min.z=t[r+2],e.max.x=t[r+3],e.max.y=t[r+4],e.max.z=t[r+5],e}function g2(r){r[0]=r[1]=r[2]=1/0,r[3]=r[4]=r[5]=-1/0}function rl(r){let t=-1,e=-1/0;for(let i=0;i<3;i++){const n=r[i+3]-r[i];n>e&&(e=n,t=i)}return t}function sl(r,t){t.set(r)}function al(r,t,e){let i,n;for(let s=0;s<3;s++){const a=s+3;i=r[s],n=t[s],e[s]=i<n?i:n,i=r[a],n=t[a],e[a]=i>n?i:n}}function qn(r,t,e){for(let i=0;i<3;i++){const n=t[r+2*i],s=t[r+2*i+1],a=n-s,l=n+s;a<e[i]&&(e[i]=a),l>e[i+3]&&(e[i+3]=l)}}function bn(r){const t=r[3]-r[0],e=r[4]-r[1],i=r[5]-r[2];return 2*(t*e+e*i+i*t)}function Ys(r,t,e,i,n=null){let s=1/0,a=1/0,l=1/0,o=-1/0,c=-1/0,h=-1/0,f=1/0,d=1/0,g=1/0,p=-1/0,v=-1/0,b=-1/0;const _=n!==null;for(let S=t*6,u=(t+e)*6;S<u;S+=6){const m=r[S+0],y=r[S+1],w=m-y,k=m+y;w<s&&(s=w),k>o&&(o=k),_&&m<f&&(f=m),_&&m>p&&(p=m);const C=r[S+2],A=r[S+3],T=C-A,P=C+A;T<a&&(a=T),P>c&&(c=P),_&&C<d&&(d=C),_&&C>v&&(v=C);const E=r[S+4],M=r[S+5],R=E-M,N=E+M;R<l&&(l=R),N>h&&(h=N),_&&E<g&&(g=E),_&&E>b&&(b=E)}i[0]=s,i[1]=a,i[2]=l,i[3]=o,i[4]=c,i[5]=h,_&&(n[0]=f,n[1]=d,n[2]=g,n[3]=p,n[4]=v,n[5]=b)}function p2(r,t,e,i){let n=1/0,s=1/0,a=1/0,l=-1/0,o=-1/0,c=-1/0;for(let h=t*6,f=(t+e)*6;h<f;h+=6){const d=r[h+0];d<n&&(n=d),d>l&&(l=d);const g=r[h+2];g<s&&(s=g),g>o&&(o=g);const p=r[h+4];p<a&&(a=p),p>c&&(c=p)}i[0]=n,i[1]=s,i[2]=a,i[3]=l,i[4]=o,i[5]=c}function m2(r,t){g2(t);const e=r.attributes.position,i=r.index?r.index.array:null,n=pn(r),s=new Float32Array(n*6),a=e.normalized,l=e.array,o=e.offset||0;let c=3;e.isInterleavedBufferAttribute&&(c=e.data.stride);const h=["getX","getY","getZ"];for(let f=0;f<n;f++){const d=f*3,g=f*6;let p=d+0,v=d+1,b=d+2;i&&(p=i[p],v=i[v],b=i[b]),a||(p=p*c+o,v=v*c+o,b=b*c+o);for(let _=0;_<3;_++){let S,u,m;a?(S=e[h[_]](p),u=e[h[_]](v),m=e[h[_]](b)):(S=l[p+_],u=l[v+_],m=l[b+_]);let y=S;u<y&&(y=u),m<y&&(y=m);let w=S;u>w&&(w=u),m>w&&(w=m);const k=(w-y)/2,C=_*2;s[g+C+0]=y+k,s[g+C+1]=k+(Math.abs(y)+k)*c2,y<t[_]&&(t[_]=y),w>t[_+3]&&(t[_+3]=w)}}return s}const Ve=32,_2=(r,t)=>r.candidate-t.candidate,ei=new Array(Ve).fill().map(()=>({count:0,bounds:new Float32Array(6),rightCacheBounds:new Float32Array(6),leftCacheBounds:new Float32Array(6),candidate:0})),Jn=new Float32Array(6);function v2(r,t,e,i,n,s){let a=-1,l=0;if(s===Kc)a=rl(t),a!==-1&&(l=(t[a]+t[a+3])/2);else if(s===o2)a=rl(r),a!==-1&&(l=y2(e,i,n,a));else if(s===l2){const o=bn(r);let c=Ws*n;const h=i*6,f=(i+n)*6;for(let d=0;d<3;d++){const g=t[d],b=(t[d+3]-g)/Ve;if(n<Ve/4){const _=[...ei];_.length=n;let S=0;for(let m=h;m<f;m+=6,S++){const y=_[S];y.candidate=e[m+2*d],y.count=0;const{bounds:w,leftCacheBounds:k,rightCacheBounds:C}=y;for(let A=0;A<3;A++)C[A]=1/0,C[A+3]=-1/0,k[A]=1/0,k[A+3]=-1/0,w[A]=1/0,w[A+3]=-1/0;qn(m,e,w)}_.sort(_2);let u=n;for(let m=0;m<u;m++){const y=_[m];for(;m+1<u&&_[m+1].candidate===y.candidate;)_.splice(m+1,1),u--}for(let m=h;m<f;m+=6){const y=e[m+2*d];for(let w=0;w<u;w++){const k=_[w];y>=k.candidate?qn(m,e,k.rightCacheBounds):(qn(m,e,k.leftCacheBounds),k.count++)}}for(let m=0;m<u;m++){const y=_[m],w=y.count,k=n-y.count,C=y.leftCacheBounds,A=y.rightCacheBounds;let T=0;w!==0&&(T=bn(C)/o);let P=0;k!==0&&(P=bn(A)/o);const E=nl+Ws*(T*w+P*k);E<c&&(a=d,c=E,l=y.candidate)}}else{for(let u=0;u<Ve;u++){const m=ei[u];m.count=0,m.candidate=g+b+u*b;const y=m.bounds;for(let w=0;w<3;w++)y[w]=1/0,y[w+3]=-1/0}for(let u=h;u<f;u+=6){let w=~~((e[u+2*d]-g)/b);w>=Ve&&(w=Ve-1);const k=ei[w];k.count++,qn(u,e,k.bounds)}const _=ei[Ve-1];sl(_.bounds,_.rightCacheBounds);for(let u=Ve-2;u>=0;u--){const m=ei[u],y=ei[u+1];al(m.bounds,y.rightCacheBounds,m.rightCacheBounds)}let S=0;for(let u=0;u<Ve-1;u++){const m=ei[u],y=m.count,w=m.bounds,C=ei[u+1].rightCacheBounds;y!==0&&(S===0?sl(w,Jn):al(w,Jn,Jn)),S+=y;let A=0,T=0;S!==0&&(A=bn(Jn)/o);const P=n-S;P!==0&&(T=bn(C)/o);const E=nl+Ws*(A*S+T*P);E<c&&(a=d,c=E,l=m.candidate)}}}}else console.warn(`MeshBVH: Invalid build strategy value ${s} used.`);return{axis:a,pos:l}}function y2(r,t,e,i){let n=0;for(let s=t,a=t+e;s<a;s++)n+=r[s*6+i*2];return n/e}class Qn{constructor(){}}function b2(r,t,e,i,n,s){let a=i,l=i+n-1;const o=s.pos,c=s.axis*2;for(;;){for(;a<=l&&e[a*6+c]<o;)a++;for(;a<=l&&e[l*6+c]>=o;)l--;if(a<l){for(let h=0;h<3;h++){let f=t[a*3+h];t[a*3+h]=t[l*3+h],t[l*3+h]=f}for(let h=0;h<6;h++){let f=e[a*6+h];e[a*6+h]=e[l*6+h],e[l*6+h]=f}a++,l--}else return a}}function S2(r,t,e,i,n,s){let a=i,l=i+n-1;const o=s.pos,c=s.axis*2;for(;;){for(;a<=l&&e[a*6+c]<o;)a++;for(;a<=l&&e[l*6+c]>=o;)l--;if(a<l){let h=r[a];r[a]=r[l],r[l]=h;for(let f=0;f<6;f++){let d=e[a*6+f];e[a*6+f]=e[l*6+f],e[l*6+f]=d}a++,l--}else return a}}function w2(r,t){const e=(r.index?r.index.count:r.attributes.position.count)/3,i=e>2**16,n=i?4:2,s=t?new SharedArrayBuffer(e*n):new ArrayBuffer(e*n),a=i?new Uint32Array(s):new Uint16Array(s);for(let l=0,o=a.length;l<o;l++)a[l]=l;return a}function C2(r,t){const e=r.geometry,i=e.index?e.index.array:null,n=t.maxDepth,s=t.verbose,a=t.maxLeafTris,l=t.strategy,o=t.onProgress,c=pn(e),h=r._indirectBuffer;let f=!1;const d=new Float32Array(6),g=new Float32Array(6),p=m2(e,d),v=t.indirect?S2:b2,b=[],_=t.indirect?$c(e):qc(e);if(_.length===1){const m=_[0],y=new Qn;y.boundingData=d,p2(p,m.offset,m.count,g),u(y,m.offset,m.count,g),b.push(y)}else for(let m of _){const y=new Qn;y.boundingData=new Float32Array(6),Ys(p,m.offset,m.count,y.boundingData,g),u(y,m.offset,m.count,g),b.push(y)}return b;function S(m){o&&o(m/c)}function u(m,y,w,k=null,C=0){if(!f&&C>=n&&(f=!0,s&&(console.warn(`MeshBVH: Max depth of ${n} reached when generating BVH. Consider increasing maxDepth.`),console.warn(e))),w<=a||C>=n)return S(y+w),m.offset=y,m.count=w,m;const A=v2(m.boundingData,k,p,y,w,l);if(A.axis===-1)return S(y+w),m.offset=y,m.count=w,m;const T=v(h,i,p,y,w,A);if(T===y||T===y+w)S(y+w),m.offset=y,m.count=w;else{m.splitAxis=A.axis;const P=new Qn,E=y,M=T-y;m.left=P,P.boundingData=new Float32Array(6),Ys(p,E,M,P.boundingData,g),u(P,E,M,g,C+1);const R=new Qn,N=T,B=w-M;m.right=R,R.boundingData=new Float32Array(6),Ys(p,N,B,R.boundingData,g),u(R,N,B,g,C+1)}return m}}function A2(r,t){const e=r.geometry;t.indirect&&(r._indirectBuffer=w2(e,t.useSharedArrayBuffer),d2(e)&&!t.verbose&&console.warn('MeshBVH: Provided geometry contains groups that do not fully span the vertex contents while using the "indirect" option. BVH may incorrectly report intersections on unrendered portions of the geometry.')),r._indirectBuffer||f2(e,t);const i=C2(r,t);let n,s,a;const l=[],o=t.useSharedArrayBuffer?SharedArrayBuffer:ArrayBuffer;for(let f=0;f<i.length;f++){const d=i[f];let g=c(d);const p=new o(br*g);n=new Float32Array(p),s=new Uint32Array(p),a=new Uint16Array(p),h(0,d),l.push(p)}r._roots=l;return;function c(f){return f.count?1:1+c(f.left)+c(f.right)}function h(f,d){const g=f/4,p=f/2,v=!!d.count,b=d.boundingData;for(let _=0;_<6;_++)n[g+_]=b[_];if(v){const _=d.offset,S=d.count;return s[g+6]=_,a[p+14]=S,a[p+15]=Ms,f+br}else{const _=d.left,S=d.right,u=d.splitAxis;let m;if(m=h(f+br,_),m/4>Math.pow(2,32))throw new Error("MeshBVH: Cannot store child pointer greater than 32 bits.");return s[g+6]=m/4,m=h(m,S),s[g+7]=u,m}}}class $e{constructor(){this.min=1/0,this.max=-1/0}setFromPointsField(t,e){let i=1/0,n=-1/0;for(let s=0,a=t.length;s<a;s++){const o=t[s][e];i=o<i?o:i,n=o>n?o:n}this.min=i,this.max=n}setFromPoints(t,e){let i=1/0,n=-1/0;for(let s=0,a=e.length;s<a;s++){const l=e[s],o=t.dot(l);i=o<i?o:i,n=o>n?o:n}this.min=i,this.max=n}isSeparated(t){return this.min>t.max||t.min>this.max}}$e.prototype.setFromBox=function(){const r=new V;return function(e,i){const n=i.min,s=i.max;let a=1/0,l=-1/0;for(let o=0;o<=1;o++)for(let c=0;c<=1;c++)for(let h=0;h<=1;h++){r.x=n.x*o+s.x*(1-o),r.y=n.y*c+s.y*(1-c),r.z=n.z*h+s.z*(1-h);const f=e.dot(r);a=Math.min(f,a),l=Math.max(f,l)}this.min=a,this.max=l}}();const k2=function(){const r=new V,t=new V,e=new V;return function(n,s,a){const l=n.start,o=r,c=s.start,h=t;e.subVectors(l,c),r.subVectors(n.end,n.start),t.subVectors(s.end,s.start);const f=e.dot(h),d=h.dot(o),g=h.dot(h),p=e.dot(o),b=o.dot(o)*g-d*d;let _,S;b!==0?_=(f*d-p*g)/b:_=0,S=(f+_*d)/g,a.x=_,a.y=S}}(),Ja=function(){const r=new Pi,t=new V,e=new V;return function(n,s,a,l){k2(n,s,r);let o=r.x,c=r.y;if(o>=0&&o<=1&&c>=0&&c<=1){n.at(o,a),s.at(c,l);return}else if(o>=0&&o<=1){c<0?s.at(0,l):s.at(1,l),n.closestPointToPoint(l,!0,a);return}else if(c>=0&&c<=1){o<0?n.at(0,a):n.at(1,a),s.closestPointToPoint(a,!0,l);return}else{let h;o<0?h=n.start:h=n.end;let f;c<0?f=s.start:f=s.end;const d=t,g=e;if(n.closestPointToPoint(f,!0,t),s.closestPointToPoint(h,!0,e),d.distanceToSquared(f)<=g.distanceToSquared(h)){a.copy(d),l.copy(f);return}else{a.copy(h),l.copy(g);return}}}}(),T2=function(){const r=new V,t=new V,e=new Na,i=new me;return function(s,a){const{radius:l,center:o}=s,{a:c,b:h,c:f}=a;if(i.start=c,i.end=h,i.closestPointToPoint(o,!0,r).distanceTo(o)<=l||(i.start=c,i.end=f,i.closestPointToPoint(o,!0,r).distanceTo(o)<=l)||(i.start=h,i.end=f,i.closestPointToPoint(o,!0,r).distanceTo(o)<=l))return!0;const v=a.getPlane(e);if(Math.abs(v.distanceToPoint(o))<=l){const _=v.projectPoint(o,t);if(a.containsPoint(_))return!0}return!1}}(),P2=1e-15;function Ks(r){return Math.abs(r)<P2}class ve extends ae{constructor(...t){super(...t),this.isExtendedTriangle=!0,this.satAxes=new Array(4).fill().map(()=>new V),this.satBounds=new Array(4).fill().map(()=>new $e),this.points=[this.a,this.b,this.c],this.sphere=new Ah,this.plane=new Na,this.needsUpdate=!0}intersectsSphere(t){return T2(t,this)}update(){const t=this.a,e=this.b,i=this.c,n=this.points,s=this.satAxes,a=this.satBounds,l=s[0],o=a[0];this.getNormal(l),o.setFromPoints(l,n);const c=s[1],h=a[1];c.subVectors(t,e),h.setFromPoints(c,n);const f=s[2],d=a[2];f.subVectors(e,i),d.setFromPoints(f,n);const g=s[3],p=a[3];g.subVectors(i,t),p.setFromPoints(g,n),this.sphere.setFromPoints(this.points),this.plane.setFromNormalAndCoplanarPoint(l,t),this.needsUpdate=!1}}ve.prototype.closestPointToSegment=function(){const r=new V,t=new V,e=new me;return function(n,s=null,a=null){const{start:l,end:o}=n,c=this.points;let h,f=1/0;for(let d=0;d<3;d++){const g=(d+1)%3;e.start.copy(c[d]),e.end.copy(c[g]),Ja(e,n,r,t),h=r.distanceToSquared(t),h<f&&(f=h,s&&s.copy(r),a&&a.copy(t))}return this.closestPointToPoint(l,r),h=l.distanceToSquared(r),h<f&&(f=h,s&&s.copy(r),a&&a.copy(l)),this.closestPointToPoint(o,r),h=o.distanceToSquared(r),h<f&&(f=h,s&&s.copy(r),a&&a.copy(o)),Math.sqrt(f)}}();ve.prototype.intersectsTriangle=function(){const r=new ve,t=new Array(3),e=new Array(3),i=new $e,n=new $e,s=new V,a=new V,l=new V,o=new V,c=new V,h=new me,f=new me,d=new me,g=new V;function p(v,b,_){const S=v.points;let u=0,m=-1;for(let y=0;y<3;y++){const{start:w,end:k}=h;w.copy(S[y]),k.copy(S[(y+1)%3]),h.delta(a);const C=Ks(b.distanceToPoint(w));if(Ks(b.normal.dot(a))&&C){_.copy(h),u=2;break}const A=b.intersectLine(h,g);if(!A&&C&&g.copy(w),(A||C)&&!Ks(g.distanceTo(k))){if(u<=1)(u===1?_.start:_.end).copy(g),C&&(m=u);else if(u>=2){(m===1?_.start:_.end).copy(g),u=2;break}if(u++,u===2&&m===-1)break}}return u}return function(b,_=null,S=!1){this.needsUpdate&&this.update(),b.isExtendedTriangle?b.needsUpdate&&b.update():(r.copy(b),r.update(),b=r);const u=this.plane,m=b.plane;if(Math.abs(u.normal.dot(m.normal))>1-1e-10){const y=this.satBounds,w=this.satAxes;e[0]=b.a,e[1]=b.b,e[2]=b.c;for(let A=0;A<4;A++){const T=y[A],P=w[A];if(i.setFromPoints(P,e),T.isSeparated(i))return!1}const k=b.satBounds,C=b.satAxes;t[0]=this.a,t[1]=this.b,t[2]=this.c;for(let A=0;A<4;A++){const T=k[A],P=C[A];if(i.setFromPoints(P,t),T.isSeparated(i))return!1}for(let A=0;A<4;A++){const T=w[A];for(let P=0;P<4;P++){const E=C[P];if(s.crossVectors(T,E),i.setFromPoints(s,t),n.setFromPoints(s,e),i.isSeparated(n))return!1}}return _&&(S||console.warn("ExtendedTriangle.intersectsTriangle: Triangles are coplanar which does not support an output edge. Setting edge to 0, 0, 0."),_.start.set(0,0,0),_.end.set(0,0,0)),!0}else{const y=p(this,m,f);if(y===1&&b.containsPoint(f.end))return _&&(_.start.copy(f.end),_.end.copy(f.end)),!0;if(y!==2)return!1;const w=p(b,u,d);if(w===1&&this.containsPoint(d.end))return _&&(_.start.copy(d.end),_.end.copy(d.end)),!0;if(w!==2)return!1;if(f.delta(l),d.delta(o),l.dot(o)<0){let M=d.start;d.start=d.end,d.end=M}const k=f.start.dot(l),C=f.end.dot(l),A=d.start.dot(l),T=d.end.dot(l),P=C<A,E=k<T;return k!==T&&A!==C&&P===E?!1:(_&&(c.subVectors(f.start,d.start),c.dot(l)>0?_.start.copy(f.start):_.start.copy(d.start),c.subVectors(f.end,d.end),c.dot(l)<0?_.end.copy(f.end):_.end.copy(d.end)),!0)}}}();ve.prototype.distanceToPoint=function(){const r=new V;return function(e){return this.closestPointToPoint(e,r),e.distanceTo(r)}}();ve.prototype.distanceToTriangle=function(){const r=new V,t=new V,e=["a","b","c"],i=new me,n=new me;return function(a,l=null,o=null){const c=l||o?i:null;if(this.intersectsTriangle(a,c))return(l||o)&&(l&&c.getCenter(l),o&&c.getCenter(o)),0;let h=1/0;for(let f=0;f<3;f++){let d;const g=e[f],p=a[g];this.closestPointToPoint(p,r),d=p.distanceToSquared(r),d<h&&(h=d,l&&l.copy(r),o&&o.copy(p));const v=this[g];a.closestPointToPoint(v,r),d=v.distanceToSquared(r),d<h&&(h=d,l&&l.copy(v),o&&o.copy(r))}for(let f=0;f<3;f++){const d=e[f],g=e[(f+1)%3];i.set(this[d],this[g]);for(let p=0;p<3;p++){const v=e[p],b=e[(p+1)%3];n.set(a[v],a[b]),Ja(i,n,r,t);const _=r.distanceToSquared(t);_<h&&(h=_,l&&l.copy(r),o&&o.copy(t))}}return Math.sqrt(h)}}();class Zt{constructor(t,e,i){this.isOrientedBox=!0,this.min=new V,this.max=new V,this.matrix=new Me,this.invMatrix=new Me,this.points=new Array(8).fill().map(()=>new V),this.satAxes=new Array(3).fill().map(()=>new V),this.satBounds=new Array(3).fill().map(()=>new $e),this.alignedSatBounds=new Array(3).fill().map(()=>new $e),this.needsUpdate=!1,t&&this.min.copy(t),e&&this.max.copy(e),i&&this.matrix.copy(i)}set(t,e,i){this.min.copy(t),this.max.copy(e),this.matrix.copy(i),this.needsUpdate=!0}copy(t){this.min.copy(t.min),this.max.copy(t.max),this.matrix.copy(t.matrix),this.needsUpdate=!0}}Zt.prototype.update=function(){return function(){const t=this.matrix,e=this.min,i=this.max,n=this.points;for(let c=0;c<=1;c++)for(let h=0;h<=1;h++)for(let f=0;f<=1;f++){const d=1*c|2*h|4*f,g=n[d];g.x=c?i.x:e.x,g.y=h?i.y:e.y,g.z=f?i.z:e.z,g.applyMatrix4(t)}const s=this.satBounds,a=this.satAxes,l=n[0];for(let c=0;c<3;c++){const h=a[c],f=s[c],d=1<<c,g=n[d];h.subVectors(l,g),f.setFromPoints(h,n)}const o=this.alignedSatBounds;o[0].setFromPointsField(n,"x"),o[1].setFromPointsField(n,"y"),o[2].setFromPointsField(n,"z"),this.invMatrix.copy(this.matrix).invert(),this.needsUpdate=!1}}();Zt.prototype.intersectsBox=function(){const r=new $e;return function(e){this.needsUpdate&&this.update();const i=e.min,n=e.max,s=this.satBounds,a=this.satAxes,l=this.alignedSatBounds;if(r.min=i.x,r.max=n.x,l[0].isSeparated(r)||(r.min=i.y,r.max=n.y,l[1].isSeparated(r))||(r.min=i.z,r.max=n.z,l[2].isSeparated(r)))return!1;for(let o=0;o<3;o++){const c=a[o],h=s[o];if(r.setFromBox(c,e),h.isSeparated(r))return!1}return!0}}();Zt.prototype.intersectsTriangle=function(){const r=new ve,t=new Array(3),e=new $e,i=new $e,n=new V;return function(a){this.needsUpdate&&this.update(),a.isExtendedTriangle?a.needsUpdate&&a.update():(r.copy(a),r.update(),a=r);const l=this.satBounds,o=this.satAxes;t[0]=a.a,t[1]=a.b,t[2]=a.c;for(let d=0;d<3;d++){const g=l[d],p=o[d];if(e.setFromPoints(p,t),g.isSeparated(e))return!1}const c=a.satBounds,h=a.satAxes,f=this.points;for(let d=0;d<3;d++){const g=c[d],p=h[d];if(e.setFromPoints(p,f),g.isSeparated(e))return!1}for(let d=0;d<3;d++){const g=o[d];for(let p=0;p<4;p++){const v=h[p];if(n.crossVectors(g,v),e.setFromPoints(n,t),i.setFromPoints(n,f),e.isSeparated(i))return!1}}return!0}}();Zt.prototype.closestPointToPoint=function(){return function(t,e){return this.needsUpdate&&this.update(),e.copy(t).applyMatrix4(this.invMatrix).clamp(this.min,this.max).applyMatrix4(this.matrix),e}}();Zt.prototype.distanceToPoint=function(){const r=new V;return function(e){return this.closestPointToPoint(e,r),e.distanceTo(r)}}();Zt.prototype.distanceToBox=function(){const r=["x","y","z"],t=new Array(12).fill().map(()=>new me),e=new Array(12).fill().map(()=>new me),i=new V,n=new V;return function(a,l=0,o=null,c=null){if(this.needsUpdate&&this.update(),this.intersectsBox(a))return(o||c)&&(a.getCenter(n),this.closestPointToPoint(n,i),a.closestPointToPoint(i,n),o&&o.copy(i),c&&c.copy(n)),0;const h=l*l,f=a.min,d=a.max,g=this.points;let p=1/0;for(let b=0;b<8;b++){const _=g[b];n.copy(_).clamp(f,d);const S=_.distanceToSquared(n);if(S<p&&(p=S,o&&o.copy(_),c&&c.copy(n),S<h))return Math.sqrt(S)}let v=0;for(let b=0;b<3;b++)for(let _=0;_<=1;_++)for(let S=0;S<=1;S++){const u=(b+1)%3,m=(b+2)%3,y=_<<u|S<<m,w=1<<b|_<<u|S<<m,k=g[y],C=g[w];t[v].set(k,C);const T=r[b],P=r[u],E=r[m],M=e[v],R=M.start,N=M.end;R[T]=f[T],R[P]=_?f[P]:d[P],R[E]=S?f[E]:d[P],N[T]=d[T],N[P]=_?f[P]:d[P],N[E]=S?f[E]:d[P],v++}for(let b=0;b<=1;b++)for(let _=0;_<=1;_++)for(let S=0;S<=1;S++){n.x=b?d.x:f.x,n.y=_?d.y:f.y,n.z=S?d.z:f.z,this.closestPointToPoint(n,i);const u=n.distanceToSquared(i);if(u<p&&(p=u,o&&o.copy(i),c&&c.copy(n),u<h))return Math.sqrt(u)}for(let b=0;b<12;b++){const _=t[b];for(let S=0;S<12;S++){const u=e[S];Ja(_,u,i,n);const m=i.distanceToSquared(n);if(m<p&&(p=m,o&&o.copy(i),c&&c.copy(n),m<h))return Math.sqrt(m)}}return Math.sqrt(p)}}();class Qa{constructor(t){this._getNewPrimitive=t,this._primitives=[]}getPrimitive(){const t=this._primitives;return t.length===0?this._getNewPrimitive():t.pop()}releasePrimitive(t){this._primitives.push(t)}}class E2 extends Qa{constructor(){super(()=>new ve)}}const he=new E2;function se(r,t){return t[r+15]===65535}function oe(r,t){return t[r+6]}function ue(r,t){return t[r+14]}function fe(r){return r+8}function de(r,t){return t[r+6]}function Jc(r,t){return t[r+7]}class x2{constructor(){this.float32Array=null,this.uint16Array=null,this.uint32Array=null;const t=[];let e=null;this.setBuffer=i=>{e&&t.push(e),e=i,this.float32Array=new Float32Array(i),this.uint16Array=new Uint16Array(i),this.uint32Array=new Uint32Array(i)},this.clearBuffer=()=>{e=null,this.float32Array=null,this.uint16Array=null,this.uint32Array=null,t.length!==0&&this.setBuffer(t.pop())}}}const xt=new x2;let oi,en;const ji=[],Zn=new Qa(()=>new ke);function M2(r,t,e,i,n,s){oi=Zn.getPrimitive(),en=Zn.getPrimitive(),ji.push(oi,en),xt.setBuffer(r._roots[t]);const a=Ca(0,r.geometry,e,i,n,s);xt.clearBuffer(),Zn.releasePrimitive(oi),Zn.releasePrimitive(en),ji.pop(),ji.pop();const l=ji.length;return l>0&&(en=ji[l-1],oi=ji[l-2]),a}function Ca(r,t,e,i,n=null,s=0,a=0){const{float32Array:l,uint16Array:o,uint32Array:c}=xt;let h=r*2;if(se(h,o)){const d=oe(r,c),g=ue(h,o);return Rt(r,l,oi),i(d,g,!1,a,s+r,oi)}else{let T=function(E){const{uint16Array:M,uint32Array:R}=xt;let N=E*2;for(;!se(N,M);)E=fe(E),N=E*2;return oe(E,R)},P=function(E){const{uint16Array:M,uint32Array:R}=xt;let N=E*2;for(;!se(N,M);)E=de(E,R),N=E*2;return oe(E,R)+ue(N,M)};const d=fe(r),g=de(r,c);let p=d,v=g,b,_,S,u;if(n&&(S=oi,u=en,Rt(p,l,S),Rt(v,l,u),b=n(S),_=n(u),_<b)){p=g,v=d;const E=b;b=_,_=E,S=u}S||(S=oi,Rt(p,l,S));const m=se(p*2,o),y=e(S,m,b,a+1,s+p);let w;if(y===il){const E=T(p),R=P(p)-E;w=i(E,R,!0,a+1,s+p,S)}else w=y&&Ca(p,t,e,i,n,s,a+1);if(w)return!0;u=en,Rt(v,l,u);const k=se(v*2,o),C=e(u,k,_,a+1,s+v);let A;if(C===il){const E=T(v),R=P(v)-E;A=i(E,R,!0,a+1,s+v,u)}else A=C&&Ca(v,t,e,i,n,s,a+1);return!!A}}const Sn=new V,$s=new V;function F2(r,t,e={},i=0,n=1/0){const s=i*i,a=n*n;let l=1/0,o=null;if(r.shapecast({boundsTraverseOrder:h=>(Sn.copy(t).clamp(h.min,h.max),Sn.distanceToSquared(t)),intersectsBounds:(h,f,d)=>d<l&&d<a,intersectsTriangle:(h,f)=>{h.closestPointToPoint(t,Sn);const d=t.distanceToSquared(Sn);return d<l&&($s.copy(Sn),l=d,o=f),d<s}}),l===1/0)return null;const c=Math.sqrt(l);return e.point?e.point.copy($s):e.point=$s.clone(),e.distance=c,e.faceIndex=o,e}const Wi=new V,Xi=new V,Yi=new V,tr=new Pi,er=new Pi,ir=new Pi,ol=new V,ll=new V,cl=new V,nr=new V;function R2(r,t,e,i,n,s){let a;return s===kh?a=r.intersectTriangle(i,e,t,!0,n):a=r.intersectTriangle(t,e,i,s!==La,n),a===null?null:{distance:r.origin.distanceTo(n),point:n.clone()}}function N2(r,t,e,i,n,s,a,l,o){Wi.fromBufferAttribute(t,s),Xi.fromBufferAttribute(t,a),Yi.fromBufferAttribute(t,l);const c=R2(r,Wi,Xi,Yi,nr,o);if(c){i&&(tr.fromBufferAttribute(i,s),er.fromBufferAttribute(i,a),ir.fromBufferAttribute(i,l),c.uv=ae.getInterpolation(nr,Wi,Xi,Yi,tr,er,ir,new Pi)),n&&(tr.fromBufferAttribute(n,s),er.fromBufferAttribute(n,a),ir.fromBufferAttribute(n,l),c.uv1=ae.getInterpolation(nr,Wi,Xi,Yi,tr,er,ir,new Pi)),e&&(ol.fromBufferAttribute(e,s),ll.fromBufferAttribute(e,a),cl.fromBufferAttribute(e,l),c.normal=ae.getInterpolation(nr,Wi,Xi,Yi,ol,ll,cl,new V),c.normal.dot(r.direction)>0&&c.normal.multiplyScalar(-1));const h={a:s,b:a,c:l,normal:new V,materialIndex:0};ae.getNormal(Wi,Xi,Yi,h.normal),c.face=h,c.faceIndex=s}return c}function Fs(r,t,e,i,n){const s=i*3;let a=s+0,l=s+1,o=s+2;const c=r.index;r.index&&(a=c.getX(a),l=c.getX(l),o=c.getX(o));const{position:h,normal:f,uv:d,uv1:g}=r.attributes,p=N2(e,h,f,d,g,a,l,o,t);return p?(p.faceIndex=i,n&&n.push(p),p):null}function zt(r,t,e,i){const n=r.a,s=r.b,a=r.c;let l=t,o=t+1,c=t+2;e&&(l=e.getX(l),o=e.getX(o),c=e.getX(c)),n.x=i.getX(l),n.y=i.getY(l),n.z=i.getZ(l),s.x=i.getX(o),s.y=i.getY(o),s.z=i.getZ(o),a.x=i.getX(c),a.y=i.getY(c),a.z=i.getZ(c)}function L2(r,t,e,i,n,s){const{geometry:a,_indirectBuffer:l}=r;for(let o=i,c=i+n;o<c;o++)Fs(a,t,e,o,s)}function I2(r,t,e,i,n){const{geometry:s,_indirectBuffer:a}=r;let l=1/0,o=null;for(let c=i,h=i+n;c<h;c++){let f;f=Fs(s,t,e,c),f&&f.distance<l&&(o=f,l=f.distance)}return o}function D2(r,t,e,i,n,s,a){const{geometry:l}=e,{index:o}=l,c=l.attributes.position;for(let h=r,f=t+r;h<f;h++){let d;if(d=h,zt(a,d*3,o,c),a.needsUpdate=!0,i(a,d,n,s))return!0}return!1}function G2(r,t=null){t&&Array.isArray(t)&&(t=new Set(t));const e=r.geometry,i=e.index?e.index.array:null,n=e.attributes.position;let s,a,l,o,c=0;const h=r._roots;for(let d=0,g=h.length;d<g;d++)s=h[d],a=new Uint32Array(s),l=new Uint16Array(s),o=new Float32Array(s),f(0,c),c+=s.byteLength;function f(d,g,p=!1){const v=d*2;if(l[v+15]===Ms){const _=a[d+6],S=l[v+14];let u=1/0,m=1/0,y=1/0,w=-1/0,k=-1/0,C=-1/0;for(let A=3*_,T=3*(_+S);A<T;A++){let P=i[A];const E=n.getX(P),M=n.getY(P),R=n.getZ(P);E<u&&(u=E),E>w&&(w=E),M<m&&(m=M),M>k&&(k=M),R<y&&(y=R),R>C&&(C=R)}return o[d+0]!==u||o[d+1]!==m||o[d+2]!==y||o[d+3]!==w||o[d+4]!==k||o[d+5]!==C?(o[d+0]=u,o[d+1]=m,o[d+2]=y,o[d+3]=w,o[d+4]=k,o[d+5]=C,!0):!1}else{const _=d+8,S=a[d+6],u=_+g,m=S+g;let y=p,w=!1,k=!1;t?y||(w=t.has(u),k=t.has(m),y=!w&&!k):(w=!0,k=!0);const C=y||w,A=y||k;let T=!1;C&&(T=f(_,g,y));let P=!1;A&&(P=f(S,g,y));const E=T||P;if(E)for(let M=0;M<3;M++){const R=_+M,N=S+M,B=o[R],q=o[R+3],nt=o[N],ct=o[N+3];o[d+M]=B<nt?B:nt,o[d+M+3]=q>ct?q:ct}return E}}}const hl=new ke;function fi(r,t,e,i){return Rt(r,t,hl),e.intersectBox(hl,i)}function O2(r,t,e,i,n,s){const{geometry:a,_indirectBuffer:l}=r;for(let o=i,c=i+n;o<c;o++){let h=l?l[o]:o;Fs(a,t,e,h,s)}}function B2(r,t,e,i,n){const{geometry:s,_indirectBuffer:a}=r;let l=1/0,o=null;for(let c=i,h=i+n;c<h;c++){let f;f=Fs(s,t,e,a?a[c]:c),f&&f.distance<l&&(o=f,l=f.distance)}return o}function U2(r,t,e,i,n,s,a){const{geometry:l}=e,{index:o}=l,c=l.attributes.position;for(let h=r,f=t+r;h<f;h++){let d;if(d=e.resolveTriangleIndex(h),zt(a,d*3,o,c),a.needsUpdate=!0,i(a,d,n,s))return!0}return!1}const ul=new V;function V2(r,t,e,i,n){xt.setBuffer(r._roots[t]),Aa(0,r,e,i,n),xt.clearBuffer()}function Aa(r,t,e,i,n){const{float32Array:s,uint16Array:a,uint32Array:l}=xt,o=r*2;if(se(o,a)){const h=oe(r,l),f=ue(o,a);L2(t,e,i,h,f,n)}else{const h=fe(r);fi(h,s,i,ul)&&Aa(h,t,e,i,n);const f=de(r,l);fi(f,s,i,ul)&&Aa(f,t,e,i,n)}}const fl=new V,z2=["x","y","z"];function H2(r,t,e,i){xt.setBuffer(r._roots[t]);const n=ka(0,r,e,i);return xt.clearBuffer(),n}function ka(r,t,e,i){const{float32Array:n,uint16Array:s,uint32Array:a}=xt;let l=r*2;if(se(l,s)){const c=oe(r,a),h=ue(l,s);return I2(t,e,i,c,h)}else{const c=Jc(r,a),h=z2[c],d=i.direction[h]>=0;let g,p;d?(g=fe(r),p=de(r,a)):(g=de(r,a),p=fe(r));const b=fi(g,n,i,fl)?ka(g,t,e,i):null;if(b){const u=b.point[h];if(d?u<=n[p+c]:u>=n[p+c+3])return b}const S=fi(p,n,i,fl)?ka(p,t,e,i):null;return b&&S?b.distance<=S.distance?b:S:b||S||null}}const rr=new ke,Ki=new ve,$i=new ve,wn=new Me,dl=new Zt,sr=new Zt;function j2(r,t,e,i){xt.setBuffer(r._roots[t]);const n=Ta(0,r,e,i);return xt.clearBuffer(),n}function Ta(r,t,e,i,n=null){const{float32Array:s,uint16Array:a,uint32Array:l}=xt;let o=r*2;if(n===null&&(e.boundingBox||e.computeBoundingBox(),dl.set(e.boundingBox.min,e.boundingBox.max,i),n=dl),se(o,a)){const h=t.geometry,f=h.index,d=h.attributes.position,g=e.index,p=e.attributes.position,v=oe(r,l),b=ue(o,a);if(wn.copy(i).invert(),e.boundsTree)return Rt(r,s,sr),sr.matrix.copy(wn),sr.needsUpdate=!0,e.boundsTree.shapecast({intersectsBounds:S=>sr.intersectsBox(S),intersectsTriangle:S=>{S.a.applyMatrix4(i),S.b.applyMatrix4(i),S.c.applyMatrix4(i),S.needsUpdate=!0;for(let u=v*3,m=(b+v)*3;u<m;u+=3)if(zt($i,u,f,d),$i.needsUpdate=!0,S.intersectsTriangle($i))return!0;return!1}});for(let _=v*3,S=(b+v)*3;_<S;_+=3){zt(Ki,_,f,d),Ki.a.applyMatrix4(wn),Ki.b.applyMatrix4(wn),Ki.c.applyMatrix4(wn),Ki.needsUpdate=!0;for(let u=0,m=g.count;u<m;u+=3)if(zt($i,u,g,p),$i.needsUpdate=!0,Ki.intersectsTriangle($i))return!0}}else{const h=r+8,f=l[r+6];return Rt(h,s,rr),!!(n.intersectsBox(rr)&&Ta(h,t,e,i,n)||(Rt(f,s,rr),n.intersectsBox(rr)&&Ta(f,t,e,i,n)))}}const ar=new Me,qs=new Zt,Cn=new Zt,W2=new V,X2=new V,Y2=new V,K2=new V;function $2(r,t,e,i={},n={},s=0,a=1/0){t.boundingBox||t.computeBoundingBox(),qs.set(t.boundingBox.min,t.boundingBox.max,e),qs.needsUpdate=!0;const l=r.geometry,o=l.attributes.position,c=l.index,h=t.attributes.position,f=t.index,d=he.getPrimitive(),g=he.getPrimitive();let p=W2,v=X2,b=null,_=null;n&&(b=Y2,_=K2);let S=1/0,u=null,m=null;return ar.copy(e).invert(),Cn.matrix.copy(ar),r.shapecast({boundsTraverseOrder:y=>qs.distanceToBox(y),intersectsBounds:(y,w,k)=>k<S&&k<a?(w&&(Cn.min.copy(y.min),Cn.max.copy(y.max),Cn.needsUpdate=!0),!0):!1,intersectsRange:(y,w)=>{if(t.boundsTree)return t.boundsTree.shapecast({boundsTraverseOrder:C=>Cn.distanceToBox(C),intersectsBounds:(C,A,T)=>T<S&&T<a,intersectsRange:(C,A)=>{for(let T=C,P=C+A;T<P;T++){zt(g,3*T,f,h),g.a.applyMatrix4(e),g.b.applyMatrix4(e),g.c.applyMatrix4(e),g.needsUpdate=!0;for(let E=y,M=y+w;E<M;E++){zt(d,3*E,c,o),d.needsUpdate=!0;const R=d.distanceToTriangle(g,p,b);if(R<S&&(v.copy(p),_&&_.copy(b),S=R,u=E,m=T),R<s)return!0}}}});{const k=pn(t);for(let C=0,A=k;C<A;C++){zt(g,3*C,f,h),g.a.applyMatrix4(e),g.b.applyMatrix4(e),g.c.applyMatrix4(e),g.needsUpdate=!0;for(let T=y,P=y+w;T<P;T++){zt(d,3*T,c,o),d.needsUpdate=!0;const E=d.distanceToTriangle(g,p,b);if(E<S&&(v.copy(p),_&&_.copy(b),S=E,u=T,m=C),E<s)return!0}}}}}),he.releasePrimitive(d),he.releasePrimitive(g),S===1/0?null:(i.point?i.point.copy(v):i.point=v.clone(),i.distance=S,i.faceIndex=u,n&&(n.point?n.point.copy(_):n.point=_.clone(),n.point.applyMatrix4(ar),v.applyMatrix4(ar),n.distance=v.sub(n.point).length(),n.faceIndex=m),i)}function q2(r,t=null){t&&Array.isArray(t)&&(t=new Set(t));const e=r.geometry,i=e.index?e.index.array:null,n=e.attributes.position;let s,a,l,o,c=0;const h=r._roots;for(let d=0,g=h.length;d<g;d++)s=h[d],a=new Uint32Array(s),l=new Uint16Array(s),o=new Float32Array(s),f(0,c),c+=s.byteLength;function f(d,g,p=!1){const v=d*2;if(l[v+15]===Ms){const _=a[d+6],S=l[v+14];let u=1/0,m=1/0,y=1/0,w=-1/0,k=-1/0,C=-1/0;for(let A=_,T=_+S;A<T;A++){const P=3*r.resolveTriangleIndex(A);for(let E=0;E<3;E++){let M=P+E;M=i?i[M]:M;const R=n.getX(M),N=n.getY(M),B=n.getZ(M);R<u&&(u=R),R>w&&(w=R),N<m&&(m=N),N>k&&(k=N),B<y&&(y=B),B>C&&(C=B)}}return o[d+0]!==u||o[d+1]!==m||o[d+2]!==y||o[d+3]!==w||o[d+4]!==k||o[d+5]!==C?(o[d+0]=u,o[d+1]=m,o[d+2]=y,o[d+3]=w,o[d+4]=k,o[d+5]=C,!0):!1}else{const _=d+8,S=a[d+6],u=_+g,m=S+g;let y=p,w=!1,k=!1;t?y||(w=t.has(u),k=t.has(m),y=!w&&!k):(w=!0,k=!0);const C=y||w,A=y||k;let T=!1;C&&(T=f(_,g,y));let P=!1;A&&(P=f(S,g,y));const E=T||P;if(E)for(let M=0;M<3;M++){const R=_+M,N=S+M,B=o[R],q=o[R+3],nt=o[N],ct=o[N+3];o[d+M]=B<nt?B:nt,o[d+M+3]=q>ct?q:ct}return E}}}const gl=new V;function J2(r,t,e,i,n){xt.setBuffer(r._roots[t]),Pa(0,r,e,i,n),xt.clearBuffer()}function Pa(r,t,e,i,n){const{float32Array:s,uint16Array:a,uint32Array:l}=xt,o=r*2;if(se(o,a)){const h=oe(r,l),f=ue(o,a);O2(t,e,i,h,f,n)}else{const h=fe(r);fi(h,s,i,gl)&&Pa(h,t,e,i,n);const f=de(r,l);fi(f,s,i,gl)&&Pa(f,t,e,i,n)}}const pl=new V,Q2=["x","y","z"];function Z2(r,t,e,i){xt.setBuffer(r._roots[t]);const n=Ea(0,r,e,i);return xt.clearBuffer(),n}function Ea(r,t,e,i){const{float32Array:n,uint16Array:s,uint32Array:a}=xt;let l=r*2;if(se(l,s)){const c=oe(r,a),h=ue(l,s);return B2(t,e,i,c,h)}else{const c=Jc(r,a),h=Q2[c],d=i.direction[h]>=0;let g,p;d?(g=fe(r),p=de(r,a)):(g=de(r,a),p=fe(r));const b=fi(g,n,i,pl)?Ea(g,t,e,i):null;if(b){const u=b.point[h];if(d?u<=n[p+c]:u>=n[p+c+3])return b}const S=fi(p,n,i,pl)?Ea(p,t,e,i):null;return b&&S?b.distance<=S.distance?b:S:b||S||null}}const or=new ke,qi=new ve,Ji=new ve,An=new Me,ml=new Zt,lr=new Zt;function tg(r,t,e,i){xt.setBuffer(r._roots[t]);const n=xa(0,r,e,i);return xt.clearBuffer(),n}function xa(r,t,e,i,n=null){const{float32Array:s,uint16Array:a,uint32Array:l}=xt;let o=r*2;if(n===null&&(e.boundingBox||e.computeBoundingBox(),ml.set(e.boundingBox.min,e.boundingBox.max,i),n=ml),se(o,a)){const h=t.geometry,f=h.index,d=h.attributes.position,g=e.index,p=e.attributes.position,v=oe(r,l),b=ue(o,a);if(An.copy(i).invert(),e.boundsTree)return Rt(r,s,lr),lr.matrix.copy(An),lr.needsUpdate=!0,e.boundsTree.shapecast({intersectsBounds:S=>lr.intersectsBox(S),intersectsTriangle:S=>{S.a.applyMatrix4(i),S.b.applyMatrix4(i),S.c.applyMatrix4(i),S.needsUpdate=!0;for(let u=v,m=b+v;u<m;u++)if(zt(Ji,3*t.resolveTriangleIndex(u),f,d),Ji.needsUpdate=!0,S.intersectsTriangle(Ji))return!0;return!1}});for(let _=v,S=b+v;_<S;_++){const u=t.resolveTriangleIndex(_);zt(qi,3*u,f,d),qi.a.applyMatrix4(An),qi.b.applyMatrix4(An),qi.c.applyMatrix4(An),qi.needsUpdate=!0;for(let m=0,y=g.count;m<y;m+=3)if(zt(Ji,m,g,p),Ji.needsUpdate=!0,qi.intersectsTriangle(Ji))return!0}}else{const h=r+8,f=l[r+6];return Rt(h,s,or),!!(n.intersectsBox(or)&&xa(h,t,e,i,n)||(Rt(f,s,or),n.intersectsBox(or)&&xa(f,t,e,i,n)))}}const cr=new Me,Js=new Zt,kn=new Zt,eg=new V,ig=new V,ng=new V,rg=new V;function sg(r,t,e,i={},n={},s=0,a=1/0){t.boundingBox||t.computeBoundingBox(),Js.set(t.boundingBox.min,t.boundingBox.max,e),Js.needsUpdate=!0;const l=r.geometry,o=l.attributes.position,c=l.index,h=t.attributes.position,f=t.index,d=he.getPrimitive(),g=he.getPrimitive();let p=eg,v=ig,b=null,_=null;n&&(b=ng,_=rg);let S=1/0,u=null,m=null;return cr.copy(e).invert(),kn.matrix.copy(cr),r.shapecast({boundsTraverseOrder:y=>Js.distanceToBox(y),intersectsBounds:(y,w,k)=>k<S&&k<a?(w&&(kn.min.copy(y.min),kn.max.copy(y.max),kn.needsUpdate=!0),!0):!1,intersectsRange:(y,w)=>{if(t.boundsTree){const k=t.boundsTree;return k.shapecast({boundsTraverseOrder:C=>kn.distanceToBox(C),intersectsBounds:(C,A,T)=>T<S&&T<a,intersectsRange:(C,A)=>{for(let T=C,P=C+A;T<P;T++){const E=k.resolveTriangleIndex(T);zt(g,3*E,f,h),g.a.applyMatrix4(e),g.b.applyMatrix4(e),g.c.applyMatrix4(e),g.needsUpdate=!0;for(let M=y,R=y+w;M<R;M++){const N=r.resolveTriangleIndex(M);zt(d,3*N,c,o),d.needsUpdate=!0;const B=d.distanceToTriangle(g,p,b);if(B<S&&(v.copy(p),_&&_.copy(b),S=B,u=M,m=T),B<s)return!0}}}})}else{const k=pn(t);for(let C=0,A=k;C<A;C++){zt(g,3*C,f,h),g.a.applyMatrix4(e),g.b.applyMatrix4(e),g.c.applyMatrix4(e),g.needsUpdate=!0;for(let T=y,P=y+w;T<P;T++){const E=r.resolveTriangleIndex(T);zt(d,3*E,c,o),d.needsUpdate=!0;const M=d.distanceToTriangle(g,p,b);if(M<S&&(v.copy(p),_&&_.copy(b),S=M,u=T,m=C),M<s)return!0}}}}}),he.releasePrimitive(d),he.releasePrimitive(g),S===1/0?null:(i.point?i.point.copy(v):i.point=v.clone(),i.distance=S,i.faceIndex=u,n&&(n.point?n.point.copy(_):n.point=_.clone(),n.point.applyMatrix4(cr),v.applyMatrix4(cr),n.distance=v.sub(n.point).length(),n.faceIndex=m),i)}function ag(){return typeof SharedArrayBuffer<"u"}const En=new xt.constructor,Rr=new xt.constructor,si=new Qa(()=>new ke),Qi=new ke,Zi=new ke,Qs=new ke,Zs=new ke;let ta=!1;function og(r,t,e,i){if(ta)throw new Error("MeshBVH: Recursive calls to bvhcast not supported.");ta=!0;const n=r._roots,s=t._roots;let a,l=0,o=0;const c=new Me().copy(e).invert();for(let h=0,f=n.length;h<f;h++){En.setBuffer(n[h]),o=0;const d=si.getPrimitive();Rt(0,En.float32Array,d),d.applyMatrix4(c);for(let g=0,p=s.length;g<p&&(Rr.setBuffer(s[h]),a=be(0,0,e,c,i,l,o,0,0,d),Rr.clearBuffer(),o+=s[g].length,!a);g++);if(si.releasePrimitive(d),En.clearBuffer(),l+=n[h].length,a)break}return ta=!1,a}function be(r,t,e,i,n,s=0,a=0,l=0,o=0,c=null,h=!1){let f,d;h?(f=Rr,d=En):(f=En,d=Rr);const g=f.float32Array,p=f.uint32Array,v=f.uint16Array,b=d.float32Array,_=d.uint32Array,S=d.uint16Array,u=r*2,m=t*2,y=se(u,v),w=se(m,S);let k=!1;if(w&&y)h?k=n(oe(t,_),ue(t*2,S),oe(r,p),ue(r*2,v),o,a+t,l,s+r):k=n(oe(r,p),ue(r*2,v),oe(t,_),ue(t*2,S),l,s+r,o,a+t);else if(w){const C=si.getPrimitive();Rt(t,b,C),C.applyMatrix4(e);const A=fe(r),T=de(r,p);Rt(A,g,Qi),Rt(T,g,Zi);const P=C.intersectsBox(Qi),E=C.intersectsBox(Zi);k=P&&be(t,A,i,e,n,a,s,o,l+1,C,!h)||E&&be(t,T,i,e,n,a,s,o,l+1,C,!h),si.releasePrimitive(C)}else{const C=fe(t),A=de(t,_);Rt(C,b,Qs),Rt(A,b,Zs);const T=c.intersectsBox(Qs),P=c.intersectsBox(Zs);if(T&&P)k=be(r,C,e,i,n,s,a,l,o+1,c,h)||be(r,A,e,i,n,s,a,l,o+1,c,h);else if(T)if(y)k=be(r,C,e,i,n,s,a,l,o+1,c,h);else{const E=si.getPrimitive();E.copy(Qs).applyMatrix4(e);const M=fe(r),R=de(r,p);Rt(M,g,Qi),Rt(R,g,Zi);const N=E.intersectsBox(Qi),B=E.intersectsBox(Zi);k=N&&be(C,M,i,e,n,a,s,o,l+1,E,!h)||B&&be(C,R,i,e,n,a,s,o,l+1,E,!h),si.releasePrimitive(E)}else if(P)if(y)k=be(r,A,e,i,n,s,a,l,o+1,c,h);else{const E=si.getPrimitive();E.copy(Zs).applyMatrix4(e);const M=fe(r),R=de(r,p);Rt(M,g,Qi),Rt(R,g,Zi);const N=E.intersectsBox(Qi),B=E.intersectsBox(Zi);k=N&&be(A,M,i,e,n,a,s,o,l+1,E,!h)||B&&be(A,R,i,e,n,a,s,o,l+1,E,!h),si.releasePrimitive(E)}}return k}const hr=new Zt,_l=new ke;class Za{static serialize(t,e={}){e={cloneBuffers:!0,...e};const i=t.geometry,n=t._roots,s=t._indirectBuffer,a=i.getIndex();let l;return e.cloneBuffers?l={roots:n.map(o=>o.slice()),index:a.array.slice(),indirectBuffer:s?s.slice():null}:l={roots:n,index:a.array,indirectBuffer:s},l}static deserialize(t,e,i={}){i={setIndex:!0,indirect:!!t.indirectBuffer,...i};const{index:n,roots:s,indirectBuffer:a}=t,l=new Za(e,{...i,[Xs]:!0});if(l._roots=s,l._indirectBuffer=a||null,i.setIndex){const o=e.getIndex();if(o===null){const c=new Gr(t.index,1,!1);e.setIndex(c)}else o.array!==n&&(o.array.set(n),o.needsUpdate=!0)}return l}get indirect(){return!!this._indirectBuffer}constructor(t,e={}){if(t.isBufferGeometry){if(t.index&&t.index.isInterleavedBufferAttribute)throw new Error("MeshBVH: InterleavedBufferAttribute is not supported for the index attribute.")}else throw new Error("MeshBVH: Only BufferGeometries are supported.");if(e=Object.assign({strategy:Kc,maxDepth:40,maxLeafTris:10,verbose:!0,useSharedArrayBuffer:!1,setBoundingBox:!0,onProgress:null,indirect:!1,[Xs]:!1},e),e.useSharedArrayBuffer&&!ag())throw new Error("MeshBVH: SharedArrayBuffer is not available.");this.geometry=t,this._roots=null,this._indirectBuffer=null,e[Xs]||(A2(this,e),!t.boundingBox&&e.setBoundingBox&&(t.boundingBox=this.getBoundingBox(new ke)));const{_indirectBuffer:i}=this;this.resolveTriangleIndex=e.indirect?n=>i[n]:n=>n}refit(t=null){return(this.indirect?q2:G2)(this,t)}traverse(t,e=0){const i=this._roots[e],n=new Uint32Array(i),s=new Uint16Array(i);a(0);function a(l,o=0){const c=l*2,h=s[c+15]===Ms;if(h){const f=n[l+6],d=s[c+14];t(o,h,new Float32Array(i,l*4,6),f,d)}else{const f=l+br/4,d=n[l+6],g=n[l+7];t(o,h,new Float32Array(i,l*4,6),g)||(a(f,o+1),a(d,o+1))}}}raycast(t,e=ro){const i=this._roots,n=this.geometry,s=[],a=e.isMaterial,l=Array.isArray(e),o=n.groups,c=a?e.side:e,h=this.indirect?J2:V2;for(let f=0,d=i.length;f<d;f++){const g=l?e[o[f].materialIndex].side:c,p=s.length;if(h(this,f,g,t,s),l){const v=o[f].materialIndex;for(let b=p,_=s.length;b<_;b++)s[b].face.materialIndex=v}}return s}raycastFirst(t,e=ro){const i=this._roots,n=this.geometry,s=e.isMaterial,a=Array.isArray(e);let l=null;const o=n.groups,c=s?e.side:e,h=this.indirect?Z2:H2;for(let f=0,d=i.length;f<d;f++){const g=a?e[o[f].materialIndex].side:c,p=h(this,f,g,t);p!=null&&(l==null||p.distance<l.distance)&&(l=p,a&&(p.face.materialIndex=o[f].materialIndex))}return l}intersectsGeometry(t,e){let i=!1;const n=this._roots,s=this.indirect?tg:j2;for(let a=0,l=n.length;a<l&&(i=s(this,a,t,e),!i);a++);return i}shapecast(t){const e=he.getPrimitive(),i=this.indirect?U2:D2;let{boundsTraverseOrder:n,intersectsBounds:s,intersectsRange:a,intersectsTriangle:l}=t;if(a&&l){const f=a;a=(d,g,p,v,b)=>f(d,g,p,v,b)?!0:i(d,g,this,l,p,v,e)}else a||(l?a=(f,d,g,p)=>i(f,d,this,l,g,p,e):a=(f,d,g)=>g);let o=!1,c=0;const h=this._roots;for(let f=0,d=h.length;f<d;f++){const g=h[f];if(o=M2(this,f,s,a,n,c),o)break;c+=g.byteLength}return he.releasePrimitive(e),o}bvhcast(t,e,i){let{intersectsRanges:n,intersectsTriangles:s}=i;const a=he.getPrimitive(),l=this.geometry.index,o=this.geometry.attributes.position,c=this.indirect?p=>{const v=this.resolveTriangleIndex(p);zt(a,v*3,l,o)}:p=>{zt(a,p*3,l,o)},h=he.getPrimitive(),f=t.geometry.index,d=t.geometry.attributes.position,g=t.indirect?p=>{const v=t.resolveTriangleIndex(p);zt(h,v*3,f,d)}:p=>{zt(h,p*3,f,d)};if(s){const p=(v,b,_,S,u,m,y,w)=>{for(let k=_,C=_+S;k<C;k++){g(k),h.a.applyMatrix4(e),h.b.applyMatrix4(e),h.c.applyMatrix4(e),h.needsUpdate=!0;for(let A=v,T=v+b;A<T;A++)if(c(A),a.needsUpdate=!0,s(a,h,A,k,u,m,y,w))return!0}return!1};if(n){const v=n;n=function(b,_,S,u,m,y,w,k){return v(b,_,S,u,m,y,w,k)?!0:p(b,_,S,u,m,y,w,k)}}else n=p}return og(this,t,e,n)}intersectsBox(t,e){return hr.set(t.min,t.max,e),hr.needsUpdate=!0,this.shapecast({intersectsBounds:i=>hr.intersectsBox(i),intersectsTriangle:i=>hr.intersectsTriangle(i)})}intersectsSphere(t){return this.shapecast({intersectsBounds:e=>t.intersectsBox(e),intersectsTriangle:e=>e.intersectsSphere(t)})}closestPointToGeometry(t,e,i={},n={},s=0,a=1/0){return(this.indirect?sg:$2)(this,t,e,i,n,s,a)}closestPointToPoint(t,e={},i=0,n=1/0){return F2(this,t,e,i,n)}getBoundingBox(t){return t.makeEmpty(),this._roots.forEach(i=>{Rt(0,new Float32Array(i),_l),t.union(_l)}),t}}const Qc=1e-6,lg=Qc*.5,Zc=Math.pow(10,-Math.log10(Qc)),cg=lg*Zc;function xe(r){return~~(r*Zc+cg)}function hg(r){return`${xe(r.x)},${xe(r.y)}`}function vl(r){return`${xe(r.x)},${xe(r.y)},${xe(r.z)}`}function ug(r){return`${xe(r.x)},${xe(r.y)},${xe(r.z)},${xe(r.w)}`}function fg(r,t,e){e.direction.subVectors(t,r).normalize();const i=r.dot(e.direction);return e.origin.copy(r).addScaledVector(e.direction,-i),e}function th(){return typeof SharedArrayBuffer<"u"}function dg(r){if(r.buffer instanceof SharedArrayBuffer)return r;const t=r.constructor,e=r.buffer,i=new SharedArrayBuffer(e.byteLength),n=new Uint8Array(e);return new Uint8Array(i).set(n,0),new t(i)}function gg(r,t=ArrayBuffer){return r>65535?new Uint32Array(new t(4*r)):new Uint16Array(new t(2*r))}function pg(r,t){if(!r.index){const e=r.attributes.position.count,i=t.useSharedArrayBuffer?SharedArrayBuffer:ArrayBuffer,n=gg(e,i);r.setIndex(new Gr(n,1));for(let s=0;s<e;s++)n[s]=s}}function mg(r){return r.index?r.index.count:r.attributes.position.count}function to(r){return mg(r)/3}const _g=1e-8,vg=new V;function yg(r){return~~(r/3)}function bg(r){return r%3}function yl(r,t){return r.start-t.start}function bl(r,t){return vg.subVectors(t,r.origin).dot(r.direction)}function Sg(r,t,e,i=_g){r.sort(yl),t.sort(yl);for(let l=0;l<r.length;l++){const o=r[l];for(let c=0;c<t.length;c++){const h=t[c];if(!(h.start>o.end)){if(o.end<h.start||h.end<o.start)continue;if(o.start<=h.start&&o.end>=h.end)s(h.end,o.end)||r.splice(l+1,0,{start:h.end,end:o.end,index:o.index}),o.end=h.start,h.start=0,h.end=0;else if(o.start>=h.start&&o.end<=h.end)s(o.end,h.end)||t.splice(c+1,0,{start:o.end,end:h.end,index:h.index}),h.end=o.start,o.start=0,o.end=0;else if(o.start<=h.start&&o.end<=h.end){const f=o.end;o.end=h.start,h.start=f}else if(o.start>=h.start&&o.end>=h.end){const f=h.end;h.end=o.start,o.start=f}else throw new Error}if(e.has(o.index)||e.set(o.index,[]),e.has(h.index)||e.set(h.index,[]),e.get(o.index).push(h.index),e.get(h.index).push(o.index),a(h)&&(t.splice(c,1),c--),a(o)){r.splice(l,1),l--;break}}}n(r),n(t);function n(l){for(let o=0;o<l.length;o++)a(l[o])&&(l.splice(o,1),o--)}function s(l,o){return Math.abs(o-l)<i}function a(l){return Math.abs(l.end-l.start)<i}}const Sl=1e-5,wl=1e-4;class wg{constructor(){this._rays=[]}addRay(t){this._rays.push(t)}findClosestRay(t){const e=this._rays,i=t.clone();i.direction.multiplyScalar(-1);let n=1/0,s=null;for(let o=0,c=e.length;o<c;o++){const h=e[o];if(a(h,t)&&a(h,i))continue;const f=l(h,t),d=l(h,i),g=Math.min(f,d);g<n&&(n=g,s=h)}return s;function a(o,c){const h=o.origin.distanceTo(c.origin)>Sl;return o.direction.angleTo(c.direction)>wl||h}function l(o,c){const h=o.origin.distanceTo(c.origin),f=o.direction.angleTo(c.direction);return h/Sl+f/wl}}}const ea=new V,ia=new V,ur=new Zl;function Cg(r,t,e){const i=r.attributes,n=r.index,s=i.position,a=new Map,l=new Map,o=Array.from(t),c=new wg;for(let h=0,f=o.length;h<f;h++){const d=o[h],g=yg(d),p=bg(d);let v=3*g+p,b=3*g+(p+1)%3;n&&(v=n.getX(v),b=n.getX(b)),ea.fromBufferAttribute(s,v),ia.fromBufferAttribute(s,b),fg(ea,ia,ur);let _,S=c.findClosestRay(ur);S===null&&(S=ur.clone(),c.addRay(S)),l.has(S)||l.set(S,{forward:[],reverse:[],ray:S}),_=l.get(S);let u=bl(S,ea),m=bl(S,ia);u>m&&([u,m]=[m,u]),ur.direction.dot(S.direction)<0?_.reverse.push({start:u,end:m,index:d}):_.forward.push({start:u,end:m,index:d})}return l.forEach(({forward:h,reverse:f},d)=>{Sg(h,f,a,e),h.length===0&&f.length===0&&l.delete(d)}),{disjointConnectivityMap:a,fragmentMap:l}}const Ag=new Pi,na=new V,kg=new Fi,ra=["","",""];class Tg{constructor(t=null){this.data=null,this.disjointConnections=null,this.unmatchedDisjointEdges=null,this.unmatchedEdges=-1,this.matchedEdges=-1,this.useDrawRange=!0,this.useAllAttributes=!1,this.matchDisjointEdges=!1,this.degenerateEpsilon=1e-8,t&&this.updateFrom(t)}getSiblingTriangleIndex(t,e){const i=this.data[t*3+e];return i===-1?-1:~~(i/3)}getSiblingEdgeIndex(t,e){const i=this.data[t*3+e];return i===-1?-1:i%3}getDisjointSiblingTriangleIndices(t,e){const i=t*3+e,n=this.disjointConnections.get(i);return n?n.map(s=>~~(s/3)):[]}getDisjointSiblingEdgeIndices(t,e){const i=t*3+e,n=this.disjointConnections.get(i);return n?n.map(s=>s%3):[]}isFullyConnected(){return this.unmatchedEdges===0}updateFrom(t){const{useAllAttributes:e,useDrawRange:i,matchDisjointEdges:n,degenerateEpsilon:s}=this,a=e?u:S,l=new Map,{attributes:o}=t,c=e?Object.keys(o):null,h=t.index,f=o.position;let d=to(t);const g=d;let p=0;i&&(p=t.drawRange.start,t.drawRange.count!==1/0&&(d=~~(t.drawRange.count/3)));let v=this.data;(!v||v.length<3*g)&&(v=new Int32Array(3*g)),v.fill(-1);let b=0,_=new Set;for(let m=p,y=d*3+p;m<y;m+=3){const w=m;for(let k=0;k<3;k++){let C=w+k;h&&(C=h.getX(C)),ra[k]=a(C)}for(let k=0;k<3;k++){const C=(k+1)%3,A=ra[k],T=ra[C],P=`${T}_${A}`;if(l.has(P)){const E=w+k,M=l.get(P);v[E]=M,v[M]=E,l.delete(P),b+=2,_.delete(M)}else{const E=`${A}_${T}`,M=w+k;l.set(E,M),_.add(M)}}}if(n){const{fragmentMap:m,disjointConnectivityMap:y}=Cg(t,_,s);_.clear(),m.forEach(({forward:w,reverse:k})=>{w.forEach(({index:C})=>_.add(C)),k.forEach(({index:C})=>_.add(C))}),this.unmatchedDisjointEdges=m,this.disjointConnections=y,b=d*3-_.size}this.matchedEdges=b,this.unmatchedEdges=_.size,this.data=v;function S(m){return na.fromBufferAttribute(f,m),vl(na)}function u(m){let y="";for(let w=0,k=c.length;w<k;w++){const C=o[c[w]];let A;switch(C.itemSize){case 1:A=xe(C.getX(m));break;case 2:A=hg(Ag.fromBufferAttribute(C,m));break;case 3:A=vl(na.fromBufferAttribute(C,m));break;case 4:A=ug(kg.fromBufferAttribute(C,m));break}y!==""&&(y+="|"),y+=A}return y}}}class Ma extends Th{constructor(...t){super(...t),this.isBrush=!0,this._previousMatrix=new Me,this._previousMatrix.elements.fill(0)}markUpdated(){this._previousMatrix.copy(this.matrix)}isDirty(){const{matrix:t,_previousMatrix:e}=this,i=t.elements,n=e.elements;for(let s=0;s<16;s++)if(i[s]!==n[s])return!0;return!1}prepareGeometry(){const t=this.geometry,e=t.attributes,i=th();if(i)for(const n in e){const s=e[n];if(s.isInterleavedBufferAttribute)throw new Error("Brush: InterleavedBufferAttributes are not supported.");s.array=dg(s.array)}if(t.boundsTree||(pg(t,{useSharedArrayBuffer:i}),t.boundsTree=new Za(t,{maxLeafTris:3,indirect:!0,useSharedArrayBuffer:i})),t.halfEdges||(t.halfEdges=new Tg(t)),!t.groupIndices){const n=to(t),s=new Uint16Array(n),a=t.groups;for(let l=0,o=a.length;l<o;l++){const{start:c,count:h}=a[l];for(let f=c/3,d=(c+h)/3;f<d;f++)s[f]=l}t.groupIndices=s}}disposeCacheData(){const{geometry:t}=this;t.halfEdges=null,t.boundsTree=null,t.groupIndices=null}}const Pg=1e-14,sa=new V,Cl=new V,Al=new V;function ai(r,t=Pg){sa.subVectors(r.b,r.a),Cl.subVectors(r.c,r.a),Al.subVectors(r.b,r.c);const e=sa.angleTo(Cl),i=sa.angleTo(Al),n=Math.PI-e-i;return Math.abs(e)<t||Math.abs(i)<t||Math.abs(n)<t||r.a.distanceToSquared(r.b)<t||r.a.distanceToSquared(r.c)<t||r.b.distanceToSquared(r.c)<t}const aa=1e-10,Tn=1e-10,Eg=1e-10,De=new me,Ot=new me,Ge=new V,oa=new V,kl=new V,fr=new Na,la=new ve;class xg{constructor(){this._pool=[],this._index=0}getTriangle(){return this._index>=this._pool.length&&this._pool.push(new ae),this._pool[this._index++]}clear(){this._index=0}reset(){this._pool.length=0,this._index=0}}class Mg{constructor(){this.trianglePool=new xg,this.triangles=[],this.normal=new V,this.coplanarTriangleUsed=!1}initialize(t){this.reset();const{triangles:e,trianglePool:i,normal:n}=this;if(Array.isArray(t))for(let s=0,a=t.length;s<a;s++){const l=t[s];if(s===0)l.getNormal(n);else if(Math.abs(1-l.getNormal(Ge).dot(n))>aa)throw new Error("Triangle Splitter: Cannot initialize with triangles that have different normals.");const o=i.getTriangle();o.copy(l),e.push(o)}else{t.getNormal(n);const s=i.getTriangle();s.copy(t),e.push(s)}}splitByTriangle(t){const{normal:e,triangles:i}=this;if(t.getNormal(oa).normalize(),Math.abs(1-Math.abs(oa.dot(e)))<Eg){this.coplanarTriangleUsed=!0;for(let s=0,a=i.length;s<a;s++){const l=i[s];l.coplanarCount=0}const n=[t.a,t.b,t.c];for(let s=0;s<3;s++){const a=(s+1)%3,l=n[s],o=n[a];Ge.subVectors(o,l).normalize(),kl.crossVectors(oa,Ge),fr.setFromNormalAndCoplanarPoint(kl,l),this.splitByPlane(fr,t)}}else t.getPlane(fr),this.splitByPlane(fr,t)}splitByPlane(t,e){const{triangles:i,trianglePool:n}=this;la.copy(e),la.needsUpdate=!0;for(let s=0,a=i.length;s<a;s++){const l=i[s];if(!la.intersectsTriangle(l,De,!0))continue;const{a:o,b:c,c:h}=l;let f=0,d=-1,g=!1,p=[],v=[];const b=[o,c,h];for(let _=0;_<3;_++){const S=(_+1)%3;De.start.copy(b[_]),De.end.copy(b[S]);const u=t.distanceToPoint(De.start),m=t.distanceToPoint(De.end);if(Math.abs(u)<Tn&&Math.abs(m)<Tn){g=!0;break}if(u>0?p.push(_):v.push(_),Math.abs(u)<Tn)continue;let y=!!t.intersectLine(De,Ge);!y&&Math.abs(m)<Tn&&(Ge.copy(De.end),y=!0),y&&!(Ge.distanceTo(De.start)<aa)&&(Ge.distanceTo(De.end)<aa&&(d=_),f===0?Ot.start.copy(Ge):Ot.end.copy(Ge),f++)}if(!g&&f===2&&Ot.distance()>Tn)if(d!==-1){d=(d+1)%3;let _=0;_===d&&(_=(_+1)%3);let S=_+1;S===d&&(S=(S+1)%3);const u=n.getTriangle();u.a.copy(b[S]),u.b.copy(Ot.end),u.c.copy(Ot.start),ai(u)||i.push(u),l.a.copy(b[_]),l.b.copy(Ot.start),l.c.copy(Ot.end),ai(l)&&(i.splice(s,1),s--,a--)}else{const _=p.length>=2?v[0]:p[0];if(_===0){let w=Ot.start;Ot.start=Ot.end,Ot.end=w}const S=(_+1)%3,u=(_+2)%3,m=n.getTriangle(),y=n.getTriangle();b[S].distanceToSquared(Ot.start)<b[u].distanceToSquared(Ot.end)?(m.a.copy(b[S]),m.b.copy(Ot.start),m.c.copy(Ot.end),y.a.copy(b[S]),y.b.copy(b[u]),y.c.copy(Ot.start)):(m.a.copy(b[u]),m.b.copy(Ot.start),m.c.copy(Ot.end),y.a.copy(b[S]),y.b.copy(b[u]),y.c.copy(Ot.end)),l.a.copy(b[_]),l.b.copy(Ot.end),l.c.copy(Ot.start),ai(m)||i.push(m),ai(y)||i.push(y),ai(l)&&(i.splice(s,1),s--,a--)}else f===3&&console.warn("TriangleClipper: Coplanar clip not handled")}}reset(){this.triangles.length=0,this.trianglePool.clear(),this.coplanarTriangleUsed=!1}}function Fg(r){return r=~~r,r+4-r%4}class Tl{constructor(t,e=500){this.expansionFactor=1.5,this.type=t,this.length=0,this.array=null,this.setSize(e)}setType(t){if(this.length!==0)throw new Error("TypeBackedArray: Cannot change the type while there is used data in the buffer.");const e=this.array.buffer;this.array=new t(e),this.type=t}setSize(t){if(this.array&&t===this.array.length)return;const e=this.type,i=th()?SharedArrayBuffer:ArrayBuffer,n=new e(new i(Fg(t*e.BYTES_PER_ELEMENT)));this.array&&n.set(this.array,0),this.array=n}expand(){const{array:t,expansionFactor:e}=this;this.setSize(t.length*e)}push(...t){let{array:e,length:i}=this;i+t.length>e.length&&(this.expand(),e=this.array);for(let n=0,s=t.length;n<s;n++)e[i+n]=t[n];this.length+=t.length}clear(){this.length=0}}class Rg{constructor(){this.groupAttributes=[{}],this.groupCount=0}getType(t){return this.groupAttributes[0][t].type}getItemSize(t){return this.groupAttributes[0][t].itemSize}getNormalized(t){return this.groupAttributes[0][t].normalized}getCount(t){if(this.groupCount<=t)return 0;const e=this.getGroupAttrArray("position",t);return e.length/e.itemSize}getTotalLength(t){const{groupCount:e,groupAttributes:i}=this;let n=0;for(let s=0;s<e;s++){const a=i[s];n+=a[t].length}return n}getGroupAttrSet(t=0){const{groupAttributes:e}=this;if(e[t])return this.groupCount=Math.max(this.groupCount,t+1),e[t];const i=e[0];for(this.groupCount=Math.max(this.groupCount,t+1);t>=e.length;){const n={};e.push(n);for(const s in i){const a=i[s],l=new Tl(a.type);l.itemSize=a.itemSize,l.normalized=a.normalized,n[s]=l}}return e[t]}getGroupAttrArray(t,e=0){const{groupAttributes:i}=this;if(!i[0][t])throw new Error(`TypedAttributeData: Attribute with "${t}" has not been initialized`);return this.getGroupAttrSet(e)[t]}initializeArray(t,e,i,n){const{groupAttributes:s}=this,l=s[0][t];if(l){if(l.type!==e)for(let o=0,c=s.length;o<c;o++){const h=s[o][t];h.setType(e),h.itemSize=i,h.normalized=n}}else for(let o=0,c=s.length;o<c;o++){const h=new Tl(e);h.itemSize=i,h.normalized=n,s[o][t]=h}}clear(){this.groupCount=0;const{groupAttributes:t}=this;t.forEach(e=>{for(const i in e)e[i].clear()})}delete(t){this.groupAttributes.forEach(e=>{delete e[t]})}reset(){this.groupAttributes=[],this.groupCount=0}}class Pl{constructor(){this.intersectionSet={},this.ids=[]}add(t,e){const{intersectionSet:i,ids:n}=this;i[t]||(i[t]=[],n.push(t)),i[t].push(e)}}const Fa=0,ze=1,Ng=2,Lg=3,Ig=4,eh=5,ih=6,ce=new Zl,El=new Me,Jt=new ae,Oe=new V,xl=new Fi,Ml=new Fi,Fl=new Fi,ca=new Fi,dr=new Fi,gr=new Fi,Rl=new me,ha=new V,ua=1e-8,Dg=1e-15,Ci=-1,Ai=1,Sr=-2,wr=2,xn=0,bi=1,eo=2,Gg=1e-14;let Cr=null;function Nl(r){Cr=r}function nh(r,t){r.getMidpoint(ce.origin),r.getNormal(ce.direction);const e=t.raycastFirst(ce,La);return!!(e&&ce.direction.dot(e.face.normal)>0)?Ci:Ai}function Og(r,t){function e(){return Math.random()-.5}r.getNormal(ha),ce.direction.copy(ha),r.getMidpoint(ce.origin);const i=3;let n=0,s=1/0;for(let a=0;a<i;a++){ce.direction.x+=e()*ua,ce.direction.y+=e()*ua,ce.direction.z+=e()*ua,ce.direction.multiplyScalar(-1);const l=t.raycastFirst(ce,La);if(!!(l&&ce.direction.dot(l.face.normal)>0)&&n++,l!==null&&(s=Math.min(s,l.distance)),s<=Dg)return l.face.normal.dot(ha)>0?wr:Sr;if(n/i>.5||(a-n+1)/i>.5)break}return n/i>.5?Ci:Ai}function Bg(r,t){const e=new Pl,i=new Pl;return El.copy(r.matrixWorld).invert().multiply(t.matrixWorld),r.geometry.boundsTree.bvhcast(t.geometry.boundsTree,El,{intersectsTriangles(n,s,a,l){if(!ai(n)&&!ai(s)){let o=n.intersectsTriangle(s,Rl,!0);if(!o){const c=n.plane,h=s.plane,f=c.normal,d=h.normal;f.dot(d)===1&&Math.abs(c.constant-h.constant)<Gg&&(o=!0)}if(o){let c=r.geometry.boundsTree.resolveTriangleIndex(a),h=t.geometry.boundsTree.resolveTriangleIndex(l);e.add(c,h),i.add(h,c),Cr&&(Cr.addEdge(Rl),Cr.addIntersectingTriangles(a,n,l,s))}}return!1}}),{aIntersections:e,bIntersections:i}}function Ug(r,t,e,i,n,s,a=!1){const l=e.attributes,o=e.index,c=r*3,h=o.getX(c+0),f=o.getX(c+1),d=o.getX(c+2);for(const g in s){const p=l[g],v=s[g];if(!(g in l))throw new Error(`CSG Operations: Attribute ${g} not available on geometry.`);const b=p.itemSize;g==="position"?(Jt.a.fromBufferAttribute(p,h).applyMatrix4(i),Jt.b.fromBufferAttribute(p,f).applyMatrix4(i),Jt.c.fromBufferAttribute(p,d).applyMatrix4(i),fa(Jt.a,Jt.b,Jt.c,t,3,v,a)):g==="normal"?(Jt.a.fromBufferAttribute(p,h).applyNormalMatrix(n),Jt.b.fromBufferAttribute(p,f).applyNormalMatrix(n),Jt.c.fromBufferAttribute(p,d).applyNormalMatrix(n),a&&(Jt.a.multiplyScalar(-1),Jt.b.multiplyScalar(-1),Jt.c.multiplyScalar(-1)),fa(Jt.a,Jt.b,Jt.c,t,3,v,a,!0)):(xl.fromBufferAttribute(p,h),Ml.fromBufferAttribute(p,f),Fl.fromBufferAttribute(p,d),fa(xl,Ml,Fl,t,b,v,a))}}function Vg(r,t,e,i,n,s,a,l=!1){da(r,i,n,s,a,l),da(l?e:t,i,n,s,a,l),da(l?t:e,i,n,s,a,l)}function rh(r,t,e=!1){switch(r){case Fa:if(t===Ai||t===wr&&!e)return bi;break;case ze:if(e){if(t===Ci)return xn}else if(t===Ai||t===Sr)return bi;break;case Ng:if(e){if(t===Ai||t===Sr)return bi}else if(t===Ci)return xn;break;case Ig:if(t===Ci)return xn;if(t===Ai)return bi;break;case Lg:if(t===Ci||t===wr&&!e)return bi;break;case eh:if(!e&&(t===Ai||t===Sr))return bi;break;case ih:if(!e&&(t===Ci||t===wr))return bi;break;default:throw new Error(`Unrecognized CSG operation enum "${r}".`)}return eo}function fa(r,t,e,i,n,s,a=!1,l=!1){const o=c=>{s.push(c.x),n>1&&s.push(c.y),n>2&&s.push(c.z),n>3&&s.push(c.w)};ca.set(0,0,0,0).addScaledVector(r,i.a.x).addScaledVector(t,i.a.y).addScaledVector(e,i.a.z),dr.set(0,0,0,0).addScaledVector(r,i.b.x).addScaledVector(t,i.b.y).addScaledVector(e,i.b.z),gr.set(0,0,0,0).addScaledVector(r,i.c.x).addScaledVector(t,i.c.y).addScaledVector(e,i.c.z),l&&(ca.normalize(),dr.normalize(),gr.normalize()),o(ca),a?(o(gr),o(dr)):(o(dr),o(gr))}function da(r,t,e,i,n,s=!1){for(const a in n){const l=t[a],o=n[a];if(!(a in t))throw new Error(`CSG Operations: Attribute ${a} no available on geometry.`);const c=l.itemSize;a==="position"?(Oe.fromBufferAttribute(l,r).applyMatrix4(e),o.push(Oe.x,Oe.y,Oe.z)):a==="normal"?(Oe.fromBufferAttribute(l,r).applyNormalMatrix(i),s&&Oe.multiplyScalar(-1),o.push(Oe.x,Oe.y,Oe.z)):(o.push(l.getX(r)),c>1&&o.push(l.getY(r)),c>2&&o.push(l.getZ(r)),c>3&&o.push(l.getW(r)))}}class zg{constructor(t){this.triangle=new ae().copy(t),this.intersects={}}addTriangle(t,e){this.intersects[t]=new ae().copy(e)}getIntersectArray(){const t=[],{intersects:e}=this;for(const i in e)t.push(e[i]);return t}}class Ll{constructor(){this.data={}}addTriangleIntersection(t,e,i,n){const{data:s}=this;s[t]||(s[t]=new zg(e)),s[t].addTriangle(i,n)}getTrianglesAsArray(t=null){const{data:e}=this,i=[];if(t!==null)t in e&&i.push(e[t].triangle);else for(const n in e)i.push(e[n].triangle);return i}getTriangleIndices(){return Object.keys(this.data).map(t=>parseInt(t))}getIntersectionIndices(t){const{data:e}=this;return e[t]?Object.keys(e[t].intersects).map(i=>parseInt(i)):[]}getIntersectionsAsArray(t=null,e=null){const{data:i}=this,n=new Set,s=[],a=l=>{if(i[l])if(e!==null)i[l].intersects[e]&&s.push(i[l].intersects[e]);else{const o=i[l].intersects;for(const c in o)n.has(c)||(n.add(c),s.push(o[c]))}};if(t!==null)a(t);else for(const l in i)a(l);return s}reset(){this.data={}}}class Hg{constructor(){this.enabled=!1,this.triangleIntersectsA=new Ll,this.triangleIntersectsB=new Ll,this.intersectionEdges=[]}addIntersectingTriangles(t,e,i,n){const{triangleIntersectsA:s,triangleIntersectsB:a}=this;s.addTriangleIntersection(t,e,i,n),a.addTriangleIntersection(i,n,t,e)}addEdge(t){this.intersectionEdges.push(t.clone())}reset(){this.triangleIntersectsA.reset(),this.triangleIntersectsB.reset(),this.intersectionEdges=[]}init(){this.enabled&&(this.reset(),Nl(this))}complete(){this.enabled&&Nl(null)}}const li=new Me,Nr=new Ph,Si=new ae,pr=new ae,ii=new ae,mr=new ae,we=[],ki=[];function jg(r){for(const t of r)return t}function Wg(r,t,e,i,n,s={}){const{useGroups:a=!0}=s,{aIntersections:l,bIntersections:o}=Bg(r,t),c=[];let h=null,f;return f=a?0:-1,Il(r,t,l,e,!1,i,n,f),Dl(r,t,l,e,!1,n,f),e.findIndex(g=>g!==ih&&g!==eh)!==-1&&(f=a?r.geometry.groups.length||1:-1,Il(t,r,o,e,!0,i,n,f),Dl(t,r,o,e,!0,n,f)),we.length=0,ki.length=0,{groups:c,materials:h}}function Il(r,t,e,i,n,s,a,l=0){const o=r.matrixWorld.determinant()<0;li.copy(t.matrixWorld).invert().multiply(r.matrixWorld),Nr.getNormalMatrix(r.matrixWorld).multiplyScalar(o?-1:1);const c=r.geometry.groupIndices,h=r.geometry.index,f=r.geometry.attributes.position,d=t.geometry.boundsTree,g=t.geometry.index,p=t.geometry.attributes.position,v=e.ids,b=e.intersectionSet;for(let _=0,S=v.length;_<S;_++){const u=v[_],m=l===-1?0:c[u]+l,y=3*u,w=h.getX(y+0),k=h.getX(y+1),C=h.getX(y+2);Si.a.fromBufferAttribute(f,w).applyMatrix4(li),Si.b.fromBufferAttribute(f,k).applyMatrix4(li),Si.c.fromBufferAttribute(f,C).applyMatrix4(li),s.reset(),s.initialize(Si);const A=b[u];for(let P=0,E=A.length;P<E;P++){const M=3*A[P],R=g.getX(M+0),N=g.getX(M+1),B=g.getX(M+2);pr.a.fromBufferAttribute(p,R),pr.b.fromBufferAttribute(p,N),pr.c.fromBufferAttribute(p,B),s.splitByTriangle(pr)}const T=s.triangles;for(let P=0,E=T.length;P<E;P++){const M=T[P],R=s.coplanarTriangleUsed?Og(M,d):nh(M,d);we.length=0,ki.length=0;for(let N=0,B=i.length;N<B;N++){const q=rh(i[N],R,n);q!==eo&&(ki.push(q),we.push(a[N].getGroupAttrSet(m)))}if(we.length!==0){Si.getBarycoord(M.a,mr.a),Si.getBarycoord(M.b,mr.b),Si.getBarycoord(M.c,mr.c);for(let N=0,B=we.length;N<B;N++){const q=we[N],ct=ki[N]===xn;Ug(u,mr,r.geometry,r.matrixWorld,Nr,q,o!==ct)}}}}return v.length}function Dl(r,t,e,i,n,s,a=0){const l=r.matrixWorld.determinant()<0;li.copy(t.matrixWorld).invert().multiply(r.matrixWorld),Nr.getNormalMatrix(r.matrixWorld).multiplyScalar(l?-1:1);const o=t.geometry.boundsTree,c=r.geometry.groupIndices,h=r.geometry.index,f=r.geometry.attributes,d=f.position,g=[],p=r.geometry.halfEdges,v=new Set,b=to(r.geometry);for(let _=0,S=b;_<S;_++)_ in e.intersectionSet||v.add(_);for(;v.size>0;){const _=jg(v);v.delete(_),g.push(_);const S=3*_,u=h.getX(S+0),m=h.getX(S+1),y=h.getX(S+2);ii.a.fromBufferAttribute(d,u).applyMatrix4(li),ii.b.fromBufferAttribute(d,m).applyMatrix4(li),ii.c.fromBufferAttribute(d,y).applyMatrix4(li);const w=nh(ii,o);ki.length=0,we.length=0;for(let k=0,C=i.length;k<C;k++){const A=rh(i[k],w,n);A!==eo&&(ki.push(A),we.push(s[k]))}for(;g.length>0;){const k=g.pop();for(let C=0;C<3;C++){const A=p.getSiblingTriangleIndex(k,C);A!==-1&&v.has(A)&&(g.push(A),v.delete(A))}if(we.length!==0){const C=3*k,A=h.getX(C+0),T=h.getX(C+1),P=h.getX(C+2),E=a===-1?0:c[k]+a;if(ii.a.fromBufferAttribute(d,A),ii.b.fromBufferAttribute(d,T),ii.c.fromBufferAttribute(d,P),!ai(ii))for(let M=0,R=we.length;M<R;M++){const N=ki[M],B=we[M].getGroupAttrSet(E),q=N===xn;Vg(A,T,P,f,r.matrixWorld,Nr,B,q!==l)}}}}}function Xg(r){for(let t=0;t<r.length-1;t++){const e=r[t],i=r[t+1];if(e.materialIndex===i.materialIndex){const n=e.start,s=i.start+i.count;i.start=n,i.count=s-n,r.splice(t,1),t--}}}function Yg(r,t,e,i){e.clear();const n=r.attributes;for(let s=0,a=i.length;s<a;s++){const l=i[s],o=n[l];e.initializeArray(l,o.array.constructor,o.itemSize,o.normalized)}for(const s in e.attributes)i.includes(s)||e.delete(s);for(const s in t.attributes)i.includes(s)||(t.deleteAttribute(s),t.dispose())}function Kg(r,t,e){let i=!1,n=-1;const s=r.attributes,a=t.groupAttributes[0];for(const o in a){const c=t.getTotalLength(o),h=t.getType(o),f=t.getItemSize(o),d=t.getNormalized(o);let g=s[o];(!g||g.array.length<c)&&(g=new Gr(new h(c),f,d),r.setAttribute(o,g),i=!0);let p=0;for(let v=0,b=Math.min(e.length,t.groupCount);v<b;v++){const _=e[v].index,{array:S,type:u,length:m}=t.groupAttributes[_][o],y=new u(S.buffer,0,m);g.array.set(y,p),p+=y.length}g.needsUpdate=!0,n=c/g.itemSize}if(r.index){const o=r.index.array;if(o.length<n)r.index=null,i=!0;else for(let c=0,h=o.length;c<h;c++)o[c]=c}let l=0;r.clearGroups();for(let o=0,c=Math.min(e.length,t.groupCount);o<c;o++){const{index:h,materialIndex:f}=e[o],d=t.getCount(h);d!==0&&(r.addGroup(l,d,f),l+=d)}r.setDrawRange(0,n),r.boundsTree=null,i&&r.dispose()}function Gl(r,t){let e=t;return Array.isArray(t)||(e=[],r.forEach(i=>{e[i.materialIndex]=t})),e}class $g{constructor(){this.triangleSplitter=new Mg,this.attributeData=[],this.attributes=["position","uv","normal"],this.useGroups=!0,this.consolidateGroups=!0,this.debug=new Hg}getGroupRanges(t){return!this.useGroups||t.groups.length===0?[{start:0,count:1/0,materialIndex:0}]:t.groups.map(e=>({...e}))}evaluate(t,e,i,n=new Ma){let s=!0;if(Array.isArray(i)||(i=[i]),Array.isArray(n)||(n=[n],s=!1),n.length!==i.length)throw new Error("Evaluator: operations and target array passed as different sizes.");t.prepareGeometry(),e.prepareGeometry();const{triangleSplitter:a,attributeData:l,attributes:o,useGroups:c,consolidateGroups:h,debug:f}=this;for(;l.length<n.length;)l.push(new Rg);n.forEach((_,S)=>{Yg(t.geometry,_.geometry,l[S],o)}),f.init(),Wg(t,e,i,a,l,{useGroups:c}),f.complete();const d=this.getGroupRanges(t.geometry),g=Gl(d,t.material),p=this.getGroupRanges(e.geometry),v=Gl(p,e.material);p.forEach(_=>_.materialIndex+=g.length);let b=[...d,...p].map((_,S)=>({..._,index:S}));if(c){const _=[...g,...v];h&&(b=b.map(u=>{const m=_[u.materialIndex];return u.materialIndex=_.indexOf(m),u}).sort((u,m)=>u.materialIndex-m.materialIndex));const S=[];for(let u=0,m=_.length;u<m;u++){let y=!1;for(let w=0,k=b.length;w<k;w++){const C=b[w];C.materialIndex===u&&(y=!0,C.materialIndex=S.length)}y&&S.push(_[u])}n.forEach(u=>{u.material=S})}else b=[{start:0,count:1/0,index:0,materialIndex:0}],n.forEach(_=>{_.material=g[0]});return n.forEach((_,S)=>{const u=_.geometry;Kg(u,l[S],b),h&&Xg(u.groups)}),s?n:n[0]}evaluateHierarchy(t,e=new Ma){t.updateMatrixWorld(!0);const i=(s,a)=>{const l=s.children;for(let o=0,c=l.length;o<c;o++){const h=l[o];h.isOperationGroup?i(h,a):a(h)}},n=s=>{const a=s.children;let l=!1;for(let c=0,h=a.length;c<h;c++){const f=a[c];l=n(f)||l}const o=s.isDirty();if(o&&s.markUpdated(),l&&!s.isOperationGroup){let c;return i(s,h=>{c?c=this.evaluate(c,h,h.operation):c=this.evaluate(s,h,h.operation)}),s._cachedGeometry=c.geometry,s._cachedMaterials=c.material,!0}else return l||o};return n(t),e.geometry=t._cachedGeometry,e.material=t._cachedMaterials,e}reset(){this.triangleSplitter.reset()}}const Be=2,ni=2,_r=1,wi=r=>{const t=new Ma(r.translate(0,0,0));return r instanceof tc?t.position.z=r.parameters.depth/2:r instanceof ec&&(t.position.z=r.parameters.height/2,t.rotateX(Math.PI/2)),t.updateMatrixWorld(),t},tn=(r,t,e)=>new tc(r,t,e),qg=(r,t)=>new ec(r,r,t,32),Jg=r=>{const t=r.panelSettings,e=t.pcbThickness+t.smdHeight,i=Math.max(t.smdHeight,...r.rectangles.map(f=>f.depth),...r.circles.map(f=>f.depth)),n=t.pcbThickness+i,s=t.pcbThickness+t.smdHeight;let a=wi(tn(t.width+2*ni,t.height+2*ni,n+Be)),l=wi(tn(t.width+2*ni,t.height+2*ni,s+Be));l.position.z+=n-s,l.updateMatrixWorld();const o=new $g,c=wi(tn(t.width,t.height,e+_r));c.position.z+=Be+n-e,c.updateMatrixWorld(),a=o.evaluate(a,c,ze),l=o.evaluate(l,c,ze);const h=wi(tn(t.width/3,t.height/3,e+_r));{h.position.z+=Be+n-e,h.updateMatrixWorld();const f=[{dx:t.width/2,dy:0},{dx:-t.width/2,dy:0},{dx:0,dy:t.height/2},{dx:0,dy:-t.height/2}];for(const d of f){h.position.x+=d.dx,h.position.y+=d.dy;try{h.updateMatrixWorld(),a=o.evaluate(a,h,ze),l=o.evaluate(l,h,ze)}finally{h.position.x-=d.dx,h.position.y-=d.dy}}}for(const f of r.rectangles){const d=wi(tn(f.width,f.height,f.depth+_r));d.position.x+=f.x+f.width/2-t.width/2,d.position.y-=f.y+f.height/2-t.height/2,d.position.z+=Be+(i-f.depth),d.updateMatrixWorld(),a=o.evaluate(a,d,ze),l=o.evaluate(l,d,ze)}for(const f of r.circles){const d=wi(qg(f.radius,f.depth+_r));d.position.x+=f.x-t.width/2,d.position.y-=f.y-t.height/2,d.position.z+=Be+(i-f.depth),d.updateMatrixWorld(),a=o.evaluate(a,d,ze),l=o.evaluate(l,d,ze)}for(const f of r.legs){const d=wi(tn(f.width,f.height,t.smdHeight));d.position.x+=f.x+f.width/2-t.width/2,d.position.y-=f.y+f.height/2-t.height/2,d.position.z+=Be+(i-t.smdHeight),d.updateMatrixWorld(),a=o.evaluate(a,d,Fa),l=o.evaluate(l,d,Fa)}return{main:{vertexArray:new Float32Array(a.geometry.attributes.position.array),dimensions:{x:t.width+2*ni,y:t.height+2*ni,depth:n+Be}},coverage:{vertexArray:new Float32Array(l.geometry.attributes.position.array),dimensions:{x:t.width+2*ni,y:t.height+2*ni,depth:s+Be}}}},Qg=async r=>new Promise((t,e)=>setTimeout(()=>{try{t(Jg(r))}catch(i){e(i instanceof Error?i.message:i)}}));let io=(r=21)=>crypto.getRandomValues(new Uint8Array(r)).reduce((t,e)=>(e&=63,e<36?t+=e.toString(36):e<62?t+=(e-26).toString(36).toUpperCase():e>62?t+="-":t+="_",t),"");const Zg=rt.object({depth:rt.number(),id:rt.string(),x:rt.number(),y:rt.number(),radius:rt.number(),fill:rt.literal("orange").default("orange"),draggable:rt.literal(!0).default(!0),opacity:rt.literal(.75).default(.75)}),t3=["fill","draggable","opacity"],Lr=2,e3=rt.object({id:rt.string(),x:rt.number(),y:rt.number(),width:rt.number(),height:rt.number(),fill:rt.literal("gray").default("gray"),draggable:rt.literal(!0).default(!0),opacity:rt.literal(.75).default(.75)}),i3=["fill","draggable","opacity"],n3=rt.object({width:rt.number(),height:rt.number(),pcbThickness:rt.number(),smdHeight:rt.number()}),r3=rt.object({depth:rt.number(),id:rt.string(),x:rt.number(),y:rt.number(),width:rt.number(),height:rt.number(),fill:rt.literal("green").default("green"),draggable:rt.literal(!0).default(!0),opacity:rt.literal(.75).default(.75)}),s3=["fill","draggable","opacity"],sh=rt.object({image:rt.string(),filename:rt.string(),panelSettings:n3,circles:rt.array(Zg),rectangles:rt.array(r3),legs:rt.array(e3)}),ah={image:"",filename:"",panelSettings:{width:100,height:100,pcbThickness:1.6,smdHeight:3},circles:[],rectangles:[],legs:[]},oh={parse:r=>{try{return sh.parse(JSON.parse(r))}catch{return ah}},stringify:r=>JSON.stringify(r,(t,e)=>{if(![...t3,...s3,...i3].includes(t))return e},2)},Bt=Eh("project",ah,{syncTabs:!0,storage:"local",serializer:oh}),ti=()=>Jl(Bt),Ar=async r=>{const t=ti(),e={depth:r?.depth||5,id:io(),x:t.panelSettings.width/2,y:t.panelSettings.height/2,radius:r?.radius||10,fill:"orange",draggable:!0,opacity:.75};if(t.circles.push(e),Nn(t.circles),!r){const{confirmed:i,settings:n}=await ic(e);i?(e.radius=n.radius,e.depth=n.depth,Nn()):ch(e)}},a3=r=>Ar(r),o3=async r=>{const{confirmed:t,name:e}=await nc("circle");if(t){const i=rc();i.push({name:e,type:"circle",radius:r.radius,depth:r.depth}),sc(i)}},lh=async r=>{const{confirmed:t,settings:e}=await ic(r);t&&(r.radius=e.radius,r.depth=e.depth,Nn())},ch=r=>{const t=ti();t.circles=t.circles.filter(e=>e!=r),Nn()},Nn=r=>Bt.update(t=>(r&&(t.circles=r),t)),l3=r=>{const e=ti().circles.find(i=>i.id===r);if(e)return[{name:`Circle ${e.radius}x${e.depth}mm`},{name:"Properties...",onClick:()=>lh(e)},{name:"Duplicate",onClick:()=>a3(e)},{name:"Add to library...",onClick:()=>o3(e)},{name:""},{name:"Delete",onClick:()=>ch(e)}]},Ol=()=>{const r=ti(),t={id:io(),x:r.panelSettings.width/2,y:r.panelSettings.height/2,width:Lr,height:Lr,fill:"gray",draggable:!0,opacity:.75};r.legs.push(t),Rs(r.legs)},c3=r=>{const t=ti();t.legs=t.legs.filter(e=>e!=r),Rs(t.legs)},Rs=r=>Bt.update(t=>(r&&(t.legs=r),t)),h3=r=>{const t=ti(),e=t.legs.find(i=>i.id===r);if(e)return[{name:"Leg"},{name:"Delete",onClick:()=>{t.legs=t.legs.filter(i=>i!=e),Rs()}}]},kr=async r=>{const t=ti(),e={depth:r?.depth||5,id:io(),x:t.panelSettings.width/2,y:t.panelSettings.height/2,width:r?.width||10,height:r?.height||5,fill:"green",draggable:!0,opacity:.75};if(t.rectangles.push(e),an(t.rectangles),!r){const{confirmed:i,settings:n}=await ac(e);i?(e.width=n.width,e.height=n.height,e.depth=n.depth,an()):uh(e)}},u3=r=>kr(r),f3=r=>{const t=r.width;r.width=r.height,r.height=t,an()},d3=async r=>{const{confirmed:t,name:e}=await nc("rectangle");if(t){const i=rc();i.push({name:e,type:"rectangle",width:r.width,height:r.height,depth:r.depth}),sc(i)}},hh=async r=>{const{confirmed:t,settings:e}=await ac(r);t&&(r.width=e.width,r.height=e.height,r.depth=e.depth,an())},uh=r=>{const t=ti();t.rectangles=t.rectangles.filter(e=>e!=r),an()},an=r=>Bt.update(t=>(r&&(t.rectangles=r),t)),g3=r=>{const e=ti().rectangles.find(i=>i.id===r);if(e)return[{name:`Rectangle ${e.width}x${e.height}x${e.depth}mm`},{name:"Properties...",onClick:()=>hh(e)},{name:"Rotate",onClick:()=>f3(e)},{name:"Duplicate",onClick:()=>u3(e)},{name:"Add to library...",onClick:()=>d3(e)},{name:""},{name:"Delete",onClick:()=>uh(e)}]};function Bl(r,t,e){const i=r.slice();return i[43]=t[e],i[44]=t,i[45]=e,i}function Ul(r,t,e){const i=r.slice();return i[46]=t[e],i[47]=t,i[48]=e,i}function Vl(r,t,e){const i=r.slice();return i[49]=t[e],i[50]=t,i[51]=e,i}function zl(r,t,e){const i=r.slice();return i[52]=t[e],i}function p3(r){let t,e,i,n,s="PCB THT Holder",a,l,o,c;return{c(){t=ut("img"),i=bt(),n=ut("span"),n.textContent=s,a=bt(),l=ut("span"),o=dt("v"),c=dt(r[5]),this.h()},l(h){t=ft(h,"IMG",{src:!0,class:!0,alt:!0}),i=St(h),n=ft(h,"SPAN",{class:!0,"data-svelte-h":!0}),yh(n)!=="svelte-yf58ke"&&(n.textContent=s),a=St(h),l=ft(h,"SPAN",{class:!0});var f=at(l);o=gt(f,"v"),c=gt(f,r[5]),f.forEach(F),this.h()},h(){bh(t.src,e=Dh+"/favicon.png")||Y(t,"src",e),Y(t,"class","me-3 h-6 sm:h-9"),Y(t,"alt","PCB THT Holder Logo"),Y(n,"class","self-center whitespace-nowrap text-xl font-semibold dark:text-white"),Y(l,"class","ml-2 self-center whitespace-nowrap text-sm dark:text-white")},m(h,f){G(h,t,f),G(h,i,f),G(h,n,f),G(h,a,f),G(h,l,f),Et(l,o),Et(l,c)},p:Yt,d(h){h&&(F(t),F(i),F(n),F(a),F(l))}}}function Hl(r){let t,e,i,n,s,a,l;return e=new Lh({props:{disabled:!r[0],$$slots:{default:[_3]},$$scope:{ctx:r}}}),e.$on("click",r[20]),n=new vu({}),a=new Tu({props:{class:"order-1",$$slots:{default:[D3]},$$scope:{ctx:r}}}),{c(){t=ut("div"),Q(e.$$.fragment),i=bt(),Q(n.$$.fragment),s=bt(),Q(a.$$.fragment),this.h()},l(o){t=ft(o,"DIV",{class:!0});var c=at(t);Z(e.$$.fragment,c),i=St(c),Z(n.$$.fragment,c),c.forEach(F),s=St(o),Z(a.$$.fragment,o),this.h()},h(){Y(t,"class","flex md:order-2")},m(o,c){G(o,t,c),tt(e,t,null),Et(t,i),tt(n,t,null),G(o,s,c),tt(a,o,c),l=!0},p(o,c){const h={};c[0]&1&&(h.disabled=!o[0]),c[1]&16777216&&(h.$$scope={dirty:c,ctx:o}),e.$set(h);const f={};c[0]&16|c[1]&16777216&&(f.$$scope={dirty:c,ctx:o}),a.$set(f)},i(o){l||(L(e.$$.fragment,o),L(n.$$.fragment,o),L(a.$$.fragment,o),l=!0)},o(o){O(e.$$.fragment,o),O(n.$$.fragment,o),O(a.$$.fragment,o),l=!1},d(o){o&&(F(t),F(s)),et(e),et(n),et(a,o)}}}function m3(r){let t;return{c(){t=dt("D")},l(e){t=gt(e,"D")},m(e,i){G(e,t,i)},d(e){e&&F(t)}}}function _3(r){let t,e,i,n;return t=new Lu({props:{class:"mr-2"}}),i=new Dn({props:{class:"ml-4 px-2 py-1",$$slots:{default:[m3]},$$scope:{ctx:r}}}),{c(){Q(t.$$.fragment),e=dt(`
				Display 3D
				`),Q(i.$$.fragment)},l(s){Z(t.$$.fragment,s),e=gt(s,`
				Display 3D
				`),Z(i.$$.fragment,s)},m(s,a){tt(t,s,a),G(s,e,a),tt(i,s,a),n=!0},p(s,a){const l={};a[1]&16777216&&(l.$$scope={dirty:a,ctx:s}),i.$set(l)},i(s){n||(L(t.$$.fragment,s),L(i.$$.fragment,s),n=!0)},o(s){O(t.$$.fragment,s),O(i.$$.fragment,s),n=!1},d(s){s&&F(e),et(t,s),et(i,s)}}}function v3(r){let t,e,i;return e=new cc({props:{class:"w-3 h-3 ms-2 text-primary-800 dark:text-white inline"}}),{c(){t=dt("File"),Q(e.$$.fragment)},l(n){t=gt(n,"File"),Z(e.$$.fragment,n)},m(n,s){G(n,t,s),tt(e,n,s),i=!0},p:Yt,i(n){i||(L(e.$$.fragment,n),i=!0)},o(n){O(e.$$.fragment,n),i=!1},d(n){n&&F(t),et(e,n)}}}function y3(r){let t;return{c(){t=dt("New")},l(e){t=gt(e,"New")},m(e,i){G(e,t,i)},d(e){e&&F(t)}}}function b3(r){let t;return{c(){t=dt("Save project")},l(e){t=gt(e,"Save project")},m(e,i){G(e,t,i)},d(e){e&&F(t)}}}function S3(r){let t;return{c(){t=dt("shift + P")},l(e){t=gt(e,"shift + P")},m(e,i){G(e,t,i)},d(e){e&&F(t)}}}function w3(r){let t,e,i;return e=new Dn({props:{class:"float-right px-2",$$slots:{default:[S3]},$$scope:{ctx:r}}}),{c(){t=dt(`Panel settings...
					`),Q(e.$$.fragment)},l(n){t=gt(n,`Panel settings...
					`),Z(e.$$.fragment,n)},m(n,s){G(n,t,s),tt(e,n,s),i=!0},p(n,s){const a={};s[1]&16777216&&(a.$$scope={dirty:s,ctx:n}),e.$set(a)},i(n){i||(L(e.$$.fragment,n),i=!0)},o(n){O(e.$$.fragment,n),i=!1},d(n){n&&F(t),et(e,n)}}}function C3(r){let t,e,i,n,s,a,l,o;return t=new He({props:{href:"#",$$slots:{default:[y3]},$$scope:{ctx:r}}}),t.$on("click",r[21]),i=new He({props:{href:"#",$$slots:{default:[b3]},$$scope:{ctx:r}}}),i.$on("click",r[22]),s=new oc({}),l=new He({props:{href:"#",$$slots:{default:[w3]},$$scope:{ctx:r}}}),l.$on("click",r[23]),{c(){Q(t.$$.fragment),e=bt(),Q(i.$$.fragment),n=bt(),Q(s.$$.fragment),a=bt(),Q(l.$$.fragment)},l(c){Z(t.$$.fragment,c),e=St(c),Z(i.$$.fragment,c),n=St(c),Z(s.$$.fragment,c),a=St(c),Z(l.$$.fragment,c)},m(c,h){tt(t,c,h),G(c,e,h),tt(i,c,h),G(c,n,h),tt(s,c,h),G(c,a,h),tt(l,c,h),o=!0},p(c,h){const f={};h[1]&16777216&&(f.$$scope={dirty:h,ctx:c}),t.$set(f);const d={};h[1]&16777216&&(d.$$scope={dirty:h,ctx:c}),i.$set(d);const g={};h[1]&16777216&&(g.$$scope={dirty:h,ctx:c}),l.$set(g)},i(c){o||(L(t.$$.fragment,c),L(i.$$.fragment,c),L(s.$$.fragment,c),L(l.$$.fragment,c),o=!0)},o(c){O(t.$$.fragment,c),O(i.$$.fragment,c),O(s.$$.fragment,c),O(l.$$.fragment,c),o=!1},d(c){c&&(F(e),F(n),F(a)),et(t,c),et(i,c),et(s,c),et(l,c)}}}function A3(r){let t,e,i;return e=new cc({props:{class:"w-3 h-3 ms-2 text-primary-800 dark:text-white inline"}}),{c(){t=dt("Component"),Q(e.$$.fragment)},l(n){t=gt(n,"Component"),Z(e.$$.fragment,n)},m(n,s){G(n,t,s),tt(e,n,s),i=!0},p:Yt,i(n){i||(L(e.$$.fragment,n),i=!0)},o(n){O(e.$$.fragment,n),i=!1},d(n){n&&F(t),et(e,n)}}}function k3(r){let t;return{c(){t=dt("shift + C")},l(e){t=gt(e,"shift + C")},m(e,i){G(e,t,i)},d(e){e&&F(t)}}}function T3(r){let t,e,i;return e=new Dn({props:{class:"float-right px-2",$$slots:{default:[k3]},$$scope:{ctx:r}}}),{c(){t=dt(`Add circle...
					`),Q(e.$$.fragment)},l(n){t=gt(n,`Add circle...
					`),Z(e.$$.fragment,n)},m(n,s){G(n,t,s),tt(e,n,s),i=!0},p(n,s){const a={};s[1]&16777216&&(a.$$scope={dirty:s,ctx:n}),e.$set(a)},i(n){i||(L(e.$$.fragment,n),i=!0)},o(n){O(e.$$.fragment,n),i=!1},d(n){n&&F(t),et(e,n)}}}function P3(r){let t;return{c(){t=dt("shift + R")},l(e){t=gt(e,"shift + R")},m(e,i){G(e,t,i)},d(e){e&&F(t)}}}function E3(r){let t,e,i;return e=new Dn({props:{class:"float-right px-2",$$slots:{default:[P3]},$$scope:{ctx:r}}}),{c(){t=dt(`Add rectangle...
					`),Q(e.$$.fragment)},l(n){t=gt(n,`Add rectangle...
					`),Z(e.$$.fragment,n)},m(n,s){G(n,t,s),tt(e,n,s),i=!0},p(n,s){const a={};s[1]&16777216&&(a.$$scope={dirty:s,ctx:n}),e.$set(a)},i(n){i||(L(e.$$.fragment,n),i=!0)},o(n){O(e.$$.fragment,n),i=!1},d(n){n&&F(t),et(e,n)}}}function x3(r){let t;return{c(){t=dt("shift + L")},l(e){t=gt(e,"shift + L")},m(e,i){G(e,t,i)},d(e){e&&F(t)}}}function M3(r){let t,e,i;return e=new Dn({props:{class:"float-right px-2",$$slots:{default:[x3]},$$scope:{ctx:r}}}),{c(){t=dt(`Add leg
					`),Q(e.$$.fragment)},l(n){t=gt(n,`Add leg
					`),Z(e.$$.fragment,n)},m(n,s){G(n,t,s),tt(e,n,s),i=!0},p(n,s){const a={};s[1]&16777216&&(a.$$scope={dirty:s,ctx:n}),e.$set(a)},i(n){i||(L(e.$$.fragment,n),i=!0)},o(n){O(e.$$.fragment,n),i=!1},d(n){n&&F(t),et(e,n)}}}function jl(r){let t,e,i,n;return t=new He({props:{class:"flex items-center justify-between",$$slots:{default:[F3]},$$scope:{ctx:r}}}),i=new ga({props:{class:"w-auto min-w-44 z-20",placement:"right-start",$$slots:{default:[N3]},$$scope:{ctx:r}}}),{c(){Q(t.$$.fragment),e=bt(),Q(i.$$.fragment)},l(s){Z(t.$$.fragment,s),e=St(s),Z(i.$$.fragment,s)},m(s,a){tt(t,s,a),G(s,e,a),tt(i,s,a),n=!0},p(s,a){const l={};a[1]&16777216&&(l.$$scope={dirty:a,ctx:s}),t.$set(l);const o={};a[0]&16|a[1]&16777216&&(o.$$scope={dirty:a,ctx:s}),i.$set(o)},i(s){n||(L(t.$$.fragment,s),L(i.$$.fragment,s),n=!0)},o(s){O(t.$$.fragment,s),O(i.$$.fragment,s),n=!1},d(s){s&&F(e),et(t,s),et(i,s)}}}function F3(r){let t,e,i;return e=new Fu({props:{class:"w-3 h-3 ms-2 text-primary-700 dark:text-white"}}),{c(){t=dt("Add from library"),Q(e.$$.fragment)},l(n){t=gt(n,"Add from library"),Z(e.$$.fragment,n)},m(n,s){G(n,t,s),tt(e,n,s),i=!0},p:Yt,i(n){i||(L(e.$$.fragment,n),i=!0)},o(n){O(e.$$.fragment,n),i=!1},d(n){n&&F(t),et(e,n)}}}function R3(r){let t=r[52].name+"",e,i,n=r[52].type+"",s,a;return{c(){e=dt(t),i=dt(" ("),s=dt(n),a=dt(")")},l(l){e=gt(l,t),i=gt(l," ("),s=gt(l,n),a=gt(l,")")},m(l,o){G(l,e,o),G(l,i,o),G(l,s,o),G(l,a,o)},p(l,o){o[0]&16&&t!==(t=l[52].name+"")&&Ye(e,t),o[0]&16&&n!==(n=l[52].type+"")&&Ye(s,n)},d(l){l&&(F(e),F(i),F(s),F(a))}}}function Wl(r){let t,e;function i(){return r[27](r[52])}return t=new He({props:{$$slots:{default:[R3]},$$scope:{ctx:r}}}),t.$on("click",i),{c(){Q(t.$$.fragment)},l(n){Z(t.$$.fragment,n)},m(n,s){tt(t,n,s),e=!0},p(n,s){r=n;const a={};s[0]&16|s[1]&16777216&&(a.$$scope={dirty:s,ctx:r}),t.$set(a)},i(n){e||(L(t.$$.fragment,n),e=!0)},o(n){O(t.$$.fragment,n),e=!1},d(n){et(t,n)}}}function N3(r){let t,e,i=Pe(r[4].sort(ql)),n=[];for(let a=0;a<i.length;a+=1)n[a]=Wl(zl(r,i,a));const s=a=>O(n[a],1,1,()=>{n[a]=null});return{c(){for(let a=0;a<n.length;a+=1)n[a].c();t=Xt()},l(a){for(let l=0;l<n.length;l+=1)n[l].l(a);t=Xt()},m(a,l){for(let o=0;o<n.length;o+=1)n[o]&&n[o].m(a,l);G(a,t,l),e=!0},p(a,l){if(l[0]&1040){i=Pe(a[4].sort(ql));let o;for(o=0;o<i.length;o+=1){const c=zl(a,i,o);n[o]?(n[o].p(c,l),L(n[o],1)):(n[o]=Wl(c),n[o].c(),L(n[o],1),n[o].m(t.parentNode,t))}for(ge(),o=i.length;o<n.length;o+=1)s(o);pe()}},i(a){if(!e){for(let l=0;l<i.length;l+=1)L(n[l]);e=!0}},o(a){n=n.filter(Boolean);for(let l=0;l<n.length;l+=1)O(n[l]);e=!1},d(a){a&&F(t),Pn(n,a)}}}function L3(r){let t;return{c(){t=dt("Library...")},l(e){t=gt(e,"Library...")},m(e,i){G(e,t,i)},d(e){e&&F(t)}}}function I3(r){let t,e,i,n,s,a,l,o,c,h,f;t=new He({props:{href:"#",$$slots:{default:[T3]},$$scope:{ctx:r}}}),t.$on("click",r[24]),i=new He({props:{href:"#",$$slots:{default:[E3]},$$scope:{ctx:r}}}),i.$on("click",r[25]),s=new He({props:{href:"#",$$slots:{default:[M3]},$$scope:{ctx:r}}}),s.$on("click",r[26]);let d=r[4].length&&jl(r);return o=new oc({}),h=new He({props:{href:"#",$$slots:{default:[L3]},$$scope:{ctx:r}}}),h.$on("click",r[28]),{c(){Q(t.$$.fragment),e=bt(),Q(i.$$.fragment),n=bt(),Q(s.$$.fragment),a=bt(),d&&d.c(),l=bt(),Q(o.$$.fragment),c=bt(),Q(h.$$.fragment)},l(g){Z(t.$$.fragment,g),e=St(g),Z(i.$$.fragment,g),n=St(g),Z(s.$$.fragment,g),a=St(g),d&&d.l(g),l=St(g),Z(o.$$.fragment,g),c=St(g),Z(h.$$.fragment,g)},m(g,p){tt(t,g,p),G(g,e,p),tt(i,g,p),G(g,n,p),tt(s,g,p),G(g,a,p),d&&d.m(g,p),G(g,l,p),tt(o,g,p),G(g,c,p),tt(h,g,p),f=!0},p(g,p){const v={};p[1]&16777216&&(v.$$scope={dirty:p,ctx:g}),t.$set(v);const b={};p[1]&16777216&&(b.$$scope={dirty:p,ctx:g}),i.$set(b);const _={};p[1]&16777216&&(_.$$scope={dirty:p,ctx:g}),s.$set(_),g[4].length?d?(d.p(g,p),p[0]&16&&L(d,1)):(d=jl(g),d.c(),L(d,1),d.m(l.parentNode,l)):d&&(ge(),O(d,1,1,()=>{d=null}),pe());const S={};p[1]&16777216&&(S.$$scope={dirty:p,ctx:g}),h.$set(S)},i(g){f||(L(t.$$.fragment,g),L(i.$$.fragment,g),L(s.$$.fragment,g),L(d),L(o.$$.fragment,g),L(h.$$.fragment,g),f=!0)},o(g){O(t.$$.fragment,g),O(i.$$.fragment,g),O(s.$$.fragment,g),O(d),O(o.$$.fragment,g),O(h.$$.fragment,g),f=!1},d(g){g&&(F(e),F(n),F(a),F(l),F(c)),et(t,g),et(i,g),et(s,g),d&&d.d(g),et(o,g),et(h,g)}}}function D3(r){let t,e,i,n,s,a,l,o;return t=new fo({props:{class:"cursor-pointer",$$slots:{default:[v3]},$$scope:{ctx:r}}}),i=new ga({props:{class:"w-60 z-20",$$slots:{default:[C3]},$$scope:{ctx:r}}}),s=new fo({props:{class:"cursor-pointer",$$slots:{default:[A3]},$$scope:{ctx:r}}}),l=new ga({props:{class:"w-60 z-20",$$slots:{default:[I3]},$$scope:{ctx:r}}}),{c(){Q(t.$$.fragment),e=bt(),Q(i.$$.fragment),n=bt(),Q(s.$$.fragment),a=bt(),Q(l.$$.fragment)},l(c){Z(t.$$.fragment,c),e=St(c),Z(i.$$.fragment,c),n=St(c),Z(s.$$.fragment,c),a=St(c),Z(l.$$.fragment,c)},m(c,h){tt(t,c,h),G(c,e,h),tt(i,c,h),G(c,n,h),tt(s,c,h),G(c,a,h),tt(l,c,h),o=!0},p(c,h){const f={};h[1]&16777216&&(f.$$scope={dirty:h,ctx:c}),t.$set(f);const d={};h[1]&16777216&&(d.$$scope={dirty:h,ctx:c}),i.$set(d);const g={};h[1]&16777216&&(g.$$scope={dirty:h,ctx:c}),s.$set(g);const p={};h[0]&16|h[1]&16777216&&(p.$$scope={dirty:h,ctx:c}),l.$set(p)},i(c){o||(L(t.$$.fragment,c),L(i.$$.fragment,c),L(s.$$.fragment,c),L(l.$$.fragment,c),o=!0)},o(c){O(t.$$.fragment,c),O(i.$$.fragment,c),O(s.$$.fragment,c),O(l.$$.fragment,c),o=!1},d(c){c&&(F(e),F(n),F(a)),et(t,c),et(i,c),et(s,c),et(l,c)}}}function G3(r){let t,e,i,n;t=new uu({props:{href:"#",$$slots:{default:[p3]},$$scope:{ctx:r}}});let s=r[0]&&Hl(r);return{c(){Q(t.$$.fragment),e=bt(),s&&s.c(),i=Xt()},l(a){Z(t.$$.fragment,a),e=St(a),s&&s.l(a),i=Xt()},m(a,l){tt(t,a,l),G(a,e,l),s&&s.m(a,l),G(a,i,l),n=!0},p(a,l){const o={};l[1]&16777216&&(o.$$scope={dirty:l,ctx:a}),t.$set(o),a[0]?s?(s.p(a,l),l[0]&1&&L(s,1)):(s=Hl(a),s.c(),L(s,1),s.m(i.parentNode,i)):s&&(ge(),O(s,1,1,()=>{s=null}),pe())},i(a){n||(L(t.$$.fragment,a),L(s),n=!0)},o(a){O(t.$$.fragment,a),O(s),n=!1},d(a){a&&(F(e),F(i)),et(t,a),s&&s.d(a)}}}function Xl(r){let t,e,i=r[1].width+"",n,s,a=r[1].height+"",l,o;return{c(){t=ut("p"),e=dt("("),n=dt(i),s=dt("x"),l=dt(a),o=dt(")"),this.h()},l(c){t=ft(c,"P",{class:!0});var h=at(t);e=gt(h,"("),n=gt(h,i),s=gt(h,"x"),l=gt(h,a),o=gt(h,")"),h.forEach(F),this.h()},h(){Y(t,"class","text-sm text-gray-500")},m(c,h){G(c,t,h),Et(t,e),Et(t,n),Et(t,s),Et(t,l),Et(t,o)},p(c,h){h[0]&2&&i!==(i=c[1].width+"")&&Ye(n,i),h[0]&2&&a!==(a=c[1].height+"")&&Ye(l,a)},d(c){c&&F(t)}}}function O3(r){let t,e;return t=new $1({props:{config:{width:r[1].width,height:r[1].height,scaleX:r[1].width/r[3].panelSettings.width,scaleY:r[1].height/r[3].panelSettings.height},$$slots:{default:[V3]},$$scope:{ctx:r}}}),t.$on("click",r[14]),{c(){Q(t.$$.fragment)},l(i){Z(t.$$.fragment,i)},m(i,n){tt(t,i,n),e=!0},p(i,n){const s={};n[0]&10&&(s.config={width:i[1].width,height:i[1].height,scaleX:i[1].width/i[3].panelSettings.width,scaleY:i[1].height/i[3].panelSettings.height}),n[0]&15|n[1]&16777216&&(s.$$scope={dirty:n,ctx:i}),t.$set(s)},i(i){e||(L(t.$$.fragment,i),e=!0)},o(i){O(t.$$.fragment,i),e=!1},d(i){et(t,i)}}}function B3(r){let t,e;return t=new a2({props:{title:"Top view of PCB image or a project file",description:"Click to upload or drag and drop a file. Image file (png, jpg) begins a new project, a .tht3d file restores a previously saved project.",onUpload:r[29]}}),{c(){Q(t.$$.fragment)},l(i){Z(t.$$.fragment,i)},m(i,n){tt(t,i,n),e=!0},p:Yt,i(i){e||(L(t.$$.fragment,i),e=!0)},o(i){O(t.$$.fragment,i),e=!1},d(i){et(t,i)}}}function Yl(r){let t,e,i;function n(o){r[31](o,r[49],r[50],r[51])}function s(){return r[32](r[49])}function a(...o){return r[33](r[49],...o)}let l={};return r[49]!==void 0&&(l.config=r[49]),t=new U1({props:l}),xi.push(()=>Dr(t,"config",n)),t.$on("dblclick",s),t.$on("dragmove",a),t.$on("dragend",r[34]),{c(){Q(t.$$.fragment)},l(o){Z(t.$$.fragment,o)},m(o,c){tt(t,o,c),i=!0},p(o,c){r=o;const h={};!e&&c[0]&8&&(e=!0,h.config=r[49],Ir(()=>e=!1)),t.$set(h)},i(o){i||(L(t.$$.fragment,o),i=!0)},o(o){O(t.$$.fragment,o),i=!1},d(o){et(t,o)}}}function Kl(r){let t,e,i;function n(o){r[35](o,r[46],r[47],r[48])}function s(){return r[36](r[46])}function a(...o){return r[37](r[46],...o)}let l={};return r[46]!==void 0&&(l.config=r[46]),t=new Yc({props:l}),xi.push(()=>Dr(t,"config",n)),t.$on("dblclick",s),t.$on("dragmove",a),t.$on("dragend",r[38]),{c(){Q(t.$$.fragment)},l(o){Z(t.$$.fragment,o)},m(o,c){tt(t,o,c),i=!0},p(o,c){r=o;const h={};!e&&c[0]&8&&(e=!0,h.config=r[46],Ir(()=>e=!1)),t.$set(h)},i(o){i||(L(t.$$.fragment,o),i=!0)},o(o){O(t.$$.fragment,o),i=!1},d(o){et(t,o)}}}function $l(r){let t,e,i;function n(o){r[39](o,r[43],r[44],r[45])}function s(){return r[40](r[43])}function a(...o){return r[41](r[43],...o)}let l={};return r[43]!==void 0&&(l.config=r[43]),t=new Yc({props:l}),xi.push(()=>Dr(t,"config",n)),t.$on("dblclick",s),t.$on("dragmove",a),t.$on("dragend",r[42]),{c(){Q(t.$$.fragment)},l(o){Z(t.$$.fragment,o)},m(o,c){tt(t,o,c),i=!0},p(o,c){r=o;const h={};!e&&c[0]&8&&(e=!0,h.config=r[43],Ir(()=>e=!1)),t.$set(h)},i(o){i||(L(t.$$.fragment,o),i=!0)},o(o){O(t.$$.fragment,o),i=!1},d(o){et(t,o)}}}function U3(r){let t,e,i,n,s,a,l,o;t=new z1({props:{config:{image:r[0],scaleX:r[3].panelSettings.width/r[1].width,scaleY:-1*r[3].panelSettings.height/r[1].height,offsetY:r[1].height,opacity:.25}}});let c={};i=new e2({props:c}),r[30](i);let h=Pe(r[3].circles),f=[];for(let u=0;u<h.length;u+=1)f[u]=Yl(Vl(r,h,u));const d=u=>O(f[u],1,1,()=>{f[u]=null});let g=Pe(r[3].rectangles),p=[];for(let u=0;u<g.length;u+=1)p[u]=Kl(Ul(r,g,u));const v=u=>O(p[u],1,1,()=>{p[u]=null});let b=Pe(r[3].legs),_=[];for(let u=0;u<b.length;u+=1)_[u]=$l(Bl(r,b,u));const S=u=>O(_[u],1,1,()=>{_[u]=null});return{c(){Q(t.$$.fragment),e=bt(),Q(i.$$.fragment),n=bt();for(let u=0;u<f.length;u+=1)f[u].c();s=bt();for(let u=0;u<p.length;u+=1)p[u].c();a=bt();for(let u=0;u<_.length;u+=1)_[u].c();l=Xt()},l(u){Z(t.$$.fragment,u),e=St(u),Z(i.$$.fragment,u),n=St(u);for(let m=0;m<f.length;m+=1)f[m].l(u);s=St(u);for(let m=0;m<p.length;m+=1)p[m].l(u);a=St(u);for(let m=0;m<_.length;m+=1)_[m].l(u);l=Xt()},m(u,m){tt(t,u,m),G(u,e,m),tt(i,u,m),G(u,n,m);for(let y=0;y<f.length;y+=1)f[y]&&f[y].m(u,m);G(u,s,m);for(let y=0;y<p.length;y+=1)p[y]&&p[y].m(u,m);G(u,a,m);for(let y=0;y<_.length;y+=1)_[y]&&_[y].m(u,m);G(u,l,m),o=!0},p(u,m){const y={};m[0]&11&&(y.config={image:u[0],scaleX:u[3].panelSettings.width/u[1].width,scaleY:-1*u[3].panelSettings.height/u[1].height,offsetY:u[1].height,opacity:.25}),t.$set(y);const w={};if(i.$set(w),m[0]&8200){h=Pe(u[3].circles);let k;for(k=0;k<h.length;k+=1){const C=Vl(u,h,k);f[k]?(f[k].p(C,m),L(f[k],1)):(f[k]=Yl(C),f[k].c(),L(f[k],1),f[k].m(s.parentNode,s))}for(ge(),k=h.length;k<f.length;k+=1)d(k);pe()}if(m[0]&4104){g=Pe(u[3].rectangles);let k;for(k=0;k<g.length;k+=1){const C=Ul(u,g,k);p[k]?(p[k].p(C,m),L(p[k],1)):(p[k]=Kl(C),p[k].c(),L(p[k],1),p[k].m(a.parentNode,a))}for(ge(),k=g.length;k<p.length;k+=1)v(k);pe()}if(m[0]&4104){b=Pe(u[3].legs);let k;for(k=0;k<b.length;k+=1){const C=Bl(u,b,k);_[k]?(_[k].p(C,m),L(_[k],1)):(_[k]=$l(C),_[k].c(),L(_[k],1),_[k].m(l.parentNode,l))}for(ge(),k=b.length;k<_.length;k+=1)S(k);pe()}},i(u){if(!o){L(t.$$.fragment,u),L(i.$$.fragment,u);for(let m=0;m<h.length;m+=1)L(f[m]);for(let m=0;m<g.length;m+=1)L(p[m]);for(let m=0;m<b.length;m+=1)L(_[m]);o=!0}},o(u){O(t.$$.fragment,u),O(i.$$.fragment,u),f=f.filter(Boolean);for(let m=0;m<f.length;m+=1)O(f[m]);p=p.filter(Boolean);for(let m=0;m<p.length;m+=1)O(p[m]);_=_.filter(Boolean);for(let m=0;m<_.length;m+=1)O(_[m]);o=!1},d(u){u&&(F(e),F(n),F(s),F(a),F(l)),et(t,u),r[30](null),et(i,u),Pn(f,u),Pn(p,u),Pn(_,u)}}}function V3(r){let t,e;return t=new W1({props:{$$slots:{default:[U3]},$$scope:{ctx:r}}}),{c(){Q(t.$$.fragment)},l(i){Z(t.$$.fragment,i)},m(i,n){tt(t,i,n),e=!0},p(i,n){const s={};n[0]&15|n[1]&16777216&&(s.$$scope={dirty:n,ctx:i}),t.$set(s)},i(i){e||(L(t.$$.fragment,i),e=!0)},o(i){O(t.$$.fragment,i),e=!1},d(i){et(t,i)}}}function z3(r){let t,e,i,n,s=r[3].filename+"",a,l,o,c,h,f,d,g,p;t=new lu({props:{$$slots:{default:[G3]},$$scope:{ctx:r}}});let v=r[1]&&Xl(r);const b=[B3,O3],_=[];function S(u,m){return u[0]?u[1]?1:-1:0}return~(h=S(r))&&(f=_[h]=b[h](r)),{c(){Q(t.$$.fragment),e=bt(),i=ut("div"),n=ut("p"),a=dt(s),l=bt(),v&&v.c(),o=bt(),c=ut("div"),f&&f.c(),this.h()},l(u){Z(t.$$.fragment,u),e=St(u),i=ft(u,"DIV",{class:!0});var m=at(i);n=ft(m,"P",{class:!0});var y=at(n);a=gt(y,s),y.forEach(F),l=St(m),v&&v.l(m),m.forEach(F),o=St(u),c=ft(u,"DIV",{class:!0});var w=at(c);f&&f.l(w),w.forEach(F),this.h()},h(){Y(n,"class","text-sm"),Y(i,"class","flex justify-center"),Y(c,"class","flex justify-center")},m(u,m){tt(t,u,m),G(u,e,m),G(u,i,m),Et(i,n),Et(n,a),Et(i,l),v&&v.m(i,null),G(u,o,m),G(u,c,m),~h&&_[h].m(c,null),d=!0,g||(p=vh(Gh.call(null,window,{trigger:[{key:"C",modifier:["shift"],callback:r[15]},{key:"R",modifier:["shift"],callback:r[16]},{key:"L",modifier:["shift"],callback:r[17]},{key:"P",modifier:["shift"],callback:r[18]},{key:"d",callback:r[19]}]})),g=!0)},p(u,m){const y={};m[0]&17|m[1]&16777216&&(y.$$scope={dirty:m,ctx:u}),t.$set(y),(!d||m[0]&8)&&s!==(s=u[3].filename+"")&&Ye(a,s),u[1]?v?v.p(u,m):(v=Xl(u),v.c(),v.m(i,null)):v&&(v.d(1),v=null);let w=h;h=S(u),h===w?~h&&_[h].p(u,m):(f&&(ge(),O(_[w],1,1,()=>{_[w]=null}),pe()),~h?(f=_[h],f?f.p(u,m):(f=_[h]=b[h](u),f.c()),L(f,1),f.m(c,null)):f=null)},i(u){d||(L(t.$$.fragment,u),L(f),d=!0)},o(u){O(t.$$.fragment,u),O(f),d=!1},d(u){u&&(F(e),F(i),F(o),F(c)),et(t,u),v&&v.d(),~h&&_[h].d(),g=!1,p()}}}const ql=(r,t)=>r.name.localeCompare(t.name);function H3(r,t,e){let i,n;ci(r,Bt,D=>e(3,i=D)),ci(r,Ih,D=>e(4,n=D)),on(()=>{const D=Jl(Bt);D.image&&D.filename&&o(D.image,D.filename,!1,!1)});const s="1.2.1";let a,l;const o=(D,U,X,wt)=>{if(X&&D.startsWith("data:application/octet-stream"))try{const Vt=atob(D.replace("data:application/octet-stream;base64,","")),yt=JSON.parse(Vt),Kt=sh.safeParse(yt);if(Kt.success){Le(Bt,i.circles=Kt.data.circles||[],i),Le(Bt,i.rectangles=Kt.data.rectangles||[],i),Le(Bt,i.legs=Kt.data.legs||[],i),o(Kt.data.image,Kt.data.filename,!1,!0),Le(Bt,i.panelSettings=Kt.data.panelSettings,i);return}}catch{}e(0,a=document.createElement("img")),a.addEventListener("load",()=>{Le(Bt,i.filename=U,i),a&&(e(1,l={width:a.width,height:a.height}),X&&Le(Bt,i.panelSettings.height=Math.round(i.panelSettings.width*(l.height/l.width)),i),Le(Bt,i.image=D,i)),(X||wt)&&Bt.update(Vt=>(Vt.image=D,Vt.filename=U,Vt)),X&&f()}),a.addEventListener("error",()=>{e(0,a=void 0),Le(Bt,i.image="",i),Le(Bt,i.filename="",i)}),e(0,a.src=D,a)},c=()=>{const D={image:i.image,filename:i.filename,panelSettings:i.panelSettings,circles:i.circles,rectangles:i.rectangles,legs:i.legs},U=oh.stringify(D);xh(i.filename.slice(0,Math.max(0,i.filename.lastIndexOf(".")))+".tht3d",U)},h=async()=>{const{confirmed:D}=await Mh("Are you sure to reset PCB panel?");D&&(e(0,a=void 0),e(1,l=void 0),Bt.update(U=>(U.image="",U.filename="",U.circles=[],U.rectangles=[],U.legs=[],U)))},f=async()=>{const{confirmed:D,settings:U}=await Fh(i.panelSettings);D&&Bt.update(X=>(X.panelSettings=U,X))},d=D=>{switch(D.type){case"circle":{Ar({radius:D.radius,depth:D.depth});break}case"rectangle":{kr({width:D.width,height:D.height,depth:D.depth});break}}},g=()=>{if(!l)return;const D=Qg({panelSettings:i.panelSettings,rectangles:i.rectangles,circles:i.circles,legs:i.legs});Rh(i.filename,D)},p=(D,U)=>{const X=D.detail.target,wt=i.panelSettings.width-("sizeX"in U?U.width:Lr),Vt=i.panelSettings.height-("sizeY"in U?U.height:Lr);X.x()<0&&X.x(0),X.x()>wt&&X.x(wt),X.y()<0&&X.y(0),X.y()>Vt&&X.y(Vt)},v=(D,U)=>{const X=D.detail.target,wt=U.radius,Vt=U.radius,yt=i.panelSettings.width-U.radius,Kt=i.panelSettings.height-U.radius;X.x()<wt&&X.x(wt),X.x()>yt&&X.x(yt),X.y()<Vt&&X.y(Vt),X.y()>Kt&&X.y(Kt)};let b;const _=D=>{if(D.detail.evt.button===2){const U=D.detail.target.id();for(const X of[l3,g3,h3]){const wt=X(U);if(wt!==void 0){b.setItems(wt),b.toggleAt(D.detail.evt.pageX,D.detail.evt.pageY);return}}}},S=()=>Ar(),u=()=>kr(),m=()=>Ol(),y=()=>f(),w=()=>g(),k=()=>g(),C=()=>h(),A=()=>c(),T=()=>f(),P=()=>Ar(),E=()=>kr(),M=()=>Ol(),R=D=>d(D),N=()=>Nh(),B=(D,U)=>o(D,U,!0,!1);function q(D){xi[D?"unshift":"push"](()=>{b=D,e(2,b)})}function nt(D,U,X,wt){X[wt]=D,Bt.set(i)}const ct=D=>lh(D),K=(D,U)=>v(U,D),$=()=>Nn();function pt(D,U,X,wt){X[wt]=D,Bt.set(i)}const Tt=D=>hh(D),Ct=(D,U)=>p(U,D),ye=()=>an();function qt(D,U,X,wt){X[wt]=D,Bt.set(i)}return[a,l,b,i,n,s,o,c,h,f,d,g,p,v,_,S,u,m,y,w,k,C,A,T,P,E,M,R,N,B,q,nt,ct,K,$,pt,Tt,Ct,ye,qt,D=>c3(D),(D,U)=>p(U,D),()=>Rs()]}class Z3 extends Nt{constructor(t){super(),Lt(this,t,H3,z3,Mt,{},null,[-1,-1])}}export{Z3 as component};
